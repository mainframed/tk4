         TITLE '          **********  IDCTP01 - FORMAT MODULE  *********
               ***      '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCTP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00002-@MAINENT)
         DC    AL1(16)                                             0002
         DC    C'IDCTP01   77.341'                                 0002
IDCTPPR  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00250-IDCTPPR)
         ENTRY IDCTPPR
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @15,@01,16(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         AH    @15,4(,@15)                                         0002
         BR    @15                                                 0002
@EP00002 DS    0H                                                  0003
*         /***********************************************************/
*         /*                                                         */
*         /* THE RUNNING CODE BEGINS HERE.  FIRST, WE MUST SET UP    */
*         /* WORKING STORAGE.                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0250
*IDCTPPR: ENTRY (GDTTBLX,FILENAME,DDPTR,FMPTR);                    0250
*                                                                  0250
*                                                                  0250
         B     @EC00250                                            0250
@EP00250 MVC   @PC00001(16),0(@01)                                 0250
@EC00250 DS    0H                                                  0251
*                                                                  0251
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0251
*        GEN;                                                      0251
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0252
         LA    @03,1                                               0252
         STC   @03,LISTLN                                          0252
@DL00252 L     @15,LISTSCAN                                        0252
         TM    LISTTEST(@15),B'10000000'                           0252
         BNZ   @DC00252                                            0252
*          LISTSCAN = LISTSCAN + 4;                                0253
         AL    @15,@CF00036                                        0253
         ST    @15,LISTSCAN                                        0253
*        END;                                                      0254
*                                                                  0254
*                                                                  0254
         AL    @03,@CF00216                                        0254
         STC   @03,LISTLN                                          0254
         C     @03,@CF00894                                        0254
         BNH   @DL00252                                            0254
@DC00252 DS    0H                                                  0255
*         GDTPR = ADDR(GDTTBLX);                                   0255
         L     GDTPR,@PC00001                                      0255
*         IF GDTTPH = NULLPTR                                      0256
*           THEN                                                   0256
         L     @03,GDTTPH(,GDTPR)                                  0256
         LTR   @03,@03                                             0256
         BNZ   @RF00256                                            0256
*             /*******************************************************/
*             /*                                                     */
*             /* AN ENTRY AT THIS POINT WITHOUT A PCT POINTER IS     */
*             /* A CATASTROPHE.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0257
*                                                                  0257
*             DO;                                                  0257
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0258
*               REG15 = 24;                                        0259
         LA    REG15,24                                            0259
*               REG14 = GDTABT;                                    0260
         L     REG14,GDTABT(,GDTPR)                                0260
*               REG13 = GDTABH;                                    0261
         L     REG13,GDTABH(,GDTPR)                                0261
*               GEN(BR    REG14);                                  0262
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0263
*             END;                                                 0264
*                                                                  0264
*         DDSTRU = DDPTR;                                          0265
@RF00256 L     @04,@PC00001+8                                      0265
         L     DDSTRU,DDPTR(,@04)                                  0265
*         PCTPTR = GDTTPH;              /* SET LOCAL PCT PTR.        */
         L     PCTPTR,GDTTPH(,GDTPR)                               0266
*        PRTBUFPT = ADDR(PRTBUFF1);    /* PRIMARY PRINT BUFFER       */
         LA    @04,PRTBUFF1                                        0267
         ST    @04,PRTBUFPT                                        0267
*         IF PCTSPP ^= NULLPTR                                     0268
*           THEN                                                   0268
         L     @04,PCTSPP(,PCTPTR)                                 0268
         LTR   @04,@04                                             0268
         BZ    @RF00268                                            0268
*             PCTPTR = PCTSPP;          /* SET SECONDARY PCT PTR     */
         LR    PCTPTR,@04                                          0269
*         FFMFLAG = ''B;                /* CLEAR THE CONTROL FLAGS   */
@RF00268 XC    FFMFLAG(2),FFMFLAG                                  0270
*         FFM2FLG = ''B;                /* CLEAR CONTROL FLAG@OZ18517*/
         XC    FFM2FLG(2),FFM2FLG                                  0271
*         FFMREDOS = 0;                 /* CLEAR REDO START.         */
         SLR   @04,@04                                             0272
         ST    @04,FFMREDOS                                        0272
*         FFMREDOC = 0;                 /* INITIALIZE REDO COUNT.    */
         STH   @04,FFMREDOC                                        0273
*         FFMBDP = DARGDBP;             /* SET DATA BLOCK POINTER.   */
         L     @15,DARGDBP(,DDSTRU)                                0274
         ST    @15,FFMBDP                                          0274
*         FFMRBOFF = 0;                 /* INITIALIZE REDO OFFSET.   */
         ST    @04,FFMRBOFF                                        0275
*         IF DARGFULL = ON                                 /*@OZ14818*/
*           THEN                                           /*@OZ14818*/
         TM    DARGFULL(DDSTRU),B'10000000'                        0276
         BNO   @RF00276                                            0276
*             CVPRETP = NULLPTR;                           /*@OZ14818*/
         ST    @04,CVPRETP                                         0277
*           ELSE                                           /*@OZ14818*/
*             CVPRETP = DARGRETP;                          /*@OZ14818*/
         B     @RC00276                                            0278
@RF00276 L     @04,DARGRETP(,DDSTRU)                               0278
         ST    @04,CVPRETP                                         0278
*         DARGILP1 = NULLPTR;                              /*@OZ14818*/
@RC00276 SLR   @04,@04                                             0279
         ST    @04,DARGILP1                                        0279
*         CVPRETC = DARGRETL;           /* SET RETURN AREA LENGTH.   */
         LH    @15,DARGRETL(,DDSTRU)                               0280
         STH   @15,CVPRETC                                         0280
*         FFMPASS = ON;                 /* TURN ON THE FIRST PASS SW */
         OI    FFMPASS,B'00010000'                                 0281
*         PRTBUFF1 = ' ';               /* PRIME FORMAT BUFF.@Y30SSJK*/
         MVI   PRTBUFF1+1,C' '                                     0282
         MVC   PRTBUFF1+2(133),PRTBUFF1+1                          0282
         MVI   PRTBUFF1,C' '                                       0282
*         PRTBUFF2 = ' ';               /* 2ND LEVEL BUFF.   @Y30SSJK*/
         MVI   PRTBUFF2+1,C' '                                     0283
         MVC   PRTBUFF2+2(133),PRTBUFF2+1                          0283
         MVI   PRTBUFF2,C' '                                       0283
*         SAVERC = 0;                   /* INITIALIZE RETURN CODE.   */
         STH   @04,SAVERC                                          0284
*         PCTAPC = 0;                   /* CLEAR NEXT PRINT POSITION */
         STH   @04,PCTAPC(,PCTPTR)                                 0285
*         PCTIOP = FILENAME;            /* SET ALTERNATE IOCS PTR    */
         L     @15,@PC00001+4                                      0286
         L     @15,FILENAME(,@15)                                  0286
         ST    @15,PCTIOP(,PCTPTR)                                 0286
*         PCTPMN =''B;                  /*RESET PUT MSG NBR          */
*                                                                  0287
         SLR   @15,@15                                             0287
         STH   @15,PCTPMN(,PCTPTR)                                 0287
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE FORMAT STRUCTURED ARGUMENT LIST ADDRESSING.  */
*         /* IF AN STID EXISTS IN THE DYNAMIC DATA STRUCTURE,        */
*         /* SEARCH THE QUEUED LIST FOR IT AND IF NOT FOUND, GET     */
*         /* IT WITH A CALL TO IDCTP05. (GET STATIC TEXT)            */
*         /* IF NO STID EXISTS, THEN SET UP THE ADDRESSING FROM THE  */
*         /* POINTER PASSED WITH THE CALL.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0288
*         IF GDTDBG = NULLPTR                                      0288
*           THEN;                                                  0288
         C     @04,GDTDBG(,GDTPR)                                  0288
         BE    @RT00288                                            0288
*           ELSE                                                   0290
*             CALL IDCDB010 (GDTTBL,'TPSI');                       0290
*                                                                  0290
         ST    GDTPR,@AL00001                                      0290
         LA    @04,@CC00898                                        0290
         ST    @04,@AL00001+4                                      0290
         MVI   @AL00001+4,X'80'                                    0290
         L     @15,GDTDBG(,GDTPR)                                  0290
         LA    @01,@AL00001                                        0290
         BALR  @14,@15                                             0290
*         IF DARGSTID ^= NULLPTR                                   0291
*           THEN                                                   0291
@RT00288 L     @04,DARGSTID(,DDSTRU)                               0291
         LTR   @04,@04                                             0291
         BZ    @RF00291                                            0291
*             DO;                                                  0292
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH THE STATIC TEXT QUEUE FOR THIS STID.         */
*             /*  THIS QUEUE IS KEPT DURING EACH FSR EXECUTION.      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0293
*               QENTP = PCTSQP;                                    0293
         L     @06,PCTSQP(,PCTPTR)                                 0293
         ST    @06,QENTP                                           0293
*               DO WHILE QENTP ^= NULLPTR & QSTID ^= DARGSTID;     0294
         B     @DE00294                                            0294
@DL00294 DS    0H                                                  0295
*                 QENTP = QCHAIN;                                  0295
         L     @06,QENTP                                           0295
         L     @06,QCHAIN(,@06)                                    0295
         ST    @06,QENTP                                           0295
*               END;                                               0296
@DE00294 L     @06,QENTP                                           0296
         LTR   @06,@06                                             0296
         BZ    @DC00294                                            0296
         CLC   QSTID(4,@06),DARGSTID(DDSTRU)                       0296
         BNE   @DL00294                                            0296
@DC00294 DS    0H                                                  0297
*               IF QENTP = NULLPTR                                 0297
*                 THEN                                             0297
         L     @06,QENTP                                           0297
         LTR   @06,@06                                             0297
         BNZ   @RF00297                                            0297
*                   DO;                                            0298
*                                                                  0298
*                   /*************************************************/
*                   /*                                               */
*                   /* MAKE THE CALL TO GET STATIC TEXT (IDCTP05)    */
*                   /* THE ADDRESSING TO THE FORMAT LIST IS SET BY   */
*                   /* THE ADDRESS RETURNED FROM GET STATIC TEXT.    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0299
*                       CALL  IDCTP05(GDTTBL,                      0299
*                       DARGSTID,SBPOOL,QENTP);                    0299
*                                                                  0299
         ST    GDTPR,@AL00001                                      0299
         LA    @06,DARGSTID(,DDSTRU)                               0299
         ST    @06,@AL00001+4                                      0299
         LA    @06,SBPOOL                                          0299
         ST    @06,@AL00001+8                                      0299
         LA    @06,QENTP                                           0299
         ST    @06,@AL00001+12                                     0299
         L     @15,@CV00881                                        0299
         LA    @01,@AL00001                                        0299
         BALR  @14,@15                                             0299
*                       RESPECIFY RTNREG RSTD;                     0300
*                       TESTRC = RTNREG;                           0301
         STH   RTNREG,TESTRC                                       0301
*                       RESPECIFY RTNREG UNRSTD;                   0302
*                       IF TESTRC ^= 0                             0303
*                         THEN                                     0303
         LH    @06,TESTRC                                          0303
         LTR   @06,@06                                             0303
         BZ    @RF00303                                            0303
*                           DO;                                    0304
*                             CALL ERROR(6);                       0305
         LA    @01,@AL00305                                        0305
         BAL   @14,ERROR                                           0305
*                             CALL IDCSAEP0(GDTTBL,MODID,TESTRC);  0306
         ST    GDTPR,@AL00001                                      0306
         LA    @06,MODID                                           0306
         ST    @06,@AL00001+4                                      0306
         LA    @06,TESTRC                                          0306
         ST    @06,@AL00001+8                                      0306
         MVI   @AL00001+8,X'80'                                    0306
         L     @15,GDTEPL(,GDTPR)                                  0306
         LA    @01,@AL00001                                        0306
         BALR  @14,@15                                             0306
*                           END;                                   0307
*                   END;                                           0308
*                                                                  0308
@RF00303 DS    0H                                                  0309
*               /*****************************************************/
*               /*                                                   */
*               /* IF THIS STATIC TEXT STRUCTURE IS FOR A HEADER,    */
*               /* SET UP THE HEADING INFORMATION IN THE PCT.        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0309
*               IF QHEADF = ON                                     0309
*                 THEN                                             0309
@RF00297 L     @06,QENTP                                           0309
         TM    QHEADF(@06),B'01000000'                             0309
         BNO   @RF00309                                            0309
*                   DO;                                            0310
*                     PCTHLC = QHLC;                               0311
         IC    @04,QHLC(,@06)                                      0311
         STC   @04,PCTHLC(,PCTPTR)                                 0311
*                     PCTHSC = QHSC;                               0312
         IC    @04,QHSC(,@06)                                      0312
         STC   @04,PCTHSC(,PCTPTR)                                 0312
*                     PCTH1F = ON;                                 0313
*                     PCTH2F = OFF;                                0314
         OI    PCTH1F(PCTPTR),B'10000000'                          0314
         NI    PCTH2F(PCTPTR),B'10111111'                          0314
*                   END;                                           0315
*               IF QMSGF = ON                                      0316
*                 THEN                                             0316
@RF00309 L     @06,QENTP                                           0316
         TM    QMSGF(@06),B'10000000'                              0316
         BNO   @RF00316                                            0316
*                   DO;                                            0317
*                     FFMPMSF = ON;                                0318
         OI    FFMPMSF,B'00010000'                                 0318
*                     PCTPMN = -1;                                 0319
*                                                                  0319
         MVC   PCTPMN(2,PCTPTR),@CH00900                           0319
*                     IF QSECMF = ON & Q2LMSG = ON                 0320
*                       THEN                                       0320
         TM    QSECMF(@06),B'00101000'                             0320
         BNO   @RF00320                                            0320
*                        FFMPSMS = ON; /* 2ND MESSAGE FLAG  @Y30SSJK*/
*                                                                  0321
         OI    FFMPSMS,B'00001000'                                 0321
*                   END;                                           0322
@RF00320 DS    0H                                                  0323
*               FSADDR = ADDR(QTEXT);                              0323
@RF00316 L     FSADDR,QENTP                                        0323
         LA    FSADDR,QTEXT(,FSADDR)                               0323
*             END;                                                 0324
*                                                                  0324
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE ADDRESSING TO THE FORMAT LIST WHEN NO STID  */
*             /* IS PASSED IN THE DYNAMIC ARGUMENT LIST.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0325
*           ELSE                                                   0325
*             DO;                                                  0325
         B     @RC00291                                            0325
@RF00291 DS    0H                                                  0326
*               IF LISTLN = 4                                      0326
*                 THEN                                             0326
         CLI   LISTLN,4                                            0326
         BNE   @RF00326                                            0326
*                   FSADDR = FMPTR;                                0327
         L     @04,@PC00001+12                                     0327
         L     FSADDR,FMPTR(,@04)                                  0327
*                 ELSE                                             0328
*                   DO;                                            0328
         B     @RC00326                                            0328
@RF00326 DS    0H                                                  0329
*                     CALL ERROR (1);                              0329
         LA    @01,@AL00329                                        0329
         BAL   @14,ERROR                                           0329
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0330
         MVC   @AL00001+4(8),@AL00330                              0330
         ST    GDTPR,@AL00001                                      0330
         L     @15,GDTEPL(,GDTPR)                                  0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*                   END;                                           0331
*             END;                                                 0332
@RC00326 DS    0H                                                  0333
*         FFMSTRS = FSADDR;                                        0333
*                                                                  0333
@RC00291 ST    FSADDR,FFMSTRS                                      0333
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO INITIAL SPACING SUB-STRUCTURE EXISTS, SET DEFAULT.*/
*         /* SPACING FOR THE FIRST LINE.                             */
*         /* DEFAULT SPACING IS SET FROM THE DEFAULT SPACE CHARACTER */
*         /* IN THE PRINT CONTROL TABLE SET UP BY THE UEST OR UREST  */
*         /* MACROS.                                                 */
*         /* SPACE TYPE IS SET TO 'R'. (RELATIVE)                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0334
*         IF FMTSCF = OFF                                          0334
*           THEN                                                   0334
         TM    FMTSCF(FSADDR),B'01000000'                          0334
         BNZ   @RF00334                                            0334
*             DO;                                                  0335
*               PRTSPF = PCTDSC;        /* SET DEFAULT SPACE FACTOR  */
         LH    @04,PCTDSC(,PCTPTR)                                 0336
         STH   @04,PRTSPF                                          0336
*               PRTSPT = 'R';           /* SET RELATIVE SPACING.     */
         MVI   PRTSPT,C'R'                                         0337
*             END;                                                 0338
*                                                                  0338
*         /***********************************************************/
*         /*                                                         */
*         /* THIS IS THE BASE DO LOOP FOR EXECUTION OF THE FORMAT    */
*         /* STRUCTURES.                                             */
*         /* THIS LOOP SCANS THROUGH THE FORMAT LIST SUB-STRUCTURES  */
*         /* SETTING UP PARAMETERS FOR THE CALL TO THE CONVERSION    */
*         /* PROCEDURE(CONVERT) AND CALLING THAT PROC ONCE FOR EACH  */
*         /* FORMAT SUB-STRUCTURE THAT DEFINES DATA.  (BLOCK, INSERT,*/
*         /* STATIC TEXT OR DEFAULT SUB-STRUCTURES)                  */
*         /* SPACE AND REDO SUB-STRUCTURES ARE HANDLED ENTIRELY      */
*         /* WITHIN THIS PROCEDURE                                   */
*         /* THE END OF THIS DO LOOP IS AFTER THE REDO LOOPING       */
*         /* CONTROLS NEAR THE END OF THIS MAIN PROCEDURE.           */
*         /* CONTROL FLAGS USED IN THIS ROUTINE ARE AS FOLLOWS       */
*         /*    FFMEOS - END OF THE SUB-STRUCTURES.                  */
*         /*    FFMVS - A VALID SUB-STRUCTURE FOUND.                 */
*         /*    FFMDATA - A DATA SUB-STRUCTURE HAS BEEN FOUND.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0339
*STRLOOP: DO WHILE FFMEOS = OFF;        /* END OF STRUCT LIST FLAG   */
*                                                                  0339
@RF00334 DS    0H                                                  0339
STRLOOP  B     @DE00339                                            0339
@DL00339 DS    0H                                                  0340
*          IF FMTSMSG = ON  &                                      0340
*             FFMPSMS = ON                                         0340
*            THEN                                                  0340
         TM    FMTSMSG(FSADDR),B'10000000'                         0340
         BNO   @RF00340                                            0340
         TM    FFMPSMS,B'00001000'                                 0340
         BNO   @RF00340                                            0340
*              PRTBUFPT = ADDR(PRTBUFF2);                  /*@Y30SSJK*/
*                                                                  0341
         LA    @04,PRTBUFF2                                        0341
         ST    @04,PRTBUFPT                                        0341
*           IF FMTSCF = ON              /* SPACE CONTROL FLAG.       */
*             THEN                                                 0342
@RF00340 TM    FMTSCF(FSADDR),B'01000000'                          0342
         BNO   @RF00342                                            0342
*               DO;                                                0343
*                 /***************************************************/
*                 /*                                                 */
*                 /* HANDLE A SPACING SUB-STRUCTURE.                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0344
*                 FFMVS = ON;                                      0344
*                                                                  0344
         OI    FFMVS,B'01000000'                                   0344
*                 CALL SPACE;                                      0345
*                                                                  0345
         BAL   @14,SPACE                                           0345
*                 RESPECIFY RTNREG RSTD;                           0346
*                 TESTRC = RTNREG;                                 0347
         STH   RTNREG,TESTRC                                       0347
*                 RESPECIFY RTNREG UNRSTD;                         0348
*                 IF TESTRC ^= 0                                   0349
*                   THEN                                           0349
         LH    @04,TESTRC                                          0349
         LTR   @04,@04                                             0349
         BZ    @RF00349                                            0349
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0350
*                                                                  0350
         MVC   @AL00001+4(8),@AL00350                              0350
         ST    GDTPR,@AL00001                                      0350
         L     @15,GDTEPL(,GDTPR)                                  0350
         LA    @01,@AL00001                                        0350
         BALR  @14,@15                                             0350
*               END;                                               0351
*             ELSE                                                 0352
*               IF FMTREPF = ON         /* REDO FLAG.                */
*                 THEN                                             0352
         B     @RC00342                                            0352
@RF00342 TM    FMTREPF(FSADDR),B'00001000'                         0352
         BNO   @RF00352                                            0352
*                   DO;                                            0353
*                   /*************************************************/
*                   /*                                               */
*                   /* HANDLE A REDO OR REPLICATION SUB-STRUCTURE.   */
*                   /*                                               */
*                   /*************************************************/
*                     FFMVS = ON;                                  0354
*                                                                  0354
         OI    FFMVS,B'01000000'                                   0354
*                     CALL REDO;                                   0355
*                                                                  0355
         BAL   @14,REDO                                            0355
*                   END;                                           0356
*                 ELSE                                             0357
*                   IF FMTSTF = ON      /* STATIC TEXT FLAG.         */
*                     THEN                                         0357
         B     @RC00352                                            0357
@RF00352 TM    FMTSTF(FSADDR),B'00000100'                          0357
         BNO   @RF00357                                            0357
*                       DO;                                        0358
*                       /*********************************************/
*                       /*                                           */
*                       /* HANDLE A STATIC TEXT SUB-STRUCTURE.       */
*                       /*                                           */
*                       /*********************************************/
*                         FFMDATA = ON;                            0359
         OI    FFMDATA,B'00000010'                                 0359
*                         FFMVS = ON;                              0360
*                                                                  0360
         OI    FFMVS,B'01000000'                                   0360
*                         CALL STATIC;                             0361
*                                                                  0361
         BAL   @14,STATIC                                          0361
*                       END;                                       0362
*                     ELSE                                         0363
*                       IF FMTBDF = ON  /* BLOCK DATA FLAG.          */
*                         THEN                                     0363
         B     @RC00357                                            0363
@RF00357 TM    FMTBDF(FSADDR),B'00010000'                          0363
         BNO   @RF00363                                            0363
*                           DO;                                    0364
*                           /*****************************************/
*                           /*                                       */
*                           /* HANDLE A BLOCK DATA SUB-STRUCTURE.    */
*                           /*                                       */
*                           /*****************************************/
*                             FFMDATA = ON;                        0365
         OI    FFMDATA,B'00000010'                                 0365
*                             FFMVS = ON;                          0366
*                                                                  0366
         OI    FFMVS,B'01000000'                                   0366
*                             CALL BLOCK;                          0367
*                                                                  0367
         BAL   @14,BLOCK                                           0367
*                           END;                                   0368
*                         ELSE                                     0369
*                           IF FMTIDF = ON                         0369
*                                       /* INSERT DATA FLAG.         */
*                             THEN                                 0369
         B     @RC00363                                            0369
@RF00363 TM    FMTIDF(FSADDR),B'00100000'                          0369
         BNO   @RF00369                                            0369
*                               DO;                                0370
*                               /*************************************/
*                               /*                                   */
*                               /* HANDLE A DATA INSERT  DATA        */
*                               /* SUB-STRUCTURE.                    */
*                               /*                                   */
*                               /*************************************/
*                                 FFMDATA = ON;                    0371
         OI    FFMDATA,B'00000010'                                 0371
*                                 FFMVS = ON;                      0372
*                                                                  0372
         OI    FFMVS,B'01000000'                                   0372
*                                 CALL INSERT;                     0373
*                                                                  0373
         BAL   @14,INSERT                                          0373
*                               END;                               0374
*                       ELSE                                       0375
*                         IF FMTDFF = ON                           0375
*                                       /* DEFAULT DATA FLAG.        */
*                           THEN                                   0375
         B     @RC00369                                            0375
@RF00369 TM    FMTDFF(FSADDR),B'00000010'                          0375
         BNO   @RF00375                                            0375
*                             DO;                                  0376
*                             /***************************************/
*                             /*                                     */
*                             /* BYPASS A DEFAULT DATA SUB-STRUCTURE */
*                             /* IF A DEFAULT DATA SUB-STRUCTURE     */
*                             /* IS USED, IT IS USED IN THE INSERT   */
*                             /* HANDLING CODE BECAUSE THE REFERENCE */
*                             /* NUMBER WAS NOT FOUND IN THE USERS   */
*                             /* DYNAMIC ARGUMENT LIST.  THERE FORE, */
*                             /* IT IS NEVER USED IN LINE.           */
*                             /*                                     */
*                             /***************************************/
*                               STRSTP = 12;                       0377
         MVC   STRSTP(2),@CH00034                                  0377
*                               FFMVS = ON;                        0378
         OI    FFMVS,B'01000000'                                   0378
*                             END;                                 0379
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK TO INSURE THAT A VALID SUB-STRUCTURE WAS FOUND. */
*           /* IF NONE WAS FOUND, ISSUE ERROR MESSAGE AND RETURN.    */
*           /*                                                       */
*           /*********************************************************/
*           IF FFMVS = OFF                                         0380
*             THEN                                                 0380
@RF00375 DS    0H                                                  0380
@RC00369 DS    0H                                                  0380
@RC00363 DS    0H                                                  0380
@RC00357 DS    0H                                                  0380
@RC00352 DS    0H                                                  0380
@RC00342 TM    FFMVS,B'01000000'                                   0380
         BNZ   @RF00380                                            0380
*               DO;                                                0381
*                                                                  0381
*                 CALL ERROR(1);                                   0382
*                                                                  0382
         LA    @01,@AL00382                                        0382
         BAL   @14,ERROR                                           0382
*                 CALL IDCSAEP0(GDTTBL,MODID,RCERR);               0383
*                                                                  0383
         MVC   @AL00001+4(8),@AL00383                              0383
         ST    GDTPR,@AL00001                                      0383
         L     @15,GDTEPL(,GDTPR)                                  0383
         LA    @01,@AL00001                                        0383
         BALR  @14,@15                                             0383
*               END;                                               0384
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SUB STRUCTURE WAS A DATA HANDLING  STRUCTURE     */
*         /* (A STATIC TEXT, BLOCK DATA OR INSERT DATA SUB-STRUCTURE)*/
*         /* CONTINUE HERE WITH THE HANDLING OF THAT STRUCTURE.      */
*         /* VERIFY AND SET UP THE OUTPUT COLUMN AND LENGTH FOR THE  */
*         /* DATA TYPE TO BE HANDLED.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0385
*           IF FFMDATA = ON & FFMPINH = OFF                        0385
*             THEN                                                 0385
@RF00380 TM    FFMDATA,B'00000010'                                 0385
         BNO   @RF00385                                            0385
         TM    FFMPINH,B'10000000'                                 0385
         BNZ   @RF00385                                            0385
*DATALOOP:      DO;                                                0386
*                                                                  0386
DATALOOP DS    0H                                                  0387
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP THE CONVERSION FLAGS IN THE PRINT AND    */
*                 /* CONVERSION ARGUMENT LIST.                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0387
*                 CVPTYF = FMTCNVF;                                0387
         MVC   CVPTYF(2),FMTCNVF(FSADDR)                           0387
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET THE PARAMETERS FOR THE CONVERSION CALL.     */
*                 /* THE PARAMETERS SET ARE-                         */
*                 /*    CVPIADD - THE INPUT STRING ADDRESS.          */
*                 /*    CVPPADD - THE PRINT LINE POSITION ADDRESS.   */
*                 /*    CVPIL - THE INPUT STRING LENGTH.             */
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */
*                 /*    CVPOL THE OUTPUT STRING LENGTH.              */
*                 /*    CVPRETC = THE RETURN AREA LENGTH.            */
*                 /*    CVPRETP - THE RETURN AREA POINTER.           */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0388
*                 IF FMTBS = ON         /* IF BLANK SUPPRESSION.     */
*                   THEN                /* ADD OFFSET IN FMTOCOL TO  */
         TM    FMTBS(FSADDR),B'00010000'                           0388
         BNO   @RF00388                                            0388
*                                       /* LAST AVAILABLE POSITION.  */
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL + PCTAPC;  0389
         LH    @04,FMTOCOL(,FSADDR)                                0389
         AL    @04,PRTBUFPT                                        0389
         AH    @04,PCTAPC(,PCTPTR)                                 0389
         ST    @04,CVPPADD                                         0389
*                   ELSE                /* PRINT COLUMN IN FMTOCOL   */
*                                       /* TO A POSSIBLE INDENT.     */
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL - 1 + DARGIND;
         B     @RC00388                                            0390
@RF00388 LH    @04,FMTOCOL(,FSADDR)                                0390
         AL    @04,PRTBUFPT                                        0390
         BCTR  @04,0                                               0390
         SLR   @15,@15                                             0390
         IC    @15,DARGIND(,DDSTRU)                                0390
         ALR   @04,@15                                             0390
         ST    @04,CVPPADD                                         0390
*                 CVPOL = FMTOLEN;      /* SET OUTPUT LENGTH.        */
*                                                                  0391
@RC00388 LH    @04,FMTOLEN(,FSADDR)                                0391
         ST    @04,CVPOL                                           0391
*                 /***************************************************/
*                 /*                                                 */
*                 /* ASSURE PRINT COLUMN IS WITHIN THE PRINT LINE.   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0392
*                 IF CVPPADD > (ADDR(PRTBUFF) + PCTPLW - 1)        0392
*                   THEN                                           0392
         L     @04,PRTBUFPT                                        0392
         AL    @04,PCTPLW(,PCTPTR)                                 0392
         BCTR  @04,0                                               0392
         C     @04,CVPPADD                                         0392
         BNL   @RF00392                                            0392
*                     DO;                                          0393
*                                                                  0393
*                       CALL ERROR(2);                             0394
*                                                                  0394
         LA    @01,@AL00394                                        0394
         BAL   @14,ERROR                                           0394
*                       FFMPINH = ON;                              0395
         OI    FFMPINH,B'10000000'                                 0395
*                     END;                                         0396
*                                                                  0396
*         /***********************************************************/
*         /*                                                         */
*         /* COMPUTE THE CONVERTED LENGTH FOR THE VARIOUS DATA TYPES */
*         /* CONVL IS USED IN THIS SECTION OF CODE TO HOLD THE       */
*         /* COMPUTED OUTPUT LENGTH FOR THE SELECTED DATA TYPE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0397
*           CONVL = 0;                                             0397
*                                                                  0397
@RF00392 SLR   @04,@04                                             0397
         ST    @04,CONVL                                           0397
*           /* SET BINARY TO HEXIDECIMAL OR PACKED TO UNPACKED.      */
*           /*  OR BINARY TO HEXADECIMAL APOSTROPHE.         #Y30LSJK*/
*                                                                  0398
*           IF CVPBH = ON  CVPPU = ON  CVPBHA = ON               0398
*             THEN                                                 0398
         TM    CVPBH,B'11001000'                                   0398
         BZ    @RF00398                                            0398
*               CONVL = CVPIL + CVPIL;                             0399
*                                                                  0399
         L     @04,CVPIL                                           0399
         LR    @15,@04                                             0399
         ALR   @15,@04                                             0399
         ST    @15,CONVL                                           0399
*           /* CHECK FOR MAXIMUM PACKED TO UNPACKED OUTPUT LENGTH.   */
*                                                                  0400
*           IF CVPPU = ON                                          0400
*             THEN                                                 0400
@RF00398 TM    CVPPU,B'00001000'                                   0400
         BNO   @RF00400                                            0400
*               DO;                                                0401
*                 IF CVPOL > 16  CVPIL > 8                        0402
*                   THEN                                           0402
         L     @04,CVPOL                                           0402
         C     @04,@CF00479                                        0402
         BH    @RT00402                                            0402
         L     @04,CVPIL                                           0402
         C     @04,@CF00176                                        0402
         BNH   @RF00402                                            0402
@RT00402 DS    0H                                                  0403
*                     DO;                                          0403
*                                                                  0403
*                       CALL ERROR(3);                             0404
*                                                                  0404
         LA    @01,@AL00404                                        0404
         BAL   @14,ERROR                                           0404
*                       IF CVPIL > 8                               0405
*                         THEN                                     0405
         LA    @04,8                                               0405
         C     @04,CVPIL                                           0405
         BNL   @RF00405                                            0405
*                           CVPIL = 8;                             0406
         ST    @04,CVPIL                                           0406
*                     END;                                         0407
@RF00405 DS    0H                                                  0408
*                CONVL = 16;                                       0408
@RF00402 MVC   CONVL(4),@CF00479                                   0408
*               END;                                               0409
*                                                                  0409
*           /* CHECK FOR MAXIMUM BINARY TO DECIMAL LENGTHS.          */
*                                                                  0410
*          IF CVPBD = ON                                           0410
*            THEN                                                  0410
@RF00400 TM    CVPBD,B'00010000'                                   0410
         BNO   @RF00410                                            0410
*              DO;                                                 0411
*                IF CVPIL > 4  CVPOL > 16                         0412
*                  THEN                                            0412
         L     @04,CVPIL                                           0412
         C     @04,@CF00036                                        0412
         BH    @RT00412                                            0412
         L     @04,CVPOL                                           0412
         C     @04,@CF00479                                        0412
         BNH   @RF00412                                            0412
@RT00412 DS    0H                                                  0413
*                    DO;                                           0413
*                                                                  0413
*                      CALL ERROR(3);                              0414
*                                                                  0414
         LA    @01,@AL00414                                        0414
         BAL   @14,ERROR                                           0414
*                      IF CVPIL > 4                                0415
*                        THEN                                      0415
         LA    @04,4                                               0415
         C     @04,CVPIL                                           0415
         BNL   @RF00415                                            0415
*                          CVPIL = 4;                              0416
         ST    @04,CVPIL                                           0416
*                    END;                                          0417
@RF00415 DS    0H                                                  0418
*                CONVL = 16;                                       0418
@RF00412 MVC   CONVL(4),@CF00479                                   0418
*              END;                                                0419
*                                                                  0419
*           /* IF NONE OF THE ABOVE, THEN SET TO THE INPUT LENGTH.   */
*                                                                  0420
*           IF CONVL = 0                                           0420
*             THEN                                                 0420
@RF00410 L     @04,CONVL                                           0420
         LTR   @04,@04                                             0420
         BNZ   @RF00420                                            0420
*               CONVL = CVPIL;                                     0421
*                                                                  0421
         L     @04,CVPIL                                           0421
         ST    @04,CONVL                                           0421
*         /***********************************************************/
*         /*                                                         */
*         /*  SET OUTPUT LENGTH FOR ANY DEFAULTED LENGTH FIELD.      */
*         /* CALLER SPECIFIED NO LENGTH IN THE FORMAT STRUCTURE.     */
*         /* OR SPECIFIED LENGTH WAS LESS THAN DATA LENGTH.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0422
*           IF CVPOL = 0  CONVL < CVPOL                           0422
*             THEN                                                 0422
@RF00420 L     @04,CVPOL                                           0422
         LTR   @04,@04                                             0422
         BZ    @RT00422                                            0422
         C     @04,CONVL                                           0422
         BNH   @RF00422                                            0422
@RT00422 DS    0H                                                  0423
*               CVPOL = CONVL;                                     0423
*                                                                  0423
         L     @04,CONVL                                           0423
         ST    @04,CVPOL                                           0423
*           /*********************************************************/
*           /*                                                       */
*           /* IF INPUT OR OUTPUT LENGTH IS LESS THAN ONE, THEN      */
*           /* PUT OUT AN ERROR MESSAGE HERE AND TERMINATE.          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0424
*           IF CVPOL < 1  CVPIL < 1                               0424
*             THEN                                                 0424
@RF00422 LA    @04,1                                               0424
         C     @04,CVPOL                                           0424
         BH    @RT00424                                            0424
         C     @04,CVPIL                                           0424
         BNH   @RF00424                                            0424
@RT00424 DS    0H                                                  0425
*               DO;                                                0425
*                                                                  0425
*                 CALL ERROR(1);                                   0426
*                                                                  0426
         LA    @01,@AL00426                                        0426
         BAL   @14,ERROR                                           0426
*                 CALL IDCSAEP0(GDTTBL,MODID,RCERR);               0427
*                                                                  0427
         MVC   @AL00001+4(8),@AL00427                              0427
         ST    GDTPR,@AL00001                                      0427
         L     @15,GDTEPL(,GDTPR)                                  0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*               END;                                               0428
*         /************************************************************
*         /*                                                 #Y30LSJK*/
*         /* ADJUST OUTPUT LENGTH FOR BINARY TO HEXADECIMAL. #Y30LSJK*/
*         /*                                                 @Y30LSJK*/
*         /************************************************************
*         IF CVPBH = ON  CVPBHA = ON                              0429
*           THEN                                                   0429
@RF00424 TM    CVPBH,B'11000000'                                   0429
         BZ    @RF00429                                            0429
*             DO;                                          /*@Y30LSJK*/
*             IF CVPOL // 2 ^= 0                                   0431
*               THEN                                               0431
         L     @04,CVPOL                                           0431
         LR    @00,@04                                             0431
         SRDA  @00,32                                              0431
         D     @00,@CF00150                                        0431
         LTR   @00,@00                                             0431
         BZ    @RF00431                                            0431
*                 CVPOL = CVPOL + 1;                       /*@Y30LSJK*/
         AL    @04,@CF00216                                        0432
         ST    @04,CVPOL                                           0432
*             END;                                         /*@Y30LSJK*/
*                                                                  0433
@RF00431 DS    0H                                                  0434
*         IF CVPBHA = ON                                           0434
*           THEN                                                   0434
@RF00429 TM    CVPBHA,B'01000000'                                  0434
         BNO   @RF00434                                            0434
*             CVPOL = CVPOL + 3;                           /*@Y30LSJK*/
*                                                                  0435
         LA    @04,3                                               0435
         AL    @04,CVPOL                                           0435
         ST    @04,CVPOL                                           0435
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SUB-STRUCTURE IS FOR A BINARY TO HEXIDECIMAL     */
*         /* DUMP, CHECK FOR ANY PREVIOUS FORMATTING AS THAT LINE    */
*         /* MUST BE PRINTED PRIOR TO CONVERTING THE DUMP.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0436
*           IF CVPBHD = ON                                         0436
*             THEN                                                 0436
@RF00434 TM    CVPBHD,B'00100000'                                  0436
         BNO   @RF00436                                            0436
*               DO;                                                0437
*                                                                  0437
*                 IF FFMFMTF = ON                                  0438
*                   THEN                                           0438
         TM    FFMFMTF,B'00000001'                                 0438
         BNO   @RF00438                                            0438
*                     DO;                                          0439
*                                                                  0439
*                       CALL LINEPRT;                              0440
*                                                                  0440
         BAL   @14,LINEPRT                                         0440
*                       RESPECIFY RTNREG RSTD;                     0441
*                       TESTRC = RTNREG;                           0442
         STH   RTNREG,TESTRC                                       0442
*                       RESPECIFY RTNREG UNRSTD;                   0443
*                       IF TESTRC >0                               0444
*                         THEN                                     0444
         LH    @04,TESTRC                                          0444
         LTR   @04,@04                                             0444
         BNP   @RF00444                                            0444
*                           CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);    0445
         MVC   @AL00001+4(8),@AL00445                              0445
         ST    GDTPR,@AL00001                                      0445
         L     @15,GDTEPL(,GDTPR)                                  0445
         LA    @01,@AL00001                                        0445
         BALR  @14,@15                                             0445
*                     END;                                         0446
*                                                                  0446
@RF00444 DS    0H                                                  0447
*                 /* SET THE PRINT ADDRESS FOR BINARY TO HEX DUMP.   */
*                                                                  0447
*                 CVPPADD = ADDR(PRTBUFF);                         0447
@RF00438 L     @04,PRTBUFPT                                        0447
         ST    @04,CVPPADD                                         0447
*               END;                                               0448
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP IS COMPLETE AND WE ARE NOW READY TO CALL THE     */
*         /* CONVERSION PROCEDURE(CONVERT) FOR THE CONVERSION OF THIS*/
*         /* SEGMENT.                                                */
*         /* RETURN CODES ARE                                        */
*         /*    0 - GOOD RETURN                                      */
*         /*    4 - GOOD RETURN BUT LINE OVERFLOW OCCURED AND ALL    */
*         /*        PREVIOUSLY FORMATTED DATA HAS BEEN PRINTED.      */
*         /*    8 - PACKED DECIMAL INPUT IS INVALID.                 */
*         /*    OTHER - ERROR IN CONVERSION OR PRINTING.             */
*         /*        GREATER THAN 8 IS TERMINATING.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0449
*           IF FFMPINH = OFF                                       0449
*             THEN                                                 0449
@RF00436 TM    FFMPINH,B'10000000'                                 0449
         BNZ   @RF00449                                            0449
*               DO;                                                0450
*                                                                  0450
*                 OLDERID2 = NEWERID2;                             0451
         L     @04,GDTTR2(,GDTPR)                                  0451
         MVC   @TS00001(95),NEWERID2(@04)                          0451
         MVC   OLDERID2(95,@04),@TS00001                           0451
*                 NEWID2 = 'TPCC';                                 0452
*                                                                  0452
         MVC   NEWID2(4,@04),@CC00912                              0452
*                 CALL CONVERT;                                    0453
*                                                                  0453
         BAL   @14,CONVERT                                         0453
*                 RESPECIFY RTNREG RSTD;                           0454
*                 TESTRC = RTNREG;                                 0455
         STH   RTNREG,TESTRC                                       0455
*                 RESPECIFY RTNREG UNRSTD;                         0456
*                 IF TESTRC > 8                                    0457
*                   THEN                                           0457
*                                                                  0457
         LH    @04,TESTRC                                          0457
         C     @04,@CF00176                                        0457
         BNH   @RF00457                                            0457
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0458
*                                                                  0458
         MVC   @AL00001+4(8),@AL00458                              0458
         ST    GDTPR,@AL00001                                      0458
         L     @15,GDTEPL(,GDTPR)                                  0458
         LA    @01,@AL00001                                        0458
         BALR  @14,@15                                             0458
*                 IF TESTRC = 8                                    0459
*                   THEN                                           0459
@RF00457 CLC   TESTRC(2),@CH00176                                  0459
         BNE   @RF00459                                            0459
*                     DO;                                          0460
*                                                                  0460
*                       CALL ERROR (7);                            0461
*                                                                  0461
         LA    @01,@AL00461                                        0461
         BAL   @14,ERROR                                           0461
*                     END;                                         0462
*                 IF TESTRC = 0                                    0463
*                   THEN                                           0463
@RF00459 LH    @04,TESTRC                                          0463
         LTR   @04,@04                                             0463
         BNZ   @RF00463                                            0463
*                     FFMFMTF = ON;                                0464
         OI    FFMFMTF,B'00000001'                                 0464
*               END;                                               0465
@RF00463 DS    0H                                                  0466
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REDO FLAG (FFMREDOF) IS ON, HANDLE THE LOOPING   */
*         /* CONTROLS FOR REDO HERE.                                 */
*         /*                                                         */
*         /* PARAMETERS CONTROLING REPLICATION ARE AS FOLLOWS:       */
*         /*                                                         */
*         /* FFMREDOF - FLAG INDICATING A REPLICATION IS OPERATING.  */
*         /* FFMREDOC - COUNT OF REDO STRUCTURES IN THE FORMAT LIST  */
*         /* FFMREDOL - COUNT OF THE NUMBER OF REPLICATIONS.         */
*         /* FFMREDOO - OFFSET IN BLOCK DATA FOR EACH REPLICATION.   */
*         /* FFMRBOFF - CURRENT INPUT BLOCK OFFSET.                  */
*         /* REDOCSAV - AREA FOR SAVING COUNT OF REDO FORMAT         */
*         /*            SUB-STRUCTURES.                              */
*         /* FFMREDOS - AREA FOR SAVING START OF REDO FORMAT         */
*         /*            SUB-STRUCTURES.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0466
*            END DATALOOP;                                         0466
@RF00449 DS    0H                                                  0467
*           IF FFMREDOF = ON & FFMDATA = ON                        0467
*             THEN                                                 0467
@RF00385 TM    FFMREDOF,B'10000010'                                0467
         BNO   @RF00467                                            0467
*               DO;                                                0468
*                                                                  0468
*                 /***************************************************/
*                 /*                                                 */
*                 /* REDUCE SUB-STRUCTURE COUNT BY ONE.              */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0469
*                 FFMREDOC = FFMREDOC - 1;                         0469
*                                                                  0469
         LH    @04,FFMREDOC                                        0469
         BCTR  @04,0                                               0469
         STH   @04,FFMREDOC                                        0469
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE REDO COUNT IS ZERO, THIS IS THE LAST     */
*                 /* SUB-STRUCTURE OF THE LOOP SO PRINT              */
*                 /* THE LINE.                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0470
*                 IF FFMREDOC = 0        /* IS THIS THE LAST STRUCT  */
*                   THEN                                           0470
         LTR   @04,@04                                             0470
         BNZ   @RF00470                                            0470
*                     DO;                                          0471
*                                                                  0471
*                       /*********************************************/
*                       /*                                           */
*                       /* PRINT THIS COMPLETE LINE                  */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0472
*                       IF FFMFMTF = ON                            0472
*                         THEN                                     0472
         TM    FFMFMTF,B'00000001'                                 0472
         BNO   @RF00472                                            0472
*                           DO;                                    0473
*                                                                  0473
*                             CALL LINEPRT;                        0474
*                                                                  0474
         BAL   @14,LINEPRT                                         0474
*                             RESPECIFY RTNREG RSTD;               0475
*                             TESTRC = RTNREG;                     0476
         STH   RTNREG,TESTRC                                       0476
*                             RESPECIFY RTNREG UNRSTD;             0477
*                             IF TESTRC ^= 0                       0478
*                               THEN                               0478
         LH    @04,TESTRC                                          0478
         LTR   @04,@04                                             0478
         BZ    @RF00478                                            0478
*                                 CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);
         MVC   @AL00001+4(8),@AL00479                              0479
         ST    GDTPR,@AL00001                                      0479
         L     @15,GDTEPL(,GDTPR)                                  0479
         LA    @01,@AL00001                                        0479
         BALR  @14,@15                                             0479
*                             IF FFMPMSF = ON     /* REDO A MESSAGE */
*                               THEN                               0480
@RF00478 TM    FFMPMSF,B'00010000'                                 0480
         BNO   @RF00480                                            0480
*                                 PCTPMN = -1;                     0481
         MVC   PCTPMN(2,PCTPTR),@CH00900                           0481
*                           END;                                   0482
*                                                                  0482
@RF00480 DS    0H                                                  0483
*                       /*********************************************/
*                       /*                                           */
*                       /* REDUCE THE LOOPING COUNT BY ONE.          */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0483
*                       FFMREDOL = FFMREDOL - 1;                   0483
*                                                                  0483
@RF00472 LH    @04,FFMREDOL                                        0483
         BCTR  @04,0                                               0483
         STH   @04,FFMREDOL                                        0483
*                       /*********************************************/
*                       /*                                           */
*                       /* IF THE LOOP COUNT IS ZERO, THIS IS THE    */
*                       /* LAST REPLICATION SO CLEAN UP AND END.     */
*                       /*                                           */
*                       /*********************************************/
*                       IF FFMREDOL = 0 /* IS THIS THE LAST TIME     */
*                         THEN                                     0484
         SLR   @15,@15                                             0484
         CR    @04,@15                                             0484
         BNE   @RF00484                                            0484
*                           DO;                                    0485
*                                                                  0485
*                             /* IF YES, CLEAR THE REDO FIELDS       */
*                                                                  0486
*                             FFMREDOF = OFF;                      0486
*                             FFMIDINH = OFF;                      0487
         NI    FFMREDOF,B'01110111'                                0487
*                             FFMREDOS = 0;                        0488
         ST    @15,FFMREDOS                                        0488
*                             FFMRBOFF = 0;                        0489
         ST    @15,FFMRBOFF                                        0489
*                           END;                                   0490
*                         ELSE                                     0491
*                           DO;                                    0491
*                                                                  0491
         B     @RC00484                                            0491
@RF00484 DS    0H                                                  0492
*                             /***************************************/
*                             /*                                     */
*                             /* IF NOT, RESTORE TO START OF STRUCT  */
*                             /* STEP THE INPUT OFFSET AND DO AGAIN  */
*                             /*                                     */
*                             /***************************************/
*                                                                  0492
*                             FFMREDOC = REDOCSAV;                 0492
         LH    @04,REDOCSAV                                        0492
         STH   @04,FFMREDOC                                        0492
*                             FSADDR = FFMREDOS;                   0493
         L     FSADDR,FFMREDOS                                     0493
*                             STRSTP = 0;                          0494
         SLR   @04,@04                                             0494
         STH   @04,STRSTP                                          0494
*                             FFMRBOFF = FFMRBOFF + FFMREDOO;      0495
         LH    @04,FFMREDOO                                        0495
         AL    @04,FFMRBOFF                                        0495
         ST    @04,FFMRBOFF                                        0495
*                             FFMIDINH = ON;                       0496
         OI    FFMIDINH,B'00001000'                                0496
*                           END;                                   0497
*                     END;                                         0498
@RC00484 DS    0H                                                  0499
*               END;                                               0499
@RF00470 DS    0H                                                  0500
*             FFMPASS = OFF;                                       0500
@RF00467 DS    0H                                                  0501
*             FFMDATA = OFF;                                       0501
*                                                                  0501
         NI    FFMPASS,B'11101101'                                 0501
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR END OF THE SUB-STRUCTURE LIST AND SET END     */
*         /* FLAG IF IT IS FINISHED.                                 */
*         /* TO BE AT THE END OF THE STRUCTURE, REDO FLAG MUST BE    */
*         /* OFF                                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0502
*           IF FMTEOLF = ON & FFMREDOF = OFF                       0502
*             THEN                                                 0502
         TM    FMTEOLF(FSADDR),B'10000000'                         0502
         BNO   @RF00502                                            0502
         TM    FFMREDOF,B'10000000'                                0502
         BNZ   @RF00502                                            0502
*               FFMEOS = ON;                                       0503
*                                                                  0503
         OI    FFMEOS,B'01000000'                                  0503
*         /***********************************************************/
*         /*                                                         */
*         /* STEP TO THE NEXT SUB-STRUCTURE.                         */
*         /* STRSTP CONTAINS THE INCREMENT TO STEP THE STRUCTURE     */
*         /* BASE ADDRESS FOR ADDRESSING THE NEXT SUB-STRUCTURE.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0504
*           FSADDR = FSADDR + STRSTP;                              0504
@RF00502 AH    FSADDR,STRSTP                                       0504
*           FFMVS = OFF;                                           0505
*           FFMPINH = OFF;                                         0506
*                                                                  0506
         NI    FFMVS,B'00111111'                                   0506
*         /***********************************************************/
*         /*                                                         */
*         /* THE SUB-STRUCTURE HANDLING LOOP ENDS HERE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0507
*         END STRLOOP;                                             0507
@DE00339 TM    FFMEOS,B'01000000'                                  0507
         BZ    @DL00339                                            0507
*         /***********************************************************/
*         /*                                                         */
*         /* THE SUB-STRUCTURE LOOP IS COMPLETED.  CLEAN UP          */
*         /* AND RETURN TO THE CALLER.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0508
*         IF FFMFMTF = ON                                          0508
*           THEN                                                   0508
         TM    FFMFMTF,B'00000001'                                 0508
         BNO   @RF00508                                            0508
*             DO;                                                  0509
*                                                                  0509
*             IF FFMPSMS = ON                                      0510
*              THEN                                                0510
         TM    FFMPSMS,B'00001000'                                 0510
         BNO   @RF00510                                            0510
*                PRTBUFPT = ADDR(PRTBUFF1);                /*@Y30SSJK*/
         LA    @06,PRTBUFF1                                        0511
         ST    @06,PRTBUFPT                                        0511
*               CALL LINEPRT;                                      0512
*                                                                  0512
@RF00510 BAL   @14,LINEPRT                                         0512
*               RESPECIFY RTNREG RSTD;                             0513
*               TESTRC = RTNREG;                                   0514
         STH   RTNREG,TESTRC                                       0514
*               RESPECIFY RTNREG UNRSTD;                           0515
*               SAVERC = TESTRC;                                   0516
         LH    @03,TESTRC                                          0516
         STH   @03,SAVERC                                          0516
*             END;                                                 0517
*         IF GDTDBG = NULLPTR                                      0518
*           THEN;                                                  0518
@RF00508 L     @03,GDTDBG(,GDTPR)                                  0518
         LTR   @03,@03                                             0518
         BZ    @RT00518                                            0518
*           ELSE                                                   0520
*             CALL IDCDB010 (GDTTBL,'TP1N');                       0520
*                                                                  0520
         ST    GDTPR,@AL00001                                      0520
         LA    @03,@CC00914                                        0520
         ST    @03,@AL00001+4                                      0520
         MVI   @AL00001+4,X'80'                                    0520
         L     @15,GDTDBG(,GDTPR)                                  0520
         LA    @01,@AL00001                                        0520
         BALR  @14,@15                                             0520
*         CALL IDCSAEP0(GDTTBL,MODID,SAVERC);                      0521
@RT00518 ST    GDTPR,@AL00001                                      0521
         LA    @03,MODID                                           0521
         ST    @03,@AL00001+4                                      0521
         LA    @03,SAVERC                                          0521
         ST    @03,@AL00001+8                                      0521
         MVI   @AL00001+8,X'80'                                    0521
         L     @15,GDTEPL(,GDTPR)                                  0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCEDURE NAME - SPACE CONTROL PROCEDURE.              */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE SETS UP SPACING DICTATED BY   */
*         /* SPACE SUB-STRUCTURE IN THE FORMAT LIST.  IN ADDITION,   */
*         /* IT CAUSES THE PRINTING OF A LINE EACH TIME THIS ITEM    */
*         /* IS ENCOUNTERED AFTER ANY DATA IS FORMATTED.             */
*         /*                                                         */
*         /* INPUT - INPUT IS THE SPACING SUB-STRUCTURE AS DEFINED   */
*         /* BY THE FORMAT STRUCTURED ARGUMENT LIST IN THE GLOBAL    */
*         /* INCLUDE.                                                */
*         /*                                                         */
*         /* OUTPUT - THE SPACING SET UP IN THE PRINT ARGUMENT LIST  */
*         /* PASSED TO THE LINE PRINT PROCEDURE.(LINEPRT)            */
*         /* SEE CVPSTRU IN THIS LISTING.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0522
*SPACE:   PROC;                                                    0522
*                                                                  0522
*                                                                  0522
         B     @PB00002                                            0522
SPACE    STM   @14,@06,@SA00002                                    0522
         STM   @08,@12,@SA00002+36                                 0522
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS NOT THE FIRST PASS, PRINT THE LINE.          */
*         /* FFMPASS IS TURNED ON BY THE FIRST ENTRY TO THE          */
*         /* CONVERSION ROUTINE.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0523
*         IF FFMPASS = OFF                                         0523
*           THEN                                                   0523
         TM    FFMPASS,B'00010000'                                 0523
         BNZ   @RF00523                                            0523
*             DO;                                                  0524
*               IF FFMFMTF = ON                                    0525
*                 THEN                                             0525
         TM    FFMFMTF,B'00000001'                                 0525
         BNO   @RF00525                                            0525
*                   DO;                                            0526
*                                                                  0526
*                     CALL LINEPRT;                                0527
*                                                                  0527
         BAL   @14,LINEPRT                                         0527
*                     RESPECIFY RTNREG RSTD;                       0528
*                     TESTRC = RTNREG;                             0529
         STH   RTNREG,TESTRC                                       0529
*                     RESPECIFY RTNREG UNRSTD;                     0530
*                     IF TESTRC > 0                                0531
*                       THEN                                       0531
         LH    @03,TESTRC                                          0531
         LTR   @03,@03                                             0531
         BNP   @RF00531                                            0531
*                         RETURN CODE (RCQUIT);                    0532
         LH    @15,RCQUIT                                          0532
         L     @14,@SA00002                                        0532
         LM    @00,@06,@SA00002+8                                  0532
         LM    @08,@12,@SA00002+36                                 0532
         BR    @14                                                 0532
*                     /**************************************@OZ18517*/
*                     /*                                     @OZ18517*/
*                     /* IF A MESSAGE, THIS IS AN EMBEDDED   @OZ18517*/
*                     /* SPACING SUBSTRUCTURE. THE SEGMENT   @OZ18517*/
*                     /* ROUTINE ASSUMES THAT USER HAS DONE  @OZ18517*/
*                     /* HIS OWN SEGMENTING. SUPPRESS MESSAGE@OZ18517*/
*                     /* NUMBER PROCESSING IN SEGMENT ROUTINE@OZ18517*/
*                     /*                                     @OZ18517*/
*                     /**************************************@OZ18517*/
*                     IF FFMPMSF = ON                      /*@OZ18517*/
*                       THEN                               /*@OZ18517*/
@RF00531 TM    FFMPMSF,B'00010000'                                 0533
         BNO   @RF00533                                            0533
*                         FFM2SMN = ON;                    /*@OZ18517*/
         OI    FFM2SMN,B'10000000'                                 0534
*                   END;                                           0535
@RF00533 DS    0H                                                  0536
*             END;                                                 0536
*                                                                  0536
@RF00525 DS    0H                                                  0537
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE SPACING ARGUMENTS FOR THIS SUB-STRUCTURE.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0537
*         PRTSPF = FMTSPF;              /* SET SPACING FACTOR.       */
@RF00523 LH    @03,FMTSPF(,FSADDR)                                 0537
         STH   @03,PRTSPF                                          0537
*         PRTSPT = FMTSPT;              /* SET SPACING TYPE.         */
         MVC   PRTSPT(1),FMTSPT(FSADDR)                            0538
*         STRSTP = 6;                   /* SET FORMAT LIST STEPPING  */
         MVC   STRSTP(2),@CH00153                                  0539
*         FFMPASS = OFF;                /* ASSURE 1ST PASS SWITCH OFF*/
*                                                                  0540
         NI    FFMPASS,B'11101111'                                 0540
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE SPACE PROCEDURE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0541
*         RETURN CODE (0);                                         0541
         SLR   @15,@15                                             0541
         L     @14,@SA00002                                        0541
         LM    @00,@06,@SA00002+8                                  0541
         LM    @08,@12,@SA00002+36                                 0541
         BR    @14                                                 0541
*         END SPACE;                                               0542
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - REPLICATION INITIALIZATION             */
*         /*                                                         */
*         /* FUNCTION - INITIALIZES PARAMETERS TO CONTROL THE REDO   */
*         /* OPERATION.                                              */
*         /*                                                         */
*         /* INPUT - THE REDO SUB-STRUCTURE OF THE FORMAT ARGUMENT   */
*         /* AS DESCRIBED IN THE GLOBAL INCLUDE.  (FMTLIST)          */
*         /*                                                         */
*         /* OUTPUT - THE PARAMETERS CONTROLLING THE REPLICATION AS  */
*         /* FOLLOWS.                                                */
*         /*                                                         */
*         /* FFMREDOF - A FLAG INDICATING REDO IS IN PROCESS.        */
*         /* FFMREDOC - THE COUNT OF THE NUMBER OF SUB-STRUCTURES    */
*         /*            REDO IS TO SPAN.                             */
*         /* REDOCSAV - A SAVE AREA FOR THE COUNT.                   */
*         /* FFMREDOL - THE COUNT OF THE NUMBER OF TIMES TO REDO.    */
*         /* FFMREDOO - THE INPUT DATA BLOCK OFFSET FOR EACH REDO.   */
*         /* FFMREDOS - THE ADDRESS OF THE FIRST SUB-STRUCTURE OF    */
*         /*            THE SET.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0543
*REDO:    PROC;                                                    0543
*                                                                  0543
REDO     STM   @14,@06,@SA00003                                    0543
         STM   @08,@12,@SA00003+36                                 0543
*         /***********************************************************/
*         /*                                                         */
*         /* ASSURE THAT THIS IS NOT A NESTED REDO SUB-STRUCTURE.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0544
*         IF FFMREDOF = ON                                         0544
*           THEN                                                   0544
         TM    FFMREDOF,B'10000000'                                0544
         BNO   @RF00544                                            0544
*             DO;                                                  0545
*                                                                  0545
*               CALL ERROR (4);                                    0546
*                                                                  0546
         LA    @01,@AL00546                                        0546
         BAL   @14,ERROR                                           0546
*               FFMREDOC = 0;             /* ZERO CURR STRU COUNT.   */
         SLR   @15,@15                                             0547
         STH   @15,FFMREDOC                                        0547
*               FFMREDOL = 0;             /* ZERO CURRENT LOOP COUNT */
         STH   @15,FFMREDOL                                        0548
*               STRSTP = 8;               /* SET FMT LIST STEP COUNT */
         MVC   STRSTP(2),@CH00176                                  0549
*               RETURN ;                                           0550
@EL00003 DS    0H                                                  0550
@EF00003 DS    0H                                                  0550
@ER00003 LM    @14,@06,@SA00003                                    0550
         LM    @08,@12,@SA00003+36                                 0550
         BR    @14                                                 0550
*             END;                                                 0551
*                                                                  0551
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE THE DYNAMIC DATA ARGUMENT LIST TO OBTAIN THE     */
*         /* DYNAMIC DATA FOR THE REDO.  THIS INCLUDES THE NUMBER    */
*         /* OF TIMES TO LOOP THROUGH THE STRUCTURES                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0552
*           DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGREP(DSINDX) ^= 0552
*               FMTRFNO;                                           0552
@RF00544 LA    @15,1                                               0552
         ST    @15,DSINDX                                          0552
         B     @DE00552                                            0552
@DL00552 LR    @14,@15                                             0552
         SLA   @14,3                                               0552
         LH    @14,DARGREP-8(@14,DDSTRU)                           0552
         CH    @14,FMTRFNO(,FSADDR)                                0552
         BE    @DC00552                                            0552
*           END;                                                   0553
*                                                                  0553
         AL    @15,@CF00216                                        0553
         ST    @15,DSINDX                                          0553
@DE00552 CH    @15,DARGCNT(,DDSTRU)                                0553
         BNH   @DL00552                                            0553
@DC00552 DS    0H                                                  0554
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE REDO PARAMETERS IF DYNAMIC ARGUMENT FOUND.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0554
*         IF DSINDX <= DARGCNT                                     0554
*           THEN                                                   0554
         L     @15,DSINDX                                          0554
         CH    @15,DARGCNT(,DDSTRU)                                0554
         BH    @RF00554                                            0554
*             DO;                                                  0555
*               FFMREDOL = DARGPCT(DSINDX);                        0556
         SLA   @15,3                                               0556
         LH    @15,DARGPCT-8(@15,DDSTRU)                           0556
         STH   @15,FFMREDOL                                        0556
*               FFMREDOF = ON;          /* TURN REDO FLAG ON.        */
         OI    FFMREDOF,B'10000000'                                0557
*               FFMREDOS = FSADDR + 8;  /* REDO START SUB-STRU       */
         LA    @15,8                                               0558
         ALR   @15,FSADDR                                          0558
         ST    @15,FFMREDOS                                        0558
*               FFMREDOC = FMTTRBC;     /* REDO SUB-STRUC COUNT.     */
         LH    @15,FMTTRBC(,FSADDR)                                0559
         STH   @15,FFMREDOC                                        0559
*               REDOCSAV = FFMREDOC;    /* SAVE IT.                  */
         STH   @15,REDOCSAV                                        0560
*               FFMREDOO = FMTRIO;      /* REDO INPUT OFFSET.        */
         LH    @15,FMTRIO(,FSADDR)                                 0561
         STH   @15,FFMREDOO                                        0561
*             END;                                                 0562
*         STRSTP = 8;                   /* STRUCTURE STEP = 8.       */
*                                                                  0563
@RF00554 MVC   STRSTP(2),@CH00176                                  0563
*         /***********************************************************/
*         /*                                                         */
*         /* IF DYNAMIC ARGUMENT SUB-STRUCTURE NOT FOUND IGNORE THE  */
*         /* REPLICATION BLOCK AND CONTINUE ON.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0564
*         RETURN;                                                  0564
         B     @EL00003                                            0564
*         END REDO;                                                0565
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - STATIC TEXT SET UP.                    */
*         /*                                                         */
*         /* FUNCTION - SETS UP THE CONVERSION ARGUMENT LIST FOR A   */
*         /* STATIC TEXT SUB-STRUCTURE.                              */
*         /*                                                         */
*         /* INPUT - THE STATIC TEXT SUB-STRUCTURE OF THE FORMAT     */
*         /*         LIST.  (FMTLIST)                                */
*         /*                                                         */
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL. (CVPSTRU)    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0566
*STATIC:  PROC;                                                    0566
*                                                                  0566
STATIC   STM   @14,@12,12(@13)                                     0566
*         CVPIADD = FFMSTRS + FMTSTO;   /* INPUT DATA ADDRESS.       */
         LH    @07,FMTSTO(,FSADDR)                                 0567
         AL    @07,FFMSTRS                                         0567
         ST    @07,CVPIADD                                         0567
*         CVPIL = FMTSTL;               /* INPUT DATA LENGTH.        */
         LH    @07,FMTSTL(,FSADDR)                                 0568
         ST    @07,CVPIL                                           0568
*         STRSTP = 12;                  /* FMT STRUCTURE STEP COUNT  */
         MVC   STRSTP(2),@CH00034                                  0569
*         RETURN;                                                  0570
*                                                                  0570
@EL00004 DS    0H                                                  0570
@EF00004 DS    0H                                                  0570
@ER00004 LM    @14,@12,12(@13)                                     0570
         BR    @14                                                 0570
*         END STATIC;                                              0571
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BLOCK DATA SET UP.                     */
*         /*                                                         */
*         /* FUNCTION - SET UP CONVERSION ARGUMENTS FOR BLOCK DATA.  */
*         /*                                                         */
*         /* INPUT - THE BLOCK DATA SUB-STRUCTURE OF THE FORMAT      */
*         /*         LIST.  (FMTLIST)                                */
*         /*                                                         */
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL.  (CVPSTRU)   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0572
*BLOCK:   PROC;                                                    0572
*                                                                  0572
BLOCK    STM   @14,@12,12(@13)                                     0572
*         IF DARGFULL = ON                                 /*@OZ14818*/
*           THEN                                           /*@OZ14818*/
         TM    DARGFULL(DDSTRU),B'10000000'                        0573
         BNO   @RF00573                                            0573
*             DARGILP1 = DARGRETP;                         /*@OZ14818*/
         L     @07,DARGRETP(,DDSTRU)                               0574
         ST    @07,DARGILP1                                        0574
*           ELSE                                           /*@OZ14818*/
*             DARGILP2 = DARGILP;                          /*@OZ14818*/
*                                                                  0575
         B     @RC00573                                            0575
@RF00573 LH    @07,DARGILP(,DDSTRU)                                0575
         STH   @07,DARGILP2                                        0575
*         CVPIADD = FFMBDP + FFMRBOFF + FMTIOFF;                   0576
@RC00573 L     @07,FFMBDP                                          0576
         AL    @07,FFMRBOFF                                        0576
         LH    @15,FMTIOFF(,FSADDR)                                0576
         ALR   @07,@15                                             0576
         ST    @07,CVPIADD                                         0576
*         IF FMTILEN > (DARGILP1-FMTIOFF)  FMTILEN = 0    /*@OZ14818*/
*           THEN                                                   0577
         LH    @07,FMTILEN(,FSADDR)                                0577
         LCR   @15,@15                                             0577
         AL    @15,DARGILP1                                        0577
         CR    @07,@15                                             0577
         BH    @RT00577                                            0577
         LTR   @07,@07                                             0577
         BNZ   @RF00577                                            0577
@RT00577 DS    0H                                                  0578
*             CVPIL = (DARGILP1-FMTIOFF);                  /*@OZ14818*/
         L     @07,DARGILP1                                        0578
         SH    @07,FMTIOFF(,FSADDR)                                0578
         ST    @07,CVPIL                                           0578
*           ELSE                                                   0579
*             CVPIL = FMTILEN;                                     0579
         B     @RC00577                                            0579
@RF00577 LH    @07,FMTILEN(,FSADDR)                                0579
         ST    @07,CVPIL                                           0579
*         STRSTP = 12;                                             0580
*                                                                  0580
@RC00577 MVC   STRSTP(2),@CH00034                                  0580
*         RETURN;                                                  0581
*                                                                  0581
@EL00005 DS    0H                                                  0581
@EF00005 DS    0H                                                  0581
@ER00005 LM    @14,@12,12(@13)                                     0581
         BR    @14                                                 0581
*         END BLOCK;                                               0582
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - INSERT DATA HANDLER.                   */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE SETS UP THE CONVERSION        */
*         /* ARGUMENT LISTS FOR INSERT DATA FORMAT SUB-STRUCTURES.   */
*         /* (SEE FMTLIST). IT SEARCHES THE DYNAMIC DATA STRUCTURE   */
*         /* FOR THE GIVEN REFERENCE NUMBER AND IF FOUND, SETS UP    */
*         /* THE DATA ARGUMENTS FROM IT.  IF NO FIND IS MADE, IT WILL*/
*         /* EXAMINE THE NEXT SUB-STRUCTURE IN THE LIST TO SEE IF IT */
*         /* IS A DEFAULT DATA SUB-STRUCTURE.  IF IT IS, IT WILL SET */
*         /* UP THE STATIC TEXT ASSOCIATED WITH IT.  IF IT IS NOT,   */
*         /* THIS STRUCTURE WILL BE IGNORED BY TURNING ON THE PRINT  */
*         /* INHIBIT FLAG. (FFMPINH)                                 */
*         /*                                                         */
*         /* INPUT - THE INSERT DATA SUB-STRUCTURE AND DYNAMIC DATA  */
*         /* SUB-STRUCTURE AS DEFINED IN FMTLIST AND DARGLIST        */
*         /*                                                         */
*         /* OUTPUT - THE DATA ARGUMENTS IN THE PRINT ARGUMENT LIST. */
*         /* (CVPSTRU)                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0583
*INSERT:  PROC;                                                    0583
*                                                                  0583
INSERT   STM   @14,@05,12(@13)                                     0583
         STM   @07,@12,48(@13)                                     0583
*         IF FFMIDINH = OFF             /* INSERT INHIBITED IN REDO  */
*           THEN                                                   0584
         TM    FFMIDINH,B'00001000'                                0584
         BNZ   @RF00584                                            0584
*             DO;                                                  0585
*                                                                  0585
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH THE DYNAMIC LIST (DARGLIST) FOR THE          */
*             /* REFERENCE NUMBER GIVEN.                             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0586
*               DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGINS(DSINDX) ^=
*                   FMTRFNO;                                       0586
         LA    @07,1                                               0586
         ST    @07,DSINDX                                          0586
         B     @DE00586                                            0586
@DL00586 LR    @15,@07                                             0586
         SLA   @15,3                                               0586
         LH    @15,DARGINS-8(@15,DDSTRU)                           0586
         CH    @15,FMTRFNO(,FSADDR)                                0586
         BE    @DC00586                                            0586
*               END;                                               0587
         AL    @07,@CF00216                                        0587
         ST    @07,DSINDX                                          0587
@DE00586 CH    @07,DARGCNT(,DDSTRU)                                0587
         BNH   @DL00586                                            0587
@DC00586 DS    0H                                                  0588
*               IF DSINDX <= DARGCNT                               0588
*                 THEN                                             0588
         L     @07,DSINDX                                          0588
         CH    @07,DARGCNT(,DDSTRU)                                0588
         BH    @RF00588                                            0588
*                   DO;                                            0589
*                                                                  0589
*                   /*************************************************/
*                   /*                                               */
*                   /* THE REFERENCE NUMBER IS FOUND.  SET UP THE    */
*                   /* ARGUMENTS FROM THE FOUND LIST.                */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0590
*                     CVPIADD = DARGDTM(DSINDX);                   0590
         SLA   @07,3                                               0590
         L     @15,DARGDTM-8(@07,DDSTRU)                           0590
         ST    @15,CVPIADD                                         0590
*                     CVPIL = DARGINL(DSINDX);                     0591
         LH    @07,DARGINL-8(@07,DDSTRU)                           0591
         ST    @07,CVPIL                                           0591
*                   END;                                           0592
*                 ELSE                                             0593
*                   DO;                                            0593
*                                                                  0593
         B     @RC00588                                            0593
@RF00588 DS    0H                                                  0594
*                 /***************************************************/
*                 /*                                                 */
*                 /* STEP FORMAT STRUCTURE ADDRESS TO CHECK FOR A    */
*                 /* POSSIBLE DEFAULT DATA STRUCTURE AS THE INSERT   */
*                 /* ITEM WAS NOT FOUND IN THE DYNAMIC STRUCTURE.    */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0594
*                     IF FMTEOLF = OFF                             0594
*                       THEN                                       0594
         TM    FMTEOLF(FSADDR),B'10000000'                         0594
         BNZ   @RF00594                                            0594
*                         DO;                                      0595
*                         FSADDR = FSADDR +12;                     0596
         AL    FSADDR,@CF00034                                     0596
*                         IF FMTDFF = ON                           0597
*                           THEN                                   0597
         TM    FMTDFF(FSADDR),B'00000010'                          0597
         BNO   @RF00597                                            0597
*                             DO;                                  0598
*                                                                  0598
*                         /*******************************************/
*                         /*                                         */
*                         /* A DEFAULT DATA SUB-STRUCTURE IS FOUND.  */
*                         /* SET UP THE ARGUMENTS FROM IT.           */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0599
*                               CVPIADD = FFMSTRS + FMTSTO;        0599
         LH    @07,FMTSTO(,FSADDR)                                 0599
         AL    @07,FFMSTRS                                         0599
         ST    @07,CVPIADD                                         0599
*                               CVPIL = FMTSTL;                    0600
         LH    @07,FMTSTL(,FSADDR)                                 0600
         ST    @07,CVPIL                                           0600
*                             END;                                 0601
*                           ELSE                                   0602
*                             DO;                                  0602
*                                                                  0602
         B     @RC00597                                            0602
@RF00597 DS    0H                                                  0603
*                 /***************************************************/
*                 /*                                                 */
*                 /* NO DEFAULT DATA STRUCTURE WAS FOUND SO RESTORE  */
*                 /* THE FORMAT STRUCTURE ADDRESS TO ITS ORIGINAL    */
*                 /* SETTING AND SUPPRESS CONVERSION AND PRINTING    */
*                 /* FOR THIS SUB-STRUCTURE.                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0603
*                               FFMPINH = ON;                      0603
         OI    FFMPINH,B'10000000'                                 0603
*                               FSADDR = FSADDR - 12;              0604
         SL    FSADDR,@CF00034                                     0604
*                             END;                                 0605
*                         END;                                     0606
*                       ELSE                                       0607
*                         FFMPINH = ON;                            0607
         B     @RC00594                                            0607
@RF00594 OI    FFMPINH,B'10000000'                                 0607
*                   END;                                           0608
*             END;                                                 0609
*           ELSE                                                   0610
*             FFMPINH = ON;             /* INHIBIT INSERT ON A REDO. */
         B     @RC00584                                            0610
@RF00584 OI    FFMPINH,B'10000000'                                 0610
*           STRSTP = 12;                                           0611
@RC00584 MVC   STRSTP(2),@CH00034                                  0611
*         END INSERT;                                              0612
@EL00006 DS    0H                                                  0612
@EF00006 DS    0H                                                  0612
@ER00006 LM    @14,@05,12(@13)                                     0612
         LM    @07,@12,48(@13)                                     0612
         BR    @14                                                 0612
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DATA CONVERSION PROCEDURE.                      */
*/*                                                                  */
*/* FUNCTION - CONVERTS DATA TO A PRINTABLE FORM.  CONVERSIONS       */
*/*      PROVIDED ARE:                                               */
*/*        EBCDIC TO CHARACTER.                                      */
*/*        BINARY TO HEXIDECIMAL.                                    */
*/*        BINARY TO HEXIDECIMAL ENCLOSED AS X'NNNN'         #Y30LSJK*/
*/*        BINARY TO HEXIDECIMAL DUMP FORMAT.                        */
*/*        PACKED DECIMAL TO UNPACKED DECIMAL.                       */
*/*        BINARY TO UNPACKED DECIMAL.                               */
*/*                                                                  */
*/* INPUT - THE CONVERSION ARGUMENT LIST CVPSTRU.                    */
*/*                                                                  */
*/* OUTPUT - THE CONVERTED DATA IN THE PRINT BUFFER (PRTBUFF)        */
*/*      OR MORE THAN ONE PRINTED LINE IF PRINT LINE OVERFLOW        */
*/*      OCCURS AS A RESULT OF THE DATA BEING MORE THAN THE LENGTH   */
*/*      OF THE PRINT BUFFER.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0613
*CONVERT: PROCEDURE;                                               0613
CONVERT  STM   @14,@06,@SA00007                                    0613
         STM   @08,@12,@SA00007+36                                 0613
*         OLDERID2 = NEWERID2;                                     0614
         L     @04,GDTTR2(,GDTPR)                                  0614
         MVC   @TS00001(95),NEWERID2(@04)                          0614
         MVC   OLDERID2(95,@04),@TS00001                           0614
*         NEWID2 = 'TP2I';                                         0615
         MVC   NEWID2(4,@04),@CC00933                              0615
*         CVFLAG = '0000'X;             /* CLEAR THE FLAG BYTES.     */
         MVC   CVFLAG(2),@CB00934                                  0616
*         /***********************************************************/
*         /*                                                         */
*         /* INSURE EVEN NUMBER OF OUTPUT BYTES FOR BINARY TO HEX    */
*         /* CONVERSION.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0617
*         IF GDTDBG = NULLPTR                                      0617
*           THEN;                                                  0617
         L     @04,GDTDBG(,GDTPR)                                  0617
         LTR   @04,@04                                             0617
         BZ    @RT00617                                            0617
*           ELSE                                                   0619
*             CALL IDCDB010 (GDTTBL,'TP2I');                       0619
         ST    GDTPR,@AL00001                                      0619
         LA    @04,@CC00933                                        0619
         ST    @04,@AL00001+4                                      0619
         MVI   @AL00001+4,X'80'                                    0619
         L     @15,GDTDBG(,GDTPR)                                  0619
         LA    @01,@AL00001                                        0619
         BALR  @14,@15                                             0619
*         IF CVPBH = ON  CVPBHA = ON                              0620
*           THEN                                                   0620
@RT00617 TM    CVPBH,B'11000000'                                   0620
         BZ    @RF00620                                            0620
*             DO;                                                  0621
*               IF CVPOL//2 ^= 0                                   0622
*                 THEN                                             0622
         L     @04,CVPOL                                           0622
         LR    @00,@04                                             0622
         SRDA  @00,32                                              0622
         D     @00,@CF00150                                        0622
         LTR   @00,@00                                             0622
         BZ    @RF00622                                            0622
*                   CVPOL = CVPOL + 1;                             0623
         AL    @04,@CF00216                                        0623
         ST    @04,CVPOL                                           0623
*             END;                                                 0624
*                                                                  0624
@RF00622 DS    0H                                                  0625
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR POSSIBLE PRINT LINE OVERFLOW AND SET UP TO    */
*         /* HANDLE IT. THE LINE PRINT ROUTINE WILL HANDLE MESSAGES  */
*         /* THAT EXCEED THE PAGE LINE WIDTH.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0625
*         IF ((CVPPADD - ADDR(PRTBUFF) + CVPOL) > PCTPLW)  /*@Z40GSJG*/
*               & FFMPMSF = OFF & FFMPSMS = OFF            /*@Z40GSJG*/
*           THEN                                                   0625
@RF00620 L     @04,CVPPADD                                         0625
         SL    @04,PRTBUFPT                                        0625
         LR    @03,@04                                             0625
         AL    @03,CVPOL                                           0625
         L     @15,PCTPLW(,PCTPTR)                                 0625
         CR    @03,@15                                             0625
         BNH   @RF00625                                            0625
         TM    FFMPMSF,B'00011000'                                 0625
         BNZ   @RF00625                                            0625
*             DO;                                                  0626
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))/2;    0627
         LR    @00,@15                                             0627
         SLR   @00,@04                                             0627
         SRDA  @00,32                                              0627
         D     @00,@CF00150                                        0627
         LR    FMSIL,@01                                           0627
*               PLOVF = ON;                                        0628
         OI    PLOVF,B'10000000'                                   0628
*             END;                                                 0629
*           ELSE                                                   0630
*             FMSIL = CVPOL/2;                                     0630
*                                                                  0630
         B     @RC00625                                            0630
@RF00625 L     @00,CVPOL                                           0630
         SRDA  @00,32                                              0630
         D     @00,@CF00150                                        0630
         LR    FMSIL,@01                                           0630
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP REMAINING PARAMETERS FOR THE INITIAL SEGMENT.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0631
*         CVSL = CVPOL;                 /* SET COMPLET OUTPUT LENGTH */
@RC00625 L     @04,CVPOL                                           0631
         ST    @04,CVSL                                            0631
*         CVSTA = CVPPADD;              /* SET PRINT START.          */
         L     @04,CVPPADD                                         0632
         ST    @04,CVSTA                                           0632
*         FMRIL = CVPIL;                /* SET REMAINING INPUT LEN.  */
         L     @04,CVPIL                                           0633
         ST    @04,FMRIL                                           0633
*         FMRIP = CVPIADD;              /* SET REMAINING INPUT LOC.  */
         L     @04,CVPIADD                                         0634
         ST    @04,FMRIP                                           0634
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR EITHER BYTE TO HEXIDECIMAL OR HEXIDECIMAL      */
*         /* APOSTROPHE CONVERSION AND CALL BHCONV PROCEDURE IF ON.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0635
*         IF CVPBH = ON  CVPBHA = ON                              0635
*           THEN                                                   0635
*                                                                  0635
         TM    CVPBH,B'11000000'                                   0635
         BZ    @RF00635                                            0635
*             CALL BHCONV;                                         0636
*                                                                  0636
         BAL   @14,BHCONV                                          0636
*         /***********************************************************/
*         /*                                                         */
*         /* IF BYTE TO HEXIDECIMAL DUMP CONVERSION IS ON            */
*         /* THEN CALL BHDCONV PROCEDURE.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0637
*         IF CVPBHD = ON                                           0637
*           THEN                                                   0637
*                                                                  0637
@RF00635 TM    CVPBHD,B'00100000'                                  0637
         BNO   @RF00637                                            0637
*             CALL BHDCONV;                                        0638
*                                                                  0638
         BAL   @14,BHDCONV                                         0638
*         /***********************************************************/
*         /*                                                         */
*         /* IF PACKED TO UNPACKED CONVERSION IS ON THEN CALL        */
*         /* PUPCONV PROCEDURE.                                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0639
*         IF CVPPU = ON                                            0639
*           THEN                                                   0639
@RF00637 TM    CVPPU,B'00001000'                                   0639
         BNO   @RF00639                                            0639
*             DO;                                                  0640
*                                                                  0640
*               CALL PUPCONV;                                      0641
*                                                                  0641
         BAL   @14,PUPCONV                                         0641
*               RESPECIFY RTNREG RSTD;                             0642
*               TESTRC = RTNREG;                                   0643
         STH   RTNREG,TESTRC                                       0643
*               RESPECIFY RTNREG UNRSTD;                           0644
*               IF TESTRC > 0                                      0645
*                 THEN                                             0645
         LH    @04,TESTRC                                          0645
         LTR   @04,@04                                             0645
         BNP   @RF00645                                            0645
*                   RETURN CODE(TESTRC);                           0646
         LR    @15,@04                                             0646
         L     @14,@SA00007                                        0646
         LM    @00,@06,@SA00007+8                                  0646
         LM    @08,@12,@SA00007+36                                 0646
         BR    @14                                                 0646
*             END;                                                 0647
*                                                                  0647
@RF00645 DS    0H                                                  0648
*         /***********************************************************/
*         /*                                                         */
*         /* IF BINARY TO DECIMAL CONVERSION FLAG IS ON CALL BDCONV  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0648
*         IF CVPBD = ON                                            0648
*           THEN                                                   0648
@RF00639 TM    CVPBD,B'00010000'                                   0648
         BNO   @RF00648                                            0648
*             DO;                                                  0649
*                                                                  0649
*               CALL BDCONV;                                       0650
*                                                                  0650
         BAL   @14,BDCONV                                          0650
*               RESPECIFY RTNREG RSTD;                             0651
*               TESTRC = RTNREG;                                   0652
         STH   RTNREG,TESTRC                                       0652
*               RESPECIFY RTNREG UNRSTD;                           0653
*               IF TESTRC > 0                                      0654
*                 THEN                                             0654
*                                                                  0654
         LH    @04,TESTRC                                          0654
         LTR   @04,@04                                             0654
         BNP   @RF00654                                            0654
*                   RETURN CODE(TESTRC);                           0655
*                                                                  0655
         LR    @15,@04                                             0655
         L     @14,@SA00007                                        0655
         LM    @00,@06,@SA00007+8                                  0655
         LM    @08,@12,@SA00007+36                                 0655
         BR    @14                                                 0655
*             END;                                                 0656
*                                                                  0656
@RF00654 DS    0H                                                  0657
*         /***********************************************************/
*         /*                                                         */
*         /* IF ALL CONVERSION FLAGS ARE OFF, THEN CONVERT THE LINE  */
*         /* AS AN EBCDIC LINE BY CALLING EBCDIC.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0657
*         IF CVPBH = OFF &                                         0657
*           CVPBHA = OFF &                                         0657
*           CVPBHD = OFF &                                         0657
*           CVPBD = OFF &                                          0657
*           CVPPU = OFF                                            0657
*           THEN                                                   0657
@RF00648 TM    CVPBH,B'11111000'                                   0657
         BNZ   @RF00657                                            0657
*             DO;                                                  0658
*                                                                  0658
*               CALL EBCDIC;                                       0659
*                                                                  0659
         BAL   @14,EBCDIC                                          0659
*               RESPECIFY RTNREG RSTD;                             0660
*               TESTRC = RTNREG;                                   0661
         STH   RTNREG,TESTRC                                       0661
*               RESPECIFY RTNREG UNRSTD;                           0662
*               IF TESTRC > 0                                      0663
*                 THEN                                             0663
         LH    @06,TESTRC                                          0663
         LTR   @06,@06                                             0663
         BNP   @RF00663                                            0663
*                   RETURN CODE(RCQUIT);                           0664
         LH    @15,RCQUIT                                          0664
         L     @14,@SA00007                                        0664
         LM    @00,@06,@SA00007+8                                  0664
         LM    @08,@12,@SA00007+36                                 0664
         BR    @14                                                 0664
*             END;                                                 0665
@RF00663 DS    0H                                                  0666
*         OLDERID2 = NEWERID2;                                     0666
@RF00657 L     @06,GDTTR2(,GDTPR)                                  0666
         MVC   @TS00001(95),NEWERID2(@06)                          0666
         MVC   OLDERID2(95,@06),@TS00001                           0666
*         NEWID2 = 'TP2N';                                         0667
*                                                                  0667
         MVC   NEWID2(4,@06),@CC00940                              0667
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE RETURN CODE NEEDED AND RETURN TO THE FORMAT     */
*         /* ROUTINE.                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0668
*         IF PLOVF = ON                                            0668
*           THEN                                                   0668
         TM    PLOVF,B'10000000'                                   0668
         BNO   @RF00668                                            0668
*             SETRC = 4;                /* ADVISE FORMAT OF OVERFLOW */
         LA    SETRC,4                                             0669
*           ELSE                                                   0670
*             SETRC = 0;                                           0670
*                                                                  0670
         B     @RC00668                                            0670
@RF00668 SLR   SETRC,SETRC                                         0670
*         IF GDTDBG = NULLPTR                                      0671
*           THEN;                                                  0671
@RC00668 L     @06,GDTDBG(,GDTPR)                                  0671
         LTR   @06,@06                                             0671
         BZ    @RT00671                                            0671
*           ELSE                                                   0673
*             CALL IDCDB010 (GDTTBL,'TP2N');                       0673
*                                                                  0673
         ST    GDTPR,@AL00001                                      0673
         LA    @06,@CC00940                                        0673
         ST    @06,@AL00001+4                                      0673
         MVI   @AL00001+4,X'80'                                    0673
         L     @15,GDTDBG(,GDTPR)                                  0673
         LA    @01,@AL00001                                        0673
         BALR  @14,@15                                             0673
*         RETURN CODE(SETRC);                                      0674
@RT00671 LR    @15,SETRC                                           0674
         L     @14,@SA00007                                        0674
         LM    @00,@06,@SA00007+8                                  0674
         LM    @08,@12,@SA00007+36                                 0674
         BR    @14                                                 0674
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO HEXADECIMAL CONVERSION.      */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY INPUT TO PRINTABLE           */
*         /* HEXADECIMAL OUTPUT, PUTTING THE CONVERTED BYTES         */
*         /* DIRECTLY INTO THE PRINT LINE.  UP TO 32K BYTES MAY BE   */
*         /* TRANSLATED IN ANY ONE SEGMENT.                          */
*         /*                                                         */
*         /* INPUT - THE DATA INPUT POINTER (CVSTA) AND LENGTH       */
*         /* (CVSL) AND THE POINTER TO THE PRINT LINE POSITION       */
*         /* WHERE THE CONVERTED OUTPUT IS TO BE PLACED.             */
*         /* IF THE INPUT LENGTH IS LARGE ENOUGH TO CAUSE THE PRINT  */
*         /* LINE TO OVERFLOW, THEN THAT LINE WILL BE PRINTED AND    */
*         /* FURTHER LINES WILL BE CONVERTED AND PRINTED UNTIL ALL OF*/
*         /* THE INPUT DATA HAS BEEN CONVERTED.  IF THE PRINT LINE   */
*         /* DOES NOT OVERFLOW, THEN NO PRINTING OCCURS HERE.        */
*         /* CONVERSION FOR ALL LINES WILL BEGIN AT THE SAME POINT   */
*         /* IN THE PRINT LINE AS THE FIRST LINE.                    */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0675
*BHCONV:  PROC;                                                    0675
*                                                                  0675
BHCONV   STM   @14,@02,@SA00008                                    0675
         STM   @04,@06,@SA00008+20                                 0675
         STM   @08,@12,@SA00008+32                                 0675
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS A BYTE TO HEX APOST, SET THE LEADING APOST.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0676
*         FMSIL = CONVL/2;                                 /*#Y30LSJK*/
*                                                                  0676
         LA    @06,2                                               0676
         L     @00,CONVL                                           0676
         SRDA  @00,32                                              0676
         DR    @00,@06                                             0676
         LR    FMSIL,@01                                           0676
*         IF CVPBHA = ON                                           0677
*           THEN                                                   0677
         TM    CVPBHA,B'01000000'                                  0677
         BNO   @RF00677                                            0677
*             DO;                                                  0678
*               CVPB(1:2) = 'X''';                                 0679
         L     @04,CVSTA                                           0679
         MVC   CVPB(2,@04),@CC00944                                0679
*               CVSTA = CVSTA + 2;                                 0680
         ALR   @04,@06                                             0680
         ST    @04,CVSTA                                           0680
*               /*****************************************************/
*               /*                                           #Y30LSJK*/
*               /* TRUNCATE BHA FORMAT AT END OF LINE        #Y30LSJK*/
*               /*                                           @Y30LSJK*/
*               /*****************************************************/
*                                                                  0681
*               IF PLOVF = ON                                      0681
*                 THEN                                             0681
         TM    PLOVF,B'10000000'                                   0681
         BNO   @RF00681                                            0681
*                   FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF))    0682
*                            - 3) / 2;                     /*@Y30LSJK*/
*                                                                  0682
         L     FMSIL,CVPPADD                                       0682
         SL    FMSIL,PRTBUFPT                                      0682
         LR    @00,FMSIL                                           0682
         LCR   @00,@00                                             0682
         AL    @00,PCTPLW(,PCTPTR)                                 0682
         SL    @00,@CF00159                                        0682
         SRDA  @00,32                                              0682
         DR    @00,@06                                             0682
         LR    FMSIL,@01                                           0682
*               PLOVF = OFF;                                       0683
@RF00681 NI    PLOVF,B'01111111'                                   0683
*               CVSL = FMSIL + FMSIL;                      /*@Y30LSJK*/
         LR    @06,FMSIL                                           0684
         ALR   @06,FMSIL                                           0684
         ST    @06,CVSL                                            0684
*             END;                                                 0685
*           ELSE                                                   0686
*             IF PLOVF = ON                                        0686
*               THEN                                               0686
         B     @RC00677                                            0686
@RF00677 TM    PLOVF,B'10000000'                                   0686
         BNO   @RF00686                                            0686
*                 FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))     0687
*                         / 2;                             /*@Y30LSJK*/
*                                                                  0687
         L     FMSIL,CVPPADD                                       0687
         SL    FMSIL,PRTBUFPT                                      0687
         LR    @00,FMSIL                                           0687
         LCR   @00,@00                                             0687
         AL    @00,PCTPLW(,PCTPTR)                                 0687
         SRDA  @00,32                                              0687
         D     @00,@CF00150                                        0687
         LR    FMSIL,@01                                           0687
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE BYTE SEGMENT TO PRINTABLE HEXADECIMAL.      */
*         /* CONVERSION IS DIRECTLY TO THE PRINT BUFFER.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0688
*         DO WHILE CVSL > 0;                                       0688
*                                                                  0688
@RF00686 DS    0H                                                  0688
@RC00677 B     @DE00688                                            0688
@DL00688 DS    0H                                                  0689
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING IS THE ACTUAL CONVERSION DO LOOP.         */
*         /* CVCHR HOLDS THE TRANSLATE TABLE OFFSET FOR THE FIRST    */
*         /* HALF BYTE.                                              */
*         /* TTOFF HOLDS THE TRANSLATE TABLE OFFSET FOR THE SECOND   */
*         /* HALF BYTE.                                              */
*         /* BHTRTB IS THE TRANSLATE TABLE.                          */
*         /* TRBUF HOLDS THE INPUT SOURCE.                           */
*         /* CVPB HOLDS THE OUTPUT TRANSLATED DATA.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0689
*           DO N = 1 TO FMSIL;                                     0689
         LA    N,1                                                 0689
         B     @DE00689                                            0689
@DL00689 DS    0H                                                  0690
*             CVPB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                 0690
         L     @06,CVSTA                                           0690
         LR    @04,N                                               0690
         ALR   @04,@04                                             0690
         ST    @04,@TF00001                                        0690
         ALR   @04,@06                                             0690
         BCTR  @04,0                                               0690
         BCTR  @04,0                                               0690
         L     @01,FMRIP                                           0690
         BCTR  @01,0                                               0690
         SLR   @15,@15                                             0690
         IC    @15,TRBUF(N,@01)                                    0690
         LR    @14,@15                                             0690
         SRL   @14,4                                               0690
         LA    @01,BHTRTB(@14)                                     0690
         MVC   CVPB(1,@04),0(@01)                                  0690
*             CVPB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);          0691
         AL    @06,@TF00001                                        0691
         BCTR  @06,0                                               0691
         N     @15,@CF00945                                        0691
         LA    @04,BHTRTB(@15)                                     0691
         MVC   CVPB(1,@06),0(@04)                                  0691
*           END;                                                   0692
         AL    N,@CF00216                                          0692
@DE00689 CR    N,FMSIL                                             0692
         BNH   @DL00689                                            0692
*           CVSL = CVSL - FMSIL * 2;                               0693
*                                                                  0693
         LR    @06,FMSIL                                           0693
         ALR   @06,@06                                             0693
         LCR   @06,@06                                             0693
         AL    @06,CVSL                                            0693
         ST    @06,CVSL                                            0693
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO PRINT LINE OVERFLOW, SET UP THE TRAILING 'X       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0694
*           IF PLOVF = OFF & CVPBHA = ON                           0694
*             THEN                                                 0694
         TM    PLOVF,B'10000000'                                   0694
         BNZ   @RF00694                                            0694
         TM    CVPBHA,B'01000000'                                  0694
         BNO   @RF00694                                            0694
*               DO;                                                0695
*                 IF CVSTA + 2*N <= ADDR(PRTBUFF) + PCTPLW         0696
*                   THEN                                           0696
         L     @06,CVSTA                                           0696
         LR    @04,N                                               0696
         ALR   @04,@04                                             0696
         LR    @15,@06                                             0696
         ALR   @15,@04                                             0696
         L     @14,PRTBUFPT                                        0696
         AL    @14,PCTPLW(,PCTPTR)                                 0696
         CR    @15,@14                                             0696
         BH    @RF00696                                            0696
*                     CVPB(2*N-1) = '''';                          0697
         ALR   @06,@04                                             0697
         BCTR  @06,0                                               0697
         BCTR  @06,0                                               0697
         MVI   CVPB(@06),C''''                                     0697
*               END;                                               0698
*                                                                  0698
@RF00696 DS    0H                                                  0699
*         /***********************************************************/
*         /*                                                 @Y30LSJK*/
*         /* SET ACTUAL PRINT COLUMN                         @Y30LSJK*/
*         /*                                                 @Y30LSJK*/
*         /***********************************************************/
*         PCTAPC = CVSTA +FMSIL + FMSIL - ADDR(PRTBUFF);   /*@Y30LSJK*/
@RF00694 LR    @06,FMSIL                                           0699
         AL    @06,CVSTA                                           0699
         ALR   @06,FMSIL                                           0699
         SL    @06,PRTBUFPT                                        0699
         STH   @06,PCTAPC(,PCTPTR)                                 0699
*         IF CVPBHA = ON                                           0700
*           THEN                                                   0700
         TM    CVPBHA,B'01000000'                                  0700
         BNO   @RF00700                                            0700
*             PCTAPC = PCTAPC + 3;                         /*@Y30LSJK*/
*                                                                  0701
         AL    @06,@CF00159                                        0701
         STH   @06,PCTAPC(,PCTPTR)                                 0701
*         /***********************************************************/
*         /*                                                         */
*         /* SINCE A PRINT LINE OVER FLOW HAS OCCURRED, PRINT THE    */
*         /* LINE JUST CONVERTED.                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0702
*           IF PLOVF = ON                                          0702
*             THEN                                                 0702
@RF00700 TM    PLOVF,B'10000000'                                   0702
         BNO   @RF00702                                            0702
*               DO;                                                0703
*                                                                  0703
*                 CALL LINEPRT;                                    0704
*                                                                  0704
         BAL   @14,LINEPRT                                         0704
*                 RESPECIFY RTNREG RSTD;                           0705
*                 TESTRC = RTNREG;                                 0706
         STH   RTNREG,TESTRC                                       0706
*                 RESPECIFY RTNREG UNRSTD;                         0707
*                 IF TESTRC ^= 0                                   0708
*                   THEN                                           0708
         LH    @06,TESTRC                                          0708
         LTR   @06,@06                                             0708
         BZ    @RF00708                                            0708
*                     RETURN CODE(RCQUIT);                         0709
*                                                                  0709
         LH    @15,RCQUIT                                          0709
         L     @14,@SA00008                                        0709
         LM    @00,@02,@SA00008+8                                  0709
         LM    @04,@06,@SA00008+20                                 0709
         LM    @08,@12,@SA00008+32                                 0709
         BR    @14                                                 0709
*                 PRTSPF = 1;                                      0710
*                                                                  0710
@RF00708 MVC   PRTSPF(2),@CH00216                                  0710
*                 /***************************************************/
*                 /*                                                 */
*                 /* UPDATE FOR THE REPETITION IF PRINT LINE         */
*                 /* OVERFLOW.                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0711
*                 FMRIP = FMRIP + FMSIL;                           0711
         LR    @06,FMSIL                                           0711
         AL    @06,FMRIP                                           0711
         ST    @06,FMRIP                                           0711
*                 CVSTA = CVPPADD;                                 0712
         L     @06,CVPPADD                                         0712
         ST    @06,CVSTA                                           0712
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0713
*                   THEN                                           0713
         L     @04,PRTBUFPT                                        0713
         AL    @04,PCTPLW(,PCTPTR)                                 0713
         SLR   @04,@06                                             0713
         C     @04,CVSL                                            0713
         BNL   @RF00713                                            0713
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD)/2;
         LR    @00,@04                                             0714
         SRDA  @00,32                                              0714
         D     @00,@CF00150                                        0714
         LR    FMSIL,@01                                           0714
*                   ELSE                                           0715
*                     FMSIL = CVSL/2;                              0715
         B     @RC00713                                            0715
@RF00713 L     @00,CVSL                                            0715
         SRDA  @00,32                                              0715
         D     @00,@CF00150                                        0715
         LR    FMSIL,@01                                           0715
*               END;                                               0716
@RC00713 DS    0H                                                  0717
*         END;                                                     0717
*                                                                  0717
@RF00702 DS    0H                                                  0717
@DE00688 SLR   @06,@06                                             0717
         C     @06,CVSL                                            0717
         BL    @DL00688                                            0717
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND RETURN TO THE MAIN PROCEDURE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0718
*         RETURN CODE (0);                                         0718
         LR    @15,@06                                             0718
         L     @14,@SA00008                                        0718
         LM    @00,@02,@SA00008+8                                  0718
         LM    @04,@06,@SA00008+20                                 0718
         LM    @08,@12,@SA00008+32                                 0718
         BR    @14                                                 0718
*         END BHCONV;                                              0719
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO HEX DUMP CONVERSION.         */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY INPUT TO DUMP FORMATTED      */
*         /* OUTPUT.  CONVERSION ALWAYS BEGINS AT POSITION ONE IN    */
*         /* THE PRINT LINE.                                         */
*         /*                                                         */
*         /* INPUT - THE DATA INPUT POINTER AND LENGTH.              */
*         /*                                                         */
*         /* OUTPUT - DUMP FORMATTED PRINT LINE(S).                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0720
*BHDCONV: PROC;                                                    0720
*                                                                  0720
BHDCONV  STM   @14,@02,@SA00009                                    0720
         STM   @04,@06,@SA00009+20                                 0720
         STM   @08,@12,@SA00009+32                                 0720
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE THE OUTPUT INDEX COUNT AND SEGMENT LENGTH.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0721
*         OLDERID2 = NEWERID2;                                     0721
         L     @06,GDTTR2(,GDTPR)                                  0721
         MVC   @TS00001(95),NEWERID2(@06)                          0721
         MVC   OLDERID2(95,@06),@TS00001                           0721
*         NEWID2 = 'TP2M';                                         0722
         MVC   NEWID2(4,@06),@CC00950                              0722
*         HDINDEXB = 0;                                            0723
         SLR   @06,@06                                             0723
         STH   @06,HDINDEXB                                        0723
*         SETRC = 0;                                               0724
         SLR   SETRC,SETRC                                         0724
*         IF FMRIL > 32                                            0725
*           THEN                                                   0725
         LA    @06,32                                              0725
         C     @06,FMRIL                                           0725
         BNL   @RF00725                                            0725
*             FMSIL = 32;                                          0726
         LR    FMSIL,@06                                           0726
*           ELSE                                                   0727
*             FMSIL = FMRIL;                                       0727
*                                                                  0727
         B     @RC00725                                            0727
@RF00725 L     FMSIL,FMRIL                                         0727
*         /***********************************************************/
*         /*                                                         */
*         /* THIS CODE BEGINS THE MAJOR CONVERSION LOOP.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0728
*         DO WHILE FMRIL > 0;                                      0728
@RC00725 B     @DE00728                                            0728
@DL00728 DS    0H                                                  0729
*           HDCVB(1:64) = ' ';                                     0729
*                                                                  0729
         MVI   HDCVB+1,C' '                                        0729
         MVC   HDCVB+2(62),HDCVB+1                                 0729
         MVI   HDCVB,C' '                                          0729
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE EBCDIC PORTION OF THE HEX DUMP FORMAT.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0730
*           HDSEG3(1:FMSIL) = TRBUF;                               0730
         L     @04,CVPPADD                                         0730
         LR    @15,FMSIL                                           0730
         BCTR  @15,0                                               0730
         L     @01,FMRIP                                           0730
         EX    @15,@SM01042                                        0730
*           HDST1 = '*';                                           0731
         MVI   HDST1(@04),C'*'                                     0731
*           HDST2 = '*';                                           0732
*                                                                  0732
         MVI   HDST2(@04),C'*'                                     0732
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE INDEX FOR THE FORMAT IN COLS 1 THROUGH 4.       */
*         /* HDINDEXC(B) CONTAINS THE UPDATED INDEX TO BE TRANSLATED */
*         /* HDINDEX IS THE INDEX LOCATION ON THE PRINT LINE.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0733
*           DO N = 1 TO 2 BY 1;                                    0733
         LA    N,1                                                 0733
@DL00733 DS    0H                                                  0734
*             HDINDEX(2*N-1) = BHTRTB(HDINDEXC(N)/16+1);           0734
         L     @06,CVPPADD                                         0734
         LR    @04,N                                               0734
         ALR   @04,@04                                             0734
         ST    @04,@TF00001                                        0734
         ALR   @04,@06                                             0734
         BCTR  @04,0                                               0734
         BCTR  @04,0                                               0734
         SLR   @15,@15                                             0734
         IC    @15,HDINDEXC-1(N)                                   0734
         SRL   @15,4                                               0734
         LA    @14,BHTRTB(@15)                                     0734
         MVC   HDINDEX(1,@04),0(@14)                               0734
*             HDINDEX(2*N) = BHTRTB((HDINDEXC(N) & '0F'X) + 1);    0735
         AL    @06,@TF00001                                        0735
         BCTR  @06,0                                               0735
         LA    @04,15                                              0735
         SLR   @15,@15                                             0735
         IC    @15,HDINDEXC-1(N)                                   0735
         NR    @04,@15                                             0735
         LA    @01,BHTRTB(@04)                                     0735
         MVC   HDINDEX(1,@06),0(@01)                               0735
*           END;                                                   0736
*                                                                  0736
         AL    N,@CF00216                                          0736
         C     N,@CF00150                                          0736
         BNH   @DL00733                                            0736
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE DUMP SEGMENTS FROM BYTE TO HEXADECIMAL.     */
*         /* TRBUF  CONTAINS THE INPUT BYTE STRING TO BE TRANSLATED  */
*         /* HDCVB CONTAINS THE TRANSLATED OUTPUT SEGMENTS.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0737
*           DO N = 1 TO FMSIL BY 1;                                0737
         LA    N,1                                                 0737
         B     @DE00737                                            0737
@DL00737 DS    0H                                                  0738
*             HDCVB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                0738
         LR    @06,N                                               0738
         ALR   @06,@06                                             0738
         LA    @04,HDCVB-2(@06)                                    0738
         L     @01,FMRIP                                           0738
         BCTR  @01,0                                               0738
         SLR   @15,@15                                             0738
         IC    @15,TRBUF(N,@01)                                    0738
         LR    @14,@15                                             0738
         SRL   @14,4                                               0738
         LA    @01,BHTRTB(@14)                                     0738
         MVC   0(1,@04),0(@01)                                     0738
*             HDCVB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);         0739
         LA    @04,HDCVB-1(@06)                                    0739
         N     @15,@CF00945                                        0739
         LA    @06,BHTRTB(@15)                                     0739
         MVC   0(1,@04),0(@06)                                     0739
*           END;                                                   0740
*                                                                  0740
         AL    N,@CF00216                                          0740
@DE00737 CR    N,FMSIL                                             0740
         BNH   @DL00737                                            0740
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE THE CONVERTED SEGMENTS TO THE PRINT BUFFER.        */
*         /* HDSEG1 IS THE FIRST HALF (4 - 8 BYTE SEGMENTS) OF THE   */
*         /* PRINT LINE.                                             */
*         /* HDSEG2 IS THE SECOND HALF (4 - 8 BYTE SEGMENTS) OF THE  */
*         /* PRINT LINE.                                             */
*         /* HDCVB CONTAINS THE CONVERTED SEGMENTS WITH NO SPACES.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0741
*           J =1;                                                  0741
         LA    @15,1                                               0741
         LR    J,@15                                               0741
*           DO N = 1 TO 28 BY 9;                                   0742
         LR    N,@15                                               0742
@DL00742 DS    0H                                                  0743
*             HDSEG1(N:N+8) = HDCVB(J:J+7);                        0743
         L     @06,CVPPADD                                         0743
         LR    @01,@06                                             0743
         ALR   @01,N                                               0743
         MVI   HDSEG1+7(@01),C' '                                  0743
         LA    @15,HDCVB-1(J)                                      0743
         MVC   HDSEG1-1(8,@01),0(@15)                              0743
*             HDSEG2(N:N+8) = HDCVB(J+32:J+39);                    0744
         ALR   @06,N                                               0744
         MVI   HDSEG2+7(@06),C' '                                  0744
         LA    @01,HDCVB+31(J)                                     0744
         MVC   HDSEG2-1(8,@06),0(@01)                              0744
*             J = J+8;                                             0745
         AL    J,@CF00176                                          0745
*           END;                                                   0746
*                                                                  0746
         AL    N,@CF00953                                          0746
         C     N,@CF00952                                          0746
         BNH   @DL00742                                            0746
*         /***********************************************************/
*         /*                                                         */
*         /* CALL THE PRINT CALL SUB-ROUTINE TO PRINT THIS LINE.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0747
*         CALL LINEPRT;                                            0747
*                                                                  0747
         BAL   @14,LINEPRT                                         0747
*         RESPECIFY RTNREG RSTD;                                   0748
*         TESTRC = RTNREG;                                         0749
         STH   RTNREG,TESTRC                                       0749
*         RESPECIFY RTNREG UNRSTD;                                 0750
*         IF TESTRC ^= 0                                           0751
*           THEN                                                   0751
         LH    @06,TESTRC                                          0751
         LTR   @06,@06                                             0751
         BZ    @RF00751                                            0751
*             RETURN CODE(RCQUIT);                                 0752
*                                                                  0752
         LH    @15,RCQUIT                                          0752
         L     @14,@SA00009                                        0752
         LM    @00,@02,@SA00009+8                                  0752
         LM    @04,@06,@SA00009+20                                 0752
         LM    @08,@12,@SA00009+32                                 0752
         BR    @14                                                 0752
*         PRTSPF = 1;                                              0753
*                                                                  0753
@RF00751 MVC   PRTSPF(2),@CH00216                                  0753
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE THE INPUT POINTERS FOR THE NEXT LINE.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0754
*           HDINDEXB = HDINDEXB + 32;   /* INCREMENT INDEX.          */
         LA    @06,32                                              0754
         LH    @04,HDINDEXB                                        0754
         ALR   @04,@06                                             0754
         STH   @04,HDINDEXB                                        0754
*           FMRIP = FMRIP + FMSIL;      /* INCREMENT INPUT PTR.      */
         LR    @04,FMSIL                                           0755
         AL    @04,FMRIP                                           0755
         ST    @04,FMRIP                                           0755
*           FMRIL = FMRIL - FMSIL;      /* DECREMENT INPUT LENGTH.   */
         L     @04,FMRIL                                           0756
         SLR   @04,FMSIL                                           0756
         ST    @04,FMRIL                                           0756
*           IF FMRIL > 32                                          0757
*             THEN                                                 0757
         CR    @04,@06                                             0757
         BNH   @RF00757                                            0757
*               FMSIL = 32;             /* SET SEGMENT LENGTH.       */
         LR    FMSIL,@06                                           0758
*             ELSE                                                 0759
*               FMSIL = FMRIL;          /* SET SEGMENT LENGTH.       */
         B     @RC00757                                            0759
@RF00757 L     FMSIL,FMRIL                                         0759
*         END;                                                     0760
*                                                                  0760
@RC00757 DS    0H                                                  0760
@DE00728 SLR   @06,@06                                             0760
         C     @06,FMRIL                                           0760
         BL    @DL00728                                            0760
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND END THE BHD CONVERSION PROCEDURE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0761
*         RETURN CODE (0);                                         0761
*                                                                  0761
         LR    @15,@06                                             0761
         L     @14,@SA00009                                        0761
         LM    @00,@02,@SA00009+8                                  0761
         LM    @04,@06,@SA00009+20                                 0761
         LM    @08,@12,@SA00009+32                                 0761
         BR    @14                                                 0761
*         END BHDCONV;                                             0762
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - EBCDIC CONVERSION PROCEDURE.           */
*         /*                                                         */
*         /* FUNCTION - MOVES EBCDIC DATA TO BE PRINTED TO THE PRINT */
*         /* LINE.                                                   */
*         /* IF PRINT LINE OVERFLOW OCCURS, ALL LINES RESULTING FROM */
*         /* THE OVERFLOW ARE PRINTED PRIOR TO RETURN TO IDCTP01.    */
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER AND LENGTH AND THE PRINT */
*         /* POSITION ADDRESS.                                       */
*         /*                                                         */
*         /* OUTPUT - DATA FORMATTED ON THE PRINT LINE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0763
*EBCDIC:  PROC;                                                    0763
*                                                                  0763
EBCDIC   STM   @14,@06,@SA00010                                    0763
         STM   @08,@12,@SA00010+36                                 0763
*         ALIGNBUF = ' ';               /* SET BUFFER BLANK  @OZ05939*/
*                                                                  0764
         MVI   ALIGNBUF+1,C' '                                     0764
         MVC   ALIGNBUF+2(133),ALIGNBUF+1                          0764
         MVI   ALIGNBUF,C' '                                       0764
*         IF PLOVF = ON                 /* CHECK PRINT LINE          */
*           THEN                        /* OVERFLOW BIT              */
         TM    PLOVF,B'10000000'                                   0765
         BNO   @RF00765                                            0765
*             DO;                                                  0766
*                                                                  0766
*             /*******************************************************/
*             /*                                                     */
*             /* FOR PRINT LINE OVERFLOW, BREAK THE INPUT DATA INTO  */
*             /* SEGMENTS AND PUT IT INTO THE PRINT LINE, INVOKING   */
*             /* LINEPRT FOR EACH LINE UNTIL ALL INPUT DATA HAS BEEN */
*             /* PRINTED.                                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0767
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)));      0767
         L     FMSIL,CVPPADD                                       0767
         SL    FMSIL,PRTBUFPT                                      0767
         LCR   FMSIL,FMSIL                                         0767
         AL    FMSIL,PCTPLW(,PCTPTR)                               0767
*               DO WHILE CVSL > 0;                                 0768
         B     @DE00768                                            0768
@DL00768 DS    0H                                                  0769
*                 CVPB(1:FMSIL) = TRBUF;                           0769
         L     @06,CVSTA                                           0769
         LR    @04,FMSIL                                           0769
         BCTR  @04,0                                               0769
         L     @15,FMRIP                                           0769
         EX    @04,@SM01044                                        0769
*                                       /* MOVE THE SEGMENT.         */
*                 CVSL = CVSL - FMSIL;                             0770
         L     @06,CVSL                                            0770
         SLR   @06,FMSIL                                           0770
         ST    @06,CVSL                                            0770
*                                       /* STEP SEGMENT LENGTH.      */
*                 FMRIP = FMRIP + FMSIL;                           0771
         ALR   @15,FMSIL                                           0771
         ST    @15,FMRIP                                           0771
*                                       /* STEP THE INPUT POINTER.   */
*                                                                  0772
*                 CALL LINEPRT;                                    0772
*                                                                  0772
         BAL   @14,LINEPRT                                         0772
*                 RESPECIFY RTNREG RSTD;                           0773
*                 TESTRC = RTNREG;                                 0774
         STH   RTNREG,TESTRC                                       0774
*                 RESPECIFY RTNREG UNRSTD;                         0775
*                   IF TESTRC > 0                                  0776
*                     THEN                                         0776
         LH    @06,TESTRC                                          0776
         LTR   @06,@06                                             0776
         BNP   @RF00776                                            0776
*                       RETURN CODE(RCQUIT);                       0777
*                                                                  0777
         LH    @15,RCQUIT                                          0777
         L     @14,@SA00010                                        0777
         LM    @00,@06,@SA00010+8                                  0777
         LM    @08,@12,@SA00010+36                                 0777
         BR    @14                                                 0777
*                 PRTSPF = 1;                                      0778
@RF00776 MVC   PRTSPF(2),@CH00216                                  0778
*                 CVSTA = CVPPADD;      /* RESET THE PRINT START ADDR*/
         L     @06,CVPPADD                                         0779
         ST    @06,CVSTA                                           0779
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0780
*                   THEN                /*IF MORE THAN ONE PRINT LINE*/
         L     @04,PRTBUFPT                                        0780
         AL    @04,PCTPLW(,PCTPTR)                                 0780
         SLR   @04,@06                                             0780
         C     @04,CVSL                                            0780
         BNL   @RF00780                                            0780
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD);  0781
         LR    FMSIL,@04                                           0781
*                                       /* MOVE A COMPLETE SEGMENT.  */
*                   ELSE                /* IF LESS THEN ONE LINE     */
*                     DO;                                          0782
         B     @RC00780                                            0782
@RF00780 DS    0H                                                  0783
*                       FMSIL = CVSL;   /* SET LENGTH FOR REMAINDER  */
         L     FMSIL,CVSL                                          0783
*                       PCTAPC = 0;                                0784
         SLR   @06,@06                                             0784
         STH   @06,PCTAPC(,PCTPTR)                                 0784
*                     END;                                         0785
*               END;                                               0786
@RC00780 DS    0H                                                  0786
@DE00768 L     @06,CVSL                                            0786
         LTR   @06,@06                                             0786
         BP    @DL00768                                            0786
*             END;                                                 0787
*           ELSE                                                   0788
*             DO;                                                  0788
*                                                                  0788
         B     @RC00765                                            0788
@RF00765 DS    0H                                                  0789
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE A PARTIAL LINE SEGMENT.                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0789
*               FMSIL = CVPOL;                                     0789
         L     FMSIL,CVPOL                                         0789
*               ALIGNBUF(1:CVSL) = TRBUF;                  /*@OZ05939*/
*                                                                  0790
         L     @07,CVSL                                            0790
         LR    @04,@07                                             0790
         BCTR  @04,0                                               0790
         L     @03,FMRIP                                           0790
         EX    @04,@SM01046                                        0790
*               /*****************************************************/
*               /*                                                   */
*               /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE   */
*               /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD    */
*               /* IS BLANKS THEN PRINT BLANK FIELD.         @OZ24776*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0791
*               DO N = CVSL TO 1 BY -1 WHILE ALIGNBUF(N) = ' ';    0791
         L     @04,CVSL                                            0791
         LR    N,@04                                               0791
         B     @DE00791                                            0791
@DL00791 LA    @04,ALIGNBUF-1(N)                                   0791
         CLI   0(@04),C' '                                         0791
         BNE   @DC00791                                            0791
*               END;                                       /*@OZ05939*/
*                                                                  0792
         BCTR  N,0                                                 0792
@DE00791 LTR   N,N                                                 0792
         BP    @DL00791                                            0792
@DC00791 DS    0H                                                  0793
*               IF N = 0 THEN N = CVSL;                    /*@OZ24776*/
*                                                                  0793
*                                                                  0793
         LTR   N,N                                                 0793
         BNZ   @RF00793                                            0793
         L     N,CVSL                                              0794
*               /*****************************************************/
*               /*                                           @OZ05939*/
*               /* MOVE LINE SEGMENT INTO PRINT BUFFER AND   @OZ05939*/
*               /* UPDATE THE AUTO PRINT COLUMN.             @OZ05939*/
*               /*                                           @OZ05939*/
*               /*****************************************************/
*               IF FMTAR = ON & N ^= CVSL                  /*@OZ05939*/
*                 THEN                                     /*@OZ05939*/
@RF00793 TM    FMTAR(FSADDR),B'00001000'                           0795
         BNO   @RF00795                                            0795
         L     @04,CVSL                                            0795
         CR    N,@04                                               0795
         BE    @RF00795                                            0795
*                   DO;                                    /*@OZ05939*/
*                   CVPB(CVSL-(N-1) : CVSL) = ALIGNBUF;    /*@OZ05939*/
         L     @06,CVSTA                                           0797
         LA    @03,1                                               0797
         SLR   @03,N                                               0797
         ALR   @03,@04                                             0797
         ST    @03,@TF00001                                        0797
         ALR   @03,@06                                             0797
         BCTR  @03,0                                               0797
         LR    @15,@04                                             0797
         SL    @15,@TF00001                                        0797
         EX    @15,@SM01048                                        0797
*                   PCTAPC = (CVSTA + CVSL -ADDR(PRTBUFF));/*@OZ05939*/
         ALR   @06,@04                                             0798
         SL    @06,PRTBUFPT                                        0798
         STH   @06,PCTAPC(,PCTPTR)                                 0798
*                   END;                                   /*@OZ05939*/
*                 ELSE                                     /*@OZ05939*/
*                   DO;                                    /*@OZ05939*/
         B     @RC00795                                            0800
@RF00795 DS    0H                                                  0801
*                   CVPB(1:CVSL) = ALIGNBUF;               /*@OZ05939*/
         L     @06,CVSTA                                           0801
         L     @04,CVSL                                            0801
         BCTR  @04,0                                               0801
         EX    @04,@SM01050                                        0801
*                   PCTAPC = (CVSTA +N) - ADDR(PRTBUFF);   /*@OZ05939*/
         ALR   @06,N                                               0802
         SL    @06,PRTBUFPT                                        0802
         STH   @06,PCTAPC(,PCTPTR)                                 0802
*                   END;                                   /*@OZ05939*/
*                                                                  0803
*             END;                                                 0804
*                                                                  0804
@RC00795 DS    0H                                                  0805
*         /***********************************************************/
*         /*                                                         */
*         /* IF PCTPMN = -1 THEN THIS IS A MESSAGE LINE.  CONVERT    */
*         /* THE MESSAGE NUMBER TO BINARY AND PUT IT BACK INTO PCTPMN*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0805
*         IF PCTPMN = -1                                           0805
*           THEN                                                   0805
@RC00765 CLC   PCTPMN(2,PCTPTR),@CH00900                           0805
         BNE   @RF00805                                            0805
*             DO;                                                  0806
*               MSGNO = PRTBUFF(5:7);                              0807
         L     @06,PRTBUFPT                                        0807
         MVC   MSGNO(3),PRTBUFF+4(@06)                             0807
*               GEN   (PACK  UNPKWD,MSGNO);                        0808
         PACK  UNPKWD,MSGNO
*               GEN   (CVB   CVDREG,UNPKWD);                       0809
         CVB   CVDREG,UNPKWD
*               PCTPMN = CVDREG;                                   0810
         STH   CVDREG,PCTPMN(,PCTPTR)                              0810
*             END;                                                 0811
*                                                                  0811
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND END THE EBCDIC PRINT PROCEDURE.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0812
*         RETURN CODE (0);                                         0812
*                                                                  0812
@RF00805 SLR   @15,@15                                             0812
         L     @14,@SA00010                                        0812
         LM    @00,@06,@SA00010+8                                  0812
         LM    @08,@12,@SA00010+36                                 0812
         BR    @14                                                 0812
*         END EBCDIC;                                              0813
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PACKED TO UNPACKED DECIMAL CONVERSION. */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONVERTS PACKED TO UNPACKED   */
*         /* DECIMAL DATA. IT IS CALLED BY THE BINARY TO DECIMAL     */
*         /* PROCEDURE IN ADDITION TO HANDLING STRAIGHT PACKED TO    */
*         /* UNPACKED.  IT IS, THEREFORE USED TO HANDLE ALL SIGN     */
*         /* CONTROL, LEFT ALIGNMENT AND ZERO SUPPRESSION.           */
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH, OUTPUT     */
*         /* PRINT POSITION POINTER, ALIGN LEFT FLAG, ZERO SUPPRESS  */
*         /* FLAG AND SIGN SUPPRESS FLAG.                            */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.  PRINT LINE  */
*         /* OVERFLOW DOES NOT OCCUR ON PACKED TO UNPACKED CONVERTS. */
*         /* IF THE CONDITION OCCURS, THE DATA OUT IS TRUNCATED.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0814
*PUPCONV: PROC;                                                    0814
*                                                                  0814
PUPCONV  STM   @14,@06,12(@13)                                     0814
         STM   @08,@12,52(@13)                                     0814
*         PLOVF = OFF;                  /* OVERFLOW NOT ALLOWED.     */
         NI    PLOVF,B'01111111'                                   0815
*         SETRC = 0;                                               0816
*                                                                  0816
         SLR   SETRC,SETRC                                         0816
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE COUNTERS USED FOR PACKED TO UNPACKED.        */
*         /* INITIALIZE FLAGS TO CONTROL ZERO SUPPRESS & LEFT ALIGN  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0817
*         PUPOCT = 1;                                              0817
         LA    @15,1                                               0817
         STH   @15,PUPOCT                                          0817
*         PUPPSC = 1;                                              0818
         LR    PUPPSC,@15                                          0818
*         IF CVPZS = OFF                /* IS IT ZERO SUPPRESS.      */
*           THEN                                                   0819
         TM    CVPZS,B'10000000'                                   0819
         BNZ   @RF00819                                            0819
*             PUPPSF = ON;              /* SET TO PRINT ZEROS.       */
         OI    PUPPSF,B'01000000'                                  0820
*           ELSE                                                   0821
*             PUPPSF = OFF;             /* SET TO SUPPRESS ZEROS.    */
         B     @RC00819                                            0821
@RF00819 NI    PUPPSF,B'10111111'                                  0821
*         IF CVPAL = OFF                /* IS IT ALIGN LEFT.         */
*           THEN                                                   0822
@RC00819 TM    CVPAL,B'01000000'                                   0822
         BNZ   @RF00822                                            0822
*             PUPIOF = ON;              /* SUPPRESS OUTPUT POINTER   */
         OI    PUPIOF,B'00100000'                                  0823
*                                       /* STEPPING IF IT IS.        */
*           ELSE                                                   0824
*             PUPIOF = OFF;             /* ALLOW OUTPUT PTR STEPPING */
*                                                                  0824
         B     @RC00822                                            0824
@RF00822 NI    PUPIOF,B'11011111'                                  0824
*         /***********************************************************/
*         /*                                                         */
*         /* BEGIN THE CONVERSION LOOP HERE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0825
*         OLDERID2 = NEWERID2;                                     0825
@RC00822 L     @15,GDTTR2(,GDTPR)                                  0825
         MVC   @TS00001(95),NEWERID2(@15)                          0825
         MVC   OLDERID2(95,@15),@TS00001                           0825
*         NEWID2 = 'TP2D';                                         0826
         MVC   NEWID2(4,@15),@CC00961                              0826
*         IF CVPPU = ON                                            0827
*           THEN                                                   0827
         TM    CVPPU,B'00001000'                                   0827
         BNO   @RF00827                                            0827
*             FMSIL = CVPIL;            /* SET PACKED TO UNPACKED    */
         L     FMSIL,CVPIL                                         0828
*                                       /* LENGTH FIELD.             */
*                                                                  0829
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE SIGN UNDER CONTROL OF THE SIGN SUPPRESS FLAG */
*         /* IN THE INPUT PARAMETERS.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0829
*         IF CVPSS = OFF                /* IS SIGN SUPPRESS OFF.     */
*           THEN                                                   0829
@RF00827 TM    CVPSS,B'00100000'                                   0829
         BNZ   @RF00829                                            0829
*             DO;                                                  0830
*               SIGNT = (TRBUF(FMSIL) & '0F'X);                    0831
         LA    SIGNT,15                                            0831
         L     @07,FMRIP                                           0831
         BCTR  @07,0                                               0831
         SLR   @15,@15                                             0831
         IC    @15,TRBUF(FMSIL,@07)                                0831
         NR    SIGNT,@15                                           0831
*                                       /* GET THE SIGN.             */
*               IF SIGNT = 11  SIGNT = 13                         0832
*                                       /* IF IT IS EITHER, MINUS.   */
*                 THEN                                             0832
         C     SIGNT,@CF00033                                      0832
         BE    @RT00832                                            0832
         C     SIGNT,@CF00962                                      0832
         BNE   @RF00832                                            0832
@RT00832 DS    0H                                                  0833
*                   SIGN = MINUS;       /* SET THE MINUS SIGN.       */
         MVI   SIGN,C'-'                                           0833
*                 ELSE                                             0834
*                   SIGN = PLUS;        /* SET THE PLUS SIGN.        */
         B     @RC00832                                            0834
@RF00832 MVI   SIGN,C'+'                                           0834
*               PUPPSC = PUPPSC + 1;    /* STEP PRINT BUFF PTR.      */
@RC00832 AL    PUPPSC,@CF00216                                     0835
*             END;                                                 0836
*                                                                  0836
*         DO N = 1 TO FMSIL BY 1;                                  0837
*                                                                  0837
@RF00829 LA    N,1                                                 0837
         B     @DE00837                                            0837
@DL00837 DS    0H                                                  0838
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE HIGH ORDER HALF BYTE AND CHECK FOR A VALID    */
*           /* PACKED DECIMAL DIGIT.                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0838
*           DECT = TRBUF(N)/16;         /* GET HIGH ORDER HALF CHAR  */
         L     @01,FMRIP                                           0838
         BCTR  @01,0                                               0838
         SLR   DECT,DECT                                           0838
         IC    DECT,TRBUF(N,@01)                                   0838
         SRL   DECT,4                                              0838
*           IF DECT > 9                 /* COMPARE TO MAXIMUM.       */
*             THEN                                                 0839
*                                                                  0839
         C     DECT,@CF00953                                       0839
         BNH   @RF00839                                            0839
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN TO THE CALLER ON A NON-VALID PACKED DECIMAL  */
*             /* DECIMAL DIGIT.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0840
*               DO;                                                0840
*                 RETURN CODE (8);                                 0841
         LA    @15,8                                               0841
         L     @14,12(,@13)                                        0841
         LM    @00,@06,20(@13)                                     0841
         LM    @08,@12,52(@13)                                     0841
         BR    @14                                                 0841
*               END;                                               0842
*                                                                  0842
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE THIS HALF BYTE TO THE OUTPUT BUFFER.           */
*             /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS   */
*             /* CONTROL FLAGS.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0843
*             IF DECT ^= 0              /* IS IT NON ZERO            */
*               THEN                                               0843
@RF00839 LTR   DECT,DECT                                           0843
         BZ    @RF00843                                            0843
*                 DO;                                              0844
*                   PUPPSF = ON;        /* TURN PRINT START ON.      */
*                   PUPIOF = ON;        /* TURN OUTPUT STEP ON.      */
         OI    PUPPSF,B'01100000'                                  0846
*                 END;                                             0847
*             IF FMSIL*2 - PUPOCT <=CVPOL                          0848
*                                      /* CHECK OUTPUT START.        */
*               THEN                                               0848
@RF00843 LR    @15,FMSIL                                           0848
         ALR   @15,@15                                             0848
         SH    @15,PUPOCT                                          0848
         C     @15,CVPOL                                           0848
         BH    @RF00848                                            0848
*                 DO;                                              0849
*                   IF PUPPSF = ON     /* IS PRINT START ON         */
*                     THEN                                         0850
         TM    PUPPSF,B'01000000'                                  0850
         BNO   @RF00850                                            0850
*                       DO;                                        0851
*                         CVPB(PUPPSC) = BHTRTB(DECT+1);           0852
         L     @15,CVSTA                                           0852
         LR    @14,@15                                             0852
         ALR   @14,PUPPSC                                          0852
         BCTR  @14,0                                               0852
         LA    @01,BHTRTB(DECT)                                    0852
         MVC   CVPB(1,@14),0(@01)                                  0852
*                                       /* MOVE CONVERTED DIGIT.     */
*                         IF SIGNPOS = OFF & CVPSS = OFF           0853
*                           THEN                                   0853
         TM    SIGNPOS,B'00010000'                                 0853
         BNZ   @RF00853                                            0853
         TM    CVPSS,B'00100000'                                   0853
         BNZ   @RF00853                                            0853
*                             DO;                                  0854
*                                                                  0854
*                             /***************************************/
*                             /*                                     */
*                             /* MOVE SIGN TO BUFFER.                */
*                             /*                                     */
*                             /***************************************/
*                                                                  0855
*                               PUPPSC=PUPPSC-1;                   0855
         BCTR  PUPPSC,0                                            0855
*                               CVPB(PUPPSC) = SIGN;               0856
         ALR   @15,PUPPSC                                          0856
         BCTR  @15,0                                               0856
         MVC   CVPB(1,@15),SIGN                                    0856
*                               PUPPSC=PUPPSC+1;                   0857
         AL    PUPPSC,@CF00216                                     0857
*                               SIGNPOS = ON;                      0858
         OI    SIGNPOS,B'00010000'                                 0858
*                             END;                                 0859
*                       END;                                       0860
@RF00853 DS    0H                                                  0861
*                   IF PUPIOF = ON      /* CAN OUTPUT PTR BE STEPPED */
*                     THEN                                         0861
@RF00850 TM    PUPIOF,B'00100000'                                  0861
         BNO   @RF00861                                            0861
*                       PUPPSC = PUPPSC + 1;                       0862
         AL    PUPPSC,@CF00216                                     0862
*                   IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW     0863
*                                       /* IS IT END OF LINE.        */
*                     THEN                                         0863
@RF00861 LR    @06,PUPPSC                                          0863
         AL    @06,CVSTA                                           0863
         L     @15,PRTBUFPT                                        0863
         AL    @15,PCTPLW(,PCTPTR)                                 0863
         CR    @06,@15                                             0863
         BNH   @RF00863                                            0863
*                       DO;                                        0864
*                         OLDERID2 = NEWERID2;                     0865
         L     @06,GDTTR2(,GDTPR)                                  0865
         MVC   @TS00001(95),NEWERID2(@06)                          0865
         MVC   OLDERID2(95,@06),@TS00001                           0865
*                         NEWID2 = 'TP2O';                         0866
         MVC   NEWID2(4,@06),@CC00963                              0866
*                         RETURN CODE(0);                          0867
         SLR   @15,@15                                             0867
         L     @14,12(,@13)                                        0867
         LM    @00,@06,20(@13)                                     0867
         LM    @08,@12,52(@13)                                     0867
         BR    @14                                                 0867
*                       END;                                       0868
*                 END;                                             0869
@RF00863 DS    0H                                                  0870
*           PUPOCT = PUPOCT + 1;                                   0870
*                                                                  0870
@RF00848 LH    @01,PUPOCT                                          0870
         LA    @01,1(,@01)                                         0870
         STH   @01,PUPOCT                                          0870
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE LOW ORDER HALF BYTE OF THE INPUT BYTE.        */
*           /* IF THIS IS THE LAST BYTE, THIS WILL BE THE SIGN.      */
*           /* IF THIS IS THE CASE, IGNORE IT & TERMINATE.           */
*           /* IF THIS IS ANY OTHER THAN THE LAST BYTE, CHECK IT FOR */
*           /* VALIDITY.                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0871
*           DECT = TRBUF(N) & '0F'X;                               0871
         LA    DECT,15                                             0871
         L     @01,FMRIP                                           0871
         BCTR  @01,0                                               0871
         SLR   @00,@00                                             0871
         IC    @00,TRBUF(N,@01)                                    0871
         NR    DECT,@00                                            0871
*           IF DECT > 9                 /* IS IT A VALID PACK DIGIT  */
*             THEN                                                 0872
         C     DECT,@CF00953                                       0872
         BNH   @RF00872                                            0872
*               DO;                                                0873
*                 IF N = FMSIL          /* IF NOT, IS IT A SIGN.     */
*                   THEN;                                          0874
         CR    N,FMSIL                                             0874
         BE    @RT00874                                            0874
*                   ELSE                                           0876
*                     DO;               /* IF NEITHER THEN ERROR RET */
*                       OLDERID2 = NEWERID2;                       0877
         L     @06,GDTTR2(,GDTPR)                                  0877
         MVC   @TS00001(95),NEWERID2(@06)                          0877
         MVC   OLDERID2(95,@06),@TS00001                           0877
*                       NEWID2 = 'TP2I';                           0878
         MVC   NEWID2(4,@06),@CC00933                              0878
*                       RETURN CODE (8);                           0879
         LA    @15,8                                               0879
         L     @14,12(,@13)                                        0879
         LM    @00,@06,20(@13)                                     0879
         LM    @08,@12,52(@13)                                     0879
         BR    @14                                                 0879
*                     END;                                         0880
*               END;                                               0881
*                                                                  0881
@RT00874 DS    0H                                                  0882
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE THE LOW ORDER HALF BYTE TO THE OUTPUT BUFFER.    */
*           /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS     */
*           /* CONTROL FLAGS.                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0882
*           IF N < FMSIL                /* CHECK FOR SIGN POSITION.  */
*             THEN                                                 0882
@RF00872 CR    N,FMSIL                                             0882
         BNL   @RF00882                                            0882
*               DO;                                                0883
*                 IF DECT ^= 0          /* CHECK FIRST NON-ZERO.     */
*                   THEN                                           0884
         LTR   DECT,DECT                                           0884
         BZ    @RF00884                                            0884
*                     DO;                                          0885
*                       PUPPSF = ON;    /* PRINT START ON.           */
*                       PUPIOF = ON;    /* OUTPUT STEP ON.           */
         OI    PUPPSF,B'01100000'                                  0887
*                     END;                                         0888
*                 IF FMSIL*2 - PUPOCT <= CVPOL                     0889
*                                      /* CHECK OUTPUT START.        */
*                   THEN                                           0889
@RF00884 LR    @15,FMSIL                                           0889
         ALR   @15,@15                                             0889
         SH    @15,PUPOCT                                          0889
         C     @15,CVPOL                                           0889
         BH    @RF00889                                            0889
*                     DO;                                          0890
*                       IF PUPPSF = ON  /* IS PRINT START ON.        */
*                         THEN                                     0891
         TM    PUPPSF,B'01000000'                                  0891
         BNO   @RF00891                                            0891
*                           DO;                                    0892
*                             CVPB(PUPPSC) = BHTRTB(DECT + 1);     0893
         L     @15,CVSTA                                           0893
         LR    @14,@15                                             0893
         ALR   @14,PUPPSC                                          0893
         BCTR  @14,0                                               0893
         LA    @01,BHTRTB(DECT)                                    0893
         MVC   CVPB(1,@14),0(@01)                                  0893
*                                       /* MOVE THE CHARACTER.       */
*                             IF SIGNPOS = OFF & CVPSS = OFF       0894
*                               THEN                               0894
         TM    SIGNPOS,B'00010000'                                 0894
         BNZ   @RF00894                                            0894
         TM    CVPSS,B'00100000'                                   0894
         BNZ   @RF00894                                            0894
*                                 DO;   /* SET THE SIGN.             */
*                                   PUPPSC=PUPPSC-1;               0896
         BCTR  PUPPSC,0                                            0896
*                                   CVPB(PUPPSC) = SIGN;           0897
         ALR   @15,PUPPSC                                          0897
         BCTR  @15,0                                               0897
         MVC   CVPB(1,@15),SIGN                                    0897
*                                   PUPPSC=PUPPSC+1;               0898
         AL    PUPPSC,@CF00216                                     0898
*                                   SIGNPOS = ON;                  0899
         OI    SIGNPOS,B'00010000'                                 0899
*                                 END;                             0900
*                           END;                                   0901
@RF00894 DS    0H                                                  0902
*                       IF PUPIOF = ON                             0902
*                         THEN                                     0902
@RF00891 TM    PUPIOF,B'00100000'                                  0902
         BNO   @RF00902                                            0902
*                           PUPPSC = PUPPSC + 1;                   0903
         AL    PUPPSC,@CF00216                                     0903
*                       IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW + 1
*                                       /* IS IT END OF PRINT LINE   */
*                         THEN                                     0904
@RF00902 LR    @06,PUPPSC                                          0904
         AL    @06,CVSTA                                           0904
         L     @15,PRTBUFPT                                        0904
         AL    @15,PCTPLW(,PCTPTR)                                 0904
         AL    @15,@CF00216                                        0904
         CR    @06,@15                                             0904
         BNH   @RF00904                                            0904
*                           DO;                                    0905
*                             OLDERID2 = NEWERID2;                 0906
         L     @06,GDTTR2(,GDTPR)                                  0906
         MVC   @TS00001(95),NEWERID2(@06)                          0906
         MVC   OLDERID2(95,@06),@TS00001                           0906
*                             NEWID2 = 'TP2V';                     0907
         MVC   NEWID2(4,@06),@CC00964                              0907
*                             RETURN CODE(0);                      0908
         SLR   @15,@15                                             0908
         L     @14,12(,@13)                                        0908
         LM    @00,@06,20(@13)                                     0908
         LM    @08,@12,52(@13)                                     0908
         BR    @14                                                 0908
*                           END;                                   0909
*                     END;                                         0910
@RF00904 DS    0H                                                  0911
*               END;                                               0911
@RF00889 DS    0H                                                  0912
*             PUPOCT = PUPOCT + 1;                                 0912
@RF00882 LH    @06,PUPOCT                                          0912
         LA    @06,1(,@06)                                         0912
         STH   @06,PUPOCT                                          0912
*         END;                                                     0913
*                                                                  0913
         AL    N,@CF00216                                          0913
@DE00837 CR    N,FMSIL                                             0913
         BNH   @DL00837                                            0913
*         /***********************************************************/
*         /*                                                 @Y30LSJK*/
*         /* SET ZERO IN ALL ZERO FIELD. IF ZERO SUPPRESS    @Y30LSJK*/
*         /* AND NO NONZERO DIGITS FOUND.                    @Y30LSJK*/
*         /*                                                 @Y30LSJK*/
*         /***********************************************************/
*         IF CVPZS = ON & PUPPSF = OFF                             0914
*           THEN                                                   0914
         TM    CVPZS,B'10000000'                                   0914
         BNO   @RF00914                                            0914
         TM    PUPPSF,B'01000000'                                  0914
         BNZ   @RF00914                                            0914
*             IF CVPAL = OFF                                       0915
*               THEN                                               0915
         TM    CVPAL,B'01000000'                                   0915
         BNZ   @RF00915                                            0915
*                 CVPB(CVSL) = '0';     /* SET ZERO IN ALL ZERO FIELD*/
         L     @04,CVSTA                                           0916
         AL    @04,CVSL                                            0916
         BCTR  @04,0                                               0916
         MVI   CVPB(@04),C'0'                                      0916
*               ELSE                                               0917
*                 CVPB(1) = '0';                           /*@Y30LSJK*/
*                                                                  0917
         B     @RC00915                                            0917
@RF00915 L     @04,CVSTA                                           0917
         MVI   CVPB(@04),C'0'                                      0917
*         /***********************************************************/
*         /*                                                 @Y30LSJK*/
*         /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE @Y30LSJK*/
*         /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD  @OZ24776*/
*         /* IS BLANKS THEN PRINT A BLANK FIELD.             @OZ24776*/
*         /*                                                 @Y30LSJK*/
*         /***********************************************************/
*                                                                  0918
*         DO N = CVSL TO 1 BY -1 WHILE CVPB(N) = ' ';      /*@Y30LSJK*/
@RC00915 DS    0H                                                  0918
@RF00914 L     N,CVSL                                              0918
         B     @DE00918                                            0918
@DL00918 L     @06,CVSTA                                           0918
         ALR   @06,N                                               0918
         BCTR  @06,0                                               0918
         CLI   CVPB(@06),C' '                                      0918
         BNE   @DC00918                                            0918
*         END;                                             /*@Y30LSJK*/
*                                                                  0919
         BCTR  N,0                                                 0919
@DE00918 LTR   N,N                                                 0919
         BP    @DL00918                                            0919
@DC00918 DS    0H                                                  0920
*         IF N = 0 THEN N = CVSL;                          /*@OZ24776*/
*                                                                  0920
         LTR   N,N                                                 0920
         BNZ   @RF00920                                            0920
         L     N,CVSL                                              0921
*         PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);            /*@Y30LSJK*/
*                                                                  0922
@RF00920 LR    @06,N                                               0922
         AL    @06,CVSTA                                           0922
         SL    @06,PRTBUFPT                                        0922
         STH   @06,PCTAPC(,PCTPTR)                                 0922
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE PACKED TO UNPACKED DECIMAL CONVERSION.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0923
*         OLDERID2 = NEWERID2;                                     0923
         L     @06,GDTTR2(,GDTPR)                                  0923
         MVC   @TS00001(95),NEWERID2(@06)                          0923
         MVC   OLDERID2(95,@06),@TS00001                           0923
*         NEWID2 = 'TP2U';                                         0924
         MVC   NEWID2(4,@06),@CC00966                              0924
*         RETURN CODE (0);                                         0925
         SLR   @15,@15                                             0925
         L     @14,12(,@13)                                        0925
         LM    @00,@06,20(@13)                                     0925
         LM    @08,@12,52(@13)                                     0925
         BR    @14                                                 0925
*         END PUPCONV;                                             0926
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO DECIMAL CONVERSION.          */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY TO PACKED DECIMAL THEN CALLS */
*         /* THE PACKED TO UNPACKED DECIMAL CONVERSION PROCEDURE TO  */
*         /* CONVERT THE PACKED DECIMAL TO UNPACKED DECIMAL.         */
*         /* THE CONVERT BINARY-TO-DECIMAL INSTRUCTION DOES  @OZ17059*/
*         /* NOT HANDLE FOUR BYTE BINARY NUMBERS WITH THE    @OZ17059*/
*         /* HIGH-ORDER BIT REPRESENTING DATA. IF THE VALUE  @OZ17059*/
*         /* TO BE CONVERTED IS FOUR BYTES IN LENGTH, HAS THE@OZ17059*/
*         /* HIGH-ORDER BIT ON AND THE SUPPRESS SIGN FLAG IS @OZ17059*/
*         /* ON, THE HIGH-ORDER BIT IS TURNED OFF AND A      @OZ17059*/
*         /* A PACKED DECIMAL VALUE IS ADDED TO THE VALUE    @OZ17059*/
*         /* RETURNED BY THE CONVERT BINARY-TO-DECIMAL       @OZ17059*/
*         /* INSTRUCTION.                                    @OZ17059*/
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH AND PRINT   */
*         /* POSITION ADDRESS.                                       */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DECIMAL DATA IN THE PRINT LINE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0927
*BDCONV:  PROC;                                                    0927
*                                                                  0927
BDCONV   STM   @14,@06,@SA00012                                    0927
         STM   @08,@12,@SA00012+36                                 0927
*         BDLEN = 5 - CVPIL;                                       0928
         L     @04,CVPIL                                           0928
         LA    @03,5                                               0928
         SLR   @03,@04                                             0928
         ST    @03,BDLEN                                           0928
*         HIORDRF = OFF;                /* SET THE HI-ORDER  @OZ17059*/
         NI    HIORDRF,B'11110111'                                 0929
*                                       /* DATA FLAG.        @OZ17059*/
*         IF CVPIL = 2                  /* IS INPUT HALF WORD.       */
*           THEN                                                   0930
         C     @04,@CF00150                                        0930
         BNE   @RF00930                                            0930
*             DO;                       /* SET UP HALF WORD INPUT.   */
*               BINHALFC(1:2) = CVPIADD ->TRBUF;                   0932
         L     @04,CVPIADD                                         0932
         MVC   BINHALFC(2),TRBUF(@04)                              0932
*               BINACC = BINHALF;                                  0933
         LH    @04,BINHALF                                         0933
         ST    @04,BINACC                                          0933
*             END;                                                 0934
*           ELSE                                                   0935
*             DO;                       /* SET UP OTHER LENGTH INPUT */
         B     @RC00930                                            0935
@RF00930 DS    0H                                                  0936
*               BINACC = 0;                                        0936
         SLR   @04,@04                                             0936
         ST    @04,BINACC                                          0936
*               BINACCC(BDLEN:4) = CVPIADD ->TRBUF;                0937
*                                                                  0937
         L     @04,BDLEN                                           0937
         LA    @03,BINACCC-1(@04)                                  0937
         LCR   @04,@04                                             0937
         AL    @04,@CF00036                                        0937
         L     @01,CVPIADD                                         0937
         EX    @04,@SM01056                                        0937
*               /******************************************* @OZ17059*/
*               /*                                           @OZ17059*/
*               /* DETERMINE IF THE HIGH-ORDER BIT CONTAINS  @OZ17059*/
*               /* DATA. DATA IS ASSUMED IF VALUE IS FOUR    @OZ17059*/
*               /* BYTES LONG, THE HIGH-ORDER BIT IS ON AND  @OZ17059*/
*               /* THE SUPPRESS SIGN FLAG IS ON.             @OZ17059*/
*               /*                                           @OZ17059*/
*               /******************************************* @OZ17059*/
*                                                                  0938
*               IF BINACCC(1) > MAXPLUS /* IS HIGH-ORDER     @OZ17059*/
*                 THEN                  /* BIT ON ?          @OZ17059*/
         CLI   BINACCC,X'7F'                                       0938
         BNH   @RF00938                                            0938
*                   IF CVPSS = ON       /* SIGN SUPPRESS?    @OZ17059*/
*                     THEN                                 /*@OZ17059*/
         TM    CVPSS,B'00100000'                                   0939
         BNO   @RF00939                                            0939
*                       DO;                                /*@OZ17059*/
*                       HIORDRF = ON;   /* SET HI-ORDER      @OZ17059*/
         OI    HIORDRF,B'00001000'                                 0941
*                                       /* DATA BIT FLAG     @OZ17059*/
*                       BINACCC(1) = BINACCC(1) & MAXPLUS; /*@OZ17059*/
         NI    BINACCC,X'7F'                                       0942
*                                       /* CLEAR HIGH-ORDER  @OZ17059*/
*                                       /* BIT               @OZ17059*/
*                       END;                               /*@OZ17059*/
*                     ELSE;                                /*@OZ17059*/
@RF00939 DS    0H                                                  0945
*                 ELSE;                                    /*@OZ17059*/
@RF00938 DS    0H                                                  0946
*             END;                                                 0946
*                                                                  0946
*GEN      (L   CVDREG,BINACC);                                     0947
@RC00930 DS    0H                                                  0947
         L   CVDREG,BINACC
*GEN      (CVD CVDREG,UNPKWD);                                     0948
*                                                                  0948
         CVD CVDREG,UNPKWD
*         /**************************************************@OZ17059*/
*         /*                                                 @OZ17059*/
*         /* IF THE HIGH-ORDER BIT CONTAINED DATA, IT MUST   @OZ17059*/
*         /* BE ADDED TO THE CONVERTED DECIMAL VALUE. THE    @OZ17059*/
*         /* DECIMAL EQUIVALENT MUST BE ADDED IN TWO PARTS   @OZ17059*/
*         /* EQUAL TO HALF THE REQUIRED VALUE BECAUSE ONE    @OZ17059*/
*         /* CONSTANT CANNOT BE DEFINED LARGE ENOUGH.        @OZ17059*/
*         /*                                                 @OZ17059*/
*         /**************************************************@OZ17059*/
*                                                                  0949
*         IF HIORDRF = ON               /* HIGH-ORDER BIT    @OZ17059*/
*           THEN                        /* CONTAINS DATA ?   @OZ17059*/
         TM    HIORDRF,B'00001000'                                 0949
         BNO   @RF00949                                            0949
*             DO;                                          /*@OZ17059*/
*             AP (UNPKWD,PKDECE);       /* ADD PACKED DECIMAL@OZ17059*/
         AP    UNPKWD(8),@CB00879(8)                               0951
*             AP (UNPKWD,PKDECE);       /* EQUIVALEN OF      @OZ17059*/
         AP    UNPKWD(8),@CB00879(8)                               0952
*             END;                      /* X'80000000' BACK  @OZ17059*/
*           ELSE;                       /* IN TWO PARTS      @OZ17059*/
*                                                                  0954
@RF00949 DS    0H                                                  0955
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE PARAMETERS FOR THE CALL TO THE PACKED TO     */
*         /* UNPACKED CONVERSION AND MAKE THE CALL TO THAT PROCEDURE */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0955
*         FMRIP = ADDR(UNPKWD);                                    0955
         LA    @06,UNPKWD                                          0955
         ST    @06,FMRIP                                           0955
*         FMSIL = 8;                                               0956
*                                                                  0956
         LA    FMSIL,8                                             0956
*         CALL PUPCONV;                                            0957
*                                                                  0957
         BAL   @14,PUPCONV                                         0957
*         RESPECIFY RTNREG RSTD;                                   0958
*         TESTRC = RTNREG;                                         0959
         STH   RTNREG,TESTRC                                       0959
*         RESPECIFY RTNREG UNRSTD;                                 0960
*         RETURN CODE (TESTRC);                                    0961
         LH    @06,TESTRC                                          0961
         LR    @15,@06                                             0961
         L     @14,@SA00012                                        0961
         LM    @00,@06,@SA00012+8                                  0961
         LM    @08,@12,@SA00012+36                                 0961
         BR    @14                                                 0961
*         END BDCONV;                                              0962
*         END CONVERT;                                             0963
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - DATA RETURN PROCEDURE.                 */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE RETURNS DATA TO A CALLER.     */
*         /* THE DATA IS RETURNED TO THE AREA POINTED TO BY DARGRETP */
*         /* TO THE LENGTH PROVIDED BY DARGRETC.  IF THE DATA LENGTH */
*         /* TO BE FORMATTED IS LESS THAN THE COUNT IN DARGRETC THEN */
*         /* THE AREA IS NOT PADDED WITH BLANKS.  IF DARGRETC IS LESS*/
*         /* THAN THE THE LENGTH OF THE DATA TO BE FORMATTED, THEN   */
*         /* FORMATTING IS STOPPED WHEN DARGRETC IS REACHED.  IN     */
*         /* EITHER CASE, NO MESSAGE IS PRINTED OR ERROR CONDITION   */
*         /* RETURNED.                                               */
*         /*                                                         */
*         /* INPUT - THE FULLY CONVERTED AND FORMATTED LINE IN THE   */
*         /* PRINT ARGUMENT LIST (CVPSTRU).                          */
*         /*                                                         */
*         /* OUTPUT - THE RETURNED DATA IN THE AREA DESIGNATED BY    */
*         /* THE CALLER.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0964
*LINERET: PROC;                                                    0964
*                                                                  0964
LINERET  STM   @14,@12,12(@13)                                     0964
*   OLDERID2 = NEWERID2;                                           0965
         L     @04,GDTTR2(,GDTPR)                                  0965
         MVC   @TS00001(95),NEWERID2(@04)                          0965
         MVC   OLDERID2(95,@04),@TS00001                           0965
*   NEWID2 = 'TPDR';                                               0966
*                                                                  0966
         MVC   NEWID2(4,@04),@CC00975                              0966
*         /***********************************************************/
*         /*                                                         */
*         /* RETURN THE FORMATTED LINE TO THE CALLER.                */
*         /* RETLN IS USED TO CONTAIN THE LENGTH OF THE AREA TO BE   */
*         /* MOVED.                                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0967
*         IF CVPRETC > PCTPLW                                      0967
*           THEN                                                   0967
         LH    @04,CVPRETC                                         0967
         L     @03,PCTPLW(,PCTPTR)                                 0967
         CR    @04,@03                                             0967
         BNH   @RF00967                                            0967
*             DO;                                                  0968
*                                                                  0968
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE SEGMENT LENGTH TO                           */
*             /* MOVE AN ENTIRE LINE TO USERS DATA AREA.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0969
*               RETLN = PCTPLW;                                    0969
         ST    @03,RETLN                                           0969
*               CVPRETC = CVPRETC - PCTPLW;                        0970
         SLR   @04,@03                                             0970
         STH   @04,CVPRETC                                         0970
*             END;                                                 0971
*           ELSE                                                   0972
*             DO;                                                  0972
*                                                                  0972
         B     @RC00967                                            0972
@RF00967 DS    0H                                                  0973
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE SEGMENT LENGTH TO                           */
*             /* MOVE A PARTIAL LINE.                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0973
*               RETLN = CVPRETC;                                   0973
         LH    @04,CVPRETC                                         0973
         ST    @04,RETLN                                           0973
*               CVPRETC = 0;                                       0974
         SLR   @04,@04                                             0974
         STH   @04,CVPRETC                                         0974
*             END;                                                 0975
*         IF RETLN > 0                                             0976
*           THEN                                                   0976
@RC00967 L     @04,RETLN                                           0976
         LTR   @04,@04                                             0976
         BNP   @RF00976                                            0976
*             DO;                                                  0977
*                                                                  0977
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE THE LINE SEGMENT TO THE USERS AREA.          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0978
*               RETAREA(1:RETLN) = PRTBUFF;                        0978
         L     @03,CVPRETP                                         0978
         LR    @15,@04                                             0978
         BCTR  @15,0                                               0978
         L     @01,PRTBUFPT                                        0978
         EX    @15,@SM01058                                        0978
*               CVPRETP = CVPRETP + RETLN;                         0979
         ALR   @03,@04                                             0979
         ST    @03,CVPRETP                                         0979
*             END;                                                 0980
*             FFMFMTF = OFF;                                       0981
@RF00976 NI    FFMFMTF,B'11111110'                                 0981
*             PRTBUFF = ' ';                                       0982
*                                                                  0982
         L     @04,PRTBUFPT                                        0982
         MVI   PRTBUFF+1(@04),C' '                                 0982
         MVC   PRTBUFF+2(133,@04),PRTBUFF+1(@04)                   0982
         MVI   PRTBUFF(@04),C' '                                   0982
*         RETURN;                                                  0983
@EL00013 DS    0H                                                  0983
@EF00013 DS    0H                                                  0983
@ER00013 LM    @14,@12,12(@13)                                     0983
         BR    @14                                                 0983
*         END LINERET;                                             0984
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - LINE PRINT PROCEDURE.                  */
*         /*                                                         */
*         /* FUNCTION - MAINTAINS PAGE FORMATTING INFORMATION,       */
*         /* PRINTING TITLE, HEADING AND FOOTING LINES AS REQUIRED   */
*         /* AND PRINTS THE LINES REQUESTED.  THIS PROCEDURE IS      */
*         /* ALSWAYS CALLED FROM THE MAIN FORMAT PROCEDURE OR FROM   */
*         /* THE CONVERSION PROCEDURE.                               */
*         /*                                                         */
*         /* INPUT - THE CONVERSION/PRINT ARGUMENT LIST. (CVPSTRU)   */
*         /*                                                         */
*         /* OUTPUT - THE PRINTED PAGE.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0985
*LINEPRT: PROC;                                                    0985
*                                                                  0985
LINEPRT  STM   @14,@06,@SA00014                                    0985
         STM   @08,@12,@SA00014+36                                 0985
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DATA IS TO BE RETURNED TO THE USER INSTEAD OF    */
*         /* BEING PRINTED, CALL THE LINE RETURN PROCEDURE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0986
*         IF CVPRETP ^= NULLPTR                                    0986
*           THEN                                                   0986
         L     @06,CVPRETP                                         0986
         LTR   @06,@06                                             0986
         BZ    @RF00986                                            0986
*             DO;                                                  0987
*                                                                  0987
*               CALL LINERET;                                      0988
*                                                                  0988
         BAL   @14,LINERET                                         0988
*               FFMFMTF = OFF;                                     0989
         NI    FFMFMTF,B'11111110'                                 0989
*               PRTBUFF = ' ';                                     0990
         L     @06,PRTBUFPT                                        0990
         MVI   PRTBUFF+1(@06),C' '                                 0990
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   0990
         MVI   PRTBUFF(@06),C' '                                   0990
*               RETURN CODE(0);                                    0991
         SLR   @15,@15                                             0991
         L     @14,@SA00014                                        0991
         LM    @00,@06,@SA00014+8                                  0991
         LM    @08,@12,@SA00014+36                                 0991
         BR    @14                                                 0991
*             END;                                                 0992
*                                                                  0992
*         IF GDTDBG = NULLPTR                                      0993
*           THEN;                                                  0993
@RF00986 L     @06,GDTDBG(,GDTPR)                                  0993
         LTR   @06,@06                                             0993
         BZ    @RT00993                                            0993
*           ELSE                                                   0995
*             CALL IDCDB010 (GDTTBL,'TP3I');                       0995
*                                                                  0995
         ST    GDTPR,@AL00001                                      0995
         LA    @06,@CC00979                                        0995
         ST    @06,@AL00001+4                                      0995
         MVI   @AL00001+4,X'80'                                    0995
         L     @15,GDTDBG(,GDTPR)                                  0995
         LA    @01,@AL00001                                        0995
         BALR  @14,@15                                             0995
*         PRLINE = ' ';                 /* SET BUFFER TO     @Z40GSJG*/
@RT00993 MVI   PRLINE+1,C' '                                       0996
         MVC   PRLINE+2(218),PRLINE+1                              0996
         MVI   PRLINE,C' '                                         0996
*         PRLINES = ' ';                /* BLANKS            @Z40GSJG*/
         MVI   PRLINES+1,C' '                                      0997
         MVC   PRLINES+2(218),PRLINES+1                            0997
         MVI   PRLINES,C' '                                        0997
*         PRCC = PRCCON(2);             /* CARR CONT = SINGLE SPACE  */
         MVC   PRCC(1),PRCCON+1                                    0998
*         SPFSAV = PRTSPF;              /* SAVE SPACING FACTOR       */
*                                                                  0999
         LH    SPFSAV,PRTSPF                                       0999
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NULL AND THE     */
*         /* ALTERNATE PRINT FILE FLAG IS ON THEN THE FILES MUST BE  */
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1000
*         IOCSPTR=PCTIOC;                                          1000
         L     IOCSPTR,PCTIOC(,PCTPTR)                             1000
*         IF PCTIOP = NULLPTR & PCTAPF = ON                        1001
*           THEN                                                   1001
         SLR   @04,@04                                             1001
         C     @04,PCTIOP(,PCTPTR)                                 1001
         BNE   @RF01001                                            1001
         TM    PCTAPF(PCTPTR),B'00001000'                          1001
         BNO   @RF01001                                            1001
*             DO;                                                  1002
*                                                                  1002
*               /*****************************************************/
*               /*                                                   */
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1003
*               IF PCTLNM ^= 0                                     1003
*                 THEN                                             1003
         CH    @04,PCTLNM(,PCTPTR)                                 1003
         BE    @RF01003                                            1003
*                   DO;                                            1004
*                     FFMPSFF = ON;                                1005
*                                                                  1005
         OI    FFMPSFF,B'00100000'                                 1005
*                     CALL STACKPUT (PRCC);                        1006
*                                                                  1006
         LA    @04,PRCC                                            1006
         ST    @04,@AL00001                                        1006
         LA    @01,@AL00001                                        1006
         BAL   @14,STACKPUT                                        1006
*                     RESPECIFY RTNREG RSTD;                       1007
*                     TESTRC = RTNREG;                             1008
         STH   RTNREG,TESTRC                                       1008
*                     RESPECIFY RTNREG UNRSTD;                     1009
*                     IF TESTRC ^= 0                               1010
*                       THEN                                       1010
         LH    @04,TESTRC                                          1010
         LTR   @04,@04                                             1010
         BZ    @RF01010                                            1010
*                         RETURN CODE(RCQUIT);                     1011
         LH    @15,RCQUIT                                          1011
         L     @14,@SA00014                                        1011
         LM    @00,@06,@SA00014+8                                  1011
         LM    @08,@12,@SA00014+36                                 1011
         BR    @14                                                 1011
*                   END;                                           1012
*                                                                  1012
@RF01010 DS    0H                                                  1013
*               /*****************************************************/
*               /*                                                   */
*               /* SWITCH THE IOCS PARMS TO THE STANDARD IOCS FILE.  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1013
*               PCTLPL = PCTAPL;                                   1013
@RF01003 MVC   PCTLPL(4,PCTPTR),PCTAPL(PCTPTR)                     1013
*               PCTACT = PCTSTD;                                   1014
         MVC   PCTACT(8,PCTPTR),PCTSTD(PCTPTR)                     1014
*               PCTAPF = OFF;                                      1015
         NI    PCTAPF(PCTPTR),B'11110111'                          1015
*             END;                                                 1016
*                                                                  1016
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NOT NULL AND THE */
*         /* ALTERNATE PRINT FILE FLAG IS OFF THEN THE FILES MUST BE */
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1017
*         IF PCTIOP ^= NULLPTR & PCTAPF = OFF                      1017
*           THEN                                                   1017
@RF01001 SLR   @04,@04                                             1017
         C     @04,PCTIOP(,PCTPTR)                                 1017
         BE    @RF01017                                            1017
         TM    PCTAPF(PCTPTR),B'00001000'                          1017
         BNZ   @RF01017                                            1017
*             DO;                                                  1018
*               /*****************************************************/
*               /*                                                   */
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1019
*               IF PCTLNM ^= 0                                     1019
*                 THEN                                             1019
         CH    @04,PCTLNM(,PCTPTR)                                 1019
         BE    @RF01019                                            1019
*                   DO;                                            1020
*                     FFMPSFF = ON;                                1021
*                                                                  1021
         OI    FFMPSFF,B'00100000'                                 1021
*                     CALL STACKPUT (PRCC);                        1022
*                                                                  1022
         LA    @04,PRCC                                            1022
         ST    @04,@AL00001                                        1022
         LA    @01,@AL00001                                        1022
         BAL   @14,STACKPUT                                        1022
*                     RESPECIFY RTNREG RSTD;                       1023
*                     TESTRC = RTNREG;                             1024
         STH   RTNREG,TESTRC                                       1024
*                     RESPECIFY RTNREG UNRSTD;                     1025
*                     IF TESTRC ^= 0                               1026
*                       THEN                                       1026
         LH    @06,TESTRC                                          1026
         LTR   @06,@06                                             1026
         BZ    @RF01026                                            1026
*                         RETURN CODE(RCQUIT);                     1027
         LH    @15,RCQUIT                                          1027
         L     @14,@SA00014                                        1027
         LM    @00,@06,@SA00014+8                                  1027
         LM    @08,@12,@SA00014+36                                 1027
         BR    @14                                                 1027
*                   END;                                           1028
*                                                                  1028
@RF01026 DS    0H                                                  1029
*               /*****************************************************/
*               /*                                                   */
*               /* SWITCH THE IOCS PARMS TO THE ALTERNATE IOCS FILE  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1029
*               PCTSTD = PCTACT;                                   1029
@RF01019 MVC   PCTSTD(8,PCTPTR),PCTACT(PCTPTR)                     1029
*               PCTACT = PCTALT;                                   1030
         MVC   PCTACT(8,PCTPTR),PCTALT(PCTPTR)                     1030
*               PCTAPF = ON;                                       1031
         OI    PCTAPF(PCTPTR),B'00001000'                          1031
*             END;                                                 1032
*                                                                  1032
*         IOCSPTR = PCTIOC;             /* SET THE IOCS POINTER.     */
@RF01017 L     IOCSPTR,PCTIOC(,PCTPTR)                             1033
*         NLISAV = PCTNLI;              /* SAVE THE NEXT LINE NUMBER */
*                                                                  1034
         LH    @04,PCTNLI(,PCTPTR)                                 1034
         STH   @04,NLISAV                                          1034
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE PREVIOUS LINE WAS A MESSAGE, ADD AN EXTRA SPACE  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1035
*         IF PRTSPT = 'R' & PCTLLM = ON & PCTPMN = 0 & QSECMF = OFF
*           THEN                                                   1035
         CLI   PRTSPT,C'R'                                         1035
         BNE   @RF01035                                            1035
         TM    PCTLLM(PCTPTR),B'00010000'                          1035
         BNO   @RF01035                                            1035
         LH    @04,PCTPMN(,PCTPTR)                                 1035
         LTR   @04,@04                                             1035
         BNZ   @RF01035                                            1035
         L     @04,QENTP                                           1035
         TM    QSECMF(@04),B'00100000'                             1035
         BNZ   @RF01035                                            1035
*             DO;                                                  1036
*               SPFSAV = SPFSAV+1;                                 1037
         AL    SPFSAV,@CF00216                                     1037
*               PCTLLM = OFF;                                      1038
         NI    PCTLLM(PCTPTR),B'11101111'                          1038
*             END;                                                 1039
*                                                                  1039
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS AN INITIAL HEADER CHECK FOR SPACE FOR THE    */
*         /* HEADING PLUS 1 PRINT LINE AND IF THIS MUCH SPACE IS     */
*         /* NOT LEFT ON THIS PAGE, FORCE A PAGE OVERFLOW.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1040
*         IF PCTH1F = ON & (PCTNLI + PCTHSC) > PCTLDL              1040
*           THEN                                                   1040
@RF01035 TM    PCTH1F(PCTPTR),B'10000000'                          1040
         BNO   @RF01040                                            1040
         SLR   @04,@04                                             1040
         IC    @04,PCTHSC(,PCTPTR)                                 1040
         AH    @04,PCTNLI(,PCTPTR)                                 1040
         CH    @04,PCTLDL(,PCTPTR)                                 1040
         BNH   @RF01040                                            1040
*             PCTNLI = 999;                                        1041
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1041
*         /***********************************************************/
*         /*                                                         */
*         /*  CONVERT ABSOLUTE TO RELATIVE SPACING IF NEEDED         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1042
*         IF PRTSPT = 'A'                                          1042
*           THEN                                                   1042
@RF01040 CLI   PRTSPT,C'A'                                         1042
         BNE   @RF01042                                            1042
*             DO;                                                  1043
*               IF SPFSAV <= PCTLDL & SPFSAV >= PCTFDL             1044
*                 THEN                                             1044
         CH    SPFSAV,PCTLDL(,PCTPTR)                              1044
         BH    @RF01044                                            1044
         CH    SPFSAV,PCTFDL(,PCTPTR)                              1044
         BL    @RF01044                                            1044
*                   DO;                                            1045
*                     IF SPFSAV >= PCTNLI                          1046
*                       THEN                                       1046
         LH    @04,PCTNLI(,PCTPTR)                                 1046
         CR    SPFSAV,@04                                          1046
         BL    @RF01046                                            1046
*                         SPFSAV = SPFSAV + 1 - PCTNLI;            1047
         LA    @15,1                                               1047
         ALR   @15,SPFSAV                                          1047
         SLR   @15,@04                                             1047
         LR    SPFSAV,@15                                          1047
*                       ELSE                                       1048
*                         DO;                                      1048
         B     @RC01046                                            1048
@RF01046 DS    0H                                                  1049
*                           SPFSAV = 1;                            1049
         LA    SPFSAV,1                                            1049
*                           PCTNLI = 999;                          1050
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1050
*                         END;                                     1051
*                   END;                                           1052
*                                                                  1052
*         /***********************************************************/
*         /*                                                         */
*         /*  ABSOLUTE LINE NUMBER IS OUT OF RANGE.                  */
*         /*  FORCE AN EJECT AND PRINT ON FIRST LINE OF NEXT PAGE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1053
*                 ELSE                                             1053
*                   DO;                                            1053
         B     @RC01044                                            1053
@RF01044 DS    0H                                                  1054
*                     SPFSAV = 1;        /* SET SINGLE SPACE CONTROL  *
         LA    SPFSAV,1                                            1054
*                     PCTNLI = 999;     /* FORCE AN EJECT            */
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1055
*                   END;                                           1056
*             END;                                                 1057
@RC01044 DS    0H                                                  1058
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR OVERFLOW OR EJECT AND HANDLE IF NEEDED.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1058
*         IF (PCTNLI + SPFSAV) > PCTLDL  PRTSPT = 'E'             1058
*           THEN                                                   1058
@RF01042 LR    @04,SPFSAV                                          1058
         AH    @04,PCTNLI(,PCTPTR)                                 1058
         CH    @04,PCTLDL(,PCTPTR)                                 1058
         BH    @RT01058                                            1058
         CLI   PRTSPT,C'E'                                         1058
         BNE   @RF01058                                            1058
@RT01058 DS    0H                                                  1059
*OFLOOP:      DO;                                                  1059
OFLOOP   DS    0H                                                  1060
*               SPFSAV = 2;                                        1060
         LA    SPFSAV,2                                            1060
*               SAVPMN = PCTPMN;       /*SAVE MSG NO.        #YL026UE*/
         LH    @04,PCTPMN(,PCTPTR)                                 1061
         STH   @04,SAVPMN                                          1061
*               PCTPMN = 0;            /*NO MSG # WITH TITLE #YL026UE*/
         SLR   @04,@04                                             1062
         STH   @04,PCTPMN(,PCTPTR)                                 1062
*               FFMHDFLN = ON;         /*SET HEAD/FOOT FLAG  @Y30SSJK*/
*                                                                  1063
         OI    FFMHDFLN,B'00000010'                                1063
*         /***********************************************************/
*         /*                                                         */
*         /*  WRITE THE FOOTING LINES IF THEY ARE REQUIRED           */
*         /* CURLI IS USED TO POINT TO THE CURRENT FOOTING LINE TO   */
*         /* BE PRINTED.                                             */
*         /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET         */
*         /* INITIALLY TO THE FOOTING LINE COUNT. (PCTFLC)           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1064
*               IF PCTFLC ^= 0                                     1064
*                 THEN                                             1064
         CH    @04,PCTFLC(,PCTPTR)                                 1064
         BE    @RF01064                                            1064
*                   DO;                                            1065
*                     PRFTSP = PCTFLN + 1 - NLISAV;                1066
*                                                                  1066
         LA    PRFTSP,1                                            1066
         AH    PRFTSP,PCTFLN(,PCTPTR)                              1066
         SH    PRFTSP,NLISAV                                       1066
*                     /***********************************************/
*                     /*                                             */
*                     /* SPACE TO THE FIRST FOOTING LINE.            */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1067
*                     PRCC = PRCCON(4);                            1067
         MVC   PRCC(1),PRCCON+3                                    1067
*                     DO WHILE PRFTSP > 3;                         1068
         B     @DE01068                                            1068
@DL01068 DS    0H                                                  1069
*                       PRFTSP = PRFTSP - 3;                       1069
*                                                                  1069
         SL    PRFTSP,@CF00159                                     1069
*                       CALL STACKPUT (PRCC);                      1070
*                                                                  1070
         LA    @15,PRCC                                            1070
         ST    @15,@AL00001                                        1070
         LA    @01,@AL00001                                        1070
         BAL   @14,STACKPUT                                        1070
*                     END;                                         1071
*                                                                  1071
@DE01068 C     PRFTSP,@CF00159                                     1071
         BH    @DL01068                                            1071
*                     /***********************************************/
*                     /*                                             */
*                     /* PRINT THE FOOTING LINES.                    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1072
*                     TTLPT = PCTFLP;   /* SET TEMP FOOTING LINE PTR */
         L     @15,PCTFLP(,PCTPTR)                                 1072
         ST    @15,TTLPT                                           1072
*                     FLCC(1) = PRCCON(PRFTSP+ 1);                 1073
         LA    @14,PRCCON(PRFTSP)                                  1073
         MVC   FLCC(1,@15),0(@14)                                  1073
*                     DO LINCT = PCTFLC BY -1 TO 1;                1074
*                                                                  1074
         LH    @04,PCTFLC(,PCTPTR)                                 1074
         ST    @04,LINCT                                           1074
         B     @DE01074                                            1074
@DL01074 DS    0H                                                  1075
*                       CALL STACKPUT (FTLI);                      1075
*                                                                  1075
         L     @04,TTLPT                                           1075
         ST    @04,@AL00001                                        1075
         LA    @01,@AL00001                                        1075
         BAL   @14,STACKPUT                                        1075
*                       TTLPT = TTLPT + STDLWPS;                   1076
         LH    @04,STDLWPS                                         1076
         AL    @04,TTLPT                                           1076
         ST    @04,TTLPT                                           1076
*                     END;                                         1077
         SLR   @04,@04                                             1077
         BCTR  @04,0                                               1077
         AL    @04,LINCT                                           1077
         ST    @04,LINCT                                           1077
@DE01074 LTR   @04,@04                                             1077
         BP    @DL01074                                            1077
*                   END;                                           1078
*                 /***************************************************/
*                 /*                                                 */
*                 /*  WRITE THE TITLE LINES REQUIRED BY THE OVER FLOW*/
*                 /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET */
*                 /* INITIALLY TO THE TITLE LINE COUNT.(PCTMLC) OR   */
*                 /* (PCTSLC)                                        */
*                 /*                                                 */
*                 /***************************************************/
*                 /*                                                 */
*                 /* WRITE THE MAIN TITLE LINES FIRST.               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1079
*                   PCTNLI = 2;         /* SET NEXT LINE NUMBER      */
@RF01064 MVC   PCTNLI(2,PCTPTR),@CH00150                           1079
*                   PCTCPN = PCTCPN + PCTPNI;                      1080
         LH    @07,PCTCPN(,PCTPTR)                                 1080
         AH    @07,PCTPNI(,PCTPTR)                                 1080
         STH   @07,PCTCPN(,PCTPTR)                                 1080
*                                       /* SET NEXT PAGE NUMBER.     */
*                                                                  1081
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP THE PAGE NUMBER IN THE MAIN TITLE LINE   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1081
*                   CVDREG = PCTCPN;    /* CONVERT PAGE NUMBER       */
         LR    CVDREG,@07                                          1081
*                   GEN (CVD   CVDREG,UNPKWD);                     1082
         CVD   CVDREG,UNPKWD
*                   GEN (UNPK  MTPN,UNPKWD);                       1083
         UNPK  MTPN,UNPKWD
*                   GEN (OI    MTPN+3,X'F0');                      1084
*                                                                  1084
         OI    MTPN+3,X'F0'
*                   MTLINE(PCTPNL:PCTPNL + 4) = MTPN;              1085
         LH    @07,PCTPNL(,PCTPTR)                                 1085
         L     @04,PCTMLP(,PCTPTR)                                 1085
         ALR   @04,@07                                             1085
         BCTR  @04,0                                               1085
         MVI   MTLINE+4(@04),C' '                                  1085
         MVC   MTLINE(4,@04),MTPN                                  1085
*                                       /* MOVE PAGE NUMBER TO LINE  */
*                                                                  1086
*                   /*************************************************/
*                   /*                                               */
*                   /* SET LEADING PAGE NUMBER ZEROS TO BLANKS.      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1086
*                   LINCT = PCTPNL;                                1086
         ST    @07,LINCT                                           1086
*                   DO N = 1 TO 3 BY 1 WHILE MTLINE(LINCT) = '0';  1087
         LA    N,1                                                 1087
@DL01087 L     @04,LINCT                                           1087
         L     @15,PCTMLP(,PCTPTR)                                 1087
         ALR   @04,@15                                             1087
         BCTR  @04,0                                               1087
         CLI   MTLINE(@04),C'0'                                    1087
         BNE   @DC01087                                            1087
*                     MTLINE(LINCT) = ' ';                         1088
         L     @04,LINCT                                           1088
         ALR   @15,@04                                             1088
         BCTR  @15,0                                               1088
         MVI   MTLINE(@15),C' '                                    1088
*                                       /* SET PRECEDING ZEROS BLANK */
*                     LINCT = LINCT +1;                            1089
         AL    @04,@CF00216                                        1089
         ST    @04,LINCT                                           1089
*                   END;                                           1090
*                                                                  1090
         AL    N,@CF00216                                          1090
         C     N,@CF00159                                          1090
         BNH   @DL01087                                            1090
@DC01087 DS    0H                                                  1091
*                   /*************************************************/
*                   /*                                               */
*                   /* PUT THE MAIN TITLE LINE TO SYSPRINT.          */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1091
*                                                                  1091
*                   CALL STACKPUT (MTLINE);                        1091
*                                                                  1091
         L     @04,PCTMLP(,PCTPTR)                                 1091
         ST    @04,@AL00001                                        1091
         LA    @01,@AL00001                                        1091
         BAL   @14,STACKPUT                                        1091
*                   RESPECIFY RTNREG RSTD;                         1092
*                   TESTRC = RTNREG;                               1093
         STH   RTNREG,TESTRC                                       1093
*                   RESPECIFY RTNREG UNRSTD;                       1094
*                   IF TESTRC ^= 0                                 1095
*                     THEN                                         1095
         LH    @04,TESTRC                                          1095
         LTR   @04,@04                                             1095
         BZ    @RF01095                                            1095
*                       RETURN CODE(RCQUIT);                       1096
*                                                                  1096
         LH    @15,RCQUIT                                          1096
         L     @14,@SA00014                                        1096
         LM    @00,@06,@SA00014+8                                  1096
         LM    @08,@12,@SA00014+36                                 1096
         BR    @14                                                 1096
*                   /*************************************************/
*                   /*                                               */
*                   /*  WRITE THE SUB TITLE LINES                    */
*                   /* THERE MAY BE FROM ONE TO THREE TITLE LINES,   */
*                   /* EACH WITH SPACING OF ONE TO THREE LINES.      */
*                   /* THIS ROUTINE WRITES THOSE LINES AND KEEPS     */
*                   /* TRACK OF THE SPACING TO DETERMINE WHAT WILL   */
*                   /* BE THE FIRST DATA LINE.                       */
*                   /* PCTSLP POINTS TO THE TITLE LINES.             */
*                   /* PCTSLC CONTAINS A COUNT OF THE NUMBER OF LINES*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1097
*                   TTLPT = PCTSLP;    /* SET TEMP SUB-TITLE PTR    */
@RF01095 L     @04,PCTSLP(,PCTPTR)                                 1097
         ST    @04,TTLPT                                           1097
*                   IF PCTSLC ^= 0                                 1098
*                     THEN                                         1098
         LH    @04,PCTSLC(,PCTPTR)                                 1098
         LTR   @04,@04                                             1098
         BZ    @RF01098                                            1098
*                       /*********************************************/
*                       /*                                           */
*                       /* COMPUTE THE LINE SPACE FOR EACH           */
*                       /* SUB-TITLE LINE FOR LOCATION OF FIRST DATA */
*                       /* LINE.                                     */
*                       /*                                           */
*                       /*********************************************/
*                                                                  1099
*                       DO LINCT = 1 TO PCTSLC;                    1099
         LA    @04,1                                               1099
         B     @DE01099                                            1099
@DL01099 DS    0H                                                  1100
*                         IF STLCC = ' '                           1100
*                           THEN       /* FIGURE LINE SPACING.       */
         L     @04,TTLPT                                           1100
         CLI   STLCC(@04),64                                       1100
         BNE   @RF01100                                            1100
*                             PCTNLI = PCTNLI + 1;                 1101
         LA    @04,1                                               1101
         AH    @04,PCTNLI(,PCTPTR)                                 1101
         STH   @04,PCTNLI(,PCTPTR)                                 1101
*                         IF STLCC = '0'                           1102
*                           THEN                                   1102
@RF01100 L     @04,TTLPT                                           1102
         CLI   STLCC(@04),240                                      1102
         BNE   @RF01102                                            1102
*                             PCTNLI = PCTNLI + 2;                 1103
         LA    @04,2                                               1103
         AH    @04,PCTNLI(,PCTPTR)                                 1103
         STH   @04,PCTNLI(,PCTPTR)                                 1103
*                         IF STLCC = '-'                           1104
*                           THEN                                   1104
@RF01102 L     @04,TTLPT                                           1104
         CLI   STLCC(@04),96                                       1104
         BNE   @RF01104                                            1104
*                             PCTNLI = PCTNLI + 3;                 1105
*                                                                  1105
         LA    @04,3                                               1105
         AH    @04,PCTNLI(,PCTPTR)                                 1105
         STH   @04,PCTNLI(,PCTPTR)                                 1105
*                       /*********************************************/
*                       /*                                           */
*                       /* PUT THE SUB-TITLE LINE TO SYSPRINT.       */
*                       /*                                           */
*                       /*********************************************/
*                                                                  1106
*                         CALL STACKPUT (STLINE);                  1106
*                                                                  1106
@RF01104 L     @04,TTLPT                                           1106
         ST    @04,@AL00001                                        1106
         LA    @01,@AL00001                                        1106
         BAL   @14,STACKPUT                                        1106
*                         RESPECIFY RTNREG RSTD;                   1107
*                         TESTRC = RTNREG;                         1108
         STH   RTNREG,TESTRC                                       1108
*                         RESPECIFY RTNREG UNRSTD;                 1109
*                         IF TESTRC ^= 0                           1110
*                           THEN                                   1110
         LH    @04,TESTRC                                          1110
         LTR   @04,@04                                             1110
         BZ    @RF01110                                            1110
*                             RETURN CODE(RCQUIT);                 1111
         LH    @15,RCQUIT                                          1111
         L     @14,@SA00014                                        1111
         LM    @00,@06,@SA00014+8                                  1111
         LM    @08,@12,@SA00014+36                                 1111
         BR    @14                                                 1111
*                         TTLPT = TTLPT + STDLWPS;                 1112
@RF01110 LH    @04,STDLWPS                                         1112
         AL    @04,TTLPT                                           1112
         ST    @04,TTLPT                                           1112
*                                       /* STEP TO NEXT LINE.        */
*                       END;                                       1113
         LA    @04,1                                               1113
         AL    @04,LINCT                                           1113
@DE01099 ST    @04,LINCT                                           1113
         CH    @04,PCTSLC(,PCTPTR)                                 1113
         BNH   @DL01099                                            1113
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF HEADINGS ARE TO BE PRINTED, DO IT HERE.      */
*                 /* HEADING LINES ARE KEPT IN A QUEUE ANCHORED ON   */
*                 /* PCTAHP.  IF PCTHAF IS ON AND PCTH1F IS OFF      */
*                 /* DURING PAGE OVERFLOW, ALL HEADING LINES IN THE  */
*                 /* QUEUE ARE PRINTED.                              */
*                 /* PCTHAF INDICATES A HEADING IS ACTIVE.           */
*                 /* PCTH1F INDICATES THE CURRENT LINE IS THE FIRST  */
*                 /*        LINE OF A NEW HEADING SET.               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1114
*                 IF PCTHAF = ON & PCTH1F = OFF                    1114
*                   THEN                                           1114
@RF01098 TM    PCTHAF(PCTPTR),B'00100000'                          1114
         BNO   @RF01114                                            1114
         TM    PCTH1F(PCTPTR),B'10000000'                          1114
         BNZ   @RF01114                                            1114
*                     DO;                                          1115
*                       HEADPTR = PCTAHP;                          1116
         L     @04,PCTAHP(,PCTPTR)                                 1116
         ST    @04,HEADPTR                                         1116
*                       DO WHILE HEADPTR > 0;                      1117
*                                                                  1117
         B     @DE01117                                            1117
@DL01117 DS    0H                                                  1118
*                         /*******************************************/
*                         /*                                         */
*                         /* COMPUTE THE LINE SPACE FOR EACH         */
*                         /* HEADING LINE FOR LOCATION OF THE FIRST  */
*                         /* DATA LINE.                              */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1118
*                         IF HEADCC = ' '                          1118
*                           THEN                                   1118
         L     @04,HEADPTR                                         1118
         CLI   HEADCC(@04),C' '                                    1118
         BNE   @RF01118                                            1118
*                             PCTNLI = PCTNLI + 1;                 1119
         LA    @04,1                                               1119
         AH    @04,PCTNLI(,PCTPTR)                                 1119
         STH   @04,PCTNLI(,PCTPTR)                                 1119
*                         IF HEADCC = '0'                          1120
*                           THEN                                   1120
@RF01118 L     @04,HEADPTR                                         1120
         CLI   HEADCC(@04),C'0'                                    1120
         BNE   @RF01120                                            1120
*                             PCTNLI = PCTNLI + 2;                 1121
         LA    @04,2                                               1121
         AH    @04,PCTNLI(,PCTPTR)                                 1121
         STH   @04,PCTNLI(,PCTPTR)                                 1121
*                         IF HEADCC = '-'                          1122
*                           THEN                                   1122
@RF01120 L     @04,HEADPTR                                         1122
         CLI   HEADCC(@04),C'-'                                    1122
         BNE   @RF01122                                            1122
*                             PCTNLI = PCTNLI + 3;                 1123
*                                                                  1123
         LA    @04,3                                               1123
         AH    @04,PCTNLI(,PCTPTR)                                 1123
         STH   @04,PCTNLI(,PCTPTR)                                 1123
*                         /*******************************************/
*                         /*                                         */
*                         /* WRITE THE HEADING LINES.                */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1124
*                         CALL STACKPUT (HEADCC);                  1124
*                                                                  1124
@RF01122 L     @04,HEADPTR                                         1124
         LA    @04,HEADCC(,@04)                                    1124
         ST    @04,@AL00001                                        1124
         LA    @01,@AL00001                                        1124
         BAL   @14,STACKPUT                                        1124
*                         RESPECIFY RTNREG RSTD;                   1125
*                         TESTRC = RTNREG;                         1126
         STH   RTNREG,TESTRC                                       1126
*                         RESPECIFY RTNREG UNRSTD;                 1127
*                         IF TESTRC ^= 0                           1128
*                           THEN                                   1128
         LH    @04,TESTRC                                          1128
         LTR   @04,@04                                             1128
         BZ    @RF01128                                            1128
*                             RETURN CODE(RCQUIT);                 1129
         LH    @15,RCQUIT                                          1129
         L     @14,@SA00014                                        1129
         LM    @00,@06,@SA00014+8                                  1129
         LM    @08,@12,@SA00014+36                                 1129
         BR    @14                                                 1129
*                         HEADPTR = HEADQP;                        1130
@RF01128 L     @04,HEADPTR                                         1130
         L     @04,HEADQP(,@04)                                    1130
         ST    @04,HEADPTR                                         1130
*                                       /* STEP HEADER LINE PTR.     */
*                       END;                                       1131
@DE01117 L     @04,HEADPTR                                         1131
         LTR   @04,@04                                             1131
         BP    @DL01117                                            1131
*                     END;                                         1132
*                     PCTPMN = SAVPMN; /*RESTORE MSG #       @YL026UE*/
*                                                                  1133
@RF01114 LH    @04,SAVPMN                                          1133
         STH   @04,PCTPMN(,PCTPTR)                                 1133
*               FFMHDFLN = OFF;         /*TURN OFF HEAD/FOOT @Y30SSJK*/
         NI    FFMHDFLN,B'11111101'                                1134
*             END OFLOOP;                                          1135
*         /***********************************************************/
*         /*                                                         */
*         /*  DO THE REQUIRED SPACING FOR THE LINE TO BE PRINTED     */
*         /*  SET UP TRIPLE LINE SPACES TO GET TO THE REQUIRED LINE  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1136
*         PRCC = PRCCON(4);             /* SET TRIPLE SPACE CHAR     */
@RF01058 MVC   PRCC(1),PRCCON+3                                    1136
*         DO WHILE SPFSAV > 3;                                     1137
         B     @DE01137                                            1137
@DL01137 DS    0H                                                  1138
*           PCTNLI = PCTNLI + 3;        /* ADVANCE LINE COUNT        */
         LA    @04,3                                               1138
         LH    @15,PCTNLI(,PCTPTR)                                 1138
         ALR   @15,@04                                             1138
         STH   @15,PCTNLI(,PCTPTR)                                 1138
*           SPFSAV = SPFSAV - 3;        /* REDUCE REQUEST COUNT      */
*                                                                  1139
         SLR   SPFSAV,@04                                          1139
*           CALL STACKPUT (PRCC);                                  1140
*                                                                  1140
         LA    @04,PRCC                                            1140
         ST    @04,@AL00001                                        1140
         LA    @01,@AL00001                                        1140
         BAL   @14,STACKPUT                                        1140
*           RESPECIFY RTNREG RSTD;                                 1141
*           TESTRC = RTNREG;                                       1142
         STH   RTNREG,TESTRC                                       1142
*           RESPECIFY RTNREG UNRSTD;                               1143
*           IF TESTRC ^= 0                                         1144
*             THEN                                                 1144
         LH    @04,TESTRC                                          1144
         LTR   @04,@04                                             1144
         BZ    @RF01144                                            1144
*               RETURN CODE(RCQUIT);                               1145
         LH    @15,RCQUIT                                          1145
         L     @14,@SA00014                                        1145
         LM    @00,@06,@SA00014+8                                  1145
         LM    @08,@12,@SA00014+36                                 1145
         BR    @14                                                 1145
*         END;                                                     1146
*                                                                  1146
@RF01144 DS    0H                                                  1146
@DE01137 C     SPFSAV,@CF00159                                     1146
         BH    @DL01137                                            1146
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE AND TRANSLATE THIS DATA LINE                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1147
*         PRCC = PRCCON(SPFSAV+1);      /* SET PROPER SPACE CHAR     */
         LA    @04,PRCCON(SPFSAV)                                  1147
         MVC   PRCC(1),0(@04)                                      1147
*         PRLINE = PRTBUFF;             /* MOVE LINE TO PRINT@Z40GSJG*/
*                                                                  1148
         MVI   PRLINE+135,C' '                                     1148
         MVC   PRLINE+136(84),PRLINE+135                           1148
         L     @04,PRTBUFPT                                        1148
         MVC   PRLINE(135),PRTBUFF(@04)                            1148
*         CVDREG = PCTTRP;              /* GET TRANSLATE TABLE ADDR. */
         L     CVDREG,PCTTRP(,PCTPTR)                              1149
*GENERATE (TR    PRLINE,0(CVDREG));     /* TRANSLATE THE LINE        */
*                                                                  1150
         TR    PRLINE,0(CVDREG)
*        IF FFMPSMS = ON                                           1151
*          THEN                                                    1151
         TM    FFMPSMS,B'00001000'                                 1151
         BNO   @RF01151                                            1151
*            DO;                                           /*@Y30SSJK*/
*              PRLINES = PRTBUFF2;                         /*@Z40GSJG*/
         MVI   PRLINES+135,C' '                                    1153
         MVC   PRLINES+136(84),PRLINES+135                         1153
         MVC   PRLINES(135),PRTBUFF2                               1153
*              GEN(TR PRLINES,0(CVDREG));                  /*@Y30SSJK*/
         TR PRLINES,0(CVDREG)
*            END;                                          /*@Y30SSJK*/
*                                                                  1155
*        /************************************************************/
*        /*                                                          */
*        /* MESSAGES MUST BE SEGMENTED BY THE SEGMENT ROUTINE TO     */
*        /* INSURE THAT AS MANY LINES AS ARE REQUIRED, TO PRINT      */
*        /* THE FULL MESSAGE TEXT, ARE PRINTED.                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1156
*         IF FFMPMSF = ON                                 /* @OZ18517*/
*           THEN                                          /* @Z40GSJG*/
@RF01151 TM    FFMPMSF,B'00010000'                                 1156
         BNO   @RF01156                                            1156
*             CALL SEGMENT;                               /* @Z40GSJG*/
*                                                                  1157
         BAL   @14,SEGMENT                                         1157
*         IF GDTDBG = NULLPTR                                      1158
*           THEN;                                                  1158
@RF01156 L     @04,GDTDBG(,GDTPR)                                  1158
         LTR   @04,@04                                             1158
         BZ    @RT01158                                            1158
*           ELSE                                                   1160
*             CALL IDCDB010(GDTTBL,'TPMS');/*                      1160
*                                                            @Z40GSJG*/
*                                                                  1160
         ST    GDTPR,@AL00001                                      1160
         LA    @04,@CC00987                                        1160
         ST    @04,@AL00001+4                                      1160
         MVI   @AL00001+4,X'80'                                    1160
         L     @15,GDTDBG(,GDTPR)                                  1160
         LA    @01,@AL00001                                        1160
         BALR  @14,@15                                             1160
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE ARGUMENTS FOR THE ADAPTER.                   */
*         /* THEN PRINT THIS LINE.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1161
*         CALL STACKPUT (PRCC);                                    1161
*                                                                  1161
@RT01158 LA    @04,PRCC                                            1161
         ST    @04,@AL00001                                        1161
         LA    @01,@AL00001                                        1161
         BAL   @14,STACKPUT                                        1161
*         RESPECIFY RTNREG RSTD;                                   1162
*         TESTRC = RTNREG;                                         1163
         STH   RTNREG,TESTRC                                       1163
*         RESPECIFY RTNREG UNRSTD;                                 1164
*     IF GDTDBG = NULLPTR                                          1165
*       THEN;                                                      1165
         L     @06,GDTDBG(,GDTPR)                                  1165
         LTR   @06,@06                                             1165
         BZ    @RT01165                                            1165
*       ELSE                                                       1167
*         CALL IDCDB010(GDTTBL,'TPX1');                            1167
         ST    GDTPR,@AL00001                                      1167
         LA    @06,@CC00988                                        1167
         ST    @06,@AL00001+4                                      1167
         MVI   @AL00001+4,X'80'                                    1167
         L     @15,GDTDBG(,GDTPR)                                  1167
         LA    @01,@AL00001                                        1167
         BALR  @14,@15                                             1167
*                                                          /*@Y30SSJK*/
*         IF TESTRC ^= 0                                           1168
*           THEN                                                   1168
@RT01165 LH    @06,TESTRC                                          1168
         LTR   @06,@06                                             1168
         BZ    @RF01168                                            1168
*             RETURN CODE(RCQUIT);                                 1169
         LH    @15,RCQUIT                                          1169
         L     @14,@SA00014                                        1169
         LM    @00,@06,@SA00014+8                                  1169
         LM    @08,@12,@SA00014+36                                 1169
         BR    @14                                                 1169
*         PCTPMN = 0;                                              1170
@RF01168 SLR   @06,@06                                             1170
         STH   @06,PCTPMN(,PCTPTR)                                 1170
*         PCTNLI = PCTNLI + SPFSAV;                                1171
*                                                                  1171
         LR    @06,SPFSAV                                          1171
         AH    @06,PCTNLI(,PCTPTR)                                 1171
         STH   @06,PCTNLI(,PCTPTR)                                 1171
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE LINE JUST PRINTED WAS A NEW HEADING LINE, SET IT */
*         /* UP IN THE HEADER QUEUE HERE.  THE CORE FOR THIS QUEUE   */
*         /* IS OBTAINED FROM POOL 'TP03'.  IF THERE WAS A PREVIOUS  */
*         /* HEADER, ITS CORE IS FREED PRIOR TO GETTING CORE FOR     */
*         /* THIS HEADER.  ALL HEADER CORE IS FREED WHEN A RESET IS  */
*         /* ISSUED AT ANY TIME.                                     */
*         /* PCTHAF IS A FLAG INDICATING THAT A HEADER IS ACTIVE.    */
*         /* PCTH1F IS A FLAG INDICATING THAT THE CURRENT LINE       */
*         /*        IS THE FIRST OF A NEW SERIES OF HEADER LINES.    */
*         /* PCTH2F IS A FLAG INDICATING THAT THE CURRENT LINE IS A  */
*         /*        CONTINUATION LINE OF A SET OF HEADERS BEING      */
*         /*        ENTERED.                                         */
*         /* PCTAHP IS THE ANCHOR POINT FOR THE HEADER QUEUE IN THE  */
*         /*        PRINT CONTROL TABLE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1172
*         /***********************************************************/
*         /*                                                         */
*         /* IF A HEADING EXISTS AND THIS LINE IS A NEW ONE, FREE    */
*         /* THE POOL SPACE FOR THE EXISTING HEADER.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1172
*         IF PCTH1F = ON & PCTHAF = ON                             1172
*           THEN                                                   1172
         TM    PCTH1F(PCTPTR),B'10100000'                          1172
         BNO   @RF01172                                            1172
*             DO;                                                  1173
*                                                                  1173
*               CALL IDCSAFP0 (GDTTBL,HDPOOL);                     1174
*                                                                  1174
         ST    GDTPR,@AL00001                                      1174
         LA    @06,HDPOOL                                          1174
         ST    @06,@AL00001+4                                      1174
         MVI   @AL00001+4,X'80'                                    1174
         L     @15,GDTFPL(,GDTPR)                                  1174
         LA    @01,@AL00001                                        1174
         BALR  @14,@15                                             1174
*               PCTAHP = ''B;                                      1175
         SLR   @06,@06                                             1175
         ST    @06,PCTAHP(,PCTPTR)                                 1175
*             END;                                                 1176
*                                                                  1176
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE POOL STORAGE FOR THE NEW HEADER LINE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1177
*         IF PCTH1F = ON  PCTH2F = ON                             1177
*           THEN                                                   1177
@RF01172 TM    PCTH1F(PCTPTR),B'11000000'                          1177
         BZ    @RF01177                                            1177
*             DO;                                                  1178
*               CURLI = PCTPLW + 4;                                1179
*                                                                  1179
         LA    @06,4                                               1179
         AL    @06,PCTPLW(,PCTPTR)                                 1179
         ST    @06,CURLI                                           1179
*               CALL IDCSAGP0 (GDTTBL,CURLI,HEADPTR,HDPOOL,SETZERO);
         ST    GDTPR,@AL00001                                      1180
         LA    @06,CURLI                                           1180
         ST    @06,@AL00001+4                                      1180
         LA    @06,HEADPTR                                         1180
         ST    @06,@AL00001+8                                      1180
         LA    @06,HDPOOL                                          1180
         ST    @06,@AL00001+12                                     1180
         LA    @06,SETZERO                                         1180
         ST    @06,@AL00001+16                                     1180
         MVI   @AL00001+16,X'80'                                   1180
         L     @15,GDTGPL(,GDTPR)                                  1180
         LA    @01,@AL00001                                        1180
         BALR  @14,@15                                             1180
*                                       /* GET THE POOL CORE.        */
*                                                                  1181
*               RESPECIFY RTNREG RSTD;                             1181
*               TESTRC = RTNREG;                                   1182
         STH   RTNREG,TESTRC                                       1182
*               RESPECIFY RTNREG UNRSTD;                           1183
*                 IF TESTRC ^= 0                                   1184
*                   THEN                                           1184
*                                                                  1184
         LH    @06,TESTRC                                          1184
         LTR   @06,@06                                             1184
         BZ    @RF01184                                            1184
*                     DO;                                          1185
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         1186
*                       REG15 = 28;                                1187
         LA    REG15,28                                            1187
*                       REG14 = GDTABT;                            1188
         L     REG14,GDTABT(,GDTPR)                                1188
*                       REG13 = GDTABH;                            1189
         L     REG13,GDTABH(,GDTPR)                                1189
*                       GEN(BR    REG14);                          1190
         BR    REG14
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        1191
*                     END;                                         1192
*                                                                  1192
*               IF PCTH1F = ON                                     1193
*                 THEN                                             1193
*                                                                  1193
@RF01184 TM    PCTH1F(PCTPTR),B'10000000'                          1193
         BNO   @RF01193                                            1193
*                 /***************************************************/
*                 /*                                                 */
*                 /* INITIALIZE A NEW HEADER QUEUE.                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1194
*                   DO;                                            1194
*                     PCTAHP = HEADPTR;                            1195
         L     @06,HEADPTR                                         1195
         ST    @06,PCTAHP(,PCTPTR)                                 1195
*                     HEADCC = PRCCON(3);                          1196
         MVC   HEADCC(1,@06),PRCCON+2                              1196
*                   END;                                           1197
*               IF PCTH2F = ON                                     1198
*                 THEN                                             1198
@RF01193 TM    PCTH2F(PCTPTR),B'01000000'                          1198
         BNO   @RF01198                                            1198
*                 /***************************************************/
*                 /*                                                 */
*                 /* ADD A NEW LINE TO THE HEADER QUEUE.             */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1199
*                   DO;                                            1199
*                     IF PCTAHP = NULLPTR                          1200
*                       THEN                                       1200
         L     @06,PCTAHP(,PCTPTR)                                 1200
         LTR   @06,@06                                             1200
         BNZ   @RF01200                                            1200
*                         DO;                                      1201
*                           /*****************************************/
*                           /*                                       */
*                           /* WE ARE PART WAY THROUGH A HEADING     */
*                           /* WITH A RESET HAVING BEEN ISSUED.      */
*                           /* RETURN WITH CONDITION 12.             */
*                           /*                                       */
*                           /*****************************************/
*                                                                  1202
*                           PCTH2F = OFF;                          1202
*                           PCTHAF = OFF;                          1203
         NI    PCTH2F(PCTPTR),B'10011111'                          1203
*                           PCTHLC = ''B;                          1204
         SLR   @06,@06                                             1204
         STC   @06,PCTHLC(,PCTPTR)                                 1204
*                           PCTHSC = ''B;                          1205
         SLR   @06,@06                                             1205
         STC   @06,PCTHSC(,PCTPTR)                                 1205
*                           RETURN CODE(RCQUIT);                   1206
         LH    @15,RCQUIT                                          1206
         L     @14,@SA00014                                        1206
         LM    @00,@06,@SA00014+8                                  1206
         LM    @08,@12,@SA00014+36                                 1206
         BR    @14                                                 1206
*                         END;                                     1207
*                     HDQPTR = PCTAHP;                             1208
@RF01200 L     @06,PCTAHP(,PCTPTR)                                 1208
         ST    @06,HDQPTR                                          1208
*                     DO WHILE HDQPTR->HEADQP ^= NULLPTR;          1209
         B     @DE01209                                            1209
@DL01209 DS    0H                                                  1210
*                       HDQPTR = HDQPTR->HEADQP;                   1210
         L     @06,HDQPTR                                          1210
         L     @06,HEADQP(,@06)                                    1210
         ST    @06,HDQPTR                                          1210
*                     END;                                         1211
@DE01209 L     @06,HDQPTR                                          1211
         L     @04,HEADQP(,@06)                                    1211
         LTR   @04,@04                                             1211
         BNZ   @DL01209                                            1211
*                     HDQPTR->HEADQP = HEADPTR;                    1212
         L     @04,HEADPTR                                         1212
         ST    @04,HEADQP(,@06)                                    1212
*                     HEADCC = PRCC;                               1213
         MVC   HEADCC(1,@04),PRCC                                  1213
*                   END;                                           1214
*                                                                  1214
*               /*****************************************************/
*               /*                                                   */
*               /* THIS STATEMENT MOVES ALL HEADING LINES TO THE     */
*               /* SPACE AQUIRED FOR THEM.                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1215
*               HEADLI(1:PCTPLW) = PRLINE(1:PCTPLW);               1215
*                                                                  1215
@RF01198 L     @06,HEADPTR                                         1215
         L     @04,PCTPLW(,PCTPTR)                                 1215
         BCTR  @04,0                                               1215
         EX    @04,@SM01062                                        1215
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK IF THIS IS THE LAST OF THE SET AND SET      */
*               /* FLAGS ACCORDINGLY.                                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1216
*               PCTHLC = PCTHLC - 1;                               1216
         SLR   @06,@06                                             1216
         IC    @06,PCTHLC(,PCTPTR)                                 1216
         BCTR  @06,0                                               1216
         STC   @06,PCTHLC(,PCTPTR)                                 1216
*               PCTH1F = OFF;                                      1217
         NI    PCTH1F(PCTPTR),B'01111111'                          1217
*               IF PCTHLC > 0                                      1218
*                 THEN                                             1218
         CLI   PCTHLC(PCTPTR),0                                    1218
         BNH   @RF01218                                            1218
*                    PCTH2F = ON;                                  1219
         OI    PCTH2F(PCTPTR),B'01000000'                          1219
*                  ELSE                                            1220
*                    PCTH2F = OFF;                                 1220
         B     @RC01218                                            1220
@RF01218 NI    PCTH2F(PCTPTR),B'10111111'                          1220
*               PCTHAF = ON;                                       1221
@RC01218 OI    PCTHAF(PCTPTR),B'00100000'                          1221
*             END;                                                 1222
*                                                                  1222
*         IF GDTDBG = NULLPTR                                      1223
*           THEN;                                                  1223
@RF01177 L     @06,GDTDBG(,GDTPR)                                  1223
         LTR   @06,@06                                             1223
         BZ    @RT01223                                            1223
*           ELSE                                                   1225
*             CALL IDCDB010 (GDTTBL,'TP3N');                       1225
*                                                                  1225
         ST    GDTPR,@AL00001                                      1225
         LA    @06,@CC00989                                        1225
         ST    @06,@AL00001+4                                      1225
         MVI   @AL00001+4,X'80'                                    1225
         L     @15,GDTDBG(,GDTPR)                                  1225
         LA    @01,@AL00001                                        1225
         BALR  @14,@15                                             1225
*         FFMFMTF = OFF;                                           1226
@RT01223 NI    FFMFMTF,B'11111110'                                 1226
*         PRTBUFF = ' ';                                           1227
         L     @06,PRTBUFPT                                        1227
         MVI   PRTBUFF+1(@06),C' '                                 1227
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   1227
         MVI   PRTBUFF(@06),C' '                                   1227
*         RETURN CODE(TESTRC);                                     1228
*                                                                  1228
         LH    @15,TESTRC                                          1228
         L     @14,@SA00014                                        1228
         LM    @00,@06,@SA00014+8                                  1228
         LM    @08,@12,@SA00014+36                                 1228
         BR    @14                                                 1228
*         END LINEPRT;                                             1229
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - LINE STACKING AND UPUT PROCEDURE.      */
*         /*                                                         */
*         /* FUNCTION - PUT THE PRINT LINES INTO THE OUTPUT BUFFER.  */
*         /*     A UPUT IS ISSUED FOR THIS BUFFER WHEN THE BUFFER    */
*         /*     IS FULL OR WHEN THE NEXT LINE TO BE PRINTED IS A    */
*         /*     MESSAGE.  THIS BUFFER IS NORMALLY 2048 BYTES LONG   */
*         /*     BUT MAY BE CHANGED BY ALTERING THE CONSTANT PRBUFL  */
*         /*     BOTH HERE AND IN THE MODULE IDCTP04.                */
*         /*     IF THE FLAG FFMPSFF IS ON, THERE IS NO LINE TO BE   */
*         /*     ADDED BUT THE STACK IS TO BE PRINTED OUT.           */
*         /*                                                         */
*         /* INPUT - A LINE WIDTH BYTE AREA CONTAINING THE CARRIAGE  */
*         /*     CONTROL CHARACTER AND THE DATA LINE.                */
*         /*                                                         */
*         /* OUTPUT - PRINT LINES TO THE IO ADAPTOR.                 */
*         /*     AS LINES ARE PUT INTO THE BUFFER OR IN THE CASE OF  */
*         /*     MESSAGES, AS THEY ARE PUT DIRECTLY TO THE IO        */
*         /*     ADAPTOR, TRAILING BLANKS ARE STRIPPED TO A MINIMUM  */
*         /*     A 1 BYTE DATA LINE PLUS THE CARRIAGE CONTROL        */
*         /*     CHARACTER.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1230
*STACKPUT: PROC (PUTLINE);                                         1230
*                                                                  1230
STACKPUT STM   @14,@06,@SA00015                                    1230
         STM   @08,@12,@SA00015+36                                 1230
         MVC   @PC00015(4),0(@01)                                  1230
*         DCL PUTLINE CHAR(441);       /* INPUT ARGUMENT     @Z40GSJG*/
*                                      /* (DATA LINE)        @Z40GSJG*/
*                                                                  1232
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE AND STRIP THE TRAILING BLANKS                    */
*         /* IF A LINE IS TO BE ADDED OR PRINTED.  (FFMPSFF OFF)     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1232
*         IF FFMPSFF = OFF                                         1232
*           THEN                                                   1232
         TM    FFMPSFF,B'00100000'                                 1232
         BNZ   @RF01232                                            1232
*               DO N = (PCTPLW+1) TO 10 BY -1 WHILE PUTLINE(N) = ' ';
         LA    N,1                                                 1233
         AL    N,PCTPLW(,PCTPTR)                                   1233
         B     @DE01233                                            1233
@DL01233 L     @04,@PC00015                                        1233
         ALR   @04,N                                               1233
         BCTR  @04,0                                               1233
         CLI   PUTLINE(@04),C' '                                   1233
         BNE   @DC01233                                            1233
*               END;                                       /*@OZ07564*/
*                                                                  1234
         BCTR  N,0                                                 1234
@DE01233 C     N,@CF00032                                          1234
         BNL   @DL01233                                            1234
@DC01233 DS    0H                                                  1235
*         /***********************************************************/
*         /*                                                         */
*         /* IF LINES ARE IN THE STACK AND IF THE STACK IS FULL OR   */
*         /* THE CURRENT LINE IS A MESSAGE, OR THE FLUSH FLAG IS ON  */
*         /* PUT THE STACK TO THE IO ADAPTOR.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1235
*         IF PCTLNM ^= 0 & ((PCTBNL + (N+2) > (PCTBUF + PRBUFL))   1235
*            FFMPMSF = ON                                         1235
*            FFMPSFF = ON)                                        1235
*           THEN                                                   1235
@RF01232 LH    @04,PCTLNM(,PCTPTR)                                 1235
         LTR   @04,@04                                             1235
         BZ    @RF01235                                            1235
         LA    @04,2                                               1235
         ALR   @04,N                                               1235
         AL    @04,PCTBNL(,PCTPTR)                                 1235
         LH    @03,PRBUFL                                          1235
         AL    @03,PCTBUF(,PCTPTR)                                 1235
         CR    @04,@03                                             1235
         BH    @RT01235                                            1235
         TM    FFMPMSF,B'00110000'                                 1235
         BZ    @RF01235                                            1235
@RT01235 DS    0H                                                  1236
*             DO;                                                  1236
*               IOCDLN = PCTBNL - PCTBUF;                          1237
         L     @04,PCTBUF(,PCTPTR)                                 1237
         L     @03,PCTBNL(,PCTPTR)                                 1237
         SLR   @03,@04                                             1237
         ST    @03,IOCDLN(,IOCSPTR)                                1237
*               IOCDAD = PCTBUF;                                   1238
         ST    @04,IOCDAD(,IOCSPTR)                                1238
*               IOCPNM = PCTLNM;                                   1239
         LH    @03,PCTLNM(,PCTPTR)                                 1239
         STH   @03,IOCPNM(,IOCSPTR)                                1239
*               PCTBNL = PCTBUF;                                   1240
         ST    @04,PCTBNL(,PCTPTR)                                 1240
*               PCTLNM = 0;                                        1241
*                                                                  1241
         SLR   @04,@04                                             1241
         STH   @04,PCTLNM(,PCTPTR)                                 1241
*               CALL IDCIOPT0 (GDTTBL,PCTIOC,NULLPMN);             1242
*                                                                  1242
         ST    GDTPR,@AL00001                                      1242
         LA    @04,PCTIOC(,PCTPTR)                                 1242
         ST    @04,@AL00001+4                                      1242
         LA    @04,NULLPMN                                         1242
         ST    @04,@AL00001+8                                      1242
         MVI   @AL00001+8,X'80'                                    1242
         L     @15,GDTPUT(,GDTPR)                                  1242
         LA    @01,@AL00001                                        1242
         BALR  @14,@15                                             1242
*               RESPECIFY RTNREG RSTD;                             1243
*               TESTRC = RTNREG;                                   1244
         STH   RTNREG,TESTRC                                       1244
*               RESPECIFY RTNREG UNRSTD;                           1245
*               IF TESTRC ^= 0                                     1246
*                 THEN                                             1246
*                                                                  1246
         LH    @04,TESTRC                                          1246
         LTR   @04,@04                                             1246
         BZ    @RF01246                                            1246
*                   DO;                                            1247
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1248
*                     REG15 = 36;                                  1249
         LA    REG15,36                                            1249
*                     REG14 = GDTABT;                              1250
         L     REG14,GDTABT(,GDTPR)                                1250
*                     REG13 = GDTABH;                              1251
         L     REG13,GDTABH(,GDTPR)                                1251
*                     GEN(BR    REG14);                            1252
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1253
*                   END;                                           1254
*                                                                  1254
*             END;                                                 1255
*                                                                  1255
*                                                                  1255
@RF01246 DS    0H                                                  1256
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE CURRENT LINE IS A MESSAGE, PUT IT DIRECTLY.      */
*         /* OR IF TSO USER, PUT IT DIRECTLY.                @OZ01484*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1256
*         IF (FFMPMSF = ON  GDTECT ^= 0) & FFMPSFF = OFF  /*@OZ01484*/
*           THEN                                                   1256
@RF01235 TM    FFMPMSF,B'00010000'                                 1256
         BO    @GL00027                                            1256
         L     @04,GDTECT(,GDTPR)                                  1256
         LTR   @04,@04                                             1256
         BZ    @RF01256                                            1256
@GL00027 TM    FFMPSFF,B'00100000'                                 1256
         BNZ   @RF01256                                            1256
*             DO;                                                  1257
*               IF QNPMF = ON          /*NO PRINT SEND 2S COMPLIMENT */
*                 THEN                                             1258
         L     @04,QENTP                                           1258
         TM    QNPMF(@04),B'00010000'                              1258
         BNO   @RF01258                                            1258
*                   PCTPMN = -PCTPMN;                      /*#YL026UE*/
         LH    @04,PCTPMN(,PCTPTR)                                 1259
         LCR   @04,@04                                             1259
         STH   @04,PCTPMN(,PCTPTR)                                 1259
*               IOCDLN = N;                                        1260
@RF01258 ST    N,IOCDLN(,IOCSPTR)                                  1260
*               IOCDAD = ADDR(PUTLINE);                            1261
         L     @04,@PC00015                                        1261
         ST    @04,IOCDAD(,IOCSPTR)                                1261
*               IOCPNM = ''B;                                      1262
*                                                                  1262
         SLR   @04,@04                                             1262
         STH   @04,IOCPNM(,IOCSPTR)                                1262
*                IF FFMPMSF = ON   &                       /*@Z40GSJG*/
*                  FFMHDFLN = OFF                                  1263
*                  THEN                                            1263
         TM    FFMPMSF,B'00010000'                                 1263
         BNO   @RF01263                                            1263
         TM    FFMHDFLN,B'00000010'                                1263
         BNZ   @RF01263                                            1263
*                    DO;                                   /*@Y30SSJK*/
*                      IOCDLN = MFTRL;                     /*@Z40GSJG*/
*                                                                  1265
         L     @04,MFTRL                                           1265
         ST    @04,IOCDLN(,IOCSPTR)                                1265
*                     /***********************************************/
*                     /*                                             */
*                     /* IN THE TSO ENVIRONMENT, PASS THE NUMBER OF  */
*                     /* PRIMARY AND SECONDARY MESSAGE SEQMENTS.     */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1266
*                      IF GDTECT ^= 0                      /*@Z40GSJG*/
*                        THEN                              /*@Z40GSJG*/
         SLR   @04,@04                                             1266
         C     @04,GDTECT(,GDTPR)                                  1266
         BE    @RF01266                                            1266
*                          DO;                             /*@Z40GSJG*/
*                          IOCTPML = MFPMRC;               /*@Z40GSJG*/
         LH    @03,MFPMRC                                          1268
         STH   @03,IOCTPML(,IOCSPTR)                               1268
*                          IOCTSML = MFSMRC;               /*@Z40GSJG*/
*                                                                  1269
         LH    @03,MFSMRC                                          1269
         STH   @03,IOCTSML(,IOCSPTR)                               1269
*                          IF MFSMRC = 0                   /*@Z40GSJG*/
*                            THEN                          /*@Z40GSJG*/
         CR    @03,@04                                             1270
         BNE   @RF01270                                            1270
*                              IOCPNM = 1;                 /*@Z40GSJG*/
         MVC   IOCPNM(2,IOCSPTR),@CH00216                          1271
*                            ELSE                          /*@Z40GSJG*/
*                              IOCPNM = 2;                 /*@Z40GSJG*/
         B     @RC01270                                            1272
@RF01270 MVC   IOCPNM(2,IOCSPTR),@CH00150                          1272
*                          END;                            /*@Z40GSJG*/
*                        ELSE                              /*@Z40GSJG*/
*                          DO;                             /*@Z40GSJG*/
         B     @RC01266                                            1274
@RF01266 DS    0H                                                  1275
*                          IOCPNM = MFRCNT;                /*@Z40GSJG*/
         LH    @04,MFRCNT                                          1275
         STH   @04,IOCPNM(,IOCSPTR)                                1275
*                          IOCTPML = 0;                    /*@Z40GSJG*/
         SLR   @04,@04                                             1276
         STH   @04,IOCTPML(,IOCSPTR)                               1276
*                          IOCTSML = 0;                    /*@Z40GSJG*/
         STH   @04,IOCTSML(,IOCSPTR)                               1277
*                          END;                            /*@Z40GSJG*/
*                    END;                                  /*@Y30SSJK*/
*                                                                  1279
@RC01266 DS    0H                                                  1280
*               CALL IDCIOPT0 (GDTTBL,PCTIOC,PCTPMN);              1280
*                                                                  1280
@RF01263 ST    GDTPR,@AL00001                                      1280
         LA    @04,PCTIOC(,PCTPTR)                                 1280
         ST    @04,@AL00001+4                                      1280
         LA    @04,PCTPMN(,PCTPTR)                                 1280
         ST    @04,@AL00001+8                                      1280
         MVI   @AL00001+8,X'80'                                    1280
         L     @15,GDTPUT(,GDTPR)                                  1280
         LA    @01,@AL00001                                        1280
         BALR  @14,@15                                             1280
*               RESPECIFY RTNREG RSTD;                             1281
*               TESTRC = RTNREG;                                   1282
         STH   RTNREG,TESTRC                                       1282
*               RESPECIFY RTNREG UNRSTD;                           1283
*               IF TESTRC ^= 0                                     1284
*                 THEN                                             1284
*                                                                  1284
         LH    @04,TESTRC                                          1284
         LTR   @04,@04                                             1284
         BZ    @RF01284                                            1284
*                   DO;                                            1285
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1286
*                     REG15 = 36;                                  1287
         LA    REG15,36                                            1287
*                     REG14 = GDTABT;                              1288
         L     REG14,GDTABT(,GDTPR)                                1288
*                     REG13 = GDTABH;                              1289
         L     REG13,GDTABH(,GDTPR)                                1289
*                     GEN(BR    REG14);                            1290
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1291
*                   END;                                           1292
*                                                                  1292
*               PCTPMN = ''B;                                      1293
@RF01284 SLR   @04,@04                                             1293
         STH   @04,PCTPMN(,PCTPTR)                                 1293
*               PCTLLM = ON;                                       1294
*                                                                  1294
         OI    PCTLLM(PCTPTR),B'00010000'                          1294
*               RETURN CODE(0);                                    1295
*                                                                  1295
         SLR   @15,@15                                             1295
         L     @14,@SA00015                                        1295
         LM    @00,@06,@SA00015+8                                  1295
         LM    @08,@12,@SA00015+36                                 1295
         BR    @14                                                 1295
*             END;                                                 1296
*         /***********************************************************/
*         /*                                                         */
*         /* PUT THIS CURRENT LINE IN THE STACK.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1297
*         IF FFMPSFF = OFF                                         1297
*           THEN                                                   1297
@RF01256 TM    FFMPSFF,B'00100000'                                 1297
         BNZ   @RF01297                                            1297
*             DO;                                                  1298
*               STACKLL = N;                                       1299
         L     @04,PCTBNL(,PCTPTR)                                 1299
         STCM  N,3,STACKLL(@04)                                    1299
*               STACKDL(1:N) = PUTLINE(1:N);                       1300
         LR    @03,N                                               1300
         BCTR  @03,0                                               1300
         L     @15,@PC00015                                        1300
         EX    @03,@SM01064                                        1300
*               PCTLNM = PCTLNM + 1;                               1301
         LA    @03,1                                               1301
         AH    @03,PCTLNM(,PCTPTR)                                 1301
         STH   @03,PCTLNM(,PCTPTR)                                 1301
*               PCTBNL = PCTBNL + N + 2;                           1302
         ALR   @04,N                                               1302
         AL    @04,@CF00150                                        1302
         ST    @04,PCTBNL(,PCTPTR)                                 1302
*             END;                                                 1303
*         FFMPSFF = OFF;                                           1304
*                                                                  1304
@RF01297 NI    FFMPSFF,B'11011111'                                 1304
*         RETURN CODE(0);                                          1305
*                                                                  1305
         SLR   @15,@15                                             1305
         L     @14,@SA00015                                        1305
         LM    @00,@06,@SA00015+8                                  1305
         LM    @08,@12,@SA00015+36                                 1305
         BR    @14                                                 1305
*         END STACKPUT;                                            1306
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ERROR PROCEDURE.                       */
*         /*                                                         */
*         /* FUNCTION - CAUSE THE PRINTING OF TP ERROR MESSAGES.     */
*         /*                                                         */
*         /* INPUT - A CODE INDICATING THE ERROR MESSAGE TO BE PUT.  */
*         /*                                                         */
*         /* OUTPUT - A TEXT PROCESSING ERROR MESSAGE.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1307
*ERROR:   PROC (ERRCODE);                                          1307
*                                                                  1307
ERROR    STM   @14,@06,@SA00016                                    1307
         STM   @08,@12,@SA00016+36                                 1307
         MVC   @PC00016(4),0(@01)                                  1307
*         DCL CVPSAVP PTR(31);                                     1308
*         DCL  1 CVPSAV  BASED(CVPSAVP),                   /*@Y30SSJK*/
*          2 CVPSAV1 CHAR(LENGTH(CVPSTRU1)),                       1309
*          2 CVPSAV2 CHAR(LENGTH(CVPSTRU2));               /*@Y30SSJK*/
*                                                                  1309
*         IF GDTDBG = NULLPTR                                      1310
*           THEN;                                                  1310
         L     @06,GDTDBG(,GDTPR)                                  1310
         LTR   @06,@06                                             1310
         BZ    @RT01310                                            1310
*           ELSE                                                   1312
*             CALL IDCDB010 (GDTTBL,'TPER');                       1312
*                                                                  1312
         ST    GDTPR,@AL00001                                      1312
         LA    @06,@CC01006                                        1312
         ST    @06,@AL00001+4                                      1312
         MVI   @AL00001+4,X'80'                                    1312
         L     @15,GDTDBG(,GDTPR)                                  1312
         LA    @01,@AL00001                                        1312
         BALR  @14,@15                                             1312
*         STIDMOD = STMODID;           /* SET MODULE IDENT           */
@RT01310 MVC   STIDMOD(3),STMODID                                  1313
*         STIDENT = ERRCODE;            /* SET THE ENTRY NUMBER.     */
*                                                                  1314
         L     @06,@PC00016                                        1314
         L     @06,ERRCODE(,@06)                                   1314
         STC   @06,STIDENT                                         1314
*         CALL IDCTP05(GDTTBL,STID,GPOOL,MSGAREA);         /*@YL026UE*/
*                                                                  1315
         ST    GDTPR,@AL00001                                      1315
         LA    @06,STID                                            1315
         ST    @06,@AL00001+4                                      1315
         LA    @06,GPOOL                                           1315
         ST    @06,@AL00001+8                                      1315
         LA    @06,MSGAREA                                         1315
         ST    @06,@AL00001+12                                     1315
         L     @15,@CV00881                                        1315
         LA    @01,@AL00001                                        1315
         BALR  @14,@15                                             1315
*         RESPECIFY RTNREG RSTD;                                   1316
*         TESTRC = RTNREG;                                         1317
         STH   RTNREG,TESTRC                                       1317
*         RESPECIFY RTNREG UNRSTD;                                 1318
*         IF TESTRC ^= 0                                           1319
*           THEN                                                   1319
         LH    @06,TESTRC                                          1319
         LTR   @06,@06                                             1319
         BZ    @RF01319                                            1319
*             RETURN CODE(RCQUIT);                                 1320
*                                                                  1320
         LH    @15,RCQUIT                                          1320
         L     @14,@SA00016                                        1320
         LM    @00,@06,@SA00016+8                                  1320
         LM    @08,@12,@SA00016+36                                 1320
         BR    @14                                                 1320
*         CALL IDCSAGS0 (GDTTBL,LENGTH(CVPSTRU),CVPSAVP);          1321
*                                                                  1321
@RF01319 ST    GDTPR,@AL00001                                      1321
         LA    @06,@CF01012                                        1321
         ST    @06,@AL00001+4                                      1321
         LA    @06,CVPSAVP                                         1321
         ST    @06,@AL00001+8                                      1321
         MVI   @AL00001+8,X'80'                                    1321
         L     @15,GDTGSP(,GDTPR)                                  1321
         LA    @01,@AL00001                                        1321
         BALR  @14,@15                                             1321
*         RESPECIFY RTNREG RSTD;                                   1322
*         TESTRC = RTNREG;                                         1323
         STH   RTNREG,TESTRC                                       1323
*         RESPECIFY RTNREG UNRSTD;                                 1324
*         IF TESTRC ^= 0                                           1325
*           THEN                                                   1325
*                                                                  1325
         LH    @06,TESTRC                                          1325
         LTR   @06,@06                                             1325
         BZ    @RF01325                                            1325
*             DO;                                                  1326
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 1327
*               REG15 = 28;                                        1328
         LA    REG15,28                                            1328
*               REG14 = GDTABT;                                    1329
         L     REG14,GDTABT(,GDTPR)                                1329
*               REG13 = GDTABH;                                    1330
         L     REG13,GDTABH(,GDTPR)                                1330
*               GEN(BR    REG14);                                  1331
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                1332
*             END;                                                 1333
*                                                                  1333
*         PCTPMN = ERRCODE + 949;       /* SET MESSAGE NUMBER.       */
@RF01325 L     @06,@PC00016                                        1334
         LA    @04,949                                             1334
         AL    @04,ERRCODE(,@06)                                   1334
         STH   @04,PCTPMN(,PCTPTR)                                 1334
*         CVPSAV1 = CVPSTRU1;           /* SAVE ARGUMENT     @Y30SSJK*/
         L     @06,CVPSAVP                                         1335
         MVC   CVPSAV1(162,@06),CVPSTRU1                           1335
*         CVPSAV2 = CVPSTRU2;           /* SAVE ARGUMENT     @Y30SSJK*/
         MVC   CVPSAV2(137,@06),CVPSTRU2                           1336
*         PCTLLM = ON;                  /* SET MESSAGE FLAG.         */
         OI    PCTLLM(PCTPTR),B'00010000'                          1337
*         PRTSPF = 2;                   /* SET SPACING FACTOR.       */
         MVC   PRTSPF(2),@CH00150                                  1338
*         PRTSPT = 'R ';                /* SET SPACING TYPE.         */
         MVI   PRTSPT,C'R'                                         1339
*         PRTBUFF = ' ';                /* CLEAR THE BUFFER.         */
         L     @06,PRTBUFPT                                        1340
         MVI   PRTBUFF+1(@06),C' '                                 1340
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   1340
         MVI   PRTBUFF(@06),C' '                                   1340
*         PRTBUFF(1:MSGLEN) = MSGTXT(1:MSGLEN);                    1341
         L     @04,MSGAREA                                         1341
         LH    @03,MSGLEN(,@04)                                    1341
         BCTR  @03,0                                               1341
         EX    @03,@SM01066                                        1341
*                                       /* MOVE MESSAGE TO BUFFER.   */
*                                                                  1342
*         CALL LINEPRT;                                            1342
*                                                                  1342
         BAL   @14,LINEPRT                                         1342
*         RESPECIFY RTNREG RSTD;                                   1343
*         TESTRC = RTNREG;                                         1344
         STH   RTNREG,TESTRC                                       1344
*         RESPECIFY RTNREG UNRSTD;                                 1345
*         CVPSTRU1 = CVPSAV1;           /* RESTORE ARGUMENT  @Y30SSJK*/
         L     @06,CVPSAVP                                         1346
         MVC   CVPSTRU1(162),CVPSAV1(@06)                          1346
*         CVPSTRU2 = CVPSAV2;           /* RESTORE ARGUMENT  @Y30SSJK*/
*                                                                  1347
         MVC   CVPSTRU2(137),CVPSAV2(@06)                          1347
*         CALL IDCSAFS0 (GDTTBL,CVPSAVP);/*                        1348
*                                          FREE PRINT ARGUMENT SPACE */
*                                                                  1348
         ST    GDTPR,@AL00001                                      1348
         LA    @06,CVPSAVP                                         1348
         ST    @06,@AL00001+4                                      1348
         L     @15,GDTFSP(,GDTPR)                                  1348
         LA    @01,@AL00001                                        1348
         BALR  @14,@15                                             1348
*         CALL IDCSAFS0 (GDTTBL,MSGAREA);/*                        1349
*                                          FREE STATIC TEXT SPACE.   */
*                                                                  1349
         ST    GDTPR,@AL00001                                      1349
         LA    @06,MSGAREA                                         1349
         ST    @06,@AL00001+4                                      1349
         L     @15,GDTFSP(,GDTPR)                                  1349
         LA    @01,@AL00001                                        1349
         BALR  @14,@15                                             1349
*         RETURN CODE (TESTRC);                                    1350
         LH    @15,TESTRC                                          1350
         L     @14,@SA00016                                        1350
         LM    @00,@06,@SA00016+8                                  1350
         LM    @08,@12,@SA00016+36                                 1350
         BR    @14                                                 1350
*         END ERROR;                                               1351
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - MESSAGE FORMAT PROCEDURE.              */
*         /*                                                         */
*         /* FUNCTION - SEGMENT AND FORMAT MESSAGES INTO ALLOWABLE   */
*         /*                                                         */
*         /* INPUT - THE MESSAGE TEXT(S) IN THE LINE FORMAT BUBBER.  */
*         /*                                                         */
*         /* OUTPUT - AS MANY MESSAGE LINES AS REQUIRED TO PRINT     */
*         /*          THE COMPLETE MESSAGE.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1352
*SEGMENT: PROC;                                            /*@Z40GSJG*/
SEGMENT  STM   @14,@06,12(@13)                                     1352
         STM   @08,@12,52(@13)                                     1352
*         /***********************************************************/
*         /*                                                         */
*         /* BEGINNING OF THE MESSAGE LINE FORMAT PROCEDURE.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1353
*         MFFLAG = ''B;                                    /*@Z40GSJG*/
         MVI   MFFLAG,X'00'                                        1353
*         MFFGO = ON;                                      /*@Z40GSJG*/
*         MFFP1 = ON;                                      /*@Z40GSJG*/
         OI    MFFGO,B'11000000'                                   1355
*         MFRCNT = 0;                                      /*@Z40GSJG*/
         SLR   @04,@04                                             1356
         STH   @04,MFRCNT                                          1356
*         MFPMRC = 0;                                      /*@Z40GSJG*/
         STH   @04,MFPMRC                                          1357
*         MFSMRC = 0;                                      /*@Z40GSJG*/
         STH   @04,MFSMRC                                          1358
*         MFTRL = 0;                                       /*@Z40GSJG*/
         ST    @04,MFTRL                                           1359
*         PRTLNPTR = ADDR(PRBUFF);                         /*@Z40GSJG*/
*                                                                  1360
         LA    @04,PRBUFF                                          1360
         ST    @04,PRTLNPTR                                        1360
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE THE MESSAGE LINE LENGTH. A MESSAGE CANNOT     */
*         /* EXCEED SEVENTY-TWO(72) CHARACTERS OR THE PRINT LINE     */
*         /* WIDTH, WHICHEVER IS THE SHORTEST.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1361
*         IF PCTPLW < 72                                   /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
*                                                                  1361
         L     @04,PCTPLW(,PCTPTR)                                 1361
         C     @04,@CF00794                                        1361
         BNL   @RF01361                                            1361
*             MFMLL = PCTPLW;                              /*@Z40GSJG*/
*                                                                  1362
         STH   @04,MFMLL                                           1362
*           ELSE                                           /*@Z40GSJG*/
*                                                                  1363
*             MFMLL = 72;                                  /*@Z40GSJG*/
*                                                                  1363
         B     @RC01361                                            1363
@RF01361 MVC   MFMLL(2),@CH00794                                   1363
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE IF THE PROCESSING IS FOR PRIMARY MESSAGE OR   */
*         /* FOR A SECONDARY MESSAGE. SET INPUT BUFFER ACCORDINGLY.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1364
*         DO UNTIL MFFGO = OFF;                            /*@Z40GSJG*/
*                                                                  1364
@RC01361 DS    0H                                                  1364
@DL01364 DS    0H                                                  1365
*         IF MFFP1 = ON                                    /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
         TM    MFFP1,B'01000000'                                   1365
         BNO   @RF01365                                            1365
*             DO;                                          /*@Z40GSJG*/
*                                                                  1366
*             MFINPTR = ADDR(PRLINE);                      /*@OZ12170*/
*                                                                  1367
         LA    MFINPTR,PRLINE                                      1367
*             MFMRCPT = ADDR(MFPMRC);                      /*@Z40GSJG*/
*                                                                  1368
         LA    @04,MFPMRC                                          1368
         ST    @04,MFMRCPT                                         1368
*             MFFP1 = OFF;                                 /*@Z40GSJG*/
*                                                                  1369
         NI    MFFP1,B'10111111'                                   1369
*             END;                                         /*@Z40GSJG*/
*                                                                  1370
*           ELSE                                           /*@Z40GSJG*/
*             DO;                                          /*@Z40GSJG*/
*                                                                  1371
         B     @RC01365                                            1371
@RF01365 DS    0H                                                  1372
*             MFINPTR = ADDR(PRLINES);                     /*@OZ12170*/
*                                                                  1372
         LA    MFINPTR,PRLINES                                     1372
*             MFMRCPT = ADDR(MFSMRC);                      /*@Z40GSJG*/
*                                                                  1373
         LA    @04,MFSMRC                                          1373
         ST    @04,MFMRCPT                                         1373
*             MFFGO = OFF;                                 /*@Z40GSJG*/
*                                                                  1374
         NI    MFFGO,B'01111111'                                   1374
*             END;                                         /*@Z40GSJG*/
*                                                                  1375
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAR MESSAGE WORK BUFFER AND MOVE MESSAGE TEXT INTO IT.*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1376
*          MFMBUF = ' ';                                   /*@Z40GSJG*/
*                                                                  1376
@RC01365 MVI   MFMBUF+1,C' '                                       1376
         MVC   MFMBUF+2(134),MFMBUF+1                              1376
         MVI   MFMBUF,C' '                                         1376
*          MFMBUF = MFINBUF;                               /*@OZ12170*/
*                                                                  1377
         MVC   MFMBUF(136),MFINBUF(MFINPTR)                        1377
*         /**************************************************@OZ18517*/
*         /*                                                 @OZ18517*/
*         /* MESSAGE NUMBER PROCESSING IS NOT REQUIRED IF THE@OZ18517*/
*         /* USER HAS INCLUDED EMBEDDED SPACING SUBSTRUCTURES@OZ18517*/
*         /* IN THE FORMAT LIST. IF MESSAGE NUMBER PROCESSING@OZ18517*/
*         /* IS TO BE SUPPRESSED, SET MESSSAGE NUMBER LENGTH @OZ18517*/
*         /* TO ZERO, OTHER WISE, CALCULATE MESSAGE NUMBER   @OZ18517*/
*         /* LENGTH.                                         @OZ18517*/
*         /*                                                 @OZ18517*/
*         /**************************************************@OZ18517*/
*         IF FFM2SMN = OFF                                 /*@OZ18517*/
*           THEN                                           /*@OZ18517*/
         TM    FFM2SMN,B'10000000'                                 1378
         BNZ   @RF01378                                            1378
*             DO;                                          /*@OZ18517*/
*                                                          /*@OZ18517*/
*             /**********************************************@OZ18517*/
*             /*                                             @OZ18517*/
*             /* CALCULATE THE MESSAGE NUMBER LENGTH         @OZ18517*/
*             /*                                             @OZ18517*/
*             /**********************************************@OZ18517*/
*                                                                  1380
*             DO MFMNL = 1 TO MFMML BY 1                   /*@OZ18517*/
*                            WHILE MFMBUF(MFMNL) ^=' ';    /*@OZ18517*/
         LA    MFMNL,1                                             1380
         B     @DE01380                                            1380
@DL01380 LA    @03,MFMBUF-1(MFMNL)                                 1380
         CLI   0(@03),C' '                                         1380
         BE    @DC01380                                            1380
*             END;                                         /*@OZ18517*/
         AL    MFMNL,@CF00216                                      1381
@DE01380 CH    MFMNL,MFMML                                         1381
         BNH   @DL01380                                            1381
@DC01380 DS    0H                                                  1382
*             MFMNL = MFMNL - 1;                           /*@OZ18517*/
         BCTR  MFMNL,0                                             1382
*             END;                                         /*@Z40GSJG*/
*           ELSE                                           /*@OZ18517*/
*             MFMNL = 0;                                   /*@OZ18517*/
*                                                                  1384
         B     @RC01378                                            1384
@RF01378 SLR   MFMNL,MFMNL                                         1384
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE THE TRANSLATED MESSAGE LENGTH                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1385
*         DO MFML = (LENGTH(MFMBUF)) TO 1 BY - 1           /*@Z40GSJG*/
*             WHILE MFMBUF(MFML) = ' ';                    /*@Z40GSJG*/
@RC01378 LA    @03,136                                             1385
         STH   @03,MFML                                            1385
@DL01385 LA    @01,MFMBUF-1(@03)                                   1385
         CLI   0(@01),C' '                                         1385
         BNE   @DC01385                                            1385
*         END;                                             /*@Z40GSJG*/
*                                                                  1386
         BCTR  @03,0                                               1386
         STH   @03,MFML                                            1386
         LTR   @03,@03                                             1386
         BP    @DL01385                                            1386
@DC01385 DS    0H                                                  1387
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE THE COMMON DATA ELEMENTS FOR THE FORMAT      */
*         /* PROCESS.                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1387
*         MFRC = MFML;                                     /*@Z40GSJG*/
*                                                                  1387
         LH    @03,MFML                                            1387
         STH   @03,MFRC                                            1387
*         MFFPASS = ON;                                    /*@Z40GSJG*/
*                                                                  1388
         OI    MFFPASS,B'00100000'                                 1388
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING LOOP WILL SEGMENT THE MESSAGE TO BE       */
*         /* PRINTED INTO THE PRINT LINE WIDTHS REQUIRED. THE MESSAGE*/
*         /* NUMBER WILL BE ADDED AT THE FIRST PART OF EACH LINE.    */
*         /* THE LINE WILL BE SEGMENTED AT BLANKS WITHIN THE TEXT.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1389
*         DO UNTIL MFRC <= 0;                              /*@Z40GSJG*/
*                                                                  1389
@DL01389 DS    0H                                                  1390
*         IF MFFPASS = ON                                  /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
         TM    MFFPASS,B'00100000'                                 1390
         BNO   @RF01390                                            1390
*             DO;                                          /*@Z40GSJG*/
*                                                                  1391
*             IF MFML > MFMLL                              /*@Z40GSJG*/
*               THEN                                       /*@Z40GSJG*/
*                                                                  1392
         LH    @03,MFMLL                                           1392
         CH    @03,MFML                                            1392
         BNL   @RF01392                                            1392
*                 MFSL = MFMLL;                            /*@Z40GSJG*/
*                                                                  1393
         LH    @15,MFMLL                                           1393
         LR    MFSL,@15                                            1393
*               ELSE                                       /*@Z40GSJG*/
*                                                                  1394
*                 MFSL = MFML + 1;                         /*@Z40GSJG*/
*                                                                  1394
         B     @RC01392                                            1394
@RF01392 LA    MFSL,1                                              1394
         AH    MFSL,MFML                                           1394
*             MFBGNT = MFMNL + 1;                          /*@Z40GSJG*/
*                                                                  1395
@RC01392 LA    @01,1(,MFMNL)                                       1395
         STH   @01,MFBGNT                                          1395
*             MFCC = PRCC;                                 /*@Z40GSJG*/
*                                                                  1396
         MVC   MFCC(1),PRCC                                        1396
*             END;                                         /*@Z40GSJG*/
*                                                                  1397
*           ELSE                                           /*@Z40GSJG*/
*             DO;                                          /*@Z40GSJG*/
*                                                                  1398
         B     @RC01390                                            1398
@RF01390 DS    0H                                                  1399
*             IF (MFRC + MFMNL) > MFMLL                    /*@Z40GSJG*/
*               THEN                                       /*@Z40GSJG*/
*                                                                  1399
         LH    @03,MFMLL                                           1399
         LR    @15,MFMNL                                           1399
         AH    @15,MFRC                                            1399
         CR    @15,@03                                             1399
         BNH   @RF01399                                            1399
*                 MFSL = MFMLL;                            /*@Z40GSJG*/
*                                                                  1400
         LH    @15,MFMLL                                           1400
         LR    MFSL,@15                                            1400
*               ELSE                                       /*@Z40GSJG*/
*                                                                  1401
*                 MFSL = MFRC + MFMNL + 1;                 /*@Z40GSJG*/
*                                                                  1401
         B     @RC01399                                            1401
@RF01399 LR    MFSL,MFMNL                                          1401
         AH    MFSL,MFRC                                           1401
         AL    MFSL,@CF00216                                       1401
*             MFCC = PRCCON(2);                            /*@Z40GSJG*/
*                                                                  1402
@RC01399 MVC   MFCC(1),PRCCON+1                                    1402
*             END;                                         /*@Z40GSJG*/
*                                                                  1403
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE THE MESSAGE SEGMENT LENGTH AND THE MESSAGE    */
*         /* SEGMENT END POINT.                                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1404
*         MFMSL = MFSL - MFMNL;                            /*@Z40GSJG*/
*                                                                  1404
@RC01390 LR    MFMSL,MFSL                                          1404
         SLR   MFMSL,MFMNL                                         1404
*         MFENDT = MFBGNT + MFMSL - 1;                     /*@Z40GSJG*/
*                                                                  1405
         LR    @07,MFMSL                                           1405
         AH    @07,MFBGNT                                          1405
         BCTR  @07,0                                               1405
         STH   @07,MFENDT                                          1405
*         /***********************************************************/
*         /*                                                         */
*         /* FIND THE CLOSEST BLANK CHARACTER TO THE SEGMENT LENGTH  */
*         /* AND CALCULATE THE NEW MESSAGE SEGMENT LENGTH, SEGMENT   */
*         /* LENGTH AND THE NEW END TEXT POINT.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1406
*         IF MFSL < MFMLL                                  /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
*                                                                  1406
         CH    MFSL,MFMLL                                          1406
         BNL   @RF01406                                            1406
*             DO N = MFENDT TO MFBGNT BY - 1               /*@Z40GSJG*/
*                  WHILE MFMBUF(N) = ' ';                  /*@Z40GSJG*/
*                                                                  1407
         LH    @15,MFENDT                                          1407
         LR    N,@15                                               1407
         B     @DE01407                                            1407
@DL01407 LA    @01,MFMBUF-1(N)                                     1407
         CLI   0(@01),C' '                                         1407
         BNE   @DC01407                                            1407
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/
         BCTR  MFSL,0                                              1408
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/
         BCTR  MFMSL,0                                             1409
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/
*                                                                  1410
         LH    @15,MFENDT                                          1410
         BCTR  @15,0                                               1410
         STH   @15,MFENDT                                          1410
*             END;                                         /*@Z40GSJG*/
*                                                                  1411
         BCTR  N,0                                                 1411
@DE01407 CH    N,MFBGNT                                            1411
         BNL   @DL01407                                            1411
@DC01407 DS    0H                                                  1412
*           ELSE                                           /*@Z40GSJG*/
*                                                                  1412
*             DO;                                          /*@Z40GSJG*/
*                                                                  1412
         B     @RC01406                                            1412
@RF01406 DS    0H                                                  1413
*             DO N = MFENDT TO MFBGNT BY -1                /*@Z40GSJG*/
*                  WHILE MFMBUF(N) ^= ' ';                 /*@Z40GSJG*/
*                                                                  1413
         LH    N,MFENDT                                            1413
         B     @DE01413                                            1413
@DL01413 LA    @01,MFMBUF-1(N)                                     1413
         CLI   0(@01),C' '                                         1413
         BE    @DC01413                                            1413
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/
         BCTR  MFSL,0                                              1414
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/
         BCTR  MFMSL,0                                             1415
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/
*                                                                  1416
         LH    @15,MFENDT                                          1416
         BCTR  @15,0                                               1416
         STH   @15,MFENDT                                          1416
*             END;                                         /*@Z40GSJG*/
*                                                                  1417
         BCTR  N,0                                                 1417
@DE01413 CH    N,MFBGNT                                            1417
         BNL   @DL01413                                            1417
@DC01413 DS    0H                                                  1418
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/
*                                                                  1418
         LH    @15,MFENDT                                          1418
         BCTR  @15,0                                               1418
         STH   @15,MFENDT                                          1418
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/
*                                                                  1419
         BCTR  MFSL,0                                              1419
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/
*                                                                  1420
         BCTR  MFMSL,0                                             1420
*             END;                                         /*@Z40GSJG*/
*                                                                  1421
*         IF MFFPASS = ON                                  /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
@RC01406 TM    MFFPASS,B'00100000'                                 1422
         BNO   @RF01422                                            1422
*             DO;                                          /*@Z40GSJG*/
*                                                                  1423
*             MFRC = MFRC - MFSL;                          /*@Z40GSJG*/
*                                                                  1424
         LH    @15,MFRC                                            1424
         SLR   @15,MFSL                                            1424
         STH   @15,MFRC                                            1424
*             MFFPASS = OFF;                               /*@Z40GSJG*/
*                                                                  1425
         NI    MFFPASS,B'11011111'                                 1425
*             END;                                         /*@Z40GSJG*/
*                                                                  1426
*           ELSE                                           /*@Z40GSJG*/
*                                                                  1427
*             MFRC = MFRC - MFMSL;                         /*@Z40GSJG*/
*                                                                  1427
         B     @RC01422                                            1427
@RF01422 LH    @15,MFRC                                            1427
         SLR   @15,MFMSL                                           1427
         STH   @15,MFRC                                            1427
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE THE MESSAGE NUMBER AND AS MUCH OF THE MESSAGE TEXT */
*         /* AS WILL FIT ON A LINE TO RECORD BUFFER. IF THE  @OZ18517*/
*         /* SUPPRESS MESSAGE NUMBER FLAG IS ON AN EMBEDDED  @OZ18517*/
*         /* SPACING SUBSTRUCTURE HAS BEEN FOUND AND IT IS   @OZ18517*/
*         /* ASSUMED THAT THE USER HAS DONE HIS OWN SEGMENTS.@OZ18517*/
*         /* DO NOT MOVE THE MESSGAE NUMBER.                 @OZ18517*/
*         /*                                                 @OZ18517*/
*         /***********************************************************/
*                                                                  1428
*         IF FFM2SMN = OFF                                 /*@OZ18517*/
*           THEN                                           /*@OZ18517*/
@RC01422 TM    FFM2SMN,B'10000000'                                 1428
         BNZ   @RF01428                                            1428
*             PRTLNTXT = MFMBUF(1:MFMNL);                  /*@OZ18517*/
         L     @01,PRTLNPTR                                        1429
         MVI   PRTLNTXT+1(@01),C' '                                1429
         MVC   PRTLNTXT+2(70,@01),PRTLNTXT+1(@01)                  1429
         LR    @15,MFMNL                                           1429
         BCTR  @15,0                                               1429
         EX    @15,@SM01068                                        1429
*           ELSE;                                          /*@OZ18517*/
@RF01428 DS    0H                                                  1431
*         MFPLB = MFMNL + 1;                               /*@Z40GSJG*/
*                                                                  1431
         LR    @15,MFMNL                                           1431
         AL    @15,@CF00216                                        1431
         STH   @15,MFPLB                                           1431
*         MFPLE = MFMNL + MFMSL;                           /*@Z40GSJG*/
*                                                                  1432
         LR    @14,MFMNL                                           1432
         ALR   @14,MFMSL                                           1432
         STH   @14,MFPLE                                           1432
*         PRTLNTXT(MFPLB:MFPLE) = MFMBUF(MFBGNT:MFENDT);   /*@Z40GSJG*/
*                                                                  1433
         L     @01,PRTLNPTR                                        1433
         ALR   @15,@01                                             1433
         LH    @00,MFPLB                                           1433
         LCR   @00,@00                                             1433
         ALR   @00,@14                                             1433
         LH    @01,MFBGNT                                          1433
         LA    @14,MFMBUF-1(@01)                                   1433
         LR    @01,@00                                             1433
         EX    @01,@SM01070                                        1433
*         /***********************************************************/
*         /*                                                         */
*         /* A '+' CHARACTER MAY BE APPENDED TO A PRIMARY MESSAGE    */
*         /* IF A SECONDARY MESSAGE FOLLOWS. THIS '+' IS TO BE       */
*         /* REMOVED HERE AND WILL BE REPLACED LATER IF REQUIRED.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1434
*         IF MFRC = 0 & MFFGO = ON                         /*@Z40GSJG*/
*           THEN                                           /*@Z40GSJG*/
         LH    @15,MFRC                                            1434
         LTR   @15,@15                                             1434
         BNZ   @RF01434                                            1434
         TM    MFFGO,B'10000000'                                   1434
         BNO   @RF01434                                            1434
*             DO;                                          /*@Z40GSJG*/
*             IF PRTLNTXT(MFPLE) = '+'                     /*@Z40GSJG*/
*               THEN                                       /*@Z40GSJG*/
         L     @15,PRTLNPTR                                        1436
         LH    @14,MFPLE                                           1436
         ALR   @15,@14                                             1436
         CLI   PRTLNTXT-1(@15),C'+'                                1436
         BNE   @RF01436                                            1436
*                 MFSL = MFSL - 1;                         /*@Z40GSJG*/
         BCTR  MFSL,0                                              1437
*               ELSE;                                      /*@Z40GSJG*/
@RF01436 DS    0H                                                  1439
*             END;                                         /*@Z40GSJG*/
*           ELSE;                                          /*@Z40GSJG*/
*                                                                  1440
@RF01434 DS    0H                                                  1441
*         /***********************************************************/
*         /*                                                       1441
*         /* SET CARRIAGE CONTROL AND RECORD LENGTH. THEN INITIALIZE */
*         /* FOR NEXT SEGMENT.                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1441
*         PRTLNLL = MFSL + 1;                              /*@Z40GSJG*/
*                                                                  1441
         L     @15,PRTLNPTR                                        1441
         LA    @14,1                                               1441
         LR    @01,MFSL                                            1441
         ALR   @01,@14                                             1441
         STH   @01,PRTLNLL(,@15)                                   1441
*         PRTLNCC = MFCC;                                  /*@Z40GSJG*/
*                                                                  1442
         MVC   PRTLNCC(1,@15),MFCC                                 1442
*         MFNL = MFNL + 1;                                 /*@Z40GSJG*/
*                                                                  1443
         L     @01,MFMRCPT                                         1443
         AH    @14,MFNL(,@01)                                      1443
         STH   @14,MFNL(,@01)                                      1443
*         MFBGNT = MFBGNT + MFMSL;                         /*@Z40GSJG*/
*                                                                  1444
         LR    @14,MFMSL                                           1444
         AH    @14,MFBGNT                                          1444
         STH   @14,MFBGNT                                          1444
*         MFTRL = MFTRL + MFSL + 3;                        /*@Z40GSJG*/
*                                                                  1445
         LA    @06,3                                               1445
         LR    @14,MFSL                                            1445
         AL    @14,MFTRL                                           1445
         ALR   @14,@06                                             1445
         ST    @14,MFTRL                                           1445
*         PRTLNPTR = PRTLNPTR + MFSL + 3;                  /*@Z40GSJG*/
*                                                                  1446
         ALR   @15,MFSL                                            1446
         ALR   @15,@06                                             1446
         ST    @15,PRTLNPTR                                        1446
*         END;                            /* END FORMAT LOOP @Z40GSJG*/
*                                                                  1447
@DE01389 LH    @06,MFRC                                            1447
         LTR   @06,@06                                             1447
         BP    @DL01389                                            1447
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE IF THERE IS A SECONDARY MESSAGE TO PROCESS    */
*         /* IF SO TURN OFF THE SUPPRESS MESSAGE NUMBER FLAG.@OZ18517*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1448
*         IF FFMPSMS = ON                                  /*@Z40GSJG*/
*           THEN                                           /*@OZ18517*/
         TM    FFMPSMS,B'00001000'                                 1448
         BNO   @RF01448                                            1448
*             FFM2SMN = OFF;                               /*@OZ18517*/
         NI    FFM2SMN,B'01111111'                                 1449
*           ELSE                                           /*@Z40GSJG*/
*                                                                  1450
*             MFFGO = OFF;                                 /*@Z40GSJG*/
*                                                                  1450
         B     @RC01448                                            1450
@RF01448 NI    MFFGO,B'01111111'                                   1450
*         END;                           /* END BIG LOOP     @Z40GSJG*/
*                                                                  1451
@RC01448 DS    0H                                                  1451
@DE01364 TM    MFFGO,B'10000000'                                   1451
         BNZ   @DL01364                                            1451
*         MFRCNT = MFPMRC + MFSMRC;                        /*@Z40GSJG*/
*                                                                  1452
         LH    @06,MFPMRC                                          1452
         AH    @06,MFSMRC                                          1452
         STH   @06,MFRCNT                                          1452
*         RETURN CODE(0);                                  /*@Z40GSJG*/
         SLR   @15,@15                                             1453
         L     @14,12(,@13)                                        1453
         LM    @00,@06,20(@13)                                     1453
         LM    @08,@12,52(@13)                                     1453
         BR    @14                                                 1453
*         END SEGMENT;                                     /*@Z40GSJG*/
@PB00017 DS    0H                                                  1455
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE FORMAT PROCEDURE.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1455
*                                                                  1455
*         GENERATE DATA;                                           1455
*         END IDCTP01                                              1456
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF40 )                                        *
*;                                                                 1456
@EL00001 L     @13,4(,@13)                                         1456
@EF00001 L     @00,@SIZDATD                                        1456
         LR    @01,@08                                             1456
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1456
         BR    @14                                                 1456
@DATA    DS    0H
@CH00981 DC    H'999'
@CH00900 DC    H'-1'
@SM01042 MVC   HDSEG3(0,@04),TRBUF(@01)
@SM01044 MVC   CVPB(0,@06),TRBUF(@15)
@SM01046 MVC   ALIGNBUF(0),TRBUF(@03)
@SM01048 MVC   CVPB(0,@03),ALIGNBUF
@SM01050 MVC   CVPB(0,@06),ALIGNBUF
@SM01056 MVC   0(0,@03),TRBUF(@01)
@SM01058 MVC   RETAREA(0,@03),PRTBUFF(@01)
@SM01062 MVC   HEADLI(0,@06),PRLINE
@SM01064 MVC   STACKDL(0,@04),PUTLINE(@15)
@SM01066 MVC   PRTBUFF(0,@06),MSGTXT(@04)
@SM01068 MVC   PRTLNTXT(0,@01),MFMBUF
@SM01070 MVC   PRTLNTXT-1(0,@15),0(@14)
         DS    0F
@AL00305 DC    A(@CF00153)             LIST WITH   1 ARGUMENT(S)
@AL00329 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00382 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00426 DC    A(@CF00216)             LIST WITH   1 ARGUMENT(S)
@AL00330 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00350 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00445 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00458 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00479 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(RCQUIT)
@AL00383 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00427 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(RCERR)
@AL00394 DC    A(@CF00150)             LIST WITH   1 ARGUMENT(S)
@AL00404 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00414 DC    A(@CF00159)             LIST WITH   1 ARGUMENT(S)
@AL00461 DC    A(@CF00469)             LIST WITH   1 ARGUMENT(S)
@AL00546 DC    A(@CF00036)             LIST WITH   1 ARGUMENT(S)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00016 DS    14F
@PC00016 DS    1F
@SA00002 DS    14F
@SA00003 DS    14F
@SA00014 DS    14F
@SA00007 DS    14F
@SA00008 DS    13F
@SA00009 DS    13F
@SA00012 DS    14F
@SA00010 DS    14F
@SA00015 DS    14F
@PC00015 DS    1F
@AL00001 DS    5A
@TF00001 DS    F
IDCTP01  CSECT
         DS    0F
@CF00216 DC    F'1'
@CH00216 EQU   @CF00216+2
@CF00150 DC    F'2'
@CH00150 EQU   @CF00150+2
@CF00159 DC    F'3'
@CF00036 DC    F'4'
@CF00153 DC    F'6'
@CH00153 EQU   @CF00153+2
@CF00469 DC    F'7'
@CF00176 DC    F'8'
@CH00176 EQU   @CF00176+2
@CF00953 DC    F'9'
@CF00032 DC    F'10'
@CF00033 DC    F'11'
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CF00962 DC    F'13'
@CF00479 DC    F'16'
@CF00952 DC    F'28'
@CF00794 DC    F'72'
@CH00794 EQU   @CF00794+2
@CF00894 DC    F'255'
@CF01012 DC    F'299'
@CF00945 DC    XL4'0F'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
OPNPTR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
DARGILP1 DS    FL4
         ORG   DARGILP1
@NM00033 DS    FL2
DARGILP2 DS    FL2
         ORG   DARGILP1+4
PRTBUFPT DS    A
QENTP    DS    A
CVSTA    DS    A
FMRIP    DS    A
TTLPT    DS    A
HEADPTR  DS    A
MSGAREA  DS    A
TEMP1    DS    F
FFMSTRS  DS    A
FFMREDOS DS    A
FFMBDP   DS    A
FFMRBOFF DS    F
CVSL     DS    F
FMRIL    DS    F
BINACC   DS    F
PRTLNPTR DS    A
MFMRCPT  DS    A
MFTRL    DS    F
LINCT    DS    F
TEMP2    DS    F
CVPSAVP  DS    A
LISTPTR  DS    A
TESTRC   DS    H
SAVERC   DS    H
STRSTP   DS    H
FFMREDOL DS    H
FFMREDOO DS    H
FFMREDOC DS    H
REDOCSAV DS    H
BINHALF  DS    H
PUPOCT   DS    H
NLISAV   DS    H
MFRC     DS    H
MFML     DS    H
MFMLL    DS    H
MFBGNT   DS    H
MFENDT   DS    H
MFPLB    DS    H
MFPLE    DS    H
MFRCNT   DS    H
MFPMRC   DS    H
MFSMRC   DS    H
SAVPMN   DS    H
PLLEN    DS    H
PRSPF    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
CVPSTRU  DS    CL299
         ORG   CVPSTRU
CVPSTRU1 DS    CL162
         ORG   CVPSTRU1
CVPIADD  DS    AL4
CVPPADD  DS    AL4
CVPIL    DS    FL4
CVPOL    DS    FL4
CVPTYF   DS    BL2
         ORG   CVPTYF
CVPBH    DS    BL1
CVPBHA   EQU   CVPTYF+0
CVPBHD   EQU   CVPTYF+0
CVPBD    EQU   CVPTYF+0
CVPPU    EQU   CVPTYF+0
@NM00034 EQU   CVPTYF+0
CVPZS    DS    BL1
CVPAL    EQU   CVPTYF+1
CVPSS    EQU   CVPTYF+1
CVPBS    EQU   CVPTYF+1
CVPAR    EQU   CVPTYF+1
@NM00035 EQU   CVPTYF+1
         ORG   CVPSTRU1+18
CVPRETC  DS    FL2
CVPRETP  DS    AL4
PRTSPF   DS    FL2
PRTSPT   DS    CL1
PRTBUFF1 DS    CL135
         ORG   CVPSTRU+162
CVPSTRU2 DS    CL137
         ORG   CVPSTRU2
PRTBUFF2 DS    CL135
PRTBFOVF DS    CL2
         ORG   CVPSTRU+299
ALIGNBUF DS    CL135
         DS    CL2
UNPKWD   DS    CL8
HDINDEXC DS    CL2
HDCVB    DS    CL64
CVFLAG   DS    BL2
         ORG   CVFLAG
PLOVF    DS    BL1
PUPPSF   EQU   CVFLAG+0
PUPIOF   EQU   CVFLAG+0
SIGNPOS  EQU   CVFLAG+0
HIORDRF  EQU   CVFLAG+0
         ORG   CVFLAG+2
SIGN     DS    CL1
MSGNO    DS    CL3
MTPN     DS    CL4
PRBUFF   DS    CL441
         ORG   PRBUFF
PRCC     DS    CL1
PRLINE   DS    CL220
PRLINES  DS    CL220
         ORG   PRBUFF+441
MFFLAG   DS    BL1
         ORG   MFFLAG
MFFGO    DS    BL1
MFFP1    EQU   MFFLAG+0
MFFPASS  EQU   MFFLAG+0
@NM00041 EQU   MFFLAG+0
         ORG   MFFLAG+1
MFMBUF   DS    CL136
MFCC     DS    CL1
STID     DS    CL4
         ORG   STID
STIDMOD  DS    CL3
STIDENT  DS    AL1
         ORG   STID+4
FFMFLAG  DS    BL2
         ORG   FFMFLAG
FFMREDOF DS    BL1
FFMEOS   EQU   FFMFLAG+0
FFMEOS1  EQU   FFMFLAG+0
FFMPASS  EQU   FFMFLAG+0
FFMIDINH EQU   FFMFLAG+0
FFMNOFM  EQU   FFMFLAG+0
FFMDATA  EQU   FFMFLAG+0
FFMFMTF  EQU   FFMFLAG+0
FFMPINH  DS    BL1
FFMVS    EQU   FFMFLAG+1
FFMPSFF  EQU   FFMFLAG+1
FFMPMSF  EQU   FFMFLAG+1
FFMPSMS  EQU   FFMFLAG+1
FFMNPMF  EQU   FFMFLAG+1
FFMHDFLN EQU   FFMFLAG+1
@NM00042 EQU   FFMFLAG+1
         ORG   FFMFLAG+2
FFM2FLG  DS    BL2
         ORG   FFM2FLG
FFM2SMN  DS    BL1
@NM00043 EQU   FFM2FLG+0
         ORG   FFM2FLG+2
IDCTP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00881 DC    V(IDCTP05)
         DS    0D
GPOOL    DC    F'0'
MFMML    DC    H'11'
NULLPMN  DC    H'0'
STDLWPS  DC    H'121'
RCQUIT   DC    H'12'
RCERR    DC    H'4'
PRBUFL   DC    H'2048'
@CC00898 DC    C'TPSI'
@CC00912 DC    C'TPCC'
@CC00914 DC    C'TP1N'
@CC00933 DC    C'TP2I'
@CC00940 DC    C'TP2N'
@CC00950 DC    C'TP2M'
@CC00961 DC    C'TP2D'
@CC00963 DC    C'TP2O'
@CC00964 DC    C'TP2V'
@CC00966 DC    C'TP2U'
@CC00975 DC    C'TPDR'
@CC00979 DC    C'TP3I'
@CC00987 DC    C'TPMS'
@CC00988 DC    C'TPX1'
@CC00989 DC    C'TP3N'
@CC01006 DC    C'TPER'
@CC00944 DC    C'X'''
@CB00879 DC    X'000001073741824C'
@CB00934 EQU   @CB00879
MODID    DC    CL4'TP01'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
FIXAREA  DC    X'00'
         DC    XL255'0'
SBPOOL   DC    CL4'TP01'
BHTRTB   DC    CL16'0123456789ABCDEF'
PRCCON   DC    CL4'+ 0-'
PRECON   DC    CL1'1'
HDPOOL   DC    CL4'TP03'
STMODID  DC    CL3'TP1'
@DATD    DSECT
IDCTP01  CSECT
         ENTRY IDCTPS1
IDCTPS1  DC A(@SIZDATD)
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCTP01  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MFMSL    EQU   @06
MFSL     EQU   @03
MFMNL    EQU   @04
MFINPTR  EQU   @03
PRFTSP   EQU   @04
SPFSAV   EQU   @03
J        EQU   @04
N        EQU   @07
SIGNT    EQU   @06
DECT     EQU   @06
PUPPSC   EQU   @04
FMSIL    EQU   @03
PCTPTR   EQU   @05
FSADDR   EQU   @06
DDSTRU   EQU   @03
IOCSPTR  EQU   @06
SETRC    EQU   @04
RTNREG   EQU   @15
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
CVDREG   EQU   @02
GDTPR    EQU   @09
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTTPH   EQU   GDTTBL+28
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
LISTTEST EQU   0
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOPT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCPNM   EQU   IOCNWM+2
IOCREL   EQU   IOCSTR+60
IOCTPML  EQU   IOCREL
IOCTSML  EQU   IOCREL+2
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGIND  EQU   DARGLIST+18
DARGFLGS EQU   DARGLIST+19
DARGFULL EQU   DARGFLGS
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGREP  EQU   DARGINS
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTEOLF  EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSMSG  EQU   FMTFLGS+1
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTSTL   EQU   FMTILEN
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTSPT   EQU   FMTSTO
FMTOCOL  EQU   FMTLIST+6
FMTRIO   EQU   FMTOCOL
FMTOLEN  EQU   FMTLIST+8
FMTCNVF  EQU   FMTLIST+10
FMTBS    EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
PCTTAB   EQU   0
PCTFLG   EQU   PCTTAB+4
PCTH1F   EQU   PCTFLG
PCTH2F   EQU   PCTFLG
PCTHAF   EQU   PCTFLG
PCTLLM   EQU   PCTFLG
PCTAPF   EQU   PCTFLG
PCTSPP   EQU   PCTTAB+8
PCTACT   EQU   PCTTAB+12
PCTIOC   EQU   PCTACT
PCTAPL   EQU   PCTACT+4
PCTCPN   EQU   PCTAPL
PCTNLI   EQU   PCTAPL+2
PCTSTD   EQU   PCTTAB+20
PCTSPL   EQU   PCTSTD+4
PCTALT   EQU   PCTTAB+28
PCTIOP   EQU   PCTALT
PCTLPL   EQU   PCTALT+4
PCTSQP   EQU   PCTTAB+48
PCTAHP   EQU   PCTTAB+52
PCTMLP   EQU   PCTTAB+56
PCTSLP   EQU   PCTTAB+60
PCTTRP   EQU   PCTTAB+64
PCTPLW   EQU   PCTTAB+68
PCTSLC   EQU   PCTTAB+74
PCTFLP   EQU   PCTTAB+76
PCTFLC   EQU   PCTTAB+80
PCTHLC   EQU   PCTTAB+82
PCTHSC   EQU   PCTTAB+83
PCTPNL   EQU   PCTTAB+84
PCTPMN   EQU   PCTTAB+86
PCTAPC   EQU   PCTTAB+88
PCTDSC   EQU   PCTTAB+92
PCTPNI   EQU   PCTTAB+94
PCTFDL   EQU   PCTTAB+96
PCTLDL   EQU   PCTTAB+98
PCTFLN   EQU   PCTTAB+100
PCTLNM   EQU   PCTTAB+102
PCTBUF   EQU   PCTTAB+104
PCTBNL   EQU   PCTTAB+108
PRTBUFF  EQU   0
RETAREA  EQU   0
QENTRY   EQU   0
QSTID    EQU   QENTRY
QCHAIN   EQU   QENTRY+4
QFLAGS   EQU   QENTRY+8
QMSGF    EQU   QFLAGS
QHEADF   EQU   QFLAGS
QSECMF   EQU   QFLAGS
QNPMF    EQU   QFLAGS
Q2LMSG   EQU   QFLAGS
QHLC     EQU   QENTRY+10
QHSC     EQU   QENTRY+11
QTEXT    EQU   QENTRY+12
CVPB     EQU   0
TRBUF    EQU   0
HDPRLI   EQU   0
HDINDEX  EQU   HDPRLI
HDSEG1   EQU   HDPRLI+6
HDSEG2   EQU   HDPRLI+44
HDST1    EQU   HDPRLI+82
HDSEG3   EQU   HDPRLI+83
HDST2    EQU   HDPRLI+115
FTLI     EQU   0
FLCC     EQU   FTLI
MTLINE   EQU   0
STLINE   EQU   0
HEADQUE  EQU   0
HEADQP   EQU   HEADQUE
HEADCC   EQU   HEADQUE+4
HEADLI   EQU   HEADQUE+5
MESSAGE  EQU   0
MSGLEN   EQU   MESSAGE+2
MSGTXT   EQU   MESSAGE+12
STACKMAP EQU   0
STACKLL  EQU   STACKMAP
STACKDL  EQU   STACKMAP+2
PRTLNSTR EQU   0
PRTLNLL  EQU   PRTLNSTR
PRTLNCC  EQU   PRTLNSTR+2
PRTLNTXT EQU   PRTLNSTR+3
MFINBUF  EQU   0
MFNL     EQU   0
CVPSAV   EQU   0
CVPSAV1  EQU   CVPSAV
CVPSAV2  EQU   CVPSAV+162
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
NEWERID1 EQU   5
PCTTRT   EQU   0
GDTTBLX  EQU   0
FILENAME EQU   0
DDPTR    EQU   0
FMPTR    EQU   0
PUTLINE  EQU   0
ERRCODE  EQU   0
STLCC    EQU   STLINE
CONVL    EQU   TEMP1
DSINDX   EQU   TEMP1
RETLN    EQU   TEMP1
BDLEN    EQU   TEMP1
HDINDEXB EQU   HDINDEXC
BINHALFC EQU   BINHALF
BINACCC  EQU   BINACC
CURLI    EQU   TEMP2
HDQPTR   EQU   TEMP2
MTLCC    EQU   MTLINE
TRBUFB   EQU   TRBUF
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00040 EQU   MESSAGE+10
@NM00039 EQU   MESSAGE+8
@NM00038 EQU   MESSAGE+6
MSGOFF   EQU   MESSAGE+4
@NM00037 EQU   MESSAGE
FL1      EQU   FTLI+1
HDSP3    EQU   HDPRLI+80
HDSP2    EQU   HDPRLI+42
HDSP1    EQU   HDPRLI+4
@NM00036 EQU   QFLAGS
PCTPPD   EQU   PCTTAB+90
PCTMLC   EQU   PCTTAB+72
PCTSME   EQU   PCTTAB+44
PCTSTM   EQU   PCTTAB+36
PCTANL   EQU   PCTLPL+2
PCTAPN   EQU   PCTLPL
PCTSNL   EQU   PCTSPL+2
PCTSPN   EQU   PCTSPL
PCTIOS   EQU   PCTSTD
@NM00032 EQU   PCTFLG
PCTIDN   EQU   PCTTAB
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
@NM00021 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
@NM00020 EQU   DARGFLGS
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00349 EQU   @RC00342
@RC00588 EQU   @RC00584
@RC00594 EQU   @RC00584
@RC01046 EQU   @RC01044
@RC01270 EQU   @RC01266
@PB00016 EQU   @PB00017
@RC00597 EQU   @RC00594
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00007 EQU   @PB00013
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCTP01,(C'PLS1136',0701,77341)

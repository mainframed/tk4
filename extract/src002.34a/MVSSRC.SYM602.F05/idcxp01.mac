         TITLE '*********** IDCXP01:  EXPORT FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCXP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCXP01   77.127'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*        /************************************************************/
*        /*                                                          */
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */
*        /*   EXPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */
*        /*   USER CATALOG OR A CLUSTER OR AIX IS TO BE EXPORTED,    */
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION.*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0294
*        OLDERID2 = NEWERID2;                                      0294
         L     @15,@PC00001                                        0294
         L     @14,GDTTR2(,@15)                                    0294
         MVC   @TS00001(95),NEWERID2(@14)                          0294
         MVC   OLDERID2(95,@14),@TS00001                           0294
*        NEWID2 = 'XPBG';                                          0295
         MVC   NEWID2(4,@14),@CC01134                              0295
*        IF GDTDBG = NULLPTR                                       0296
*          THEN;                                                   0296
         L     @15,GDTDBG(,@15)                                    0296
         LTR   @15,@15                                             0296
         BZ    @RT00296                                            0296
*          ELSE                                                    0298
*            CALL IDCDB010 (GDTTBL,'XP01');                        0298
         L     @15,@PC00001                                        0298
         ST    @15,@AL00001                                        0298
         LA    @14,@CC00896                                        0298
         ST    @14,@AL00001+4                                      0298
         MVI   @AL00001+4,X'80'                                    0298
         L     @15,GDTDBG(,@15)                                    0298
         LA    @01,@AL00001                                        0298
         BALR  @14,@15                                             0298
*        DDSTRU = ADDR(PRINTTAB);                                  0299
@RT00296 LA    @07,PRINTTAB                                        0299
         ST    @07,DDSTRU                                          0299
*        DARGLIST = ''B;                                           0300
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0300
*        DEFSTID = NORMSTAT;                               /*@Y30SSFR*/
         SLR   DEFSTID,DEFSTID                                     0301
*        DARGSMOD = EXPMSG;                                        0302
         MVC   DARGSMOD(3,@07),@CC00914                            0302
*        SUPPRESS = OFF;                                           0303
         NI    SUPPRESS,B'01111111'                                0303
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/
*        DEALLOC = OFF;                                    /*@YM08500*/
*                                                                  0305
         NI    DEALLOC,B'01111111'                                 0305
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE CATALOG ACB POINTER, POINTER TO OPEN         */
*        /*  OUTPUT DATA SET IOCS, AND POINTER TO OPEN INPUT         */
*        /*  DATA SET IOCS                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0306
*        PTRCTACB = NULLPTR;                                       0306
         SLR   @07,@07                                             0306
         ST    @07,PTRCTACB                                        0306
*        PINIOCS = NULLPTR;                                        0307
         ST    @07,PINIOCS                                         0307
*        POUTIOCS = NULLPTR;                                       0308
*                                                                  0308
         ST    @07,POUTIOCS                                        0308
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE WHETHER A USERCATALOG OR A CLUSTER OR AN AIX   */
*        /* IS TO BE EXPORTED                                @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0309
*        IF ADDR(DISCT) ^= NULLPTR                                 0309
*          THEN                                                    0309
         L     @15,@PC00001+4                                      0309
         C     @07,FDTPTR+52(,@15)                                 0309
         BE    @RF00309                                            0309
*            DO;                                                   0310
*                                                                  0310
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS DISCONNECT OF USER CATALOG                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  0311
*            CALL DSCTPROC;                                        0311
         BAL   @14,DSCTPROC                                        0311
*            RESPECIFY RTNREG RSTD;                                0312
*            TESTRC = RTNREG;                                      0313
         LR    TESTRC,RTNREG                                       0313
*            RESPECIFY RTNREG UNRSTD;                              0314
*            SETRC = TESTRC;                                       0315
         STH   TESTRC,SETRC                                        0315
*            END;                                                  0316
*                                                                  0316
*          ELSE                                                    0317
*            DO;                                                   0317
*                                                                  0317
         B     @RC00309                                            0317
@RF00309 DS    0H                                                  0318
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS EXPORTATION OF A CLUSTER OR AN AIX  @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0318
*            CALL CLUSPROC;                                        0318
         BAL   @14,CLUSPROC                                        0318
*            RESPECIFY RTNREG RSTD;                                0319
*            TESTRC = RTNREG;                                      0320
         LR    TESTRC,RTNREG                                       0320
*            RESPECIFY RTNREG UNRSTD;                              0321
*            SETRC = TESTRC;                                       0322
*                                                                  0322
         STH   TESTRC,SETRC                                        0322
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF SOMETHING THAT WAS ALLOCATED BY EXPORT   @Y30SSFR*/
*            /*  IS STILL ALLOCATED, DYNAMICALLY UNALLOCATE  @Y30SSFR*/
*            /*  IT.                                         @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0323
*            IF DEALLOC = ON                               /*#YM08500*/
*              THEN                                                0323
         TM    DEALLOC,B'10000000'                                 0323
         BNO   @RF00323                                            0323
*                CALL IDCSADL0(GDTTBL,ALLAGL);             /*#YL026UA*/
         L     @07,@PC00001                                        0324
         ST    @07,@AL00001                                        0324
         L     @01,ALLPTR                                          0324
         ST    @01,@AL00001+4                                      0324
         MVI   @AL00001+4,X'80'                                    0324
         L     @15,GDTDLC(,@07)                                    0324
         LA    @01,@AL00001                                        0324
         BALR  @14,@15                                             0324
*            END;                                                  0325
*                                                                  0325
@RF00323 DS    0H                                                  0326
*        /************************************************************/
*        /*                                                          */
*        /*   TERMINATION PROCESSING WILL LIST APPROPRIATE ERROR     */
*        /*   MESSAGES, AND INDICATE THE FINAL STATUS OF EXPORT      */
*        /*   IN LASTCC.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0326
*        IF GDTDBG = NULLPTR                                       0326
*          THEN;                                                   0326
@RC00309 L     @07,@PC00001                                        0326
         L     @07,GDTDBG(,@07)                                    0326
         LTR   @07,@07                                             0326
         BZ    @RT00326                                            0326
*          ELSE                                                    0328
*            CALL IDCDB010 (GDTTBL,'XPFN');                        0328
*                                                                  0328
         L     @07,@PC00001                                        0328
         ST    @07,@AL00001                                        0328
         LA    @15,@CC01139                                        0328
         ST    @15,@AL00001+4                                      0328
         MVI   @AL00001+4,X'80'                                    0328
         L     @15,GDTDBG(,@07)                                    0328
         LA    @01,@AL00001                                        0328
         BALR  @14,@15                                             0328
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR ANY SPECIAL MESSAGES TO BE LISTED - ERROR OR   */
*        /*  INFORMATIONAL                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0329
*        IF DEFSTID ^= NORMSTAT                                    0329
*          THEN                                                    0329
@RT00326 C     DEFSTID,@CF00116                                    0329
         BE    @RF00329                                            0329
*            DO;                                                   0330
*            DARGSENT = DEFSTID;                                   0331
*                                                                  0331
         L     @07,DDSTRU                                          0331
         STC   DEFSTID,DARGSENT(,@07)                              0331
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0332
*                                                                  0332
         L     @15,@PC00001                                        0332
         ST    @15,@AL00001                                        0332
         LA    @14,@CF00116                                        0332
         ST    @14,@AL00001+4                                      0332
         LA    @14,DDSTRU                                          0332
         ST    @14,@AL00001+8                                      0332
         MVI   @AL00001+8,X'80'                                    0332
         L     @15,GDTPRT(,@15)                                    0332
         LA    @01,@AL00001                                        0332
         BALR  @14,@15                                             0332
*            END;                                                  0333
*                                                                  0333
*        IF SUPPRESS = ON & SETRC < LASTCC04                       0334
*          THEN                                                    0334
@RF00329 TM    SUPPRESS,B'10000000'                                0334
         BNO   @RF00334                                            0334
         LA    @15,4                                               0334
         CH    @15,SETRC                                           0334
         BNH   @RF00334                                            0334
*            SETRC = LASTCC04;                                     0335
*                                                                  0335
         STH   @15,SETRC                                           0335
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE FINAL COMPLETION MESSAGE INDICATING WHETHER       */
*        /*  EXPORT WAS SUCCESSFUL OR NOT                            */
*        /*  SET LASTCC TO INDICATE SUCCESS OR FAILURE TO THE        */
*        /*  AMS EXECUTIVE                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0336
*        IF (SETRC > LASTCC00) & (GDTECT ^= NULLPTR)       /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00334 SLR   @15,@15                                             0336
         CH    @15,SETRC                                           0336
         BNL   @RF00336                                            0336
         L     @14,@PC00001                                        0336
         C     @15,GDTECT(,@14)                                    0336
         BE    @RF00336                                            0336
*            DARGSENT = TSOFAIL;                           /*@Y30SSFR*/
         L     @01,DDSTRU                                          0337
         MVI   DARGSENT(@01),X'0F'                                 0337
*          ELSE                                            /*@Y30SSFR*/
*            IF SETRC < LASTCC08                           /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         B     @RC00336                                            0338
@RF00336 LH    @15,SETRC                                           0338
         C     @15,@CF00180                                        0338
         BNL   @RF00338                                            0338
*                DARGSENT = EXPTGOOD;                      /*@Y30SSFR*/
         L     @01,DDSTRU                                          0339
         MVI   DARGSENT(@01),X'01'                                 0339
*              ELSE                                        /*@Y30SSFR*/
*                DARGSENT = EXPTFAIL;                      /*@Y30SSFR*/
         B     @RC00338                                            0340
@RF00338 L     @01,DDSTRU                                          0340
         MVI   DARGSENT(@01),X'03'                                 0340
*        LASTCC = SETRC;                                   /*@Y30SSFR*/
@RC00338 DS    0H                                                  0341
@RC00336 L     @15,@PC00001+8                                      0341
         LH    @14,SETRC                                           0341
         STH   @14,LASTCC(,@15)                                    0341
*        DARGSMOD = UNIVMSG;                                       0342
         L     @14,DDSTRU                                          0342
         MVC   DARGSMOD(3,@14),@CC00930                            0342
*        DARGDBP = ADDR(LASTCC);                                   0343
         ST    @15,DARGDBP(,@14)                                   0343
*        DARGILP = LENGTH(LASTCC);                                 0344
*                                                                  0344
         MVC   DARGILP(2,@14),@CH00154                             0344
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0345
*                                                                  0345
         L     @15,@PC00001                                        0345
         ST    @15,@AL00001                                        0345
         LA    @14,@CF00116                                        0345
         ST    @14,@AL00001+4                                      0345
         LA    @14,DDSTRU                                          0345
         ST    @14,@AL00001+8                                      0345
         MVI   @AL00001+8,X'80'                                    0345
         L     @15,GDTPRT(,@15)                                    0345
         LA    @01,@AL00001                                        0345
         BALR  @14,@15                                             0345
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE ANY OPEN DATA SETS                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0346
*        IF POUTIOCS ^= NULLPTR                                    0346
*          THEN                                                    0346
*                                                                  0346
         L     @15,POUTIOCS                                        0346
         LTR   @15,@15                                             0346
         BZ    @RF00346                                            0346
*            CALL IDCIOCL0 (GDTTBL,POUTIOCS);                      0347
*                                                                  0347
         L     @15,@PC00001                                        0347
         ST    @15,@AL00001                                        0347
         LA    @14,POUTIOCS                                        0347
         ST    @14,@AL00001+4                                      0347
         MVI   @AL00001+4,X'80'                                    0347
         L     @15,GDTCLS(,@15)                                    0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*        IF PINIOCS ^= NULLPTR                                     0348
*          THEN                                                    0348
*                                                                  0348
@RF00346 L     @15,PINIOCS                                         0348
         LTR   @15,@15                                             0348
         BZ    @RF00348                                            0348
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0349
*                                                                  0349
*                                                                  0349
         L     @15,@PC00001                                        0349
         ST    @15,@AL00001                                        0349
         LA    @14,PINIOCS                                         0349
         ST    @14,@AL00001+4                                      0349
         MVI   @AL00001+4,X'80'                                    0349
         L     @15,GDTCLS(,@15)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*        OLDERID2 = NEWERID2;                                      0350
@RF00348 L     @15,@PC00001                                        0350
         L     @14,GDTTR2(,@15)                                    0350
         MVC   @TS00001(95),NEWERID2(@14)                          0350
         MVC   OLDERID2(95,@14),@TS00001                           0350
*        NEWID2 = 'XPED';                                          0351
         MVC   NEWID2(4,@14),@CC01140                              0351
*        CALL IDCSAFP0 (GDTTBL,GPID);                              0352
*                                                                  0352
         ST    @15,@AL00001                                        0352
         LA    @14,GPID                                            0352
         ST    @14,@AL00001+4                                      0352
         MVI   @AL00001+4,X'80'                                    0352
         L     @15,GDTFPL(,@15)                                    0352
         LA    @01,@AL00001                                        0352
         BALR  @14,@15                                             0352
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0353
         L     @15,@PC00001                                        0353
         ST    @15,@AL00001                                        0353
         LA    @14,MODID                                           0353
         ST    @14,@AL00001+4                                      0353
         L     @14,@PC00001+8                                      0353
         ST    @14,@AL00001+8                                      0353
         MVI   @AL00001+8,X'80'                                    0353
         L     @15,GDTEPL(,@15)                                    0353
         LA    @01,@AL00001                                        0353
         BALR  @14,@15                                             0353
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - CLUSPROC                               */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT    @Y30SSFR*/
*        /*  THE OBJECT BEING EXPORTED AND ANY PATHS DEFINED @Y30SSFR*/
*        /*  OVER IT.  BUILDS CONTROL AND DATA RECORDS, AND  @Y30SSFR*/
*        /*  WRITES OUT THE HEADER RECORDS OF THE            @Y30SSFR*/
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL        @Y30SSFR*/
*        /*  PROCEDURES TO WRITE THE RECORDS OF THE DATA     @Y30SSFR*/
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA      @Y30SSFR*/
*        /*  SET.                                            @Y30SSFR*/
*        /*                                                          */
*        /* INPUT - FDT                                              */
*        /*                                                          */
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */
*        /*  THE IMPORT FSR TO RECONSTRUCT THE VSAM OBJECT ON THE    */
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0354
*CLUSPROC: PROCEDURE;                                              0354
*                                                                  0354
@EL00001 L     @13,4(,@13)                                         0354
@EF00001 L     @00,@SIZDATD                                        0354
         LR    @01,@08                                             0354
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0354
         BR    @14                                                 0354
CLUSPROC STM   @14,@05,@SA00002                                    0354
         STM   @07,@12,@SA00002+32                                 0354
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SET AN INITIAL VALUE FOR THE BLOCKSIZE OF THE   @Y30SSFR*/
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0355
*        BLKSIZ = 2048;                                    /*@Y30SSFR*/
*                                                                  0355
         MVC   BLKSIZ(4),@CF01144                                  0355
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR OUT PARAMETERS SPECIFIED IN AMS COMMAND        */
*        /*  IF OUTDS OR OUT NOT SPECIFIED, RETURN WITH ERROR        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0356
*        IF ADDR(OUT) = NULLPTR & ADDR(OUTDS) = NULLPTR            0356
*          THEN                                                    0356
         SLR   @07,@07                                             0356
         L     @15,@PC00001+4                                      0356
         C     @07,FDTPTR+8(,@15)                                  0356
         BNE   @RF00356                                            0356
         C     @07,FDTPTR+68(,@15)                                 0356
         BNE   @RF00356                                            0356
*            DO;                                                   0357
*            DARGSENT = NOOUPARM;                          /*@ZA01380*/
         L     @07,DDSTRU                                          0358
         MVI   DARGSENT(@07),X'02'                                 0358
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0359
         L     @07,@PC00001                                        0359
         ST    @07,@AL00001                                        0359
         LA    @15,@CF00116                                        0359
         ST    @15,@AL00001+4                                      0359
         LA    @15,DDSTRU                                          0359
         ST    @15,@AL00001+8                                      0359
         MVI   @AL00001+8,X'80'                                    0359
         L     @15,GDTPRT(,@07)                                    0359
         LA    @01,@AL00001                                        0359
         BALR  @14,@15                                             0359
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/
         LA    @15,12                                              0360
         L     @14,@SA00002                                        0360
         LM    @00,@05,@SA00002+8                                  0360
         LM    @07,@12,@SA00002+32                                 0360
         BR    @14                                                 0360
*            END;                                                  0361
*                                                                  0361
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRIES ARE NOT FULLY QUALIFIED - ISSUE  @YL026UA*/
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIERS       */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0362
*          IF ENTFUQ = ON                                          0362
*            THEN                                                  0362
*                                                                  0362
@RF00356 L     @07,@PC00001+4                                      0362
         L     @07,FDTPTR(,@07)                                    0362
         TM    ENTFUQ(@07),B'10000000'                             0362
         BNO   @RF00362                                            0362
*              DO;                                         /*@YL026UA*/
*                QUALLIST = ''B;                           /*@YL026UA*/
         XC    QUALLIST(12),QUALLIST                               0364
*                QUALADDR = ADDR(ENTVAL);                   /*@YL026UA*
         LA    @15,ENTVAL(,@07)                                    0365
         ST    @15,QUALADDR                                        0365
*                IF ENTPLN ^= 0                                    0366
*                  THEN                                            0366
         CLI   ENTPLN(@07),0                                       0366
         BE    @RF00366                                            0366
*                    QUALPAS = ADDR(ENTPAS);               /*@YL026UA*/
         LA    @07,ENTPAS(,@07)                                    0367
         ST    @07,QUALPAS                                         0367
*                QUALLEN = ENTLEN;                         /*@Y30SSFR*/
*                                                                  0368
@RF00366 L     @07,@PC00001+4                                      0368
         L     @07,FDTPTR(,@07)                                    0368
         SLR   @03,@03                                             0368
         IC    @03,ENTLEN(,@07)                                    0368
         STH   @03,QUALLEN                                         0368
*                CALL IDCSAQL0(GDTTBL,QUALADDR,QUALLEN,    /*@Y30SSFR*/
*                  QUALCAT,QUALPAS);                       /*@Y30SSFR*/
         L     @07,@PC00001                                        0369
         ST    @07,@AL00001                                        0369
         LA    @03,QUALADDR                                        0369
         ST    @03,@AL00001+4                                      0369
         LA    @03,QUALLEN                                         0369
         ST    @03,@AL00001+8                                      0369
         LA    @03,QUALCAT                                         0369
         ST    @03,@AL00001+12                                     0369
         LA    @03,QUALPAS                                         0369
         ST    @03,@AL00001+16                                     0369
         MVI   @AL00001+16,X'80'                                   0369
         L     @15,GDTQAL(,@07)                                    0369
         LA    @01,@AL00001                                        0369
         BALR  @14,@15                                             0369
*                RESPECIFY RTNREG RSTD;                            0370
*                TESTRC = RTNREG;                                  0371
         LR    TESTRC,RTNREG                                       0371
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UA*/
*                IF TESTRC ^= 0                                    0373
*                  THEN                                            0373
         LTR   TESTRC,TESTRC                                       0373
         BZ    @RF00373                                            0373
*                    RETURN CODE(LASTCC12);                /*#YL026UA*/
         LA    @15,12                                              0374
         L     @14,@SA00002                                        0374
         LM    @00,@05,@SA00002+8                                  0374
         LM    @07,@12,@SA00002+32                                 0374
         BR    @14                                                 0374
*              END;                                        /*#YL026UA*/
*                                                                  0375
@RF00373 DS    0H                                                  0376
*          IF OUTDSFUQ = ON & ADDR(OUTDS) ^= NULLPTR               0376
*            THEN                                                  0376
@RF00362 L     @07,@PC00001+4                                      0376
         L     @07,FDTPTR+68(,@07)                                 0376
         TM    OUTDSFUQ(@07),B'10000000'                           0376
         BNO   @RF00376                                            0376
         LTR   @07,@07                                             0376
         BZ    @RF00376                                            0376
*              DO;                                         /*#YL026UA*/
*                QUALLIST = ''B;                           /*#YL026UA*/
         XC    QUALLIST(12),QUALLIST                               0378
*                QUALADDR = ADDR(OUTDSVAL);                /*@Y30SSFR*/
         LA    @15,OUTDSVAL(,@07)                                  0379
         ST    @15,QUALADDR                                        0379
*                IF OUTDSPLN ^= NULLPTR                            0380
*                  THEN                                            0380
         CLI   OUTDSPLN(@07),0                                     0380
         BE    @RF00380                                            0380
*                    QUALPAS = ADDR(OUTDSPAS);             /*#YL026UA*/
         LA    @07,OUTDSPAS(,@07)                                  0381
         ST    @07,QUALPAS                                         0381
*                QUALLEN = OUTDSLEN;                       /*@OZ17980*/
*                                                                  0382
@RF00380 L     @07,@PC00001+4                                      0382
         L     @07,FDTPTR+68(,@07)                                 0382
         SLR   @03,@03                                             0382
         IC    @03,OUTDSLEN(,@07)                                  0382
         STH   @03,QUALLEN                                         0382
*                CALL IDCSAQL0(GDTTBL,QUALADDR,QUALLEN,QUALCAT,QUALPAS)
         L     @07,@PC00001                                        0383
         ST    @07,@AL00001                                        0383
         LA    @03,QUALADDR                                        0383
         ST    @03,@AL00001+4                                      0383
         LA    @03,QUALLEN                                         0383
         ST    @03,@AL00001+8                                      0383
         LA    @03,QUALCAT                                         0383
         ST    @03,@AL00001+12                                     0383
         LA    @03,QUALPAS                                         0383
         ST    @03,@AL00001+16                                     0383
         MVI   @AL00001+16,X'80'                                   0383
         L     @15,GDTQAL(,@07)                                    0383
         LA    @01,@AL00001                                        0383
         BALR  @14,@15                                             0383
*                                                          /*#YL026UA*/
*                RESPECIFY RTNREG RSTD;                            0384
*                TESTRC = RTNREG;                                  0385
         LR    TESTRC,RTNREG                                       0385
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UA*/
*                IF TESTRC ^= 0                                    0387
*                  THEN                                            0387
         LTR   TESTRC,TESTRC                                       0387
         BZ    @RF00387                                            0387
*                    RETURN CODE(LASTCC12);                /*#YL026UA*/
         LA    @15,12                                              0388
         L     @14,@SA00002                                        0388
         LM    @00,@05,@SA00002+8                                  0388
         LM    @07,@12,@SA00002+32                                 0388
         BR    @14                                                 0388
*              END;                                        /*#YL026UA*/
*                                                                  0389
@RF00387 DS    0H                                                  0390
*        /************************************************************/
*        /*                                                  #YL026UA*/
*        /*  ALLOCATE THE CLUSTER IF IT WAS NOT ALLOCATED BY JCL     */
*        /*                                                  #YL026UA*/
*        /************************************************************/
*                                                                  0390
*        IF ADDR(INDD) = NULLPTR                                   0390
*          THEN                                            /*@YL026UA*/
@RF00376 L     @07,@PC00001+4                                      0390
         L     @15,FDTPTR+4(,@07)                                  0390
         LTR   @15,@15                                             0390
         BNZ   @RF00390                                            0390
*            DO;                                           /*@YL026UA*/
*              ALLPTR = ADDR(ALLLIST);                     /*@YL026UA*/
         LA    @15,ALLLIST                                         0392
         ST    @15,ALLPTR                                          0392
*              ALLAGL = ''B;                               /*@YL026UA*/
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0393
*              ALLDSN = ADDR(ENTVAL);                      /*@Y30SSFR*/
         L     @07,FDTPTR(,@07)                                    0394
         LA    @14,ENTVAL(,@07)                                    0394
         ST    @14,ALLDSN(,@15)                                    0394
*              IF ENTPLN ^= 0                                      0395
*                THEN                                              0395
         CLI   ENTPLN(@07),0                                       0395
         BE    @RF00395                                            0395
*                  ALLPWD = ADDR(ENTPAS);                  /*@YL026UA*/
         LA    @07,ENTPAS(,@07)                                    0396
         ST    @07,ALLPWD(,@15)                                    0396
*              ALLOPTVL = OFF;                             /*@YL026UA*/
@RF00395 DS    0H                                                  0398
*              ALLOPTDS = ON;                              /*@YL026UA*/
         L     @07,ALLPTR                                          0398
         OI    ALLOPTDS(@07),B'01000000'                           0398
         NI    ALLOPTVL(@07),B'01111111'                           0398
*              ALLSTSOD = ON;                              /*@YL026UA*/
         OI    ALLSTSOD(@07),B'00000001'                           0399
*              ALLDSPKP = ON;                              /*#YL026UA*/
         OI    ALLDSPKP(@07),B'00001000'                           0400
*              CALL IDCSAAL0(GDTTBL,ALLAGL);               /*#YL026UA*/
         L     @03,@PC00001                                        0401
         ST    @03,@AL00001                                        0401
         ST    @07,@AL00001+4                                      0401
         MVI   @AL00001+4,X'80'                                    0401
         L     @15,GDTALC(,@03)                                    0401
         LA    @01,@AL00001                                        0401
         BALR  @14,@15                                             0401
*              RESPECIFY RTNREG RSTD;                              0402
*              TESTRC = RTNREG;                                    0403
         LR    TESTRC,RTNREG                                       0403
*              RESPECIFY RTNREG UNRSTD;                    /*#YL026UA*/
*              IF TESTRC ^= 0                                      0405
*                THEN                                              0405
         LTR   TESTRC,TESTRC                                       0405
         BZ    @RF00405                                            0405
*                  RETURN CODE(LASTCC12);                  /*#YL026UA*/
         LA    @15,12                                              0406
         L     @14,@SA00002                                        0406
         LM    @00,@05,@SA00002+8                                  0406
         LM    @07,@12,@SA00002+32                                 0406
         BR    @14                                                 0406
*              DEALLOC = ON;                               /*#YM08500*/
@RF00405 OI    DEALLOC,B'10000000'                                 0407
*            END;                                          /*#YL026UA*/
*                                                                  0408
*        /************************************************************/
*        /*                                                  #YL026UA*/
*        /*  INITIALIZE POINTERS TO CPL'S YET TO BE CONSTRUCTED      */
*        /*                                                  #YL026UA*/
*        /************************************************************/
*                                                                  0409
*        DO I= 1 TO 5;                                     /*@Y30SSFR*/
@RF00390 LA    I,1                                                 0409
@DL00409 DS    0H                                                  0410
*          PTRCPL(I) = NULLPTR;                                    0410
         LR    @07,I                                               0410
         SLA   @07,2                                               0410
         SLR   @05,@05                                             0410
         ST    @05,PTRCPL-4(@07)                                   0410
*        END;                                                      0411
*                                                                  0411
         AL    I,@CF00220                                          0411
         C     I,@CF00287                                          0411
         BNH   @DL00409                                            0411
*        RECSZ = 0;                    /*LRECL FOR PORTABLE DATA SET */
         SLR   @07,@07                                             0412
         ST    @07,RECSZ                                           0412
*        SUPPRESS = OFF;               /*INITIALIZE PASSWORD SUPPRESS*/
         NI    SUPPRESS,B'01111111'                                0413
*        AIXFLAG = OFF;                /*INITIALIZE AIXFLAG  @Y30SSFR*/
         NI    AIXFLAG,B'01111111'                                 0414
*                                      /*FLAG                        */
*                                                                  0415
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM LOCATE ON THE CLUSTER OR AIX NAME.      @Y30SSFR*/
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0415
*        OLDERID2 = NEWERID2;                                      0415
         L     @07,@PC00001                                        0415
         L     @07,GDTTR2(,@07)                                    0415
         MVC   @TS00001(95),NEWERID2(@07)                          0415
         MVC   OLDERID2(95,@07),@TS00001                           0415
*        NEWID2 = 'XPCP';                                          0416
         MVC   NEWID2(4,@07),@CC01145                              0416
*        CALL LOCPROC(ADDR(ENTVAL),NULLPARM,NULLPARM,FIELDLST,CNUM,
*          PTRCPL(1));                                             0417
*                                                                  0417
         MVC   @AL00001+4(16),@AL00417                             0417
         L     @07,@PC00001+4                                      0417
         L     @07,FDTPTR(,@07)                                    0417
         LA    @07,ENTVAL(,@07)                                    0417
         ST    @07,@AFTEMPS                                        0417
         LA    @07,@AFTEMPS                                        0417
         ST    @07,@AL00001                                        0417
         LA    @07,PTRCPL                                          0417
         ST    @07,@AL00001+20                                     0417
         LA    @01,@AL00001                                        0417
         BAL   @14,LOCPROC                                         0417
*        /************************************************************/
*        /*                                                          */
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0418
*        RESPECIFY RTNREG RSTD;                                    0418
*        TESTRC = RTNREG;                                          0419
         LR    TESTRC,RTNREG                                       0419
*        RESPECIFY RTNREG UNRSTD;                                  0420
*        IF TESTRC ^= 0                                            0421
*          THEN                                                    0421
         LTR   TESTRC,TESTRC                                       0421
         BZ    @RF00421                                            0421
*            RETURN CODE(LASTCC12);                                0422
*                                                                  0422
         LA    @15,12                                              0422
         L     @14,@SA00002                                        0422
         LM    @00,@05,@SA00002+8                                  0422
         LM    @07,@12,@SA00002+32                                 0422
         BR    @14                                                 0422
*        CALL CTLGPROC(PTRCPL(1));                                 0423
*                                                                  0423
@RF00421 LA    @07,PTRCPL                                          0423
         ST    @07,@AL00001                                        0423
         LA    @01,@AL00001                                        0423
         BAL   @14,CTLGPROC                                        0423
*        /************************************************************/
*        /*                                                          */
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0424
*        RESPECIFY RTNREG RSTD;                                    0424
*        TESTRC = RTNREG;                                          0425
         LR    TESTRC,RTNREG                                       0425
*        RESPECIFY RTNREG UNRSTD;                                  0426
*        IF TESTRC ^= 0                                            0427
*          THEN                                                    0427
         LTR   TESTRC,TESTRC                                       0427
         BZ    @RF00427                                            0427
*            RETURN CODE(LASTCC12);                                0428
*                                                                  0428
         LA    @15,12                                              0428
         L     @14,@SA00002                                        0428
         LM    @00,@05,@SA00002+8                                  0428
         LM    @07,@12,@SA00002+32                                 0428
         BR    @14                                                 0428
*        /************************************************************/
*        /*                                                          */
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A CLUSTER OR AIX     */
*        /*  NAME                                            @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0429
*        CTGPLPTR = PTRCPL(1);                                     0429
@RF00427 L     @07,PTRCPL                                          0429
         ST    @07,CTGPLPTR                                        0429
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0430
         L     CTGFLPTR,CTGFIELD(,@07)                             0430
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      0431
*          THEN                                                    0431
         SLR   @07,@07                                             0431
         C     @07,CTGFLNG(,CTGFLPTR)                              0431
         BE    @RF00431                                            0431
         L     @03,CTGFLPT(,CTGFLPTR)                              0431
         CR    @03,@07                                             0431
         BE    @RF00431                                            0431
*            IF FENTYPE = CTGTAIX                          /*@Y30SSFR*/
*              THEN                                                0432
*                                                                  0432
         CLI   FENTYPE(@03),C'G'                                   0432
         BNE   @RF00432                                            0432
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  HAVE AN AIX.  SET AIXFLAG TO ON.        @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0433
*                AIXFLAG = ON;                             /*@Y30SSFR*/
         OI    AIXFLAG,B'10000000'                                 0433
*              ELSE                                        /*@Y30SSFR*/
*                IF FENTYPE = CTGTCL                       /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         B     @RC00432                                            0434
@RF00432 L     @07,CTGFLPT(,CTGFLPTR)                              0434
         CLI   FENTYPE(@07),C'C'                                   0434
         BNE   @RF00434                                            0434
*                    DO;                                   /*@Y30SSFR*/
*                    CTGFLPTR = CTGFIELD(ICATTR);          /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        0436
         L     CTGFLPTR,CTGFIELD+92(,@07)                          0436
*                    IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0  /*@Y30SSFR*/
*                     & FCATTR ^= NOTINIT(1:1) &           /*@Y30SSFR*/
*                     PAGESPC = ON                         /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         SLR   @07,@07                                             0437
         C     @07,CTGFLNG(,CTGFLPTR)                              0437
         BE    @RF00437                                            0437
         L     @03,CTGFLPT(,CTGFLPTR)                              0437
         CR    @03,@07                                             0437
         BE    @RF00437                                            0437
         CLC   FCATTR(1,@03),NOTINIT                               0437
         BE    @RF00437                                            0437
         TM    PAGESPC(@03),B'00000001'                            0437
         BNO   @RF00437                                            0437
*                        DO;                               /*@Y30SSFR*/
*                        DEFSTID = NOCLUSNM;               /*@Y30SSFR*/
         LA    DEFSTID,3                                           0439
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/
         LA    @15,12                                              0440
         L     @14,@SA00002                                        0440
         LM    @00,@05,@SA00002+8                                  0440
         LM    @07,@12,@SA00002+32                                 0440
         BR    @14                                                 0440
*                        END;                              /*@Y30SSFR*/
*                    END;                                  /*@Y30SSFR*/
*              ELSE                                        /*@YL026UA*/
*                                                                  0443
*                IF FENTYPE ^= CTGTCL                      /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         B     @RC00434                                            0443
@RF00434 L     @07,CTGFLPT(,CTGFLPTR)                              0443
         CLI   FENTYPE(@07),C'C'                                   0443
         BE    @RF00443                                            0443
*                      DO;                                 /*@Y30SSFR*/
*                      DEFSTID = NOCLUSNM;                 /*@Y30SSFR*/
         LA    DEFSTID,3                                           0445
*                      RETURN CODE(LASTCC12);              /*@Y30SSFR*/
         LA    @15,12                                              0446
         L     @14,@SA00002                                        0446
         LM    @00,@05,@SA00002+8                                  0446
         LM    @07,@12,@SA00002+32                                 0446
         BR    @14                                                 0446
*                      END;                                /*@Y30SSFR*/
*                    ELSE;                                 /*@Y30SSFR*/
@RF00443 DS    0H                                                  0449
*          ELSE                                                    0449
*                                                                  0449
*            /********************************************************/
*            /*                                                      */
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0449
*            DO;                                                   0449
         B     @RC00431                                            0449
@RF00431 DS    0H                                                  0450
*            DEFSTID = NOCTFLD;                                    0450
         LA    DEFSTID,4                                           0450
*            RETURN CODE(LASTCC12);                                0451
         LA    @15,12                                              0451
         L     @14,@SA00002                                        0451
         LM    @00,@05,@SA00002+8                                  0451
         LM    @07,@12,@SA00002+32                                 0451
         BR    @14                                                 0451
*            END;                                                  0452
*                                                                  0452
*        /************************************************************/
*        /*                                                          */
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0453
*        CTGFLPTR = CTGFIELD(ICATACB);                             0453
@RC00431 L     @07,CTGPLPTR                                        0453
         L     CTGFLPTR,CTGFIELD+88(,@07)                          0453
*        PTRCTACB = FCATACB;                                       0454
*                                                                  0454
         L     @03,CTGFLPT(,CTGFLPTR)                              0454
         L     @03,FCATACB(,@03)                                   0454
         ST    @03,PTRCTACB                                        0454
*        /************************************************************/
*        /*                                                          */
*        /*  GET NAMEDS FPL FOR DATA AND POSSIBLY INDEX.     @Y30SSFR*/
*        /*  CALL LOCPROC TO BUILD CPL AND FPLS AND ISSUE A  @Y30SSFR*/
*        /*  LOCATE.                                         @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0455
*        CTGFLPTR = CTGFIELD(INAMEDS);                             0455
*                                                                  0455
         L     CTGFLPTR,CTGFIELD+84(,@07)                          0455
*        /************************************************************/
*        /*                                                          */
*        /*TEST FOR DATA AND INDEX COMPONENT                         */
*        /*RETURN IF UNAVAILABLE                                     */
*        /*  THE STRUCTURE OF THE NAMEDS AREA RETURNED BY    @Y30SSFR*/
*        /*  CATALOG MANAGEMENT IS USED EXPLICITLY IN ALL    @Y30SSFR*/
*        /*  OF THE CODE IN THIS MODULE THAT REFERENCES      @Y30SSFR*/
*        /*  NAMEDS.  FOR A CLUSTER OBJECT THE STRUCTURE     @Y30SSFR*/
*        /*  IS DATA, INDEX (IF EXISTANT), AND A MIXTURE OF  @Y30SSFR*/
*        /*  PATHS AND ALTERNATE INDEXES.  IN THE CASE OF    @Y30SSFR*/
*        /*  AN AIX, THE ORDER OF ASSOCIATED OBJECTS IS      @Y30SSFR*/
*        /*  DATA, INDEX, BASE CLUSTER, AND ANY PATHS.  FOR  @Y30SSFR*/
*        /*  PATHS IDCXP01 ASSUMES ONLY THAT THE PATHENTRY   @Y30SSFR*/
*        /*  OBJECT APPEARS FIRST IN THE NAMEDS AREA.        @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0456
*        IF CTGFLNG(1) = 0                                         0456
*          THEN                                                    0456
         L     @07,CTGFLNG(,CTGFLPTR)                              0456
         LTR   @07,@07                                             0456
         BNZ   @RF00456                                            0456
*            DO;                                                   0457
*            DEFSTID= NOCTFLD;                                     0458
         LA    DEFSTID,4                                           0458
*            RETURN CODE(LASTCC12);                                0459
         LA    @15,12                                              0459
         L     @14,@SA00002                                        0459
         LM    @00,@05,@SA00002+8                                  0459
         LM    @07,@12,@SA00002+32                                 0459
         BR    @14                                                 0459
*            END;                                                  0460
*                                                                  0460
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE LOCATES FOR EITHER DATA AND INDEX OR JUST @Y30SSFR*/
*        /*  DATA.  THE INFORMATION RETURNED BY CATALOG WILL @Y30SSFR*/
*        /*  BE WRITTEN TO THE PORTABILITY DATA SET.         @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0461
*        FNMPTR = CTGFLPT(1);                              /*@Y30SSFR*/
@RF00456 L     FNMPTR,CTGFLPT(,CTGFLPTR)                           0461
*        NUMOBJ = CTGFLNG(1) / LNAMEDS;                    /*@Y30SSFR*/
         L     @00,CTGFLNG(,CTGFLPTR)                              0462
         SRDA  @00,32                                              0462
         D     @00,@CF00043                                        0462
         STH   @01,NUMOBJ                                          0462
*        NUMOBJCT = NUMOBJ;                                /*@Y30SSFR*/
         LR    NUMOBJCT,@01                                        0463
*        NUMASSOC = NUMOBJ;                                /*@Y30SSFR*/
         STH   @01,NUMASSOC                                        0464
*        KSDSFLAG = OFF;                                   /*@Y30SSFR*/
*        PATHFLAG = OFF;                                   /*@Y30SSFR*/
*                                                                  0466
         NI    KSDSFLAG,B'10011111'                                0466
*ASSOCLP: DO I = 1 TO NUMOBJ;                              /*@Y30SSFR*/
ASSOCLP  LA    I,1                                                 0467
         B     @DE00467                                            0467
@DL00467 DS    0H                                                  0468
*          OLDERID2 = NEWERID2;                                    0468
         L     @07,@PC00001                                        0468
         L     @07,GDTTR2(,@07)                                    0468
         MVC   @TS00001(95),NEWERID2(@07)                          0468
         MVC   OLDERID2(95,@07),@TS00001                           0468
*          NEWID2 = 'XPAO';                                /*@Y30SSFR*/
*                                                                  0469
         MVC   NEWID2(4,@07),@CC01150                              0469
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF DATA OR INDEX, CALL LOCPROC TO BUILD CPL,  @Y30SSFR*/
*          /*  FPL'S.  THEN CALL CTLGPROC TO ISSUE A UCATLG. @Y30SSFR*/
*          /*  IF EITHER PROCEDURE SHOULD FAIL, RETURN.      @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  0470
*          IF FTYPE = CTGTINDX  FTYPE = CTGTDATA          /*@Y30SSFR*/
*              (FTYPE = CTGTCL & AIXFLAG = ON)            /*@Y30SSFR*/
*            THEN                                          /*@Y30SSFR*/
         CLI   FTYPE(FNMPTR),C'I'                                  0470
         BE    @RT00470                                            0470
         CLI   FTYPE(FNMPTR),C'D'                                  0470
         BE    @RT00470                                            0470
         CLI   FTYPE(FNMPTR),C'C'                                  0470
         BNE   @RF00470                                            0470
         TM    AIXFLAG,B'10000000'                                 0470
         BNO   @RF00470                                            0470
@RT00470 DS    0H                                                  0471
*LOCCOMP:      DO;                                         /*@Y30SSFR*/
LOCCOMP  DS    0H                                                  0472
*              IF (FTYPE = CTGTINDX)  (FTYPE = CTGTDATA)  /*@ZA03936*/
*                THEN                                      /*@ZA03936*/
         CLI   FTYPE(FNMPTR),C'I'                                  0472
         BE    @RT00472                                            0472
         CLI   FTYPE(FNMPTR),C'D'                                  0472
         BNE   @RF00472                                            0472
@RT00472 DS    0H                                                  0473
*                  CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,   /*@ZA03936*/
*                    FIELDLST,ONUM,PTRCPL(I+1));           /*@ZA03936*/
         LA    @07,NULLPARM                                        0473
         ST    @07,@AL00001                                        0473
         LA    @07,FNAME(,FNMPTR)                                  0473
         ST    @07,@AL00001+4                                      0473
         LA    @07,PTRCTACB                                        0473
         ST    @07,@AL00001+8                                      0473
         LA    @07,FIELDLST                                        0473
         ST    @07,@AL00001+12                                     0473
         LA    @07,ONUM                                            0473
         ST    @07,@AL00001+16                                     0473
         LR    @07,I                                               0473
         SLA   @07,2                                               0473
         LA    @07,PTRCPL(@07)                                     0473
         ST    @07,@AL00001+20                                     0473
         LA    @01,@AL00001                                        0473
         BAL   @14,LOCPROC                                         0473
*                ELSE                                      /*@ZA03936*/
*                  DO;                                     /*@ZA03936*/
         B     @RC00472                                            0474
@RF00472 DS    0H                                                  0475
*                  CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,   /*@ZA03936*/
*                    FIELDLST,AIXNUM,PTRCPL(I+1));         /*@ZA03936*/
*                                                                  0475
         LA    @07,NULLPARM                                        0475
         ST    @07,@AL00001                                        0475
         LA    @07,FNAME(,FNMPTR)                                  0475
         ST    @07,@AL00001+4                                      0475
         LA    @07,PTRCTACB                                        0475
         ST    @07,@AL00001+8                                      0475
         LA    @07,FIELDLST                                        0475
         ST    @07,@AL00001+12                                     0475
         LA    @07,AIXNUM                                          0475
         ST    @07,@AL00001+16                                     0475
         LR    @07,I                                               0475
         SLA   @07,2                                               0475
         LA    @07,PTRCPL(@07)                                     0475
         ST    @07,@AL00001+20                                     0475
         LA    @01,@AL00001                                        0475
         BAL   @14,LOCPROC                                         0475
*                  /**************************************************/
*                  /*                                        @ZA03936*/
*                  /*  SET CTGBYPSS ON TO BYPASS DOS         @ZA03936*/
*                  /*  SECURITY.                             @ZA03936*/
*                  /*                                        @ZA03936*/
*                  /**************************************************/
*                                                                  0476
*                  PTRCPL(I+1)->CTGBYPSS = ON;             /*@ZA03936*/
         LR    @07,I                                               0476
         SLA   @07,2                                               0476
         L     @07,PTRCPL(@07)                                     0476
         OI    CTGBYPSS(@07),B'10000000'                           0476
*                  END;                                    /*@ZA03936*/
*                                                                  0477
*              /******************************************************/
*              /*                                                    */
*              /*  IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -       */
*              /*  TERMINATE.                                        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0478
*              RESPECIFY RTNREG RSTD;                              0478
@RC00472 DS    0H                                                  0479
*              TESTRC = RTNREG;                                    0479
         LR    TESTRC,RTNREG                                       0479
*              RESPECIFY RTNREG UNRSTD;                            0480
*              IF TESTRC ^= 0                                      0481
*                THEN                                              0481
         LTR   TESTRC,TESTRC                                       0481
         BZ    @RF00481                                            0481
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/
*                                                                  0482
         LA    @15,12                                              0482
         L     @14,@SA00002                                        0482
         LM    @00,@05,@SA00002+8                                  0482
         LM    @07,@12,@SA00002+32                                 0482
         BR    @14                                                 0482
*              /******************************************************/
*              /*                                                    */
*              /*  INVOKE CATALOG MANAGEMENT TO LOCATE RELATED       */
*              /*  CLUSTER OR AIX OBJECT.                    #Y30SSFR*/
*              /*  TERMINATE IF LOCATE UNSUCCESSFUL                  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0483
*              CALL CTLGPROC(PTRCPL(I+1));                         0483
*                                                                  0483
@RF00481 LR    @07,I                                               0483
         SLA   @07,2                                               0483
         LA    @07,PTRCPL(@07)                                     0483
         ST    @07,@AL00001                                        0483
         LA    @01,@AL00001                                        0483
         BAL   @14,CTLGPROC                                        0483
*              RESPECIFY RTNREG RSTD;                              0484
*              TESTRC = RTNREG;                                    0485
         LR    TESTRC,RTNREG                                       0485
*              RESPECIFY RTNREG UNRSTD;                            0486
*              IF TESTRC ^= 0                                      0487
*                THEN                                              0487
         LTR   TESTRC,TESTRC                                       0487
         BZ    @RF00487                                            0487
*                  RETURN CODE(LASTCC12);                          0488
*                                                                  0488
         LA    @15,12                                              0488
         L     @14,@SA00002                                        0488
         LM    @00,@05,@SA00002+8                                  0488
         LM    @07,@12,@SA00002+32                                 0488
         BR    @14                                                 0488
*              CTGPLPTR = PTRCPL(I+1);                     /*@Y30SSFR*/
*                                                                  0489
@RF00487 LR    @07,I                                               0489
         SLA   @07,2                                               0489
         L     @07,PTRCPL(@07)                                     0489
         ST    @07,CTGPLPTR                                        0489
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  IF WE ARE LOCATING A CLUSTER ASSOCIATED   @Y30SSFR*/
*              /*  OBJECT FOR AN AIX, SAVE THE NAME OF THE   @Y30SSFR*/
*              /*  CLUSTER.  ALSO DECREMENT THE NUMBER OF    @Y30SSFR*/
*              /*  THINGS TO BE EXPORTED.                    @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0490
*              IF FTYPE = CTGTCL & AIXFLAG = ON            /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         CLI   FTYPE(FNMPTR),C'C'                                  0490
         BNE   @RF00490                                            0490
         TM    AIXFLAG,B'10000000'                                 0490
         BNO   @RF00490                                            0490
*                  DO;                                     /*@Y30SSFR*/
*                  CTGFLPTR = CTGFIELD(IENTNAME);          /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD+4(,@07)                           0492
*                  RELNAME = FENTNAME;                     /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              0493
         MVC   RELNAME(44),FENTNAME(@07)                           0493
*                  NUMOBJCT = NUMOBJCT - 1;                /*@Y30SSFR*/
         BCTR  NUMOBJCT,0                                          0494
*                  END;                                    /*@Y30SSFR*/
*                                                                  0495
*                                                                  0495
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  TEST FOR THE USABILITY OF THE OBJECT.     @Y30SSFR*/
*              /*  IF IT HAS BEEN MARKED AS NOT USABLE,SET   @Y30SSFR*/
*              /*  UP TO PRINT A MESSAGE AND RETURN.         @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0496
*              IF FTYPE ^= CTGTCL                          /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
@RF00490 CLI   FTYPE(FNMPTR),C'C'                                  0496
         BE    @RF00496                                            0496
*                  DO;                                     /*@Y30SSFR*/
*                  CTGFLPTR = CTGFIELD(IDSATTR);           /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        0498
         L     CTGFLPTR,CTGFIELD+8(,@07)                           0498
*                  IF FDSNTUSE = ON                        /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              0499
         TM    FDSNTUSE(@07),B'00000001'                           0499
         BNO   @RF00499                                            0499
*                      DO;                                 /*@Y30SSFR*/
*                      DEFSTID = NOTUSEMG;                 /*@Y30SSFR*/
         LA    DEFSTID,7                                           0501
*                      DARGSMOD = EXPMSG;                  /*@Y30SSFR*/
         L     @07,DDSTRU                                          0502
         MVC   DARGSMOD(3,@07),@CC00914                            0502
*                      RETURN CODE(LASTCC12);              /*@Y30SSFR*/
         LA    @15,12                                              0503
         L     @14,@SA00002                                        0503
         LM    @00,@05,@SA00002+8                                  0503
         LM    @07,@12,@SA00002+32                                 0503
         BR    @14                                                 0503
*                      END;                                /*@Y30SSFR*/
*                  END;                                    /*@Y30SSFR*/
*                                                                  0505
@RF00499 DS    0H                                                  0506
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  IF THE LOCATE WAS ON A DATA COMPONENT     @Y30SSFR*/
*              /*  EXTRACT THE AMDSB FIELD THAT GIVES THE    @Y30SSFR*/
*              /*  MAXIMUM LRECL (AMDLRECL), AND SET THE     @Y30SSFR*/
*              /*  LRECL OF THE PORTABILITY DATA SET         @Y30SSFR*/
*              /*  ACCORDINGLY.  TEST FOR A RELATIVE RECORD  @Y30SSFR*/
*              /*  DATA SET, AND SET THE RRDSFLAG IF THE     @Y30SSFR*/
*              /*  TEST SUCCEEDS.                            @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0506
*              CTGFLPTR = CTGFIELD(IENTYPE);               /*@Y30SSFR*/
*                                                                  0506
@RF00496 L     @07,CTGPLPTR                                        0506
         L     CTGFLPTR,CTGFIELD(,@07)                             0506
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  TEST TO BE CERTAIN THAT AN ENTYPE FIELD   @Y30SSFR*/
*              /*  HAS BEEN LOCATED.                         @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0507
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0        /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         SLR   @15,@15                                             0507
         C     @15,CTGFLNG(,CTGFLPTR)                              0507
         BE    @RF00507                                            0507
         L     @14,CTGFLPT(,CTGFLPTR)                              0507
         CR    @14,@15                                             0507
         BE    @RF00507                                            0507
*                  IF FENTYPE = CTGTDATA                   /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         CLI   FENTYPE(@14),C'D'                                   0508
         BNE   @RF00508                                            0508
*                      DO;                                 /*@Y30SSFR*/
*                      CTGFLPTR = CTGFIELD(IAMDSB);        /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD+68(,@07)                          0510
*                      DSCCATPT = CTGFLPT(1);              /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              0511
         ST    @07,DSCCATPT                                        0511
*                      RESPECIFY IDAAMDSB BASED(DSCCATPT); /*@Y30SSFR*/
*                                                                  0512
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  IF THE DATA SET IS AN RRDS, SET   @Y30SSFR*/
*                      /*  THE LRECL OF THE PORTABILITY DATA @Y30SSFR*/
*                      /*  SET TO BE THE MAXIMUM OF THE      @Y30SSFR*/
*                      /*  OF THE LRECL OF THE VSAM OBJECT   @Y30SSFR*/
*                      /*  AND THE CONTROL RECORD SIZE PLUS  @Y30SSFR*/
*                      /*  8 BYTES (4 FOR RECORD DESCRIPTOR  @Y30SSFR*/
*                      /*  WORD AND 4 FOR RELATIVE RECORD    @Y30SSFR*/
*                      /*  NUMBER).  OTHERWISE, SET THE      @Y30SSFR*/
*                      /*  LRECL OF THE PORTABILITY DATA SET @Y30SSFR*/
*                      /*  TO BE THE MAXIMUM OF THE LRECL OF @Y30SSFR*/
*                      /*  THE VSAM OBJECT BEING EXPORTED    @Y30SSFR*/
*                      /*  AND THE SIZE OF A CONTROL RECORD  @Y30SSFR*/
*                      /*  PLUS 4 BYTES.                     @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0513
*                      IF AMDRRDS = ON                     /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         TM    AMDRRDS(@07),B'00000010'                            0513
         BNO   @RF00513                                            0513
*                          DO;                             /*@Y30SSFR*/
*                          RRDSFLAG = ON;                  /*@Y30SSFR*/
         OI    RRDSFLAG,B'00010000'                                0515
*                          RECSZ = AMDLRECL + 8;           /*@Y30SSFR*/
         LA    @02,8                                               0516
         L     @07,AMDLRECL(,@07)                                  0516
         ALR   @07,@02                                             0516
         ST    @07,RECSZ                                           0516
*                          IF RECSZ < MINRECSZ + 8         /*@Y30SSFR*/
*                            THEN                          /*@Y30SSFR*/
         AL    @02,MINRECSZ                                        0517
         CR    @07,@02                                             0517
         BNL   @RF00517                                            0517
*                              RECSZ = MINRECSZ + 8;       /*@Y30SSFR*/
         ST    @02,RECSZ                                           0518
*                            ELSE ;                        /*@Y30SSFR*/
@RF00517 DS    0H                                                  0520
*                          END;                            /*@Y30SSFR*/
*                        ELSE                              /*@Y30SSFR*/
*                          DO;                             /*@Y30SSFR*/
         B     @RC00513                                            0521
@RF00513 DS    0H                                                  0522
*                          RECSZ = AMDLRECL +4;            /*@Y30SSFR*/
         LA    @07,4                                               0522
         L     @02,DSCCATPT                                        0522
         L     @02,AMDLRECL(,@02)                                  0522
         ALR   @02,@07                                             0522
         ST    @02,RECSZ                                           0522
*                          IF RECSZ < MINRECSZ + 4         /*@Y30SSFR*/
*                            THEN                          /*@Y30SSFR*/
         AL    @07,MINRECSZ                                        0523
         CR    @02,@07                                             0523
         BNL   @RF00523                                            0523
*                              RECSZ = MINRECSZ + 4;       /*@Y30SSFR*/
         ST    @07,RECSZ                                           0524
*                          END;                            /*@Y30SSFR*/
*                      END;                                /*@Y30SSFR*/
*                                                                  0526
*                    ELSE                                          0527
*                                                                  0527
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  TEST FOR THE PRESENCE OF AN INDEX   @Y30SSFR*/
*                    /*  COMPONENT.  IF THIS IS ONE, THEN    @Y30SSFR*/
*                    /*  SET THE KSDSFLAG TO ON.             @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  0527
*                      IF FENTYPE = CTGTINDX               /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         B     @RC00508                                            0527
@RF00508 L     @07,CTGFLPT(,CTGFLPTR)                              0527
         CLI   FENTYPE(@07),C'I'                                   0527
         BNE   @RF00527                                            0527
*                          KSDSFLAG = ON;                  /*@Y30SSFR*/
         OI    KSDSFLAG,B'01000000'                                0528
*                        ELSE ;                            /*@Y30SSFR*/
*                                                                  0529
@RF00527 DS    0H                                                  0530
*              END LOCCOMP;                                /*@Y30SSFR*/
*                                                                  0530
*            ELSE                                          /*@Y30SSFR*/
*                                                                  0531
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  TEST TO SEE IF THE ENTRY TYPE IS PATH.  IF  @Y30SSFR*/
*            /*  SO, SET A FLAG INDICATING PATH ASSOCIATIONS @Y30SSFR*/
*            /*  OTHERWISE TEST FOR AN AIX.  IF ONE IS       @Y30SSFR*/
*            /*  PRESENT, SUBTRACT ONE FROM THE TOTAL        @Y30SSFR*/
*            /*  NUMBER OF THINGS TO BE EXPORTED.            @Y30SSFR*/
*            /*  AIX'S OVER CLUSTERS DO NOT GET EXPORTED.    @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0531
*              IF FTYPE = CTGTPTH                          /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         B     @RC00470                                            0531
@RF00470 CLI   FTYPE(FNMPTR),C'R'                                  0531
         BNE   @RF00531                                            0531
*                  PATHFLAG = ON;                          /*@Y30SSFR*/
         OI    PATHFLAG,B'00100000'                                0532
*                ELSE                                      /*@Y30SSFR*/
*                  IF FTYPE = CTGTAIX                      /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         B     @RC00531                                            0533
@RF00531 CLI   FTYPE(FNMPTR),C'G'                                  0533
         BNE   @RF00533                                            0533
*                      NUMOBJCT = NUMOBJCT - 1;            /*@Y30SSFR*/
         BCTR  NUMOBJCT,0                                          0534
*                    ELSE ;                                /*@Y30SSFR*/
*                                                                  0535
@RF00533 DS    0H                                                  0536
*          FNMPTR = FNMPTR + LNAMEDS;                      /*@Y30SSFR*/
@RC00531 DS    0H                                                  0536
@RC00470 AL    FNMPTR,@CF00043                                     0536
*        END ASSOCLP;                                      /*@Y30SSFR*/
*                                                                  0537
         AL    I,@CF00220                                          0537
@DE00467 CH    I,NUMOBJ                                            0537
         BNH   @DL00467                                            0537
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SET THE NUMBER OF OBJECTS TO BE EXPORTED TO BE  @Y30SSFR*/
*        /*  THE NUMBER OF OBJECTS ASSOCIATED WITH THE ENTRY @Y30SSFR*/
*        /*  MINUS THE NUMBER OF AIX'S ASSOCIATED.           @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0538
*        NUMOBJ = NUMOBJCT;                                /*@Y30SSFR*/
*                                                                  0538
         STH   NUMOBJCT,NUMOBJ                                     0538
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INDICATE HOW MANY CPL'S HAVE BEEN BUILT AND     @Y30SSFR*/
*        /*  ARE TO BE WRITTEN TO THE PORTABILITY DATA       @Y30SSFR*/
*        /*  SET.                                            @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0539
*        IF KSDSFLAG = ON                                  /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         TM    KSDSFLAG,B'01000000'                                0539
         BNO   @RF00539                                            0539
*            NUMCPL = 3;                                   /*@Y30SSFR*/
         LA    NUMCPL,3                                            0540
*          ELSE                                            /*@Y30SSFR*/
*            NUMCPL = 2;                                   /*@Y30SSFR*/
         B     @RC00539                                            0541
@RF00539 LA    NUMCPL,2                                            0541
*        /************************************************************/
*        /*                                                          */
*        /*  OPEN OUTPUT DATA SET - THE PORTABILITY DATA SET         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0542
*        IF RECSZ = 0                                              0542
*          THEN                                                    0542
@RC00539 L     @07,RECSZ                                           0542
         LTR   @07,@07                                             0542
         BNZ   @RF00542                                            0542
*            DO;                                                   0543
*                                                                  0543
*            /********************************************************/
*            /*                                                      */
*            /*  IF NO VALID LRECL SIZE WAS SET, THE CATALOG MUST BE */
*            /*  IN ERROR.  SET ERROR MESSAGE NUMBER AND RETURN      */
*            /*                                                      */
*            /********************************************************/
*                                                                  0544
*            DEFSTID = NOCTFLD;                                    0544
         LA    DEFSTID,4                                           0544
*            RETURN CODE(LASTCC12);                                0545
         LA    @15,12                                              0545
         L     @14,@SA00002                                        0545
         LM    @00,@05,@SA00002+8                                  0545
         LM    @07,@12,@SA00002+32                                 0545
         BR    @14                                                 0545
*            END;                                                  0546
*                                                                  0546
*        IF ADDR(OUTDD) = NULLPTR                          /*@OZ15686*/
*          THEN                                            /*@OZ15686*/
@RF00542 L     @07,@PC00001+4                                      0547
         L     @04,FDTPTR+12(,@07)                                 0547
         LTR   @04,@04                                             0547
         BNZ   @RF00547                                            0547
*            CALL OPENPROC('O',NULLPARM,ADDR(OUTDSVAL),    /*@OZ15686*/
*              RECSZ,BLKSIZ,ADDR(POUTIOCS));               /*@OZ15686*/
         LA    @04,@CC01155                                        0548
         ST    @04,@AL00001                                        0548
         LA    @04,NULLPARM                                        0548
         ST    @04,@AL00001+4                                      0548
         L     @07,FDTPTR+68(,@07)                                 0548
         LA    @07,OUTDSVAL(,@07)                                  0548
         ST    @07,@AFTEMPS                                        0548
         LA    @07,@AFTEMPS                                        0548
         ST    @07,@AL00001+8                                      0548
         LA    @07,RECSZ                                           0548
         ST    @07,@AL00001+12                                     0548
         LA    @07,BLKSIZ                                          0548
         ST    @07,@AL00001+16                                     0548
         LA    @07,POUTIOCS                                        0548
         ST    @07,@AFTEMPS+4                                      0548
         LA    @07,@AFTEMPS+4                                      0548
         ST    @07,@AL00001+20                                     0548
         LA    @01,@AL00001                                        0548
         BAL   @14,OPENPROC                                        0548
*           ELSE                                           /*@OZ15686*/
*            CALL OPENPROC('O',ADDR(OUTDDVAL),NULLPARM,    /*@Y30SSFR*/
*              RECSZ,BLKSIZ,ADDR(POUTIOCS));               /*@Y30SSFR*/
*                                                                  0549
         B     @RC00547                                            0549
@RF00547 LA    @07,@CC01155                                        0549
         ST    @07,@AL00001                                        0549
         L     @07,@PC00001+4                                      0549
         L     @07,FDTPTR+12(,@07)                                 0549
         LA    @07,OUTDDVAL(,@07)                                  0549
         ST    @07,@AFTEMPS                                        0549
         LA    @07,@AFTEMPS                                        0549
         ST    @07,@AL00001+4                                      0549
         LA    @07,NULLPARM                                        0549
         ST    @07,@AL00001+8                                      0549
         LA    @07,RECSZ                                           0549
         ST    @07,@AL00001+12                                     0549
         LA    @07,BLKSIZ                                          0549
         ST    @07,@AL00001+16                                     0549
         LA    @07,POUTIOCS                                        0549
         ST    @07,@AFTEMPS+4                                      0549
         LA    @07,@AFTEMPS+4                                      0549
         ST    @07,@AL00001+20                                     0549
         LA    @01,@AL00001                                        0549
         BAL   @14,OPENPROC                                        0549
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL         */
*        /*  RETURN TO CALLING PROCESSOR WITH ERROR INDICATED        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0550
*        RESPECIFY RTNREG RSTD;                                    0550
@RC00547 DS    0H                                                  0551
*        TESTRC = RTNREG;                                          0551
         LR    TESTRC,RTNREG                                       0551
*        RESPECIFY RTNREG UNRSTD;                                  0552
*        IF TESTRC ^= 0                                            0553
*          THEN                                                    0553
         LTR   TESTRC,TESTRC                                       0553
         BZ    @RF00553                                            0553
*            RETURN CODE(LASTCC12);                                0554
         LA    @15,12                                              0554
         L     @14,@SA00002                                        0554
         LM    @00,@05,@SA00002+8                                  0554
         LM    @07,@12,@SA00002+32                                 0554
         BR    @14                                                 0554
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */
*        /*  AREA RETURNED BY LOCATE                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0555
*        OLDERID2 = NEWERID2;                                      0555
@RF00553 L     @07,@PC00001                                        0555
         L     @04,GDTTR2(,@07)                                    0555
         MVC   @TS00001(95),NEWERID2(@04)                          0555
         MVC   OLDERID2(95,@04),@TS00001                           0555
*        NEWID2 = 'XPWC';                                          0556
*                                                                  0556
         MVC   NEWID2(4,@04),@CC01156                              0556
*        /************************************************************/
*        /*                                                          */
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR        *
*        /*                                                          */
*        /************************************************************/
*                                                                  0557
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);
*                                                                  0557
         MVC   @AL00001+4(16),@AL00557                             0557
         ST    @07,@AL00001                                        0557
         LA    @04,CONRCPTR                                        0557
         ST    @04,@AL00001+8                                      0557
         L     @15,GDTGPL(,@07)                                    0557
         LA    @01,@AL00001                                        0557
         BALR  @14,@15                                             0557
*        RESPECIFY RTNREG RSTD;                                    0558
*        TESTRC = RTNREG;                                          0559
         LR    TESTRC,RTNREG                                       0559
*        RESPECIFY RTNREG UNRSTD;                                  0560
*        IF TESTRC ^= 0                                            0561
*          THEN                                                    0561
         LTR   TESTRC,TESTRC                                       0561
         BZ    @RF00561                                            0561
*            DO;                                                   0562
*            DARGSMOD = UNIVMSG;                                   0563
         L     @07,DDSTRU                                          0563
         MVC   DARGSMOD(3,@07),@CC00930                            0563
*            DEFSTID = NOSTORAG;                                   0564
         LA    DEFSTID,4                                           0564
*            RETURN CODE(LASTCC12);                                0565
         LA    @15,12                                              0565
         L     @14,@SA00002                                        0565
         LM    @00,@05,@SA00002+8                                  0565
         LM    @07,@12,@SA00002+32                                 0565
         BR    @14                                                 0565
*            END;                                                  0566
*                                                                  0566
*        /************************************************************/
*        /*                                                          */
*        /*  THE FIRST RECORD WRITTEN TO THE PORTABILITY DATA SET IS */
*        /*  THE TIME STAMP INDICATING THE EXACT MOMENT WHEN EXPORT  */
*        /*  OCCURRED.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0567
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          0567
*                                                                  0567
@RF00561 L     @07,@PC00001                                        0567
         ST    @07,@AL00001                                        0567
         LA    @04,8                                               0567
         AL    @04,CONRCPTR                                        0567
         LA    @15,TIMEODAY(,@04)                                  0567
         ST    @15,@AL00001+4                                      0567
         LA    @04,TIMEDATE(,@04)                                  0567
         ST    @04,@AL00001+8                                      0567
         LA    @04,FORMAT                                          0567
         ST    @04,@AL00001+12                                     0567
         MVI   @AL00001+12,X'80'                                   0567
         L     @15,GDTTIM(,@07)                                    0567
         LA    @01,@AL00001                                        0567
         BALR  @14,@15                                             0567
*        PORTTIME = TIMEODAY;                                      0568
         L     @07,CONRCPTR                                        0568
         LA    @04,8                                               0568
         ALR   @04,@07                                             0568
         MVC   PORTTIME(8),TIMEODAY(@04)                           0568
*        PORTDATE = TIMEDATE;                                      0569
*                                                                  0569
         MVC   PORTDATE(8),TIMEDATE(@04)                           0569
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               0570
         MVC   HEADLN(2,@07),@CH01340                              0570
*        HEADFLG1 = HDFL1CAT;                                      0571
         MVI   HEADFLG1(@07),X'FF'                                 0571
*        HEADFLG2 = HDFL2TSP;                                      0572
*                                                                  0572
         MVI   HEADFLG2(@07),X'FF'                                 0572
*        /************************************************************/
*        /*                                                          */
*        /*  IF INHIBITTARGET HAS BEEN SPECIFIED, THE DSATTR FIELDS  */
*        /*  MUST BE CHANGED TO SPECIFY INHIBIT UPDATE AT IMPORT TIME*/
*        /*  A FLAG WILL BE SET IN THE TIME STAMP RECORD, SO THAT    */
*        /*  IMPORT WILL KNOW TO ALTER THE DSATTR FIELDS AFTER THE   */
*        /*  DATA SET HAS BEEN LOADED.                               */
*        /*  ALSO PUT THE NUMBER OF CLUSTER COMPONENTS IN THE RECORD */
*        /*                                                          */
*        /************************************************************/
*                                                                  0573
*        IF ADDR(INHBT) ^= NULLPTR                                 0573
*          THEN                                                    0573
         L     @07,@PC00001+4                                      0573
         L     @07,FDTPTR+32(,@07)                                 0573
         LTR   @07,@07                                             0573
         BZ    @RF00573                                            0573
*            TEXINHTG = ON;                                        0574
*                                                                  0574
         OI    TEXINHTG(@04),B'01000000'                           0574
*        NUMOBJ = NUMOBJ + 1;                              /*@Y30SSFR*/
@RF00573 LA    @07,1                                               0575
         AH    @07,NUMOBJ                                          0575
         STH   @07,NUMOBJ                                          0575
*        TEXOJCT = NUMOBJ;                                 /*@Y30SSFR*/
*                                                                  0576
         LA    @04,8                                               0576
         AL    @04,CONRCPTR                                        0576
         STC   @07,TEXOJCT(,@04)                                   0576
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THE PATHFLAG IS ON, SET THE TEXASSOC BIT, AND@Y30SSFR*/
*        /*  TEST THE KSDSFLAG.  IF THAT FLAG IS ALSO ON,    @Y30SSFR*/
*        /*  SET THE TEXBASE BIT.                            @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0577
*        IF PATHFLAG = ON                                  /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         TM    PATHFLAG,B'00100000'                                0577
         BNO   @RF00577                                            0577
*            DO;                                           /*@Y30SSFR*/
*            TEXASSOC = ON;                                /*@Y30SSFR*/
         OI    TEXASSOC(@04),B'00100000'                           0579
*            IF KSDSFLAG = ON                              /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         TM    KSDSFLAG,B'01000000'                                0580
         BNO   @RF00580                                            0580
*                TEXBASE = ON;                             /*@Y30SSFR*/
         OI    TEXBASE(@04),B'00010000'                            0581
*            END;                                          /*@Y30SSFR*/
*                                                                  0582
@RF00580 DS    0H                                                  0583
*        TEXFLG2 = EXPTYPE1;                                       0583
*                                                                  0583
@RF00577 L     @07,CONRCPTR                                        0583
         MVC   TEXFLG2+8(1,@07),EXPTYPE1                           0583
*        TOTLEN = HEADLN;                                          0584
*                                                                  0584
         LH    @07,HEADLN(,@07)                                    0584
         ST    @07,TOTLEN                                          0584
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */
*        /*  IF AN ERROR IS ENCOUNTERED, RETURN TO THE CALLING       */
*        /*  PROCESSOR.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0585
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            0585
*                                                                  0585
         LA    @07,TOTLEN                                          0585
         ST    @07,@AL00001                                        0585
         LA    @07,CONRCPTR                                        0585
         ST    @07,@AL00001+4                                      0585
         LA    @01,@AL00001                                        0585
         BAL   @14,PUTPROC                                         0585
*        RESPECIFY RTNREG RSTD;                                    0586
*        TESTRC = RTNREG;                                          0587
         LR    TESTRC,RTNREG                                       0587
*        RESPECIFY RTNREG UNRSTD;                                  0588
*        IF TESTRC ^= 0                                            0589
*          THEN                                                    0589
         LTR   TESTRC,TESTRC                                       0589
         BZ    @RF00589                                            0589
*            RETURN CODE(LASTCC12);                                0590
*                                                                  0590
         LA    @15,12                                              0590
         L     @14,@SA00002                                        0590
         LM    @00,@05,@SA00002+8                                  0590
         LM    @07,@12,@SA00002+32                                 0590
         BR    @14                                                 0590
*        /************************************************************/
*        /*                                                          */
*        /*  NOW SELECT EACH CPL AND INTERROGATE FPL'S FOR FIELD     */
*        /*  INFORMATION                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0591
*        DO INDXCPL = 1 TO NUMCPL;                        /*@Y30SSFR*/
*                                                                  0591
@RF00589 LA    @07,1                                               0591
         B     @DE00591                                            0591
@DL00591 DS    0H                                                  0592
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,   @Y30SSFR*/
*          /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.         @Y30SSFR*/
*          /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN   @Y30SSFR*/
*          /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE    @Y30SSFR*/
*          /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY    @Y30SSFR*/
*          /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO    @Y30SSFR*/
*          /*  THE PORTABILITY DATA SET.                     @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  0592
*          IF AIXFLAG = ON & INDXCPL =1                    /*@Y30SSFR*/
*            THEN                                          /*@Y30SSFR*/
         TM    AIXFLAG,B'10000000'                                 0592
         BNO   @RF00592                                            0592
         C     @07,@CF00220                                        0592
         BNE   @RF00592                                            0592
*              DO;                                         /*@Y30SSFR*/
*              CALL CONTRBL(INDXCPL,CTGTAIX);              /*@Y30SSFR*/
         LA    @07,INDXCPL                                         0594
         ST    @07,@AL00001                                        0594
         LA    @07,@CC00738                                        0594
         ST    @07,@AL00001+4                                      0594
         LA    @01,@AL00001                                        0594
         BAL   @14,CONTRBL                                         0594
*              RESPECIFY RTNREG RSTD;                              0595
*              TESTRC = RTNREG;                                    0596
         LR    TESTRC,RTNREG                                       0596
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/
*              IF TESTRC ^= 0                              /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0598
         BZ    @RF00598                                            0598
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/
         LA    @15,12                                              0599
         L     @14,@SA00002                                        0599
         LM    @00,@05,@SA00002+8                                  0599
         LM    @07,@12,@SA00002+32                                 0599
         BR    @14                                                 0599
*              END;                                        /*@Y30SSFR*/
*            ELSE                                          /*@Y30SSFR*/
*              DO;                                         /*@Y30SSFR*/
         B     @RC00592                                            0601
@RF00592 DS    0H                                                  0602
*              CALL CONTRBL(INDXCPL,'N');                  /*@Y30SSFR*/
         LA    @07,INDXCPL                                         0602
         ST    @07,@AL00001                                        0602
         LA    @07,@CC01159                                        0602
         ST    @07,@AL00001+4                                      0602
         LA    @01,@AL00001                                        0602
         BAL   @14,CONTRBL                                         0602
*              RESPECIFY RTNREG RSTD;                              0603
*              TESTRC = RTNREG;                                    0604
         LR    TESTRC,RTNREG                                       0604
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/
*              IF TESTRC ^= 0                              /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0606
         BZ    @RF00606                                            0606
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/
         LA    @15,12                                              0607
         L     @14,@SA00002                                        0607
         LM    @00,@05,@SA00002+8                                  0607
         LM    @07,@12,@SA00002+32                                 0607
         BR    @14                                                 0607
*              END;                                        /*@Y30SSFR*/
*                                                                  0608
@RF00606 DS    0H                                                  0609
*        END;                                              /*@Y30SSFR*/
*                                                                  0609
@RC00592 LA    @07,1                                               0609
         AL    @07,INDXCPL                                         0609
@DE00591 ST    @07,INDXCPL                                         0609
         CR    @07,NUMCPL                                          0609
         BNH   @DL00591                                            0609
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  TEST TO DETERMINE IF THERE ARE PATH             @Y30SSFR*/
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING        @Y30SSFR*/
*        /*  LOCATES FOR THE PATHS, AND WRITING OUT THE      @Y30SSFR*/
*        /*  CATALOG INFORMATION TO THE PORTABILITY          @Y30SSFR*/
*        /*  DATA SET.                                       @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0610
*        IF PATHFLAG = ON                                          0610
*          THEN                                                    0610
         TM    PATHFLAG,B'00100000'                                0610
         BNO   @RF00610                                            0610
*PTHDEF:     DO;                                           /*@Y30SSFR*/
*                                                                  0611
PTHDEF   DS    0H                                                  0612
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET A FLAG TO INDICATE THAT WE ARE PROCESS- @Y30SSFR*/
*            /*  ING THE FIRST PATH.  LOOP THROUGH THE PATHS @Y30SSFR*/
*            /*  DOING LOCATES AND WRITING CATALOG           @Y30SSFR*/
*            /*  INFORMATION TO THE PORTABILITY DATA SET.    @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0612
*            FIRFLAG = ON;                                 /*@Y30SSFR*/
*                                                                  0612
         OI    FIRFLAG,B'00001000'                                 0612
*PATHREC:    DO I = NUMCPL+1 TO NUMASSOC+1;                /*@Y30SSFR*/
PATHREC  LA    I,1                                                 0613
         ALR   I,NUMCPL                                            0613
         B     @DE00613                                            0613
@DL00613 DS    0H                                                  0614
*              CTGPLPTR = PTRCPL(1);                       /*@Y30SSFR*/
         L     @07,PTRCPL                                          0614
         ST    @07,CTGPLPTR                                        0614
*              CTGFLPTR = CTGFIELD(INAMEDS);               /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD+84(,@07)                          0615
*              FNMPTR = CTGFLPT(1) + LNAMEDS *             /*@Y30SSFR*/
*                (I - 2);                                  /*@Y30SSFR*/
*                                                                  0616
         LR    FNMPTR,I                                            0616
         BCTR  FNMPTR,0                                            0616
         BCTR  FNMPTR,0                                            0616
         SLA   FNMPTR,2                                            0616
         AL    FNMPTR,CTGFLPT(,CTGFLPTR)                           0616
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  TEST TO DETERMINE IF THE ASSOCIATED       @Y30SSFR*/
*              /*  OBJECT IS A PATH.                         @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0617
*              IF FTYPE = CTGTPTH                          /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
*                                                                  0617
         CLI   FTYPE(FNMPTR),C'R'                                  0617
         BNE   @RF00617                                            0617
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  TEST TO DETERMINE WHETHER THIS IS THE @Y30SSFR*/
*                  /*  FIRST PATH TO BE PROCESSED.           @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  0618
*                  IF FIRFLAG = ON                         /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         TM    FIRFLAG,B'00001000'                                 0618
         BNO   @RF00618                                            0618
*FIRPATH:              DO;                                 /*@Y30SSFR*/
FIRPATH  DS    0H                                                  0620
*                      FIRFLAG = OFF;                      /*@Y30SSFR*/
*                                                                  0620
         NI    FIRFLAG,B'11110111'                                 0620
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  IF THIS IS THE FIRST PATH TO BE   @Y30SSFR*/
*                      /*  PROCESSED CALL LOCPROC TO BUILD   @Y30SSFR*/
*                      /*  THE CPL AND FPL'S.                @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0621
*                      CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,       0621
*                        FIELDLST,ONUM,                    /*@Y30SSFR*/
*                        PTRCPL(PTHCPLNO));                /*@Y30SSFR*/
*                                                                  0621
         LA    @07,NULLPARM                                        0621
         ST    @07,@AL00001                                        0621
         LA    @07,FNAME(,FNMPTR)                                  0621
         ST    @07,@AL00001+4                                      0621
         LA    @07,PTRCTACB                                        0621
         ST    @07,@AL00001+8                                      0621
         LA    @07,FIELDLST                                        0621
         ST    @07,@AL00001+12                                     0621
         LA    @07,ONUM                                            0621
         ST    @07,@AL00001+16                                     0621
         LA    @07,PTRCPL+16                                       0621
         ST    @07,@AL00001+20                                     0621
         LA    @01,@AL00001                                        0621
         BAL   @14,LOCPROC                                         0621
*                      RESPECIFY RTNREG RSTD;                      0622
*                      TESTRC = RTNREG;                            0623
         LR    TESTRC,RTNREG                                       0623
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/
*                                                                  0624
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0625
         BZ    @RF00625                                            0625
*                          RETURN CODE(LASTCC04);          /*@Y30SSFR*/
*                                                                  0626
         LA    @15,4                                               0626
         L     @14,@SA00002                                        0626
         LM    @00,@05,@SA00002+8                                  0626
         LM    @07,@12,@SA00002+32                                 0626
         BR    @14                                                 0626
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  SAVE THE CPL AND FPL'S JUST       @Y30SSFR*/
*                      /*  CONSTRUCTED FOR USE WITH OTHER    @Y30SSFR*/
*                      /*  PATHS.                            @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0627
*                      SAPLLEN = LENGTH(SAVEPL);           /*@Y30SSFR*/
*                                                                  0627
@RF00625 MVC   SAPLLEN(2),@CH01341                                 0627
*                      CALL MVDAPROC(SAPLLEN,PTRCPL(PTHCPLNO),     0628
*                        ADDR(SAVEPL),NULLPARM);           /*@Y30SSFR*/
*                                                                  0628
         LA    @07,SAPLLEN                                         0628
         ST    @07,@AL00001                                        0628
         LA    @07,PTRCPL+16                                       0628
         ST    @07,@AL00001+4                                      0628
         LA    @07,SAVEPL                                          0628
         ST    @07,@AFTEMPS                                        0628
         LA    @07,@AFTEMPS                                        0628
         ST    @07,@AL00001+8                                      0628
         LA    @07,NULLPARM                                        0628
         ST    @07,@AL00001+12                                     0628
         LA    @01,@AL00001                                        0628
         BAL   @14,MVDAPROC                                        0628
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG   @Y30SSFR*/
*                      /*  TO DO THE ACTUAL LOCATE.          @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0629
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));    /*@Y30SSFR*/
*                                                                  0629
         LA    @07,PTRCPL+16                                       0629
         ST    @07,@AL00001                                        0629
         LA    @01,@AL00001                                        0629
         BAL   @14,CTLGPROC                                        0629
*                      RESPECIFY RTNREG RSTD;                      0630
*                      TESTRC = RTNREG;                            0631
         LR    TESTRC,RTNREG                                       0631
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/
*                                                                  0632
*                      IF TESTRC ^= 0                              0633
*                        THEN                                      0633
         LTR   TESTRC,TESTRC                                       0633
         BZ    @RF00633                                            0633
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/
*                                                                  0634
         LA    @15,12                                              0634
         L     @14,@SA00002                                        0634
         LM    @00,@05,@SA00002+8                                  0634
         LM    @07,@12,@SA00002+32                                 0634
         BR    @14                                                 0634
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CALL CONTRBL TO BUILD THE CONTROL @Y30SSFR*/
*                      /*  RECORD FOR THE CURRENT PATH AND   @Y30SSFR*/
*                      /*  TO WRITE IT AND THE CATALOG WORK  @Y30SSFR*/
*                      /*  AREA OUT THE PORTABILITY DATA SET @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0635
*                      CALL CONTRBL(PTHCPLNO,CTGTPTH);     /*@Y30SSFR*/
*                                                                  0635
@RF00633 LA    @01,@AL00635                                        0635
         BAL   @14,CONTRBL                                         0635
*                      RESPECIFY RTNREG RSTD;                      0636
*                      TESTRC = RTNREG;                            0637
         LR    TESTRC,RTNREG                                       0637
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/
*                                                                  0638
*                      IF TESTRC ^= 0                              0639
*                        THEN                                      0639
         LTR   TESTRC,TESTRC                                       0639
         BZ    @RF00639                                            0639
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/
*                                                                  0640
         LA    @15,12                                              0640
         L     @14,@SA00002                                        0640
         LM    @00,@05,@SA00002+8                                  0640
         LM    @07,@12,@SA00002+32                                 0640
         BR    @14                                                 0640
*                      END FIRPATH;                        /*@Y30SSFR*/
*                                                                  0641
*                    ELSE                                          0642
*                                                                  0642
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  THIS IS NOT THE FIRST PATH TO BE  @Y30SSFR*/
*                      /*  PROCESSED.  RESTORE THE CPL AND   @Y30SSFR*/
*                      /*  FPL'S, MODIFY THE CPL TO DO A     @Y30SSFR*/
*                      /*  LOCATE ON THE APPROPRIATE PATH    @Y30SSFR*/
*                      /*  AND CALL CATALOG.                 @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0642
*NFIRPATH:             DO;                                 /*@Y30SSFR*/
         B     @RC00618                                            0642
@RF00618 DS    0H                                                  0642
NFIRPATH DS    0H                                                  0643
*                      CTGPLPTR = PTRCPL(PTHCPLNO);        /*@Y30SSFR*/
         L     @07,PTRCPL+16                                       0643
         ST    @07,CTGPLPTR                                        0643
*                      CALL MVDAPROC(SAPLLEN,ADDR(SAVEPL),         0644
*                        PTRCPL(PTHCPLNO),NULLPARM);       /*@Y30SSFR*/
*                                                                  0644
         LA    @07,SAPLLEN                                         0644
         ST    @07,@AL00001                                        0644
         LA    @07,SAVEPL                                          0644
         ST    @07,@AFTEMPS                                        0644
         LA    @07,@AFTEMPS                                        0644
         ST    @07,@AL00001+4                                      0644
         LA    @07,PTRCPL+16                                       0644
         ST    @07,@AL00001+8                                      0644
         LA    @07,NULLPARM                                        0644
         ST    @07,@AL00001+12                                     0644
         LA    @01,@AL00001                                        0644
         BAL   @14,MVDAPROC                                        0644
*                      CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),     0645
*                        NULLPARM,CTGWKA,SETZERO);         /*@Y30SSFR*/
         MVC   @AL00001(16),@AL00645                               0645
         L     @07,CTGPLPTR                                        0645
         LA    @07,CTGWKA(,@07)                                    0645
         ST    @07,@AL00001+8                                      0645
         LA    @01,@AL00001                                        0645
         BAL   @14,MVDAPROC                                        0645
*                      AREALN = WKAREALN;                  /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        0646
         L     @02,CTGWKA(,@07)                                    0646
         MVC   AREALN(2,@02),@CH00894                              0646
*                      CTGENT = ADDR(FNAME);               /*@Y30SSFR*/
*                                                                  0647
         LA    @02,FNAME(,FNMPTR)                                  0647
         ST    @02,CTGENT(,@07)                                    0647
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CLEAR THE FPL POINTERS SET BY     @Y30SSFR*/
*                      /*  THE PREVIOUS LOCATE.              @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0648
*                      DO CLRFDCTR = 1 TO ONUM;            /*@Y30SSFR*/
         LA    CLRFDCTR,1                                          0648
         B     @DE00648                                            0648
@DL00648 DS    0H                                                  0649
*                        CTGFLPTR = CTGFIELD(CLRFDCTR);    /*@Y30SSFR*/
         LR    @07,CLRFDCTR                                        0649
         SLA   @07,2                                               0649
         L     @01,CTGPLPTR                                        0649
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        0649
*                        CTGFLNG(1) = 0;                   /*@Y30SSFR*/
         SLR   @07,@07                                             0650
         ST    @07,CTGFLNG(,CTGFLPTR)                              0650
*                        CTGFLPT(1) = NULLPTR;             /*@Y30SSFR*/
         ST    @07,CTGFLPT(,CTGFLPTR)                              0651
*                      END;                                /*@Y30SSFR*/
*                                                                  0652
         AL    CLRFDCTR,@CF00220                                   0652
@DE00648 SLR   @07,@07                                             0652
         IC    @07,ONUM                                            0652
         CR    CLRFDCTR,@07                                        0652
         BNH   @DL00648                                            0652
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG   @Y30SSFR*/
*                      /*  TO DO THE ACTUAL LOCATE.          @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0653
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));    /*@Y30SSFR*/
*                                                                  0653
         LA    @07,PTRCPL+16                                       0653
         ST    @07,@AL00001                                        0653
         LA    @01,@AL00001                                        0653
         BAL   @14,CTLGPROC                                        0653
*                      RESPECIFY RTNREG RSTD;                      0654
*                      TESTRC = RTNREG;                            0655
         LR    TESTRC,RTNREG                                       0655
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/
*                                                                  0656
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0657
         BZ    @RF00657                                            0657
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/
*                                                                  0658
         LA    @15,12                                              0658
         L     @14,@SA00002                                        0658
         LM    @00,@05,@SA00002+8                                  0658
         LM    @07,@12,@SA00002+32                                 0658
         BR    @14                                                 0658
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CALL CONTRBL TO BUILD THE CONTROL @Y30SSFR*/
*                      /*  RECORD FOR THE CURRENT PATH AND   @Y30SSFR*/
*                      /*  TO WRITE IT AND THE CATALOG WORK  @Y30SSFR*/
*                      /*  AREA OUT THE PORTABILITY DATA SET @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  0659
*                      CALL CONTRBL(PTHCPLNO,CTGTPTH);     /*@Y30SSFR*/
*                                                                  0659
@RF00657 LA    @01,@AL00659                                        0659
         BAL   @14,CONTRBL                                         0659
*                      RESPECIFY RTNREG RSTD;                      0660
*                      TESTRC = RTNREG;                            0661
         LR    TESTRC,RTNREG                                       0661
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0663
         BZ    @RF00663                                            0663
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/
*                                                                  0664
         LA    @15,12                                              0664
         L     @14,@SA00002                                        0664
         LM    @00,@05,@SA00002+8                                  0664
         LM    @07,@12,@SA00002+32                                 0664
         BR    @14                                                 0664
*                      END NFIRPATH;                       /*@Y30SSFR*/
*                                                                  0665
*                ELSE ;                                    /*@Y30SSFR*/
*                                                                  0666
@RF00617 DS    0H                                                  0667
*            END PATHREC;                                  /*@Y30SSFR*/
*                                                                  0667
@RC00617 AL    I,@CF00220                                          0667
@DE00613 LA    @07,1                                               0667
         AH    @07,NUMASSOC                                        0667
         CR    I,@07                                               0667
         BNH   @DL00613                                            0667
*            END PTHDEF;                                   /*@Y30SSFR*/
*                                                                  0668
*          ELSE  ;                                         /*@Y30SSFR*/
@RF00610 DS    0H                                                  0670
*        /************************************************************/
*        /*                                                          */
*        /*  CALL RECPROC TO COPY THE CLUSTER DATA SET TO THE        */
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */
*        /*  CALLING PROCESSOR.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0670
*        CALL RECPROC;                                             0670
*                                                                  0670
         BAL   @14,RECPROC                                         0670
*        RESPECIFY RTNREG RSTD;                                    0671
*        TESTRC = RTNREG;                                          0672
         LR    TESTRC,RTNREG                                       0672
*        RESPECIFY RTNREG UNRSTD;                                  0673
*        IF TESTRC ^= 0                                            0674
*          THEN                                                    0674
         LTR   TESTRC,TESTRC                                       0674
         BZ    @RF00674                                            0674
*            RETURN CODE(LASTCC12);                                0675
*                                                                  0675
         LA    @15,12                                              0675
         L     @14,@SA00002                                        0675
         LM    @00,@05,@SA00002+8                                  0675
         LM    @07,@12,@SA00002+32                                 0675
         BR    @14                                                 0675
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE OUTPUT DATA SET- PORTABILITY DATA SET             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0676
*        CALL IDCIOCL0 (GDTTBL,POUTIOCS);                          0676
*                                                                  0676
@RF00674 L     @07,@PC00001                                        0676
         ST    @07,@AL00001                                        0676
         LA    @04,POUTIOCS                                        0676
         ST    @04,@AL00001+4                                      0676
         MVI   @AL00001+4,X'80'                                    0676
         L     @15,GDTCLS(,@07)                                    0676
         LA    @01,@AL00001                                        0676
         BALR  @14,@15                                             0676
*        RESPECIFY RTNREG RSTD;                                    0677
*        TESTRC = RTNREG;                                          0678
         LR    TESTRC,RTNREG                                       0678
*        RESPECIFY RTNREG UNRSTD;                                  0679
*        POUTIOCS = NULLPTR;                                       0680
         SLR   @07,@07                                             0680
         ST    @07,POUTIOCS                                        0680
*        IF TESTRC ^= 0                                            0681
*          THEN                                                    0681
*                                                                  0681
         CR    TESTRC,@07                                          0681
         BE    @RF00681                                            0681
*            /********************************************************/
*            /*                                                      */
*            /*  IF CLOSE FAILED, SET RETURN CODE TO INDICATE        */
*            /*  FAILURE AND RETURN TO MAIN LINE OF CODE             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0682
*            RETURN CODE(LASTCC12);                                0682
*                                                                  0682
         LA    @15,12                                              0682
         L     @14,@SA00002                                        0682
         LM    @00,@05,@SA00002+8                                  0682
         LM    @07,@12,@SA00002+32                                 0682
         BR    @14                                                 0682
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE MESSAGE - PORTABLE DATA SET CREATED SUCCESSFULLY. */
*        /*                                                          */
*        /************************************************************/
*                                                                  0683
*        DARGCNT = 2;                                              0683
@RF00681 LA    @07,2                                               0683
         L     @04,DDSTRU                                          0683
         STH   @07,DARGCNT(,@04)                                   0683
*        DARGINS(1) = 1;                                           0684
         MVC   DARGINS(2,@04),@CH00220                             0684
*        DARGINL(1) = LENGTH(PORTDATE);                            0685
         LA    @15,8                                               0685
         STH   @15,DARGINL(,@04)                                   0685
*        DARGDTM(1) = ADDR(PORTDATE);                              0686
         LA    @14,PORTDATE                                        0686
         ST    @14,DARGDTM(,@04)                                   0686
*        DARGINS(2) = 2;                                           0687
         STH   @07,DARGINS+8(,@04)                                 0687
*        DARGINL(2) = LENGTH(PORTTIME);                            0688
         STH   @15,DARGINL+8(,@04)                                 0688
*        DARGDTM(2) = ADDR(PORTTIME);                              0689
         LA    @07,PORTTIME                                        0689
         ST    @07,DARGDTM+8(,@04)                                 0689
*        DARGSENT = GOODPORT;                                      0690
*                                                                  0690
         MVI   DARGSENT(@04),X'05'                                 0690
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0691
*                                                                  0691
         L     @07,@PC00001                                        0691
         ST    @07,@AL00001                                        0691
         LA    @04,@CF00116                                        0691
         ST    @04,@AL00001+4                                      0691
         LA    @04,DDSTRU                                          0691
         ST    @04,@AL00001+8                                      0691
         MVI   @AL00001+8,X'80'                                    0691
         L     @15,GDTPRT(,@07)                                    0691
         LA    @01,@AL00001                                        0691
         BALR  @14,@15                                             0691
*        DARGLIST = ''B;                                           0692
         L     @07,DDSTRU                                          0692
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0692
*        DARGSMOD = EXPMSG;                                        0693
*                                                                  0693
         MVC   DARGSMOD(3,@07),@CC00914                            0693
*        /************************************************************/
*        /*                                                          */
*        /*  IF PASSWORDS HAVE BEEN SUPPRESSED BY LOCATE, ISSUE      */
*        /*  MESSAGE TO USER                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0694
*        IF SUPPRESS = ON                                          0694
*          THEN                                                    0694
         TM    SUPPRESS,B'10000000'                                0694
         BNO   @RF00694                                            0694
*            DO;                                                   0695
*            DARGSENT = PASSUPRS;                                  0696
*                                                                  0696
         MVI   DARGSENT(@07),X'06'                                 0696
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0697
*                                                                  0697
         L     @07,@PC00001                                        0697
         ST    @07,@AL00001                                        0697
         LA    @04,@CF00116                                        0697
         ST    @04,@AL00001+4                                      0697
         LA    @04,DDSTRU                                          0697
         ST    @04,@AL00001+8                                      0697
         MVI   @AL00001+8,X'80'                                    0697
         L     @15,GDTPRT(,@07)                                    0697
         LA    @01,@AL00001                                        0697
         BALR  @14,@15                                             0697
*            DARGLIST = ''B;                                       0698
         L     @07,DDSTRU                                          0698
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0698
*            DARGSMOD = EXPMSG;                                    0699
         MVC   DARGSMOD(3,@07),@CC00914                            0699
*            END;                                                  0700
*                                                                  0700
*                                                                  0701
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS DISPOSITION OPTIONS - PERMANENT OR TEMPORARY    */
*        /*  EXPORT.  FOR PERMANENT ISSUE A CATALOG DELETE ON CLUSTER*/
*        /*  NAME.  FOR TEMPORARY ISSUE A CATALOG ALTER              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0701
*         IF ADDR(PERM) ^= NULLPTR                                 0701
*          THEN                                                    0701
@RF00694 L     @07,@PC00001+4                                      0701
         L     @07,FDTPTR+24(,@07)                                 0701
         LTR   @07,@07                                             0701
         BZ    @RF00701                                            0701
*PERMP:      DO;                                                   0702
PERMP    DS    0H                                                  0703
*            OLDERID2 = NEWERID2;                                  0703
         L     @07,@PC00001                                        0703
         L     @07,GDTTR2(,@07)                                    0703
         MVC   @TS00001(95),NEWERID2(@07)                          0703
         MVC   OLDERID2(95,@07),@TS00001                           0703
*            NEWID2 = 'XPPM';                                      0704
*                                                                  0704
         MVC   NEWID2(4,@07),@CC01172                              0704
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS PERMANENT OPTION BY DELETING CLUSTER NAME   */
*            /*  IF THE DELETE IS NOT COMPLETED SUCCESSFULLY,        */
*            /*  RETURN TO THE CALLING PROCESSOR                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0705
*            IF AIXFLAG = ON                               /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         TM    AIXFLAG,B'10000000'                                 0705
         BNO   @RF00705                                            0705
*                CALL DELTPROC(CTGTAIX,ADDR(ENTVAL),       /*@Y30SSFR*/
*                  DCPLPTR);                               /*@Y30SSFR*/
         LA    @07,@CC00738                                        0706
         ST    @07,@AL00001                                        0706
         L     @07,@PC00001+4                                      0706
         L     @07,FDTPTR(,@07)                                    0706
         LA    @07,ENTVAL(,@07)                                    0706
         ST    @07,@AFTEMPS                                        0706
         LA    @07,@AFTEMPS                                        0706
         ST    @07,@AL00001+4                                      0706
         LA    @07,DCPLPTR                                         0706
         ST    @07,@AL00001+8                                      0706
         LA    @01,@AL00001                                        0706
         BAL   @14,DELTPROC                                        0706
*              ELSE                                        /*@Y30SSFR*/
*                CALL DELTPROC(CTGTCL,ADDR(ENTVAL),        /*@Y30SSFR*/
*                  DCPLPTR);                               /*@Y30SSFR*/
         B     @RC00705                                            0707
@RF00705 LA    @07,@CC00736                                        0707
         ST    @07,@AL00001                                        0707
         L     @07,@PC00001+4                                      0707
         L     @07,FDTPTR(,@07)                                    0707
         LA    @07,ENTVAL(,@07)                                    0707
         ST    @07,@AFTEMPS                                        0707
         LA    @07,@AFTEMPS                                        0707
         ST    @07,@AL00001+4                                      0707
         LA    @07,DCPLPTR                                         0707
         ST    @07,@AL00001+8                                      0707
         LA    @01,@AL00001                                        0707
         BAL   @14,DELTPROC                                        0707
*            RESPECIFY RTNREG RSTD;                                0708
@RC00705 DS    0H                                                  0709
*            TESTRC = RTNREG;                                      0709
         LR    TESTRC,RTNREG                                       0709
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*            IF TESTRC ^= 0                                        0711
*              THEN                                                0711
         LTR   TESTRC,TESTRC                                       0711
         BZ    @RF00711                                            0711
*                RETURN CODE(TESTRC);                      /*@Y30SSFR*/
         LR    @15,TESTRC                                          0712
         L     @14,@SA00002                                        0712
         LM    @00,@05,@SA00002+8                                  0712
         LM    @07,@12,@SA00002+32                                 0712
         BR    @14                                                 0712
*            END PERMP;                                            0713
*                                                                  0713
*          ELSE                                                    0714
*                                                                  0714
*            /********************************************************/
*            /*                                                      */
*            /*  TEMPORARY WAS INDICATED IN AMS COMMAND              */
*            /*  MODIFY DSATTR FIELDS IN CATALOG TO INDICATE         */
*            /*  TEMPORARY EXPORT (OPTIONALLY INHIBIT UPDATE).       */
*            /*                                                      */
*            /********************************************************/
*                                                                  0714
*TEMPLP:     DO INDX = 2 TO NUMCPL;                        /*@Y30SSFR*/
         B     @RC00701                                            0714
@RF00701 DS    0H                                                  0714
TEMPLP   LA    INDX,2                                              0714
         B     @DE00714                                            0714
@DL00714 DS    0H                                                  0715
*              CTGPLPTR = PTRCPL(INDX);                            0715
         LR    @07,INDX                                            0715
         SLA   @07,2                                               0715
         L     @07,PTRCPL-4(@07)                                   0715
         ST    @07,CTGPLPTR                                        0715
*              CTGFLPTR = CTGFIELD(IDSATTR);                       0716
         L     CTGFLPTR,CTGFIELD+8(,@07)                           0716
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR          0717
*                THEN                                              0717
         SLR   @07,@07                                             0717
         C     @07,CTGFLNG(,CTGFLPTR)                              0717
         BE    @RF00717                                            0717
         L     @03,CTGFLPT(,CTGFLPTR)                              0717
         CR    @03,@07                                             0717
         BE    @RF00717                                            0717
*                  DO;                                             0718
*                                                                  0718
*                  /**************************************************/
*                  /*                                                */
*                  /*  A DSATTR CATALOG FIELD EXISTS FOR THIS OBJECT */
*                  /*  SET THE APPROPRIATE FLAGS IN THE DSATTR FIELD */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0719
*                  IF FDSATTR ^= NOTINIT(1:2)              /*@Y30SSFR*/
*                    THEN                                          0719
         CLC   FDSATTR(2,@03),NOTINIT                              0719
         BE    @RF00719                                            0719
*                      DO;                                         0720
*                        FDSTMPEX = ON;                            0721
         OI    FDSTMPEX(@03),B'00000010'                           0721
*                        IF ADDR(INHBS) ^= NULLPTR                 0722
*                          THEN                                    0722
         L     @15,@PC00001+4                                      0722
         C     @07,FDTPTR+28(,@15)                                 0722
         BE    @RF00722                                            0722
*                            FDSINHUP = ON;                        0723
*                                                                  0723
         OI    FDSINHUP(@03),B'00000100'                           0723
*                  /**************************************************/
*                  /*                                                */
*                  /*  CALL ALTERPROC TO MODIFY THE CPL FOR AN ALTER */
*                  /*  THEN CALL CTLGPROC TO CALL CATALOG MANAGEMENT */
*                  /* IF ALTERPROC FAILS TO MODIFY THE CPL OR IF     */
*                  /*  CTLGPROC FAILS TO PERFORM THE ALTER -TERMINATE*/
*                  /*                                                */
*                  /**************************************************/
*                                                                  0724
*                  OLDERID2 = NEWERID2;                            0724
@RF00722 L     @07,@PC00001                                        0724
         L     @07,GDTTR2(,@07)                                    0724
         MVC   @TS00001(95),NEWERID2(@07)                          0724
         MVC   OLDERID2(95,@07),@TS00001                           0724
*                  NEWID2 = 'XPTM';                                0725
         MVC   NEWID2(4,@07),@CC01176                              0725
*                  CALL ALTRPROC(PTRCPL(INDX));                    0726
*                                                                  0726
         LR    @07,INDX                                            0726
         SLA   @07,2                                               0726
         LA    @07,PTRCPL-4(@07)                                   0726
         ST    @07,@AL00001                                        0726
         LA    @01,@AL00001                                        0726
         BAL   @14,ALTRPROC                                        0726
*                  RESPECIFY RTNREG RSTD;                          0727
*                  TESTRC = RTNREG;                                0728
         LR    TESTRC,RTNREG                                       0728
*                  RESPECIFY RTNREG UNRSTD;                        0729
*                  IF TESTRC ^= 0                                  0730
*                    THEN                                          0730
         LTR   TESTRC,TESTRC                                       0730
         BZ    @RF00730                                            0730
*                      RETURN CODE(LASTCC08);                      0731
*                                                                  0731
         LA    @15,8                                               0731
         L     @14,@SA00002                                        0731
         LM    @00,@05,@SA00002+8                                  0731
         LM    @07,@12,@SA00002+32                                 0731
         BR    @14                                                 0731
*                  CALL CTLGPROC(PTRCPL(INDX));                    0732
*                                                                  0732
@RF00730 LR    @07,INDX                                            0732
         SLA   @07,2                                               0732
         LA    @07,PTRCPL-4(@07)                                   0732
         ST    @07,@AL00001                                        0732
         LA    @01,@AL00001                                        0732
         BAL   @14,CTLGPROC                                        0732
*                  RESPECIFY RTNREG RSTD;                          0733
*                  TESTRC = RTNREG;                                0734
         LR    TESTRC,RTNREG                                       0734
*                  RESPECIFY RTNREG UNRSTD;                        0735
*                  IF TESTRC ^= 0                                  0736
*                    THEN                                          0736
         LTR   TESTRC,TESTRC                                       0736
         BZ    @RF00736                                            0736
*                      RETURN CODE(LASTCC08);                      0737
         LA    @15,8                                               0737
         L     @14,@SA00002                                        0737
         LM    @00,@05,@SA00002+8                                  0737
         LM    @07,@12,@SA00002+32                                 0737
         BR    @14                                                 0737
*                  END;                                            0738
@RF00736 DS    0H                                                  0739
*             END;                                                 0739
*                                                                  0739
@RF00719 DS    0H                                                  0740
*             END TEMPLP;                                          0740
*                                                                  0740
@RF00717 AL    INDX,@CF00220                                       0740
@DE00714 CR    INDX,NUMCPL                                         0740
         BNH   @DL00714                                            0740
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO MAIN PROCEDURE WITH SUCCESS INDICATED         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0741
*        RETURN CODE(0);                                           0741
*                                                                  0741
@RC00701 SLR   @15,@15                                             0741
         L     @14,@SA00002                                        0741
         LM    @00,@05,@SA00002+8                                  0741
         LM    @07,@12,@SA00002+32                                 0741
         BR    @14                                                 0741
*END CLUSPROC;                                                     0742
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - DSCTPROC                       @Y30SSFR*/
*        /*                                                          */
*        /*  FUNCTION - PROCESS EXPORTING OF A USER CATALOG BY       */
*        /*  DISCONNECTING THE USER CATALOG FROM THE MASTER CATALOG  */
*        /*                                                          */
*        /*  INPUT - FDT                                             */
*        /*                                                          */
*        /*  OUTPUT -  USER CATALOG WILL BE DISCONNECTED FROM MASTER */
*        /*  CATALOG AND THE PHYSICAL VOLUME ON WHICH THE USER       */
*        /*  RESIDES CAN THEN BE HAND CARRIED TO ANOTHER SYSTEM      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0743
*DSCTPROC: PROCEDURE;                                              0743
*                                                                  0743
DSCTPROC STM   @14,@05,@SA00003                                    0743
         STM   @07,@12,@SA00003+32                                 0743
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD CPL REQUIRED FOR CATALOG DISCONNECT WHICH IS      */
*        /*  A FORM OF DELETE                                        */
*        /*  IF THE CPL IS NOT CONSTRUCTED SUCCESSFULLY, RETURN       *
*        /*  TO THE CALLING PROCESSOR WITH FAILURE INDICATED          *
*        /*                                                          */
*        /************************************************************/
*                                                                  0744
*        OLDERID2 = NEWERID2;                                      0744
         L     @07,@PC00001                                        0744
         L     @07,GDTTR2(,@07)                                    0744
         MVC   @TS00001(95),NEWERID2(@07)                          0744
         MVC   OLDERID2(95,@07),@TS00001                           0744
*        NEWID2 = 'XPUC';                                          0745
         MVC   NEWID2(4,@07),@CC01181                              0745
*        NUMOBJ = 1;                                       /*@Y30SSFR*/
*                                                                  0746
         MVC   NUMOBJ(2),@CH00220                                  0746
*        CALL DELTPROC('U',ADDR(ENTVAL),DCPLPTR);          /*@Y30SSFR*/
*                                                                  0747
         LA    @07,@CC00732                                        0747
         ST    @07,@AL00001                                        0747
         L     @07,@PC00001+4                                      0747
         L     @07,FDTPTR(,@07)                                    0747
         LA    @07,ENTVAL(,@07)                                    0747
         ST    @07,@AFTEMPS+8                                      0747
         LA    @07,@AFTEMPS+8                                      0747
         ST    @07,@AL00001+4                                      0747
         LA    @07,DCPLPTR                                         0747
         ST    @07,@AL00001+8                                      0747
         LA    @01,@AL00001                                        0747
         BAL   @14,DELTPROC                                        0747
*        RESPECIFY RTNREG RSTD;                                    0748
*        TESTRC = RTNREG;                                          0749
         LR    TESTRC,RTNREG                                       0749
*        RESPECIFY RTNREG UNRSTD;                                  0750
*        IF TESTRC ^= 0                                            0751
*          THEN                                                    0751
         LTR   TESTRC,TESTRC                                       0751
         BZ    @RF00751                                            0751
*            RETURN CODE(LASTCC12);                                0752
*                                                                  0752
         LA    @15,12                                              0752
         L     @14,@SA00003                                        0752
         LM    @00,@05,@SA00003+8                                  0752
         LM    @07,@12,@SA00003+32                                 0752
         BR    @14                                                 0752
*        /************************************************************/
*        /*                                                          */
*        /*  INVOKE  CATALOG MANAGEMENT SUPPORT                      */
*        /*  IF THE DISCONNECT FAILS, RETURN TO THE CALLING PROCESSOR*/
*        /*  WITH FAILURE INDICATED                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0753
*        CALL CTLGPROC(DCPLPTR);                                   0753
*                                                                  0753
@RF00751 LA    @07,DCPLPTR                                         0753
         ST    @07,@AL00001                                        0753
         LA    @01,@AL00001                                        0753
         BAL   @14,CTLGPROC                                        0753
*        RESPECIFY RTNREG RSTD;                                    0754
*        TESTRC = RTNREG;                                          0755
         LR    TESTRC,RTNREG                                       0755
*        RESPECIFY RTNREG UNRSTD;                                  0756
*        IF TESTRC ^= 0                                            0757
*          THEN                                                    0757
         LTR   TESTRC,TESTRC                                       0757
         BZ    @RF00757                                            0757
*            RETURN CODE(LASTCC12);                                0758
*                                                                  0758
*                                                                  0758
         LA    @15,12                                              0758
         L     @14,@SA00003                                        0758
         LM    @00,@05,@SA00003+8                                  0758
         LM    @07,@12,@SA00003+32                                 0758
         BR    @14                                                 0758
*        CTGPLPTR = DCPLPTR;                                       0759
*                                                                  0759
@RF00757 L     @07,DCPLPTR                                         0759
         ST    @07,CTGPLPTR                                        0759
*        /************************************************************/
*        /*                                                          */
*        /*  CONTROL IS RETURNED TO IDCXP01.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0760
*        RETURN CODE(0);                                           0760
*                                                                  0760
         SLR   @15,@15                                             0760
         L     @14,@SA00003                                        0760
         LM    @00,@05,@SA00003+8                                  0760
         LM    @07,@12,@SA00003+32                                 0760
         BR    @14                                                 0760
*END DSCTPROC;                                                     0761
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - LOCPROC                                 */
*        /*                                                          */
*        /*  FUNCTION - BUILD A CPL AND A MULTITUDE OF FPL'S FOR     */
*        /*  USE BY CATALOG LOCATE                                   */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    . LNAME - 44-BYTE ENTRYNAME                           */
*        /*    . LCINUM - CONTROL INTERVAL NUMBER (LOCATE BY         */
*        /*      CONTROL INTERVAL)                                   */
*        /*    . LCATACB - CATALOG ACB ADDRESS                       */
*        /*    . LFLDLST - LIST OF CATALOG FIELD NAMES. AN FPL IS    */
*        /*      CONSTRUCTED FOR EACH ONE.                           */
*        /*    . LFLDNUM - NUMBER OF NAMES IN FIELD LIST             */
*        /*    . LCPLPTR - RETURN CELL FOR CPL ADDRESS               */
*        /*                                                          */
*        /*  OUTPUT- CPL ADDRESS                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0762
*LOCPROC:  PROCEDURE(LNAME,            /*44-BYTE ENTRY NAME          */
*                    LCINUM,           /*CONTROL INTERVAL NUMBER     */
*                    LCATACB,          /*CATALOG ACB ADDRESS         */
*                    LFLDLST,          /*LIST OF CATALOG FIELD NAMES */
*                    LFLDNUM,          /*NUMBER OF FIELDS IN LIST    */
*                    LCPLPTR);         /*RETURN CELL FOR CPL POINTER */
*                                                                  0762
LOCPROC  STM   @14,@05,@SA00004                                    0762
         STM   @07,@12,@SA00004+32                                 0762
         MVC   @PC00004(24),0(@01)                                 0762
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0763
*        DCL                                                       0763
*          LNAME      PTR(31),                                     0763
*          LCINUM     FIXED(24),                                   0763
*          LCATACB    PTR(31),                                     0763
*          LFLDLST(*) CHAR(8),                                     0763
*          LFLDNUM    PTR(8),                                      0763
*          LCPLPTR    PTR(31);                                     0763
*                                                                  0763
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0764
*        DCL CITYPEXT CHAR(8) INIT('ITYPEXT ');                    0764
*        DCL SSFLAG   CHAR(1) INIT('80'X);                         0765
*                                                                  0765
*        /************************************************************/
*        /*                                                          */
*        /*  COMPUTE HOW MUCH CORE NECESSARY FOR ONE CPL AND THE     */
*        /*  NUMBER OF FPL'S SPECIFIED BY FLDNUM, AND GET A CHUNK    */
*        /*  OF CORE.  GET A SEPARATE CHUNK OF CORE FOR THE WORK AREA*/
*        /*  IF CORE IS NOT OBTAINED, CONTROL IS RETURNED TO THE     */
*        /*  CALLING PROCESSOR WITH FAILURE INDICATED                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0766
*        OLDERID2 = NEWERID2;                                      0766
         L     @07,@PC00001                                        0766
         L     @03,GDTTR2(,@07)                                    0766
         MVC   @TS00001(95),NEWERID2(@03)                          0766
         MVC   OLDERID2(95,@03),@TS00001                           0766
*        NEWID2 = 'XPLP';                                          0767
*                                                                  0767
         MVC   NEWID2(4,@03),@CC01200                              0767
*        TOTLEN = LENGTH(CTGPL) + LFLDNUM*4                        0768
*                  + (LENGTH(CTGFL) + 8) * (LFLDNUM + 1);          0768
*                                                                  0768
         L     @03,@PC00004+16                                     0768
         SLR   @15,@15                                             0768
         IC    @15,LFLDNUM(,@03)                                   0768
         LR    @03,@15                                             0768
         SLA   @03,2                                               0768
         AL    @03,@CF01340                                        0768
         AL    @15,@CF00220                                        0768
         MH    @15,@CH00311                                        0768
         ALR   @03,@15                                             0768
         ST    @03,TOTLEN                                          0768
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,LCPLPTR,GPID,SETZERO);       0769
*                                                                  0769
         ST    @07,@AL00001                                        0769
         LA    @03,TOTLEN                                          0769
         ST    @03,@AL00001+4                                      0769
         L     @03,@PC00004+20                                     0769
         ST    @03,@AL00001+8                                      0769
         LA    @03,GPID                                            0769
         ST    @03,@AL00001+12                                     0769
         LA    @03,SETZERO                                         0769
         ST    @03,@AL00001+16                                     0769
         MVI   @AL00001+16,X'80'                                   0769
         L     @15,GDTGPL(,@07)                                    0769
         LA    @01,@AL00001                                        0769
         BALR  @14,@15                                             0769
*        RESPECIFY RTNREG RSTD;                                    0770
*        TESTRC = RTNREG;                                          0771
         LR    TESTRC,RTNREG                                       0771
*        RESPECIFY RTNREG UNRSTD;                                  0772
*        IF TESTRC ^= 0                                            0773
*          THEN                                                    0773
         LTR   TESTRC,TESTRC                                       0773
         BZ    @RF00773                                            0773
*            DO;                                                   0774
*            DARGSMOD = UNIVMSG;                                   0775
         L     @07,DDSTRU                                          0775
         MVC   DARGSMOD(3,@07),@CC00930                            0775
*            DEFSTID = NOSTORAG;                                   0776
         LA    DEFSTID,4                                           0776
*            RETURN CODE(LASTCC12);                                0777
         LA    @15,12                                              0777
         L     @14,@SA00004                                        0777
         LM    @00,@05,@SA00004+8                                  0777
         LM    @07,@12,@SA00004+32                                 0777
         BR    @14                                                 0777
*            END;                                                  0778
*                                                                  0778
*        CTGPLPTR = LCPLPTR;                                       0779
*                                                                  0779
@RF00773 L     @07,@PC00004+20                                     0779
         L     @07,LCPLPTR(,@07)                                   0779
         ST    @07,CTGPLPTR                                        0779
*        /************************************************************/
*        /*                                                          */
*        /*  GET WORK AREA CORE FOR CATALOG MANAGEMENT LOCATE        */
*        /*  IF CORE NOT OBTAINED - TERMINATE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0780
*        CALL IDCSAGP0 (GDTTBL,WKAREALN+LENGTH(PATHREL),           0780
*          CTGWKA,GPID,SETZERO);                           /*@Y30SSFR*/
         MVC   @AL00001+4(16),@AL00780                             0780
         L     @03,@PC00001                                        0780
         ST    @03,@AL00001                                        0780
         LA    @07,CTGWKA(,@07)                                    0780
         ST    @07,@AL00001+8                                      0780
         L     @15,GDTGPL(,@03)                                    0780
         LA    @01,@AL00001                                        0780
         BALR  @14,@15                                             0780
*        RESPECIFY RTNREG RSTD;                                    0781
*        TESTRC = RTNREG;                                          0782
         LR    TESTRC,RTNREG                                       0782
*        RESPECIFY RTNREG UNRSTD;                                  0783
*        IF TESTRC ^= 0                                            0784
*          THEN                                                    0784
         LTR   TESTRC,TESTRC                                       0784
         BZ    @RF00784                                            0784
*            DO;                                                   0785
*            DARGSMOD = UNIVMSG;                                   0786
         L     @07,DDSTRU                                          0786
         MVC   DARGSMOD(3,@07),@CC00930                            0786
*            DEFSTID = NOSTORAG;                                   0787
         LA    DEFSTID,4                                           0787
*            RETURN CODE(LASTCC12);                                0788
         LA    @15,12                                              0788
         L     @14,@SA00004                                        0788
         LM    @00,@05,@SA00004+8                                  0788
         LM    @07,@12,@SA00004+32                                 0788
         BR    @14                                                 0788
*            END;                                                  0789
*                                                                  0789
*        AREALN = WKAREALN;                                        0790
*                                                                  0790
@RF00784 L     @07,CTGPLPTR                                        0790
         L     @01,CTGWKA(,@07)                                    0790
         MVC   AREALN(2,@01),@CH00894                              0790
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE CPL WITH ENTRYNAME OR CONTROL INTERVAL NUMBER*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0791
*        IF LNAME ^= NULLPTR                                       0791
*          THEN                                                    0791
         L     @15,@PC00004                                        0791
         L     @15,LNAME(,@15)                                     0791
         LTR   @15,@15                                             0791
         BZ    @RF00791                                            0791
*            DO;                                                   0792
*            CTGENT = LNAME;                                       0793
         ST    @15,CTGENT(,@07)                                    0793
*            CTGNAME = ON;                                         0794
         OI    CTGNAME(@07),B'00000100'                            0794
*            END;                                                  0795
*          ELSE                                                    0796
*            CTGENT = ADDR(LCINUM);                                0796
*                                                                  0796
         B     @RC00791                                            0796
@RF00791 L     @07,@PC00004+4                                      0796
         L     @01,CTGPLPTR                                        0796
         ST    @07,CTGENT(,@01)                                    0796
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE CPL POINTER TO CATALOG NAME OR ACB PTR OR 0  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0797
*        IF LCATACB ^= NULLPTR                                     0797
*          THEN                                                    0797
@RC00791 L     @07,@PC00004+8                                      0797
         L     @15,LCATACB(,@07)                                   0797
         LTR   @15,@15                                             0797
         BZ    @RF00797                                            0797
*            CTGCAT = ADDR(LCATACB);                               0798
*                                                                  0798
         L     @01,CTGPLPTR                                        0798
         ST    @07,CTGCAT(,@01)                                    0798
*          ELSE                                                    0799
*            CTGCNAME = ON;                                        0799
*                                                                  0799
         B     @RC00797                                            0799
@RF00797 L     @07,CTGPLPTR                                        0799
         OI    CTGCNAME(@07),B'00000010'                           0799
*        /************************************************************/
*        /*                                                          */
*        /*  SET OPTIONS FLAGS IN CPL FOR LOCATE                     */
*        /*                                                          */
*        /************************************************************/
*        CTGAM0 = ON;                                              0800
@RC00797 DS    0H                                                  0801
*        CTGNUM = ON;                                              0801
         L     @07,CTGPLPTR                                        0801
         OI    CTGAM0(@07),B'00000011'                             0801
*        CTGFUNC = CTGLOC;                                         0802
*                                                                  0802
         NI    CTGFUNC(@07),B'00111111'                            0802
         OI    CTGFUNC(@07),B'00100000'                            0802
*        /************************************************************/
*        /*                                                          */
*        /*  SET PASSWORD IF SPECIFIED IN AMS COMMAND                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0803
*                                                                  0803
*        IF ENTPLN > 0                                             0803
*          THEN                                                    0803
         L     @15,@PC00001+4                                      0803
         L     @15,FDTPTR(,@15)                                    0803
         CLI   ENTPLN(@15),0                                       0803
         BNH   @RF00803                                            0803
*            CTGPSWD = ADDR(ENTPAS);                               0804
         LA    @15,ENTPAS(,@15)                                    0804
         ST    @15,CTGPSWD(,@07)                                   0804
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD A FPL FOR EACH CATALOG FIELD NAME IN THE FIELD    */
*        /*  LIST.  THE FPLS WILL BE BUILT FOLLOWING THE CPL         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0805
*        CTGFLPTR = CTGPLPTR + LENGTH(CTGPL) + LFLDNUM*4;          0805
@RF00803 L     @07,CTGPLPTR                                        0805
         LA    CTGFLPTR,28                                         0805
         ALR   CTGFLPTR,@07                                        0805
         L     @03,@PC00004+16                                     0805
         SLR   @15,@15                                             0805
         IC    @15,LFLDNUM(,@03)                                   0805
         LR    @14,@15                                             0805
         SLA   @14,2                                               0805
         ALR   CTGFLPTR,@14                                        0805
*        CTGNOFLD = LFLDNUM;                                       0806
*                                                                  0806
         STC   @15,CTGNOFLD(,@07)                                  0806
*          /**********************************************************/
*          /*                                                        */
*          /*  LFLDNUM CONTAINS THE NUMBER OF FIELDNAMES, HENCE      */
*          /*  THE NUMBER OF FPLS TO BE CONSTRUCTED.  THE CPL        */
*          /*  CONTAINS A POINTER TO EACH FPL IN THE ARRAY CTGFIELD  */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0807
*        DO INDX = 1 TO LFLDNUM;                                   0807
         LA    INDX,1                                              0807
         B     @DE00807                                            0807
@DL00807 DS    0H                                                  0808
*          CTGFIELD(INDX) = CTGFLPTR;                              0808
         LR    @07,INDX                                            0808
         SLA   @07,2                                               0808
         L     @05,CTGPLPTR                                        0808
         ST    CTGFLPTR,CTGFIELD-4(@07,@05)                        0808
*          CTGFLDNO = '00000001'B;                                 0809
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0809
*          CTGFLDNM = ADDR(LFLDLST(INDX));                         0810
         LR    @07,INDX                                            0810
         SLA   @07,3                                               0810
         L     @05,@PC00004+12                                     0810
         AL    @05,@CF01368                                        0810
         LA    @07,LFLDLST(@07,@05)                                0810
         ST    @07,CTGFLDNM(,CTGFLPTR)                             0810
*          CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;                0811
*                                                                  0811
         LA    @07,24                                              0811
         ALR   CTGFLPTR,@07                                        0811
*          /**********************************************************/
*          /*                                                        */
*          /*  IF CONSTRUCTING A VOLSER FPL, CONSTRUCT AN ADDITIONAL */
*          /*  FPL TO BE CHAINED TO THE VOLSER FPL FOR THE TEST      */
*          /*  SO THAT CATALOG MANAGEMENT WILL NOT RETURN SEQUENCE   */
*          /*  SET VOLUMES(IMBED FEATURE)                            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0812
*          IF INDX = IVOLSER                                       0812
*            THEN                                                  0812
         C     INDX,@CF00988                                       0812
         BNE   @RF00812                                            0812
*              DO;                                                 0813
*              CTGFIELD(INDX) -> CTGFLCHN = CTGFLPTR;              0814
         LR    @05,INDX                                            0814
         SLA   @05,2                                               0814
         L     @03,CTGPLPTR                                        0814
         L     @05,CTGFIELD-4(@05,@03)                             0814
         ST    CTGFLPTR,CTGFLCHN(,@05)                             0814
*              CTGFLDNO = '00000001'B;                             0815
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0815
*              CTGFLDCD = CTGFLDZ;                                 0816
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            0816
*              CTGFLDNM = ADDR(CITYPEXT);                          0817
         LA    @05,CITYPEXT                                        0817
         ST    @05,CTGFLDNM(,CTGFLPTR)                             0817
*              CTGFLNG(1) = 1;                                     0818
         MVC   CTGFLNG(4,CTGFLPTR),@CF00220                        0818
*              CTGFLPT(1) = ADDR(SSFLAG);                          0819
         LA    @05,SSFLAG                                          0819
         ST    @05,CTGFLPT(,CTGFLPTR)                              0819
*              CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;            0820
         ALR   CTGFLPTR,@07                                        0820
*              END;                                                0821
*        END;                                                      0822
*                                                                  0822
@RF00812 AL    INDX,@CF00220                                       0822
@DE00807 L     @07,@PC00004+16                                     0822
         SLR   @05,@05                                             0822
         IC    @05,LFLDNUM(,@07)                                   0822
         CR    INDX,@05                                            0822
         BNH   @DL00807                                            0822
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0823
*        RETURN CODE(0);                                           0823
*                                                                  0823
         SLR   @15,@15                                             0823
         L     @14,@SA00004                                        0823
         LM    @00,@05,@SA00004+8                                  0823
         LM    @07,@12,@SA00004+32                                 0823
         BR    @14                                                 0823
*END LOCPROC;                                                      0824
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - CTLGPROC                                */
*        /*                                                          */
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE,ALTER,DELETE)*/
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */
*        /*  INDICATORS                                              */
*        /*  CTLGPROC DOES NOT PERFORM CATALOG DELETES FOR   @Y30SSFR*/
*        /*  CLUSTERS AND AIX'S, BUT IT DOES INVOKE CATALOG  @Y30SSFR*/
*        /*  MANAGEMENT TO DO DISCONNECTS FOR USER CATALOGS. @Y30SSFR*/
*        /*  DELETION OF CLUSTERS AND AIX'S IS DONE USING    @Y30SSFR*/
*        /*  DELTPROC.                                       @Y30SSFR*/
*        /*                                                          */
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */
*        /*                                                          */
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */
*        /*  FAILURE.  DEFSTID IS SET TO INDICATE MESSAGE ID IF      */
*        /*  AN ERROR MESSAGE IS TO BE LISTED.                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0825
*CTLGPROC:  PROCEDURE(SCPLPTR);         /*CPL POINTER                */
*                                                                  0825
CTLGPROC STM   @14,@05,@SA00005                                    0825
         STM   @07,@12,@SA00005+32                                 0825
         MVC   @PC00005(4),0(@01)                                  0825
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0826
*        DCL SCPLPTR PTR(31);                                      0826
*                                                                  0826
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0827
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */
*                                      /*VSAM CATALOG MANAGEMENT     */
*                                                                  0828
*        /************************************************************/
*        /*                                                          */
*        /*  INVOKE CATALOG MANAGEMENT                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0828
*        OLDERID2 = NEWERID2;                                      0828
         L     @07,@PC00001                                        0828
         L     @15,GDTTR2(,@07)                                    0828
         MVC   @TS00001(95),NEWERID2(@15)                          0828
         MVC   OLDERID2(95,@15),@TS00001                           0828
*        NEWID2 = 'XPSP';                                          0829
         MVC   NEWID2(4,@15),@CC01208                              0829
*        CATRTNID = 'CATLGRTN';                                    0830
*                                                                  0830
         MVC   CATRTNID(8),@CC01209                                0830
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           0831
*                                                                  0831
         ST    @07,@AL00001                                        0831
         L     @15,@PC00005                                        0831
         ST    @15,@AL00001+4                                      0831
         L     @15,GDTCAT(,@07)                                    0831
         LA    @01,@AL00001                                        0831
         BALR  @14,@15                                             0831
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/
*        CATLGRC = REG15;                                          0833
         STH   REG15,CATLGRC                                       0833
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/
*        IF GDTDBG = NULLPTR                                       0835
*          THEN;                                                   0835
         L     @07,@PC00001                                        0835
         L     @07,GDTDBG(,@07)                                    0835
         LTR   @07,@07                                             0835
         BZ    @RT00835                                            0835
*          ELSE                                                    0837
*            CALL IDCDB010 (GDTTBL,'XPZZ');                        0837
*                                                                  0837
         L     @07,@PC00001                                        0837
         ST    @07,@AL00001                                        0837
         LA    @15,@CC01210                                        0837
         ST    @15,@AL00001+4                                      0837
         MVI   @AL00001+4,X'80'                                    0837
         L     @15,GDTDBG(,@07)                                    0837
         LA    @01,@AL00001                                        0837
         BALR  @14,@15                                             0837
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0838
*        IF CATLGRC ^= 0                                           0838
*          THEN                                                    0838
@RT00835 LH    @07,CATLGRC                                         0838
         LTR   @07,@07                                             0838
         BZ    @RF00838                                            0838
*            IF CATLGRC = 40                                       0839
*              THEN                                                0839
         C     @07,@CF01110                                        0839
         BNE   @RF00839                                            0839
*                DO;                                               0840
*                                                                  0840
*                /****************************************************/
*                /*                                                  */
*                /*  GET NEEDED SIZE FROM CATALOG WORKARE AT OFFSET  */
*                /*  AND OBTAIN CORE.  IF SIZE NOT RETURNED OR       */
*                /*  CORE NOT OBTAINED - TERMINATE                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0841
*                CTGPLPTR = SCPLPTR;                               0841
         L     @07,@PC00005                                        0841
         L     @07,SCPLPTR(,@07)                                   0841
         ST    @07,CTGPLPTR                                        0841
*                WSIZE = RETURNLN;                                 0842
*                                                                  0842
         L     @01,CTGWKA(,@07)                                    0842
         LH    WSIZE,RETURNLN(,@01)                                0842
*                CALL IDCSAFS0 (GDTTBL,CTGWKA);                    0843
*                                                                  0843
         L     @15,@PC00001                                        0843
         ST    @15,@AL00001                                        0843
         LA    @07,CTGWKA(,@07)                                    0843
         ST    @07,@AL00001+4                                      0843
         L     @15,GDTFSP(,@15)                                    0843
         LA    @01,@AL00001                                        0843
         BALR  @14,@15                                             0843
*                CALL IDCSAGP0 (GDTTBL,WSIZE + LENGTH(PATHREL),/*  0844
*                                                            @Y30SSFR*/
*                  CTGWKA,GPID,SETZERO);                   /*@Y30SSFR*/
         L     @07,@PC00001                                        0844
         ST    @07,@AL00001                                        0844
         LA    @15,52                                              0844
         ALR   @15,WSIZE                                           0844
         ST    @15,@AFTEMPS+12                                     0844
         LA    @15,@AFTEMPS+12                                     0844
         ST    @15,@AL00001+4                                      0844
         L     @01,CTGPLPTR                                        0844
         LA    @15,CTGWKA(,@01)                                    0844
         ST    @15,@AL00001+8                                      0844
         LA    @15,GPID                                            0844
         ST    @15,@AL00001+12                                     0844
         LA    @15,SETZERO                                         0844
         ST    @15,@AL00001+16                                     0844
         MVI   @AL00001+16,X'80'                                   0844
         L     @15,GDTGPL(,@07)                                    0844
         LA    @01,@AL00001                                        0844
         BALR  @14,@15                                             0844
*                RESPECIFY RTNREG RSTD;                            0845
*                TESTRC = RTNREG;                                  0846
         LR    TESTRC,RTNREG                                       0846
*                RESPECIFY RTNREG UNRSTD;                          0847
*                IF TESTRC ^= 0                                    0848
*                  THEN                                            0848
         LTR   TESTRC,TESTRC                                       0848
         BZ    @RF00848                                            0848
*                    DO;                                           0849
*                    DARGSMOD = UNIVMSG;                           0850
         L     @07,DDSTRU                                          0850
         MVC   DARGSMOD(3,@07),@CC00930                            0850
*                    DEFSTID = NOSTORAG;                           0851
         LA    DEFSTID,4                                           0851
*                    RETURN CODE(LASTCC12);                        0852
         LA    @15,12                                              0852
         L     @14,@SA00005                                        0852
         LM    @00,@05,@SA00005+8                                  0852
         LM    @07,@12,@SA00005+32                                 0852
         BR    @14                                                 0852
*                    END;                                          0853
*                                                                  0853
*                AREALN = WSIZE;                                   0854
*                                                                  0854
@RF00848 L     @07,CTGPLPTR                                        0854
         L     @07,CTGWKA(,@07)                                    0854
         STH   WSIZE,AREALN(,@07)                                  0854
*                /****************************************************/
*                /*                                                  */
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0855
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   0855
*                                                                  0855
         L     @07,@PC00001                                        0855
         ST    @07,@AL00001                                        0855
         L     @15,@PC00005                                        0855
         ST    @15,@AL00001+4                                      0855
         L     @15,GDTCAT(,@07)                                    0855
         LA    @01,@AL00001                                        0855
         BALR  @14,@15                                             0855
*                RESPECIFY REG15 RSTD;                     /*@Y30SSFR*/
*                CATLGRC = REG15;                                  0857
         STH   REG15,CATLGRC                                       0857
*                RESPECIFY REG15 UNRSTD;                   /*@Y30SSFR*/
*                END;                                              0859
*        IF CATLGRC ^= 0                                           0860
*          THEN                                                    0860
@RF00839 DS    0H                                                  0860
@RF00838 LH    @07,CATLGRC                                         0860
         LTR   @07,@07                                             0860
         BZ    @RF00860                                            0860
*ERCALL1:     DO;                                          /*@Y30SSFR*/
*                                                                  0861
ERCALL1  DS    0H                                                  0862
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     @Y30SSFR*/
*            /*  ERROR CONVERSION TABLE.                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0862
*            ERRORTAB = ''B;                               /*@Y30SSFR*/
*                                                                  0862
         XC    ERRORTAB(32),ERRORTAB                               0862
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    @Y30SSFR*/
*            /*  THE ERROR CONVERSION TABLE.                 @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0863
*            ERCNVADR = ADDR(ERRORTAB);                    /*@Y30SSFR*/
*                                                                  0863
         LA    @07,ERRORTAB                                        0863
         ST    @07,ERCNVADR                                        0863
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  @Y30SSFR*/
*            /*  IS A CATALOG ERROR.  DETERMINE THE CMS      @Y30SSFR*/
*            /*  FUNCTION BEING PERFORMED, AND SET THE       @Y30SSFR*/
*            /*  APPROPRIATE EROPER BIT.                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0864
*            ERCATLG = ON;                                 /*@Y30SSFR*/
         OI    ERCATLG(@07),B'10000000'                            0864
*            IF CTGFUNC = CTGLOC                                   0865
*              THEN                                                0865
*                                                                  0865
         L     @01,CTGPLPTR                                        0865
         TM    CTGFUNC(@01),B'00100000'                            0865
         BNO   @RF00865                                            0865
         TM    CTGFUNC(@01),B'11000000'                            0865
         BNZ   @RF00865                                            0865
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  THE OPERATION WAS A LOCATE.  SET        @Y30SSFR*/
*                /*  ERCATLC.                                @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0866
*                ERCATLC = ON;                             /*@Y30SSFR*/
         OI    ERCATLC(@07),B'10000000'                            0866
*              ELSE                                                0867
*                IF CTGOPTNS = CTGALTER                            0867
*                  THEN                                            0867
*                                                                  0867
         B     @RC00865                                            0867
@RF00865 L     @07,CTGPLPTR                                        0867
         TM    CTGOPTNS(@07),B'00010000'                           0867
         BNO   @RF00867                                            0867
         TM    CTGOPTNS(@07),B'11101000'                           0867
         BNZ   @RF00867                                            0867
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  THE CATALOG OPERATION IS AN ALTER.  @Y30SSFR*/
*                    /*  SET ERCATAL TO BE ON.               @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  0868
*                    ERCATAL = ON;                         /*@Y30SSFR*/
         L     @07,ERCNVADR                                        0868
         OI    ERCATAL(@07),B'00010000'                            0868
*                  ELSE                                            0869
*                    IF CTGOPTNS = CTGDELET                        0869
*                      THEN                                        0869
*                                                                  0869
         B     @RC00867                                            0869
@RF00867 L     @07,CTGPLPTR                                        0869
         TM    CTGOPTNS(@07),B'00011000'                           0869
         BNO   @RF00869                                            0869
         TM    CTGOPTNS(@07),B'11100000'                           0869
         BNZ   @RF00869                                            0869
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  THE CATALOG OPERATION WAS A     @Y30SSFR*/
*                        /*  DELETE.  SET ERCATDL TO BE      @Y30SSFR*/
*                        /*  ON.                             @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0870
*                        ERCATDL = ON;                     /*@Y30SSFR*/
*                                                                  0870
         L     @07,ERCNVADR                                        0870
         OI    ERCATDL(@07),B'00100000'                            0870
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  @Y30SSFR*/
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0871
*            ERCATRC = CATLGRC;                            /*@Y30SSFR*/
@RF00869 DS    0H                                                  0871
@RC00867 DS    0H                                                  0871
@RC00865 L     @07,ERCNVADR                                        0871
         LH    @15,CATLGRC                                         0871
         ST    @15,ERCATRC(,@07)                                   0871
*            ERCPLPT = SCPLPTR;                            /*@Y30SSFR*/
*                                                                  0872
         L     @15,@PC00005                                        0872
         L     @15,SCPLPTR(,@15)                                   0872
         ST    @15,ERCPLPT(,@07)                                   0872
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET AN POINTER TO THE ENTRY NAME IN THE     @Y30SSFR*/
*            /*  ERROR CONVERSION TABLE.                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0873
*            IF ERCATLC = ON  ERCATDL = ON                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         TM    ERCATLC(@07),B'10100000'                            0873
         BZ    @RF00873                                            0873
*                ERDSNM = CTGENT;                          /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        0874
         L     @15,CTGENT(,@01)                                    0874
         ST    @15,ERDSNM(,@07)                                    0874
*              ELSE                                        /*@Y30SSFR*/
*                ERDSNM = CTGFVT -> CTGFVENT;              /*@Y30SSFR*/
*                                                                  0875
         B     @RC00873                                            0875
@RF00873 L     @07,CTGPLPTR                                        0875
         L     @07,CTGFVT(,@07)                                    0875
         L     @07,CTGFVENT(,@07)                                  0875
         L     @01,ERCNVADR                                        0875
         ST    @07,ERDSNM(,@01)                                    0875
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    @Y30SSFR*/
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0876
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*@Y30SSFR*/
*                                                                  0876
@RC00873 L     @07,@PC00001                                        0876
         ST    @07,@AL00001                                        0876
         LA    @15,ERCNVADR                                        0876
         ST    @15,@AL00001+4                                      0876
         MVI   @AL00001+4,X'80'                                    0876
         L     @15,GDTERR(,@07)                                    0876
         LA    @01,@AL00001                                        0876
         BALR  @14,@15                                             0876
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  RETURN TO THE CALLER WITH AN ERROR          @Y30SSFR*/
*            /*  INDICATED.                                  @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0877
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/
         LA    @15,12                                              0877
         L     @14,@SA00005                                        0877
         LM    @00,@05,@SA00005+8                                  0877
         LM    @07,@12,@SA00005+32                                 0877
         BR    @14                                                 0877
*            END ERCALL1;                                  /*#Y30SSFR*/
*                                                                  0878
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0879
*        RETURN CODE(0);                                           0879
*                                                                  0879
@RF00860 SLR   @15,@15                                             0879
         L     @14,@SA00005                                        0879
         LM    @00,@05,@SA00005+8                                  0879
         LM    @07,@12,@SA00005+32                                 0879
         BR    @14                                                 0879
*END CTLGPROC;                                                     0880
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - OPENPROC                               */
*        /*                                                          */
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING AN   */
*        /*  VSAM COMPONENT FOR INPUT, OR OPENING THE PORTABILITY    */
*        /*  DATA SET FOR OUTPUT.                                    */
*        /*  WHEN OPENING THE VSAM OBJECT FOR INPUT, SETS    @Y30SSFR*/
*        /*  THE EXPORT/IMPORT FLAG IN THE OPNAGL.           @Y30SSFR*/
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */
*        /*           OPENED                                         */
*        /*    .ODSN - NAME OF VSAM COMPONENT                        */
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0881
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */
*                                      /*TO CLUSTER                  */
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */
*                     OIOCS);          /*RETURN CELL FOR IOCS        */
*                                                                  0881
OPENPROC STM   @14,@12,@SA00006                                    0881
         MVC   @PC00006(24),0(@01)                                 0881
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0882
*        DCL                                                       0882
*          OTYPE CHAR(1),                                          0882
*          ODD   PTR(31),                                          0882
*          ODSN  PTR(31),                                          0882
*          OREC,                                                   0882
*          OBLK,                                                   0882
*          OIOCS PTR(31);                                          0882
*                                                                  0882
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0883
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               0883
*                                      /* STORAGE FOR OPEN ARGUMENT  */
*                                      /* LIST                       */
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        0884
*                                      /*PTR TO IOCS RETURNED BY OPEN*/
*                                                                  0885
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */
*        /*  VERSUS AN OUTPUT DATA SET                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0885
*        OLDERID2 = NEWERID2;                                      0885
         L     @02,@PC00001                                        0885
         L     @02,GDTTR2(,@02)                                    0885
         MVC   @TS00001(95),NEWERID2(@02)                          0885
         MVC   OLDERID2(95,@02),@TS00001                           0885
*        NEWID2 = 'XPOP';                                          0886
         MVC   NEWID2(4,@02),@CC01230                              0886
*        OPENLIST = ''B;                                           0887
         XC    OPENLIST(48),OPENLIST                               0887
*        OPNPTR = ADDR(OPENLIST);                                  0888
         LA    OPNPTR,OPENLIST                                     0888
*        IF OTYPE = 'O'                                            0889
*          THEN                                                    0889
         L     @02,@PC00006                                        0889
         CLI   OTYPE(@02),C'O'                                     0889
         BNE   @RF00889                                            0889
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN FOR OUTPUT SPECIFIED - SET VBS  FORMAT         */
*            /*                                                      */
*            /********************************************************/
*                                                                  0890
*            DO;                                                   0890
*            OPNOPTOT = ON;                                        0891
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0891
*            OPNRFMSF = ON;                                        0892
*            OPNRFMBK = ON;                                        0893
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0893
*            OPNBLK = OBLK;                                        0894
         L     @02,@PC00006+16                                     0894
         L     @02,OBLK(,@02)                                      0894
         ST    @02,OPNBLK(,OPNPTR)                                 0894
*            OPNREC = OREC;                                        0895
*                                                                  0895
         L     @02,@PC00006+12                                     0895
         L     @02,OREC(,@02)                                      0895
         ST    @02,OPNREC(,OPNPTR)                                 0895
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS TO SPECIFY    */
*            /*  DEVICE TYPES ON EXPORT COMMAND                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  0896
*            IF ADDR(ENVIR) ^= NULLPTR                             0896
*              THEN                                                0896
         SLR   @02,@02                                             0896
         L     @15,@PC00001+4                                      0896
         C     @02,FDTPTR+16(,@15)                                 0896
         BE    @RF00896                                            0896
*                DO;                                               0897
*                IF ADDR(PDEV) ^= NULLPTR                          0898
*                  THEN                                            0898
         L     @15,FDTPTR+76(,@15)                                 0898
         CR    @15,@02                                             0898
         BE    @RF00898                                            0898
*                    OPNDEVDT = ADDR(PDEVVAL);                     0899
*                                                                  0899
         LA    @02,PDEVVAL(,@15)                                   0899
         ST    @02,OPNDEVDT(,OPNPTR)                               0899
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IF THE USER HAS SPECIFIED THE BLKSZ     @Y30SSFR*/
*                /*  SUBPARAMETER, RESET THE VALUE OF OPNBLK @Y30SSFR*/
*                /*  TO THAT GIVEN BY THE USER.              @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0900
*                IF ADDR(BLKSZ) ^= NULLPTR                 /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
@RF00898 L     @02,@PC00001+4                                      0900
         L     @02,FDTPTR+80(,@02)                                 0900
         LTR   @02,@02                                             0900
         BZ    @RF00900                                            0900
*                    OPNBLK = BLKSZVAL;                    /*@Y30SSFR*/
*                                                                  0901
         L     @02,BLKSZVAL(,@02)                                  0901
         ST    @02,OPNBLK(,OPNPTR)                                 0901
*                END;                                              0902
@RF00900 DS    0H                                                  0903
*             IF ADDR(OUTDD) = NULLPTR                             0903
*               THEN                                               0903
@RF00896 L     @02,@PC00001+4                                      0903
         L     @02,FDTPTR+12(,@02)                                 0903
         LTR   @02,@02                                             0903
         BNZ   @RF00903                                            0903
*                 OPNDSN = ODSN;                           /*@YL026UA*/
         L     @02,@PC00006+8                                      0904
         L     @02,ODSN(,@02)                                      0904
         ST    @02,OPNDSN(,OPNPTR)                                 0904
*               ELSE                                               0905
*                 OPNDDN = ODD;                            /*@YL026UA*/
         B     @RC00903                                            0905
@RF00903 L     @02,@PC00006+4                                      0905
         L     @02,ODD(,@02)                                       0905
         ST    @02,OPNDDN(,OPNPTR)                                 0905
*            END;                                                  0906
*                                                                  0906
@RC00903 DS    0H                                                  0907
*        IF OTYPE = 'I'                                            0907
*          THEN                                                    0907
*                                                                  0907
@RF00889 L     @02,@PC00006                                        0907
         CLI   OTYPE(@02),C'I'                                     0907
         BNE   @RF00907                                            0907
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN VSAM CLUSTER FOR INPUT AND RECORD PROCESSING   */
*            /*  SET THE EXPORT/IMPORT FLAG IN THE OPENAGL.  @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0908
*            DO;                                                   0908
*            OPNOPTIN = ON;                                        0909
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0909
*            OPNTYPXM = ON;                                /*@Y30SSFR*/
*                                                                  0910
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0910
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF EXPORTING AN AIX, SET THE OPNMODAX BIT   @Y30SSFR*/
*            /*  SO THAT WHEN OPENING BY PATH NAME, THE AIX  @Y30SSFR*/
*            /*  IS OPENED RATHER THAN THE BASE CLUSTER.     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0911
*            IF AIXFLAG = ON                               /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         TM    AIXFLAG,B'10000000'                                 0911
         BNO   @RF00911                                            0911
*                OPNMODAX = ON;                            /*@Y30SSFR*/
*                                                                  0912
         OI    OPNMODAX(OPNPTR),B'00001000'                        0912
*            CTGFLPTR = PTRCPL(1) -> CTGFIELD(IPASSWOR);           0913
@RF00911 L     @01,PTRCPL                                          0913
         L     CTGFLPTR,CTGFIELD+36(,@01)                          0913
*            IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR            0914
*              THEN                                                0914
         SLR   @15,@15                                             0914
         C     @15,CTGFLNG(,CTGFLPTR)                              0914
         BE    @RF00914                                            0914
         L     @14,CTGFLPT(,CTGFLPTR)                              0914
         CR    @14,@15                                             0914
         BE    @RF00914                                            0914
*                OPNPWA = CTGFLPT(1);                              0915
         ST    @14,OPNPWA(,OPNPTR)                                 0915
*              ELSE                                                0916
*                IF ENTPLN > 0                                     0916
*                  THEN                                            0916
         B     @RC00914                                            0916
@RF00914 L     @02,@PC00001+4                                      0916
         L     @02,FDTPTR(,@02)                                    0916
         CLI   ENTPLN(@02),0                                       0916
         BNH   @RF00916                                            0916
*                    OPNPWA = ADDR(ENTPAS);                        0917
         LA    @02,ENTPAS(,@02)                                    0917
         ST    @02,OPNPWA(,OPNPTR)                                 0917
*             OPNDDN = ODD;                                /*@YL026UA*/
@RF00916 DS    0H                                                  0918
@RC00914 L     @02,@PC00006+4                                      0918
         L     @02,ODD(,@02)                                       0918
         ST    @02,OPNDDN(,OPNPTR)                                 0918
*            END;                                                  0919
*                                                                  0919
*                                                                  0919
*        /************************************************************/
*        /*                                                          */
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */
*        /*  INPUT                                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0920
*        OPNIOC = OIOCS;                                           0920
*                                                                  0920
@RF00907 L     @15,@PC00006+20                                     0920
         L     @15,OIOCS(,@15)                                     0920
         ST    @15,OPNIOC(,OPNPTR)                                 0920
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0921
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            0921
*                                                                  0921
         L     @15,@PC00001                                        0921
         ST    @15,@AL00001                                        0921
         ST    OPNPTR,@AL00001+4                                   0921
         MVI   @AL00001+4,X'80'                                    0921
         L     @15,GDTOPN(,@15)                                    0921
         LA    @01,@AL00001                                        0921
         BALR  @14,@15                                             0921
*        RESPECIFY RTNREG RSTD;                                    0922
*        TESTRC = RTNREG;                                          0923
         LR    TESTRC,RTNREG                                       0923
*        RESPECIFY RTNREG UNRSTD;                                  0924
*                                                                  0924
*        /************************************************************/
*        /*                                                          */
*        /*  TEST RETURN CODE FROM OPEN.  IF NOT SUCCESSFUL, CLOSE   */
*        /*  DATA SET TO FREE CORE, AND SET RETURN CODE TO FAILURE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0925
*        IF TESTRC ^= 0                                            0925
*          THEN                                                    0925
         LTR   TESTRC,TESTRC                                       0925
         BZ    @RF00925                                            0925
*            DO;                                                   0926
*                                                                  0926
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);                      0927
*                                                                  0927
         L     @15,@PC00001                                        0927
         ST    @15,@AL00001                                        0927
         L     @14,@PC00006+20                                     0927
         L     @01,OIOCS(,@14)                                     0927
         ST    @01,@AL00001+4                                      0927
         MVI   @AL00001+4,X'80'                                    0927
         L     @15,GDTCLS(,@15)                                    0927
         LA    @01,@AL00001                                        0927
         BALR  @14,@15                                             0927
*            OIOCSPTR = NULLPTR;                                   0928
         L     @15,@PC00006+20                                     0928
         L     @01,OIOCS(,@15)                                     0928
         SLR   @00,@00                                             0928
         ST    @00,OIOCSPTR(,@01)                                  0928
*            RETURN CODE(LASTCC12);                                0929
         LA    @15,12                                              0929
         L     @14,@SA00006                                        0929
         LM    @00,@12,@SA00006+8                                  0929
         BR    @14                                                 0929
*            END;                                                  0930
*          ELSE                                                    0931
*                                                                  0931
*            /********************************************************/
*            /*                                                      */
*            /*  RETURN TO CALLER INDICATING SUCCESSFUL COMPLETION   */
*            /*  OF OPEN                                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0931
*            RETURN CODE(0);                                       0931
*                                                                  0931
@RF00925 SLR   @15,@15                                             0931
         L     @14,@SA00006                                        0931
         LM    @00,@12,@SA00006+8                                  0931
         BR    @14                                                 0931
*END OPENPROC;                                                     0932
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - ALTRPROC                               */
*        /*                                                          */
*        /*  FUNCTION - WILL MODIFY THE CPL FOR CATALOG ALTER        */
*        /*  OPERATION, SO THAT DSATTR CATALOG FIELD CAN BE MODIFIED */
*        /*                                                          */
*        /*  INPUT - CPL POINTER FOR CPL TO BE MODIFIED              */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO CONSTRUCTED CPL                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0933
*ALTRPROC: PROCEDURE(ACPLPTR);         /*CPL POINTER                 */
*                                                                  0933
ALTRPROC STM   @14,@05,@SA00007                                    0933
         STM   @07,@12,@SA00007+32                                 0933
         MVC   @PC00007(4),0(@01)                                  0933
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0934
*        DCL ACPLPTR PTR(31);          /* CPL POINTER                */
*                                                                  0934
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0935
*        DCL A1CPLPTR  PTR(31);        /*ADDR OF CONSTRUCTED CPL     */
*        DCL AFVTPTR   PTR(31);        /*ADDR OF CONSTRUCTED FVT     */
*                                                                  0936
*        /************************************************************/
*        /*                                                          */
*        /*  FIRST GET CORE FOR FIELD VECTOR TABLE (FVT) WHICH WILL  */
*        /*  POINT TO ENTNAME FPL AND DSATTR FPL (FIELD PARAMETER    */
*        /*  BLOCK)                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0937
*        OLDERID2 = NEWERID2;                                      0937
         L     @07,@PC00001                                        0937
         L     @03,GDTTR2(,@07)                                    0937
         MVC   @TS00001(95),NEWERID2(@03)                          0937
         MVC   OLDERID2(95,@03),@TS00001                           0937
*        NEWID2 = 'XPAP';                                          0938
*                                                                  0938
         MVC   NEWID2(4,@03),@CC01238                              0938
*        CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGFV)+LENGTH(CTGPL)),A1CPLPTR,
*                GPID,SETZERO);                                    0939
*                                                                  0939
         ST    @07,@AL00001                                        0939
         LA    @03,120                                             0939
         ST    @03,@AFTEMPS+16                                     0939
         LA    @03,@AFTEMPS+16                                     0939
         ST    @03,@AL00001+4                                      0939
         LA    @03,A1CPLPTR                                        0939
         ST    @03,@AL00001+8                                      0939
         LA    @03,GPID                                            0939
         ST    @03,@AL00001+12                                     0939
         LA    @03,SETZERO                                         0939
         ST    @03,@AL00001+16                                     0939
         MVI   @AL00001+16,X'80'                                   0939
         L     @15,GDTGPL(,@07)                                    0939
         LA    @01,@AL00001                                        0939
         BALR  @14,@15                                             0939
*        RESPECIFY RTNREG RSTD;                                    0940
*        TESTRC = RTNREG;                                          0941
         LR    TESTRC,RTNREG                                       0941
*        RESPECIFY RTNREG UNRSTD;                                  0942
*                                                                  0942
*        /************************************************************/
*        /*                                                          */
*        /*  IF CORE WAS NOT OBTAINED SUCCESSFULLY, PROCESSING IS    */
*        /*  TERMINATED AND CONTROL RETURNS TO THE CALLING PROCESSOR */
*        /*  WITH SETRC SET TO INDICATE FAILURE                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0943
*        IF TESTRC ^= 0                                            0943
*          THEN                                                    0943
         LTR   TESTRC,TESTRC                                       0943
         BZ    @RF00943                                            0943
*            DO;                                                   0944
*            DARGSMOD = UNIVMSG;                                   0945
         L     @07,DDSTRU                                          0945
         MVC   DARGSMOD(3,@07),@CC00930                            0945
*            DEFSTID = NOSTORAG;                                   0946
         LA    DEFSTID,4                                           0946
*            RETURN CODE(LASTCC12);                                0947
         LA    @15,12                                              0947
         L     @14,@SA00007                                        0947
         LM    @00,@05,@SA00007+8                                  0947
         LM    @07,@12,@SA00007+32                                 0947
         BR    @14                                                 0947
*            END;                                                  0948
*                                                                  0948
*        /************************************************************/
*        /*                                                          */
*        /*  MODIFY CPL FOR AN ALTER OPERATION                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0949
*        CTGPLPTR = A1CPLPTR;                                      0949
@RF00943 L     @07,A1CPLPTR                                        0949
         ST    @07,CTGPLPTR                                        0949
*        CTGAM0= ON;                                               0950
*        CTGNUM = ON;                                              0951
         OI    CTGAM0(@07),B'00000011'                             0951
*        CTGNAME = ON;                                             0952
         OI    CTGNAME(@07),B'00000100'                            0952
*        CTGCAT = ADDR(PTRCTACB);                                  0953
         LA    @15,PTRCTACB                                        0953
         ST    @15,CTGCAT(,@07)                                    0953
*        CTGFUNC = CTGCMS;                                         0954
         NI    CTGFUNC(@07),B'10011111'                            0954
         OI    CTGFUNC(@07),B'10000000'                            0954
*        CTGOPTNS = CTGALTER;                                      0955
         NI    CTGOPTNS(@07),B'00010111'                           0955
         OI    CTGOPTNS(@07),B'00010000'                           0955
*        CTGNAME = ON;                                             0956
*                                                                  0956
         OI    CTGNAME(@07),B'00000100'                            0956
*        /************************************************************/
*        /*                                                          */
*        /*  PLACE PASSWORD INFORMATION INTO CPL IF AVAILABLE         *
*        /*                                                          */
*        /************************************************************/
*                                                                  0957
*        IF ENTPLN > 0                                             0957
*          THEN                                                    0957
         L     @15,@PC00001+4                                      0957
         L     @15,FDTPTR(,@15)                                    0957
         CLI   ENTPLN(@15),0                                       0957
         BNH   @RF00957                                            0957
*            CTGPSWD = ADDR(ENTPAS);                               0958
         LA    @15,ENTPAS(,@15)                                    0958
         ST    @15,CTGPSWD(,@07)                                   0958
*          ELSE                                                    0959
*            DO;                                                   0959
         B     @RC00957                                            0959
@RF00957 DS    0H                                                  0960
*            CTGFLPTR = ACPLPTR -> CTGFIELD(IPASSWOR);             0960
         L     @07,@PC00007                                        0960
         L     @07,ACPLPTR(,@07)                                   0960
         L     CTGFLPTR,CTGFIELD+36(,@07)                          0960
*            IF CTGFLNG(1) ^= 0  & CTGFLPT(1) ^= NULLPTR           0961
*              THEN                                                0961
         SLR   @07,@07                                             0961
         C     @07,CTGFLNG(,CTGFLPTR)                              0961
         BE    @RF00961                                            0961
         L     @03,CTGFLPT(,CTGFLPTR)                              0961
         CR    @03,@07                                             0961
         BE    @RF00961                                            0961
*                CTGPSWD = CTGFLPT(1);                             0962
         L     @07,CTGPLPTR                                        0962
         ST    @03,CTGPSWD(,@07)                                   0962
*            END;                                          /*@Y30SSFR*/
*                                                                  0963
@RF00961 DS    0H                                                  0964
*        CTGFVT = CTGPLPTR + LENGTH(CTGPL);                        0964
@RC00957 L     @07,CTGPLPTR                                        0964
         LA    @03,28                                              0964
         ALR   @03,@07                                             0964
         ST    @03,CTGFVT(,@07)                                    0964
*        AFVTPTR = CTGFVT;                                         0965
*                                                                  0965
         LR    AFVTPTR,@03                                         0965
*        /************************************************************/
*        /*                                                          */
*        /*  SET FPL POINTERS IN FVT TO DSATTR AND ENTNAME FPLS      */
*        /*  BECAUSE THE FPL'S HAVE BEEN USED BY LOCATE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0966
*        CTGPLPTR = ACPLPTR;                                       0966
         L     @07,@PC00007                                        0966
         L     @03,ACPLPTR(,@07)                                   0966
         ST    @03,CTGPLPTR                                        0966
*        CTGFVT = AFVTPTR;                                         0967
         ST    AFVTPTR,CTGFVT(,@03)                                0967
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0968
         L     CTGFLPTR,CTGFIELD(,@03)                             0968
*        CTGFVTYP = FENTYPE;             /*  ENTRY TYPE              */
         L     @01,CTGPLPTR                                        0969
         L     @15,CTGFVT(,@01)                                    0969
         L     @01,CTGFLPT(,CTGFLPTR)                              0969
         MVC   CTGFVTYP(1,@15),FENTYPE(@01)                        0969
*        CTGFLPTR = CTGFIELD(IENTNAME);                            0970
         L     CTGFLPTR,CTGFIELD+4(,@03)                           0970
*        CTGFVENT = CTGFLPT(1);          /*  ENTRY NAME              */
         L     @14,CTGFLPT(,CTGFLPTR)                              0971
         ST    @14,CTGFVENT(,@15)                                  0971
*        CTGFVATR = CTGFIELD(IDSATTR);                             0972
         L     @03,CTGFIELD+8(,@03)                                0972
         ST    @03,CTGFVATR(,@15)                                  0972
*        CTGFLPTR = CTGFVATR;            /*  DATA SET ATTRIBUTES     */
         LR    CTGFLPTR,@03                                        0973
*        CTGFLDWA = ''B;                                           0974
         XC    CTGFLDWA(4,CTGFLPTR),CTGFLDWA(CTGFLPTR)             0974
*        CTGFLCHN = NULLPTR;                                       0975
         SLR   @03,@03                                             0975
         ST    @03,CTGFLCHN(,CTGFLPTR)                             0975
*        CTGFVIND = ADDR(INDDVAL);                         /*@Y30SSFR*/
*                                                                  0976
         L     @14,@PC00001+4                                      0976
         L     @01,FDTPTR+4(,@14)                                  0976
         LA    @14,INDDVAL(,@01)                                   0976
         ST    @14,CTGFVIND(,@15)                                  0976
*        /************************************************************/
*        /*                                                          */
*        /*  NOW RESET ACPLPTR TO THE NEWLY CONSTRUCTED CPL WHICH    */
*        /*  CONTAINS A POINTER TO THE NEWLY CONSTRUCTED FVT, AND    */
*        /*  RETURN TO CALLER.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0977
*        ACPLPTR = A1CPLPTR;                                       0977
*                                                                  0977
         L     @02,A1CPLPTR                                        0977
         ST    @02,ACPLPTR(,@07)                                   0977
*        RETURN CODE(0);                                           0978
*                                                                  0978
         LR    @15,@03                                             0978
         L     @14,@SA00007                                        0978
         LM    @00,@05,@SA00007+8                                  0978
         LM    @07,@12,@SA00007+32                                 0978
         BR    @14                                                 0978
*END ALTRPROC;                                                     0979
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - DELTPROC                               */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT A CATALOG PARAMETER LIST (CPL) TO  */
*        /*  BE EMPLOYED BY CATALOG DELETE TO DELETE A CLUSTER OR    */
*        /*  TO DISCONNECT A USER CATALOG                            */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .DTYPE - TYPE OF DELETE REQUEST                       */
*        /*              'U' = USER CATALOG DISCONNECT               */
*        /*              'C' = CLUSTER OBJECT DELETE                 */
*        /*              'G' = AIX OBJECT TO BE DELETED      @Y30SSFR*/
*        /*    .DENTVAL - NAME OF OBJECT TO BE DELETED               */
*        /*    .DCPL - RETURN CELL FOR CPL POINTER                   */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO CPL CONSTRUCTED                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0980
*DELTPROC: PROCEDURE(DTYPE,            /*TYPE OF REQUEST             */
*                    DENTVAL,          /*NAME OF OBJECT              */
*                    DCPL);            /*RETURN CELL FOR CPL         */
*                                                                  0980
DELTPROC STM   @14,@05,@SA00008                                    0980
         STM   @07,@12,@SA00008+32                                 0980
         MVC   @PC00008(12),0(@01)                                 0980
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0981
*        DCL                                                       0981
*          DTYPE   CHAR(1),                                        0981
*          DENTVAL PTR(31),                                        0981
*          DCPL    PTR(31);                                        0981
*                                                                  0981
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SIZE TO BE REQUESTED IN CALL TO UGPOOL.         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0982
*        DCL DSIZE FIXED(31);                              /*@Y30SSFR*/
*                                                                  0982
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INDEX TO THE OBJECT TO BE ALLOCATED ON A VSAM   @Y30SSFR*/
*        /*  CATALOG RETURN CODE OF 72.                      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0983
*        DCL ALLOINDX FIXED(31);                           /*@Y30SSFR*/
*                                                                  0983
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOOP CONTROL VARIABLES.                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0984
*        DCL DEFINED BIT(1);           /*VARIABLE USED TO    @Y30SSFR*/
*                                      /*CONTROL THE LOOP    @Y30SSFR*/
*                                      /*CATALOG             @Y30SSFR*/
*        DCL IND1    FIXED(31);        /*INDEX USED TO CLEAR @Y30SSFR*/
*                                      /*WORK AREA           @Y30SSFR*/
*        DCL IX      FIXED(31);        /*INDEX USED TO PRINT @Y30SSFR*/
*                                      /*NAMES FROM THE      @Y30SSFR*/
*                                      /*WORK AREA           @Y30SSFR*/
*                                                                  0987
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  NUMBER OF OBJECTS IN THE WORKAREA ON A VSAM     @Y30SSFR*/
*        /*  CATALOG RETURN CODE OF 40.                      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0987
*        DCL MNOENT FIXED(31);                             /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                          */
*        /*  GET CORE IN WHICH TO CONSTRUCT CPL                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0988
*        OLDERID2 = NEWERID2;                                      0988
         L     @07,@PC00001                                        0988
         L     @03,GDTTR2(,@07)                                    0988
         MVC   @TS00001(95),NEWERID2(@03)                          0988
         MVC   OLDERID2(95,@03),@TS00001                           0988
*        NEWID2 = 'XPDP';                                          0989
*                                                                  0989
         MVC   NEWID2(4,@03),@CC01254                              0989
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CTGPL),DCPL,GPID,SETZERO);   0990
*                                                                  0990
         MVC   @AL00001+4(16),@AL00990                             0990
         ST    @07,@AL00001                                        0990
         L     @03,@PC00008+8                                      0990
         ST    @03,@AL00001+8                                      0990
         L     @15,GDTGPL(,@07)                                    0990
         LA    @01,@AL00001                                        0990
         BALR  @14,@15                                             0990
*        RESPECIFY RTNREG RSTD;                                    0991
*        TESTRC = RTNREG;                                          0992
         LR    TESTRC,RTNREG                                       0992
*        RESPECIFY RTNREG UNRSTD;                                  0993
*                                                                  0993
*        /************************************************************/
*        /*                                                          */
*        /*  IF CORE CAN NOT BE OBTAINED, RETURN TO CALLING          */
*        /*  PROCESSOR INDICATING FAILURE                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0994
*        IF TESTRC ^= 0                                            0994
*          THEN                                                    0994
         LTR   TESTRC,TESTRC                                       0994
         BZ    @RF00994                                            0994
*            DO;                                                   0995
*            DARGSMOD = UNIVMSG;                                   0996
         L     @07,DDSTRU                                          0996
         MVC   DARGSMOD(3,@07),@CC00930                            0996
*            DEFSTID = NOSTORAG;                                   0997
         LA    DEFSTID,4                                           0997
*            RETURN CODE(LASTCC12);                                0998
         LA    @15,12                                              0998
         L     @14,@SA00008                                        0998
         LM    @00,@05,@SA00008+8                                  0998
         LM    @07,@12,@SA00008+32                                 0998
         BR    @14                                                 0998
*            END;                                                  0999
*                                                                  0999
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE FIELDS IN THE CPL                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1000
*        CTGPLPTR = DCPL;                                          1000
@RF00994 L     @07,@PC00008+8                                      1000
         L     @07,DCPL(,@07)                                      1000
         ST    @07,CTGPLPTR                                        1000
*        CTGAM0 = ON;                  /* VSAM REQUEST               */
         OI    CTGAM0(@07),B'00000001'                             1001
*        CTGENT = DENTVAL;             /* POINTER TO ENTRY NAME      */
         L     @15,@PC00008+4                                      1002
         L     @15,DENTVAL(,@15)                                   1002
         ST    @15,CTGENT(,@07)                                    1002
*        CTGNAME = ON;                 /* NAME FLAG                  */
*                                                                  1003
         OI    CTGNAME(@07),B'00000100'                            1003
*        /************************************************************/
*        /*                                                          */
*        /*  DETERMINE IF PASSWORD SUPPLIED AND IF SO PUT IN CPL     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1004
*        IF ENTPLN ^= 0                                            1004
*          THEN                                                    1004
         L     @15,@PC00001+4                                      1004
         L     @15,FDTPTR(,@15)                                    1004
         CLI   ENTPLN(@15),0                                       1004
         BE    @RF01004                                            1004
*            CTGPSWD = ADDR(ENTPAS);                               1005
*                                                                  1005
         LA    @15,ENTPAS(,@15)                                    1005
         ST    @15,CTGPSWD(,@07)                                   1005
*        /************************************************************/
*        /*                                                          */
*        /* TEST FOR CATALOG ACB SUPPLIED  IF IT IS NOT INDICATE     */
*        /* THAT THE CATALOG NAME IS SUPPLIED                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1006
*        IF PTRCTACB ^= NULLPTR                                    1006
*          THEN                                                    1006
@RF01004 L     @07,PTRCTACB                                        1006
         LTR   @07,@07                                             1006
         BZ    @RF01006                                            1006
*            CTGCAT = ADDR(PTRCTACB);                              1007
         LA    @07,PTRCTACB                                        1007
         L     @01,CTGPLPTR                                        1007
         ST    @07,CTGCAT(,@01)                                    1007
*          ELSE                                                    1008
*            CTGCNAME = ON;            /* ACB NOT PASSED             */
*                                                                  1008
         B     @RC01006                                            1008
@RF01006 L     @07,CTGPLPTR                                        1008
         OI    CTGCNAME(@07),B'00000010'                           1008
*        CTGFUNC = CTGCMS;             /*  CMS FUNCTION              */
@RC01006 L     @07,CTGPLPTR                                        1009
         NI    CTGFUNC(@07),B'10011111'                            1009
         OI    CTGFUNC(@07),B'10000000'                            1009
*        CTGOPTNS = CTGDELET;          /*  DELETE REQUEST            */
*                                                                  1010
         NI    CTGOPTNS(@07),B'00011111'                           1010
         OI    CTGOPTNS(@07),B'00011000'                           1010
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TYPE FIELD.  IF TYPE INDICATES USER CATALOG,       */
*        /*  SET DISCONNECT FLAG AND TYPE FIELD TO 'U'               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1011
*        IF DTYPE = 'U'                                            1011
*          THEN                                                    1011
         L     @15,@PC00008                                        1011
         CLI   DTYPE(@15),C'U'                                     1011
         BNE   @RF01011                                            1011
*            DO;                                                   1012
*            CTGDISC = ON;             /*  A DISCONNECT REQUEST      */
         OI    CTGDISC(@07),B'00001000'                            1013
*            CTGTYPE = CTGTUCAT;       /*  USER CATALOG INDICATION   */
         MVI   CTGTYPE(@07),C'U'                                   1014
*            END;                                                  1015
*                                                                  1015
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  THE TYPE IS CLUSTER OR AIX.  SET SPECIAL      @Y30SSFR*/
*          /*  FIELDS IN CPL                                 @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1016
*          ELSE                                                    1016
*            DO;                                                   1016
         B     @RC01011                                            1016
@RF01011 DS    0H                                                  1017
*            CTGTYPE = DTYPE;         /*  TYPE IS CLUSTER    @Y30SSFR*/
         L     @07,CTGPLPTR                                        1017
         L     @15,@PC00008                                        1017
         MVC   CTGTYPE(1,@07),DTYPE(@15)                           1017
*                                      /* OR AIX             @Y30SSFR*/
*            IF ADDR(INDD) ^= NULLPTR                      /*@Y30SSFR*/
*              THEN                                                1018
         L     @15,@PC00001+4                                      1018
         L     @15,FDTPTR+4(,@15)                                  1018
         LTR   @15,@15                                             1018
         BZ    @RF01018                                            1018
*                CTGDDNM = ADDR(INDDVAL);  /*  INPUT DD NAME ADDRESS */
         LA    @15,INDDVAL(,@15)                                   1019
         ST    @15,CTGDDNM(,@07)                                   1019
*              ELSE                                        /*@YL026UA*/
*                CTGDDNM = ADDR(ALLDDN);   /*  INPUT DD NAME ADDRESS */
         B     @RC01018                                            1020
@RF01018 L     @07,ALLPTR                                          1020
         LA    @07,ALLDDN(,@07)                                    1020
         L     @01,CTGPLPTR                                        1020
         ST    @07,CTGDDNM(,@01)                                   1020
*            IF CTGPSWD = NULLPTR                                  1021
*              THEN                                                1021
@RC01018 SLR   @07,@07                                             1021
         L     @15,CTGPLPTR                                        1021
         C     @07,CTGPSWD(,@15)                                   1021
         BNE   @RF01021                                            1021
*                DO;                                               1022
*                CTGFLPTR =  PTRCPL(1) -> CTGFIELD(IPASSWOR);      1023
         L     @01,PTRCPL                                          1023
         L     CTGFLPTR,CTGFIELD+36(,@01)                          1023
*                IF CTGFLNG(1) ^= 0                                1024
*                  THEN                                            1024
         C     @07,CTGFLNG(,CTGFLPTR)                              1024
         BE    @RF01024                                            1024
*                    CTGPSWD = CTGFLPT(1); /*  CLUSTER PASSWORD      */
         L     @07,CTGFLPT(,CTGFLPTR)                              1025
         ST    @07,CTGPSWD(,@15)                                   1025
*                END;                                              1026
*                                                                  1026
@RF01024 DS    0H                                                  1027
*            END;                                                  1027
*                                                                  1027
@RF01021 DS    0H                                                  1028
*        /************************************************************/
*        /*                                                          */
*        /*  GET CORE FOR CATALOG WORK AREA WHERE OBJECT NAMES       */
*        /*  OF DELETED OBJECTS WILL BE RETURNED                     */
*        /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1028
*        DSIZE = NUMOBJ * NMLENGTH +4;                     /*@Y30SSFR*/
*                                                                  1028
@RC01011 LH    @07,NUMOBJ                                          1028
         MH    @07,NMLENGTH                                        1028
         AL    @07,@CF00043                                        1028
         ST    @07,DSIZE                                           1028
*        CALL IDCSAGP0 (GDTTBL,DSIZE,CTGWKA,GPID,SETZERO);         1029
*                                                                  1029
         L     @07,@PC00001                                        1029
         ST    @07,@AL00001                                        1029
         LA    @03,DSIZE                                           1029
         ST    @03,@AL00001+4                                      1029
         L     @03,CTGPLPTR                                        1029
         LA    @03,CTGWKA(,@03)                                    1029
         ST    @03,@AL00001+8                                      1029
         LA    @03,GPID                                            1029
         ST    @03,@AL00001+12                                     1029
         LA    @03,SETZERO                                         1029
         ST    @03,@AL00001+16                                     1029
         MVI   @AL00001+16,X'80'                                   1029
         L     @15,GDTGPL(,@07)                                    1029
         LA    @01,@AL00001                                        1029
         BALR  @14,@15                                             1029
*        RESPECIFY RTNREG RSTD;                                    1030
*        TESTRC = RTNREG;                                          1031
         LR    TESTRC,RTNREG                                       1031
*        RESPECIFY RTNREG UNRSTD;                                  1032
*        IF TESTRC ^= 0                                            1033
*          THEN                                                    1033
         LTR   TESTRC,TESTRC                                       1033
         BZ    @RF01033                                            1033
*            DO;                                                   1034
*            DARGSMOD = UNIVMSG;                                   1035
         L     @07,DDSTRU                                          1035
         MVC   DARGSMOD(3,@07),@CC00930                            1035
*            DEFSTID = NOSTORAG;                                   1036
         LA    DEFSTID,4                                           1036
*            RETURN CODE(LASTCC12);                                1037
         LA    @15,12                                              1037
         L     @14,@SA00008                                        1037
         LM    @00,@05,@SA00008+8                                  1037
         LM    @07,@12,@SA00008+32                                 1037
         BR    @14                                                 1037
*            END;                                                  1038
*        AREALN = DSIZE;                                           1039
*                                                                  1039
@RF01033 L     @07,CTGPLPTR                                        1039
         L     @07,CTGWKA(,@07)                                    1039
         L     @15,DSIZE                                           1039
         STH   @15,AREALN(,@07)                                    1039
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THE TYPE IS EITHER CLUSTER OR AIX, FINISH    @Y30SSFR*/
*        /*  BUILDING THE CPL AND CALL CATALOG TO DELETE     @Y30SSFR*/
*        /*  THE OBJECT.                                     @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1040
*        IF DTYPE = CTGTCL  DTYPE = CTGTAIX                       1040
*          THEN                                                    1040
         L     @07,@PC00008                                        1040
         CLI   DTYPE(@07),C'C'                                     1040
         BE    @RT01040                                            1040
         CLI   DTYPE(@07),C'G'                                     1040
         BNE   @RF01040                                            1040
@RT01040 DS    0H                                                  1041
*PERMEXP:    DO;                                           /*@Y30SSFR*/
*                                                                  1041
PERMEXP  DS    0H                                                  1042
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF ERASE OR NOERASE WAS SPECIFIED ON THE    @Y30SSFR*/
*            /*  EXPORT COMMAND, SET THE APPROPRIATE BITS.   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1042
*            IF ADDR(ERASE) ^= NULLPTR                             1042
*              THEN                                                1042
         L     @07,@PC00001+4                                      1042
         L     @07,FDTPTR+36(,@07)                                 1042
         LTR   @07,@07                                             1042
         BZ    @RF01042                                            1042
*                DO;                                       /*@Y30SSFR*/
*                CTGERASE = ON;                            /*@Y30SSFR*/
*                CTGOVRID = ON;                            /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        1045
         OI    CTGERASE(@07),B'01000100'                           1045
*                END;                                      /*@Y30SSFR*/
*              ELSE                                                1047
*                IF ADDR(NOERS) ^= NULLPTR                         1047
*                  THEN                                            1047
         B     @RC01042                                            1047
@RF01042 L     @07,@PC00001+4                                      1047
         L     @07,FDTPTR+40(,@07)                                 1047
         LTR   @07,@07                                             1047
         BZ    @RF01047                                            1047
*                    CTGOVRID = ON;                        /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        1048
         OI    CTGOVRID(@07),B'00000100'                           1048
*                  ELSE ;                                  /*@Y30SSFR*/
*                                                                  1049
@RF01047 DS    0H                                                  1050
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF PURGE WAS SPECIFIED ON THE AMS COMMAND,  @Y30SSFR*/
*            /*  SET THE CTGPURG BIT TO ON.                  @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1050
*            IF ADDR(PURGE) ^= NULLPTR                             1050
*              THEN                                                1050
@RC01042 L     @07,@PC00001+4                                      1050
         L     @07,FDTPTR+44(,@07)                                 1050
         LTR   @07,@07                                             1050
         BZ    @RF01050                                            1050
*                CTGPURG = ON;                             /*@Y30SSFR*/
*                                                                  1051
         L     @07,CTGPLPTR                                        1051
         OI    CTGPURG(@07),B'00100000'                            1051
*            /*********************************************************
*            /*                                              @Y30SSFR*/
*            /*  SAVE THE DELETE CPL                         @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1052
*            CTGPLPTR = DCPLPTR;                           /*@Y30SSFR*/
@RF01050 L     @07,DCPLPTR                                         1052
         ST    @07,CTGPLPTR                                        1052
*            DSAVCPL = CTGPL;                              /*@Y30SSFR*/
         MVC   DSAVCPL(28),CTGPL(@07)                              1053
*            DEFINED = ON;                                 /*@Y30SSFR*/
*                                                                  1054
         OI    DEFINED,B'10000000'                                 1054
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CALL THE VSAM CATALOG WITH REGISTER 1       @Y30SSFR*/
*            /*  POINTING TO THE CATALOG PARAMETER LIST.     @Y30SSFR*/
*            /*  THE CATALOG IS CALLED ITERATIVELY UNTIL A   @Y30SSFR*/
*            /*  TERMINATING ERROR OCCURS OR UNTIL THE ENTIRE@Y30SSFR*/
*            /*  STRUCTURE ASSOCIATED WITH THE ENTRY BEING   @Y30SSFR*/
*            /*  DELETED HAS BEEN REMOVED FROM THE CATALOG.  @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1055
*CATALOG:     DO WHILE DEFINED = ON;                       /*@Y30SSFR*/
*                                                                  1055
CATALOG  B     @DE01055                                            1055
@DL01055 DS    0H                                                  1056
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  SET THE LOOP CONTROL VARIABLE TO OFF      @Y30SSFR*/
*              /*  AND SAVE THE CTGPL BEFORE INVOKING        @Y30SSFR*/
*              /*  VSAM CATALOG MANAGEMENT.                  @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1056
*              DEFINED = OFF;                              /*@Y30SSFR*/
         NI    DEFINED,B'01111111'                                 1056
*              DSAVCPL = CTGPL;                            /*@Y30SSFR*/
*                                                                  1057
         L     @07,CTGPLPTR                                        1057
         MVC   DSAVCPL(28),CTGPL(@07)                              1057
*              CALL IDCSACA0 (GDTTBL,DCPLPTR);             /*@Y30SSFR*/
*                                                                  1058
         L     @07,@PC00001                                        1058
         ST    @07,@AL00001                                        1058
         LA    @15,DCPLPTR                                         1058
         ST    @15,@AL00001+4                                      1058
         L     @15,GDTCAT(,@07)                                    1058
         LA    @01,@AL00001                                        1058
         BALR  @14,@15                                             1058
*              RESPECIFY REG15 RSTD;                       /*@Y30SSFR*/
*              CATLGRC = REG15;                            /*@Y30SSFR*/
         STH   REG15,CATLGRC                                       1060
*              RESPECIFY REG15 UNRSTD;                     /*@Y30SSFR*/
*                                                                  1061
*              IF GDTDBG = NULLPTR                                 1062
*                THEN;                                             1062
         L     @07,@PC00001                                        1062
         L     @07,GDTDBG(,@07)                                    1062
         LTR   @07,@07                                             1062
         BZ    @RT01062                                            1062
*                ELSE                                              1064
*                  CALL IDCDB010 (GDTTBL,'XPZY');                  1064
         L     @07,@PC00001                                        1064
         ST    @07,@AL00001                                        1064
         LA    @15,@CC01259                                        1064
         ST    @15,@AL00001+4                                      1064
         MVI   @AL00001+4,X'80'                                    1064
         L     @15,GDTDBG(,@07)                                    1064
         LA    @01,@AL00001                                        1064
         BALR  @14,@15                                             1064
*                                                          /*@Y30SSFR*/
*                                                                  1065
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  INITIALIZE THE VALUE OF MNOENT TO ZERO    @Y30SSFR*/
*              /*  IN CASE CATALOG RETURNS WITH RETURNLN     @Y30SSFR*/
*              /*  EQUAL TO 4, AND A RETURN CODE OF 40.      @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1065
*              MNOENT = 0;                                 /*@Y30SSFR*/
*                                                                  1065
@RT01062 SLR   @07,@07                                             1065
         ST    @07,MNOENT                                          1065
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  IF CATALOG HAS SET RETURNLN TO A VALUE    @Y30SSFR*/
*              /*  GREATER THAN 4, THERE ARE NAMES IN THE    @Y30SSFR*/
*              /*  WORK AREA TO BE PRINTED.  EXCEPT WHEN     @Y30SSFR*/
*              /*  THE VSAM CATALOG RETURN CODE IS 72, ALL   @Y30SSFR*/
*              /*  OF THE NAMES IN WORKAREA ARE TO BE        @Y30SSFR*/
*              /*  PRINTED.  WHEN THE RETURN CODE IS 72,     @Y30SSFR*/
*              /*  THE LAST NAME IN THE WORKAREA IS THE      @Y30SSFR*/
*              /*  NAME OF THE OBJECT TO BE ALLOCATED.       @Y30SSFR*/
*              /*  IT AND ITS IMMEDIATE ASSOCIATIONS HAVE    @Y30SSFR*/
*              /*  NOT BEEN DELETED, AND SO MUST NOT BE      @Y30SSFR*/
*              /*  PRINTED.                                  @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1066
*              IF RETURNLN > 4                                     1066
*                THEN                                              1066
*                                                                  1066
         L     @07,CTGPLPTR                                        1066
         L     @07,CTGWKA(,@07)                                    1066
         LH    @07,RETURNLN(,@07)                                  1066
         C     @07,@CF00043                                        1066
         BNH   @RF01066                                            1066
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF THE VSAM CATALOG RETURN CODE       @Y30SSFR*/
*                  /*  IS 40, THEN THE VALUE OF RETURNLN     @Y30SSFR*/
*                  /*  IS THE SUM OF THE AMOUNT OF SPACE     @Y30SSFR*/
*                  /*  IN THE WORKAREA THAT IS BEING USED    @Y30SSFR*/
*                  /*  CURRENTLY AND THE AMOUNT THAT CMS     @Y30SSFR*/
*                  /*  REQUIRES ON THE NEXT ITERATION.       @Y30SSFR*/
*                  /*  ACCORDINGLY, A SPECIAL CALCULATION    @Y30SSFR*/
*                  /*  IS REQUIRED TO DETERMINE HOW MANY     @Y30SSFR*/
*                  /*  NAMES TO PRINT.                       @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1067
*                  IF CATLGRC = NEEDCORE                   /*@Y30SSFR*/
*                     THEN                                 /*@Y30SSFR*/
         CLC   CATLGRC(2),@CH01110                                 1067
         BNE   @RF01067                                            1067
*MPRTLP:                DO;                                 /*@Y30SSFR*
*                                                                  1068
MPRTLP   DS    0H                                                  1069
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  SET UP THE DARGLIST FOR THE ENTRY @Y30SSFR*/
*                      /*  DELETED MESSAGE.                  @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1069
*                      DARGSMOD = DELMSG;                  /*@Y30SSFR*/
         L     @07,DDSTRU                                          1069
         MVC   DARGSMOD(3,@07),@CC00938                            1069
*                      DARGSENT = ENTRYMSG;                /*@Y30SSFR*/
*                                                                  1070
         MVI   DARGSENT(@07),X'01'                                 1070
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CALCULATE THE MAXIMUM NUMBER      @Y30SSFR*/
*                      /*  OF ITEMS THAT WILL FIT INTO THE   @Y30SSFR*/
*                      /*  CURRENT WORK AREA.  THEN LOOP     @Y30SSFR*/
*                      /*  PRINTING NAMES UNTIL THIS LIMIT   @Y30SSFR*/
*                      /*  IS REACHED OR AN EMPTY SLOT IS    @Y30SSFR*/
*                      /*  FOUND.                            @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1071
*                      LIMIT = (AREALN - 4) /              /*@Y30SSFR*/
*                      LENGTH(ENTITEM);                    /*@Y30SSFR*/
         LA    @03,45                                              1071
         L     @01,CTGPLPTR                                        1071
         L     @01,CTGWKA(,@01)                                    1071
         LH    @00,AREALN(,@01)                                    1071
         SL    @00,@CF00043                                        1071
         SRDA  @00,32                                              1071
         DR    @00,@03                                             1071
         ST    @01,LIMIT                                           1071
*                      IX = 1;                             /*@Y30SSFR*/
         LA    IX,1                                                1072
*                      DARGILP = LENGTH(ENTLIST(1));       /*@Y30SSFR*/
*                                                                  1073
         STH   @03,DARGILP(,@07)                                   1073
*                      DO WHILE IX <= LIMIT &              /*@Y30SSFR*/
*                      ENTRYTYP(IX) ^= 0;                  /*@Y30SSFR*/
         B     @DE01074                                            1074
@DL01074 DS    0H                                                  1075
*                        DARGDBP = ADDR(ENTLIST(IX));      /*@Y30SSFR*/
*                                                                  1075
         LR    @07,IX                                              1075
         MH    @07,@CH00912                                        1075
         L     @03,CTGPLPTR                                        1075
         L     @03,CTGWKA(,@03)                                    1075
         AL    @03,@CF01373                                        1075
         LA    @07,ENTLIST-4(@07,@03)                              1075
         L     @03,DDSTRU                                          1075
         ST    @07,DARGDBP(,@03)                                   1075
*                        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*   1076
*                                                            @Y30SSFR*/
*                                                                  1076
         L     @07,@PC00001                                        1076
         ST    @07,@AL00001                                        1076
         LA    @03,@CF00116                                        1076
         ST    @03,@AL00001+4                                      1076
         LA    @03,DDSTRU                                          1076
         ST    @03,@AL00001+8                                      1076
         MVI   @AL00001+8,X'80'                                    1076
         L     @15,GDTPRT(,@07)                                    1076
         LA    @01,@AL00001                                        1076
         BALR  @14,@15                                             1076
*                        IX = IX + 1;                      /*@Y30SSFR*/
         AL    IX,@CF00220                                         1077
*                      END;                                /*@Y30SSFR*/
*                                                                  1078
@DE01074 C     IX,LIMIT                                            1078
         BH    @DC01074                                            1078
         LR    @07,IX                                              1078
         MH    @07,@CH00912                                        1078
         L     @03,CTGPLPTR                                        1078
         L     @03,CTGWKA(,@03)                                    1078
         AL    @03,@CF01373                                        1078
         SLR   @15,@15                                             1078
         IC    @15,ENTRYTYP-4(@07,@03)                             1078
         C     @15,@CF00116                                        1078
         BNE   @DL01074                                            1078
@DC01074 DS    0H                                                  1079
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  UPON EXITING THE LOOP THE VALUE   @Y30SSFR*/
*                      /*  OF IX IS ONE MORE THAN THE ACTUAL @Y30SSFR*/
*                      /*  NUMBER OF ENTRIES IN THE WORK     @Y30SSFR*/
*                      /*  WORK AREA.  SUBTRACT ONE TO GET   @Y30SSFR*/
*                      /*  THE VALUE TO BE PASSED TO MORESP. @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1079
*                      MNOENT = IX - 1;                    /*@Y30SSFR*/
*                                                                  1079
         LR    @07,IX                                              1079
         BCTR  @07,0                                               1079
         ST    @07,MNOENT                                          1079
*                      END MPRTLP;                         /*@Y30SSFR*/
*                                                                  1080
*                    ELSE                                  /*@Y30SSFR*/
*                                                                  1081
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  IF THE VSAM CATALOG RETURN CODE   @Y30SSFR*/
*                      /*  IS 72 OR 76, THEN THE LAST ITEM   @Y30SSFR*/
*                      /*  IN THE WORKAREA IS THE NAME OF AN @Y30SSFR*/
*                      /*  OBJECT THAT MUST BE DYNAMICALLY   @Y30SSFR*/
*                      /*  ALLOCATED.  NOTE THAT THIS THING  @Y30SSFR*/
*                      /*  HAS NOT BEEN DELETED YET,         @Y30SSFR*/
*                      /*  AND SO MUST NOT BE PRINTED.       @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1081
*                      IF (CATLGRC = ALLORC1)             /*@Y30SSFR*/
*                           (CATLGRC = ALLORC3)            /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
         B     @RC01067                                            1081
@RF01067 LH    @07,CATLGRC                                         1081
         C     @07,@CF01112                                        1081
         BE    @RT01081                                            1081
         C     @07,@CF01114                                        1081
         BNE   @RF01081                                            1081
@RT01081 DS    0H                                                  1082
*A1PRTLP:                  DO;                             /*@Y30SSFR*/
*                                                                  1082
A1PRTLP  DS    0H                                                  1083
*                          LIMIT = ((RETURNLN - 4) /       /*@Y30SSFR*/
*                          LENGTH(ENTITEM)) -1 ;           /*@Y30SSFR*/
*                                                                  1083
         LA    @07,45                                              1083
         L     @03,CTGPLPTR                                        1083
         L     @03,CTGWKA(,@03)                                    1083
         LH    @00,RETURNLN(,@03)                                  1083
         SL    @00,@CF00043                                        1083
         SRDA  @00,32                                              1083
         DR    @00,@07                                             1083
         BCTR  @01,0                                               1083
         ST    @01,LIMIT                                           1083
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  LOOP, PRINTING THE NAMES OF   @Y30SSFR*/
*                          /*  THE ENTRIES DELETED SO FAR.   @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1084
*                          DARGSMOD = DELMSG;              /*@Y30SSFR*/
         L     @03,DDSTRU                                          1084
         MVC   DARGSMOD(3,@03),@CC00938                            1084
*                          DARGSENT = ENTRYMSG;            /*@Y30SSFR*/
         MVI   DARGSENT(@03),X'01'                                 1085
*                          IX = 1;                         /*@Y30SSFR*/
         LA    IX,1                                                1086
*                          DARGILP = LENGTH(ENTLIST(1));   /*@Y30SSFR*/
*                                                                  1087
         STH   @07,DARGILP(,@03)                                   1087
*                          DO WHILE IX <= LIMIT &          /*@Y30SSFR*/
*                          ENTRYTYP(IX) ^= 0;              /*@Y30SSFR*/
         B     @DE01088                                            1088
@DL01088 DS    0H                                                  1089
*                            DARGDBP = ADDR(ENTLIST(IX));  /*@Y30SSFR*/
*                                                                  1089
         LR    @07,IX                                              1089
         MH    @07,@CH00912                                        1089
         L     @03,CTGPLPTR                                        1089
         L     @03,CTGWKA(,@03)                                    1089
         AL    @03,@CF01373                                        1089
         LA    @07,ENTLIST-4(@07,@03)                              1089
         L     @03,DDSTRU                                          1089
         ST    @07,DARGDBP(,@03)                                   1089
*                            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*
*                                                            @Y30SSFR*/
*                                                                  1090
         L     @07,@PC00001                                        1090
         ST    @07,@AL00001                                        1090
         LA    @03,@CF00116                                        1090
         ST    @03,@AL00001+4                                      1090
         LA    @03,DDSTRU                                          1090
         ST    @03,@AL00001+8                                      1090
         MVI   @AL00001+8,X'80'                                    1090
         L     @15,GDTPRT(,@07)                                    1090
         LA    @01,@AL00001                                        1090
         BALR  @14,@15                                             1090
*                            IX = IX + 1;                  /*@Y30SSFR*/
         AL    IX,@CF00220                                         1091
*                          END;                            /*@Y30SSFR*/
@DE01088 C     IX,LIMIT                                            1092
         BH    @DC01088                                            1092
         LR    @07,IX                                              1092
         MH    @07,@CH00912                                        1092
         L     @03,CTGPLPTR                                        1092
         L     @03,CTGWKA(,@03)                                    1092
         AL    @03,@CF01373                                        1092
         SLR   @15,@15                                             1092
         IC    @15,ENTRYTYP-4(@07,@03)                             1092
         C     @15,@CF00116                                        1092
         BNE   @DL01088                                            1092
@DC01088 DS    0H                                                  1093
*                          END A1PRTLP;                    /*@Y30SSFR*/
*                                                                  1093
*                        ELSE                              /*@Y30SSFR*/
*                                                                  1094
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  IN ALL OTHER CASES THE VALUE  @Y30SSFR*/
*                          /*  OF RETURNLN IS AN ACCURATE    @Y30SSFR*/
*                          /*  INIDCATION OF HOW MANY ITEMS  @Y30SSFR*/
*                          /*  ARE TO BE PRINTED.            @Y30SSFR*/
*                          /*  CALCULATE THE NUMBER OF ITEMS @Y30SSFR*/
*                          /*  IN THE WORKAREA AND PRINT     @Y30SSFR*/
*                          /*  THEM OUT.                     @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1094
*OTPRTLP:                  DO;                             /*@Y30SSFR*/
*                                                                  1094
         B     @RC01081                                            1094
@RF01081 DS    0H                                                  1094
OTPRTLP  DS    0H                                                  1095
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  CALCULATE THE NUMBER OF ITEMS @Y30SSFR*/
*                          /*  TO BE PRINTED.  SET THE       @Y30SSFR*/
*                          /*  MODULE AND ENTRY ID'S AND     @Y30SSFR*/
*                          /*  THE ENTRY LENGTH IN THE       @Y30SSFR*/
*                          /*  DARGLIST.                     @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1095
*                          ENTRYNO = (RETURNLN - 4)/       /*@Y30SSFR*/
*                          LENGTH(ENTLIST);                /*@Y30SSFR*/
         LA    @07,45                                              1095
         L     @01,CTGPLPTR                                        1095
         L     @01,CTGWKA(,@01)                                    1095
         LH    @00,RETURNLN(,@01)                                  1095
         SL    @00,@CF00043                                        1095
         SRDA  @00,32                                              1095
         DR    @00,@07                                             1095
         LR    ENTRYNO,@01                                         1095
*                          DARGSMOD = DELMSG;              /*@Y30SSFR*/
         L     @03,DDSTRU                                          1096
         MVC   DARGSMOD(3,@03),@CC00938                            1096
*                          DARGSENT = ENTRYMSG;            /*@Y30SSFR*/
         MVI   DARGSENT(@03),X'01'                                 1097
*                          DARGILP = LENGTH(ENTLIST(1));   /*@Y30SSFR*/
*                                                                  1098
         STH   @07,DARGILP(,@03)                                   1098
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  LOOP PRINTING THE NAMES OF    @Y30SSFR*/
*                          /*  THE OBJECTS DELETED SO FAR BY @Y30SSFR*/
*                          /*  CATALOG MANAGEMENT.           @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1099
*                          DO I = 1 TO ENTRYNO;            /*@Y30SSFR*/
         LA    I,1                                                 1099
         B     @DE01099                                            1099
@DL01099 DS    0H                                                  1100
*                            DARGDBP = ADDR(ENTLIST(I));   /*@Y30SSFR*/
*                                                                  1100
         LR    @07,I                                               1100
         MH    @07,@CH00912                                        1100
         L     @05,CTGPLPTR                                        1100
         L     @05,CTGWKA(,@05)                                    1100
         AL    @05,@CF01373                                        1100
         LA    @07,ENTLIST-4(@07,@05)                              1100
         L     @05,DDSTRU                                          1100
         ST    @07,DARGDBP(,@05)                                   1100
*                            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*
*                                                            @Y30SSFR*/
*                                                                  1101
         L     @07,@PC00001                                        1101
         ST    @07,@AL00001                                        1101
         LA    @05,@CF00116                                        1101
         ST    @05,@AL00001+4                                      1101
         LA    @05,DDSTRU                                          1101
         ST    @05,@AL00001+8                                      1101
         MVI   @AL00001+8,X'80'                                    1101
         L     @15,GDTPRT(,@07)                                    1101
         LA    @01,@AL00001                                        1101
         BALR  @14,@15                                             1101
*                          END;                            /*@Y30SSFR*/
*                                                                  1102
         AL    I,@CF00220                                          1102
@DE01099 CR    I,ENTRYNO                                           1102
         BNH   @DL01099                                            1102
*                          END OTPRTLP;                    /*@Y30SSFR*/
*                                                                  1103
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  NOW TEST THE VSAM CATALOG RETURN CODE     @Y30SSFR*/
*              /*  TO DETERMINE THE COURSE OF FURTHER        @Y30SSFR*/
*              /*  PROCESSING.  A VSAM CATALOG RETURN        @Y30SSFR*/
*              /*  CODE OF 40 INDICATES THAT CATALOG NEEDS   @Y30SSFR*/
*              /*  A LARGER WORK AREA.  MORESP IS INVOKED    @Y30SSFR*/
*              /*  TO HANDLE THIS.  A CATALOG RETURN CODE    @Y30SSFR*/
*              /*  OF 72 IS AN ALLOCATION REQUEST.  THE      @Y30SSFR*/
*              /*  NAME OF THE THING TO BE ALLOCATED IS THE  @Y30SSFR*/
*              /*  LAST ITEM IN THE WORKAREA.  ANY OTHER     @Y30SSFR*/
*              /*  NON-ZERO RETURN CODE IS A TERMINAL ERROR. @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1104
*              IF CATLGRC = NEEDCORE                               1104
*                THEN                                              1104
*                                                                  1104
@RC01081 DS    0H                                                  1104
@RC01067 DS    0H                                                  1104
@RF01066 CLC   CATLGRC(2),@CH01110                                 1104
         BNE   @RF01104                                            1104
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  THE VSAM CATALOG RETURN CODE IS 40.   @Y30SSFR*/
*                  /*  CALL MORESP TO GET A NEW WORKAREA OR  @Y30SSFR*/
*                  /*  CLEAR THE OLD ONE.  IF IT IS SUCCESS- @Y30SSFR*/
*                  /*  FUL SET DEFINED TO BE ON TO INDICATE  @Y30SSFR*/
*                  /*  ANOTHER ITERATION OF THE LOOP CATALOG @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1105
*NCRC:             DO;                                     /*@Y30SSFR*/
NCRC     DS    0H                                                  1106
*                  CALL MORESP(MNOENT);                    /*@Y30SSFR*/
         LA    @07,MNOENT                                          1106
         ST    @07,@AL00001                                        1106
         LA    @01,@AL00001                                        1106
         BAL   @14,MORESP                                          1106
*                  RESPECIFY RTNREG RSTD;                          1107
*                  TESTRC = RTNREG;                                1108
         LR    TESTRC,RTNREG                                       1108
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30SSFR*/
*                  IF TESTRC ^= 0                          /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1110
         BZ    @RF01110                                            1110
*                      DO;                                 /*@Y30SSFR*/
*                      SETRC = LASTCC08;                   /*@Y30SSFR*/
         LA    @07,8                                               1112
         STH   @07,SETRC                                           1112
*                      RETURN CODE(SETRC);                 /*@Y30SSFR*/
         LR    @15,@07                                             1113
         L     @14,@SA00008                                        1113
         LM    @00,@05,@SA00008+8                                  1113
         LM    @07,@12,@SA00008+32                                 1113
         BR    @14                                                 1113
*                      END;                                /*@Y30SSFR*/
*                  DEFINED = ON;                           /*@Y30SSFR*/
@RF01110 OI    DEFINED,B'10000000'                                 1115
*                  END NCRC;                               /*@Y30SSFR*/
*                                                                  1116
*                ELSE                                      /*@Y30SSFR*/
*                                                                  1117
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  TEST FOR A VSAM CATALOG RETURN CODE   @Y30SSFR*/
*                  /*  OF 72 OR 76.                          @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /***************************************************
*                                                                  1117
*                  IF (CATLGRC = ALLORC1)  (CATLGRC = ALLORC3)    1117
*                    THEN                                          1117
*                                                                  1117
         B     @RC01104                                            1117
@RF01104 LH    @07,CATLGRC                                         1117
         C     @07,@CF01112                                        1117
         BE    @RT01117                                            1117
         C     @07,@CF01114                                        1117
         BNE   @RF01117                                            1117
@RT01117 DS    0H                                                  1118
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  THE VSAM CATALOG RETURN CODE IS   @Y30SSFR*/
*                      /*  72 OR 76. DYNAMICALLY ALLOCATE THE@Y30SSFR*/
*                      /*  OBJECT NAMED BY THE LAST ENTRY    @Y30SSFR*/
*                      /*  IN THE WORKAREA.                  @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1118
*A1RC:                 DO;                                 /*@Y30SSFR*/
A1RC     DS    0H                                                  1119
*                      ALLOINDX = (RETURNLN-4)/            /*@Y30SSFR*/
*                      LENGTH(ENTITEM);                    /*@Y30SSFR*/
*                                                                  1119
         L     @07,CTGPLPTR                                        1119
         L     @07,CTGWKA(,@07)                                    1119
         LH    @00,RETURNLN(,@07)                                  1119
         SL    @00,@CF00043                                        1119
         SRDA  @00,32                                              1119
         D     @00,@CF00912                                        1119
         LR    ALLOINDX,@01                                        1119
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  ALLOINDX IS THE INDEX OF THE LAST @Y30SSFR*/
*                      /*  ENTRY IN THE CMS WORKAREA. IN     @Y30SSFR*/
*                      /*  TO DYNAMICALLY ALLOCATE THIS      @Y30SSFR*/
*                      /*  OBJECT, WE MUST FIRST TEST TO     @Y30SSFR*/
*                      /*  DETERMINE IF THE ALLAGL IS IN     @Y30SSFR*/
*                      /*  USE DUE TO A PRIOR CALL TO        @Y30SSFR*/
*                      /*  DYNAMIC ALLOCATION.               @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1120
*                      IF DEALLOC = ON                     /*@Y30SSFR*/
*                        THEN                              /*@Y30SSFR*/
*                                                                  1120
         TM    DEALLOC,B'10000000'                                 1120
         BNO   @RF01120                                            1120
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  DYNAMIC ALLOCATION HAS BEEN   @Y30SSFR*/
*                          /*  USED PREVIOUSLY.  SET DEALLOC @Y30SSFR*/
*                          /*  TO OFF TO INDICATE THAT       @Y30SSFR*/
*                          /*  DYNAMIC UNALLOCATION HAS BEEN @Y30SSFR*/
*                          /*  ATTEMPTED.                    @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1121
*                          DO;                             /*@Y30SSFR*/
*                          DEALLOC = OFF;                  /*@Y30SSFR*/
*                                                                  1122
         NI    DEALLOC,B'01111111'                                 1122
*                          /******************************************/
*                          /*                                @Y30SSFR*/
*                          /*  ISSUE THE UDEALLOC REQUEST,   @Y30SSFR*/
*                          /*  AND SET THE VALUE OF SETRC    @Y30SSFR*/
*                          /*  ACCORDINGLY.                  @Y30SSFR*/
*                          /*                                @Y30SSFR*/
*                          /******************************************/
*                                                                  1123
*                          CALL IDCSADL0(GDTTBL,ALLAGL);   /*@Y30SSFR*/
         L     @07,@PC00001                                        1123
         ST    @07,@AL00001                                        1123
         L     @01,ALLPTR                                          1123
         ST    @01,@AL00001+4                                      1123
         MVI   @AL00001+4,X'80'                                    1123
         L     @15,GDTDLC(,@07)                                    1123
         LA    @01,@AL00001                                        1123
         BALR  @14,@15                                             1123
*                          RESPECIFY RTNREG RSTD;                  1124
*                          TESTRC = RTNREG;                        1125
         LR    TESTRC,RTNREG                                       1125
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30SSFR*/
*                          IF TESTRC ^= 0                  /*@Y30SSFR*/
*                            THEN                          /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1127
         BZ    @RF01127                                            1127
*                              DO;                         /*@Y30SSFR*/
*                              SETRC = MAX(SETRC,          /*@Y30SSFR*/
*                              LASTCC08);                  /*@Y30SSFR*/
         LH    @07,SETRC                                           1129
         LA    @15,8                                               1129
         CR    @07,@15                                             1129
         BNL   *+6
         LR    @07,@15                                             1129
         STH   @07,SETRC                                           1129
*                              RETURN CODE(SETRC);         /*@Y30SSFR*/
         LR    @15,@07                                             1130
         L     @14,@SA00008                                        1130
         LM    @00,@05,@SA00008+8                                  1130
         LM    @07,@12,@SA00008+32                                 1130
         BR    @14                                                 1130
*                              END;                        /*@Y30SSFR*/
*                      END;                                /*@Y30SSFR*/
*                                                                  1132
@RF01127 DS    0H                                                  1133
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  BUILD AN ALLAGL FOR THE OBJECT TO BE  @Y30SSFR*/
*                  /*  ALLOCATED.  POINT TO THAT PART OF     @Y30SSFR*/
*                  /*  MAIN STORAGE IN WHICH THE ALLAGL IS   @Y30SSFR*/
*                  /*  TO BE BUILT, AND CLEAR IT.            @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1133
*                  ALLPTR = ADDR(ALLLIST);                 /*@Y30SSFR*/
@RF01120 LA    @07,ALLLIST                                         1133
         ST    @07,ALLPTR                                          1133
*                  ALLAGL = ''B;                           /*@Y30SSFR*/
*                                                                  1134
         XC    ALLAGL(31,@07),ALLAGL(@07)                          1134
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  SET A POINTER TO THE DSNAME IN THE    @Y30SSFR*/
*                  /*  ALLAGL.                               @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1135
*                  ALLDSN = ADDR(ENTRYNM(ALLOINDX));       /*@Y30SSFR*/
*                                                                  1135
         LR    @15,ALLOINDX                                        1135
         MH    @15,@CH00912                                        1135
         L     @01,CTGPLPTR                                        1135
         L     @01,CTGWKA(,@01)                                    1135
         AL    @01,@CF01374                                        1135
         LA    @15,ENTRYNM-5(@15,@01)                              1135
         ST    @15,ALLDSN(,@07)                                    1135
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  SELECT ALLOCATION OPTIONS.            @Y30SSFR*/
*                  /*  (1) ALLOCATION BY DATA SET NAME       @Y30SSFR*/
*                  /*  (2) STATUS = OLD                      @Y30SSFR*/
*                  /*  (3) DISP = KEEP                       @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1136
*                  ALLOPTVL = OFF;                         /*@Y30SSFR*/
*                  ALLOPTDS = ON;                          /*@Y30SSFR*/
         OI    ALLOPTDS(@07),B'01000000'                           1137
         NI    ALLOPTVL(@07),B'01111111'                           1137
*                  ALLSTSOD = ON;                          /*@Y30SSFR*/
         OI    ALLSTSOD(@07),B'00000001'                           1138
*                  ALLDSPKP = ON;                          /*@Y30SSFR*/
*                                                                  1139
         OI    ALLDSPKP(@07),B'00001000'                           1139
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  ISSUE THE UALLOC, AND TEST THE        @Y30SSFR*/
*                  /*  RETURN CODE.                          @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1140
*                  CALL IDCSAAL0(GDTTBL,ALLAGL);           /*@Y30SSFR*/
*                                                                  1140
         L     @15,@PC00001                                        1140
         ST    @15,@AL00001                                        1140
         ST    @07,@AL00001+4                                      1140
         MVI   @AL00001+4,X'80'                                    1140
         L     @15,GDTALC(,@15)                                    1140
         LA    @01,@AL00001                                        1140
         BALR  @14,@15                                             1140
*                  RESPECIFY RTNREG RSTD;                          1141
*                  TESTRC = RTNREG;                                1142
         LR    TESTRC,RTNREG                                       1142
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30SSFR*/
*                  IF TESTRC = 0                           /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1144
         BNZ   @RF01144                                            1144
*                      DO;                                 /*@Y30SSFR*/
*                                                                  1145
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  THE OBJECT HAS BEEN ALLOCATED     @Y30SSFR*/
*                      /*  SUCCESSFULLY.  PLACE A POINTER    @Y30SSFR*/
*                      /*  TO THE DDNAME RETURNED IN THE     @Y30SSFR*/
*                      /*  CPL.  SET DEALLOC TO ON TO        @Y30SSFR*/
*                      /*  INDICATE THAT THE ALLAGL IS       @Y30SSFR*/
*                      /*  AGAIN IN USE.                     @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1146
*                      CTGDDNM = ADDR(ALLDDN);             /*@Y30SSFR*/
         L     @07,ALLPTR                                          1146
         LA    @07,ALLDDN(,@07)                                    1146
         L     @02,CTGPLPTR                                        1146
         ST    @07,CTGDDNM(,@02)                                   1146
*                      DEALLOC = ON;                       /*@Y30SSFR*/
*                                                                  1147
         OI    DEALLOC,B'10000000'                                 1147
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  CLEAR THE CATALOG WORKAREA.       @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1148
*                      DO IND1 = 1 TO ALLOINDX;            /*@Y30SSFR*/
         LA    IND1,1                                              1148
         B     @DE01148                                            1148
@DL01148 DS    0H                                                  1149
*                        ENTLIST(IND1) = ''B;              /*@Y30SSFR*/
         LR    @07,IND1                                            1149
         MH    @07,@CH00912                                        1149
         L     @01,CTGPLPTR                                        1149
         L     @01,CTGWKA(,@01)                                    1149
         ALR   @01,@07                                             1149
         AL    @01,@CF01373                                        1149
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1149
*                      END;                                /*@Y30SSFR*/
         AL    IND1,@CF00220                                       1150
@DE01148 CR    IND1,ALLOINDX                                       1150
         BNH   @DL01148                                            1150
*                      RETURNLN = 0;                       /*@Y30SSFR*/
*                                                                  1151
         L     @07,CTGPLPTR                                        1151
         L     @07,CTGWKA(,@07)                                    1151
         SLR   @15,@15                                             1151
         STH   @15,RETURNLN(,@07)                                  1151
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  SET DEFINED TO BE ON TO INDICATE  @Y30SSFR*/
*                      /*  ANOTHER ITERATION OF THE LOOP     @Y30SSFR*/
*                      /*  CATALOG.                          @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1152
*                      DEFINED = ON;                       /*@Y30SSFR*/
         OI    DEFINED,B'10000000'                                 1152
*                      END;                                /*@Y30SSFR*/
*                                                                  1153
*                    ELSE                                  /*@Y30SSFR*/
*                                                                  1154
*                      /**********************************************/
*                      /*                                    @Y30SSFR*/
*                      /*  DYNAMIC ALLOCATION HAS FAILED.    @Y30SSFR*/
*                      /*  MAKE SETRC 8 TO INDICATE THAT THE @Y30SSFR*/
*                      /*  THE OBJECT CANNOT BE DELETED.     @Y30SSFR*/
*                      /*  RETURN TO THE CALLIN PROCESSOR.   @Y30SSFR*/
*                      /*                                    @Y30SSFR*/
*                      /**********************************************/
*                                                                  1154
*                      DO;                                 /*@Y30SSFR*/
         B     @RC01144                                            1154
@RF01144 DS    0H                                                  1155
*                      SETRC = MAX(SETRC,LASTCC08);        /*@Y30SSFR*/
         LH    @07,SETRC                                           1155
         LA    @15,8                                               1155
         CR    @07,@15                                             1155
         BNL   *+6
         LR    @07,@15                                             1155
         STH   @07,SETRC                                           1155
*                      RETURN CODE(SETRC);                 /*@Y30SSFR*/
         LR    @15,@07                                             1156
         L     @14,@SA00008                                        1156
         LM    @00,@05,@SA00008+8                                  1156
         LM    @07,@12,@SA00008+32                                 1156
         BR    @14                                                 1156
*                      END;                                /*@Y30SSFR*/
*                    END A1RC;                             /*@Y30SSFR*/
*                                                                  1158
@RC01144 DS    0H                                                  1159
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  SAVE THE CURRENT CPL IN DSAVCPL PRIOR TO  @Y30SSFR*/
*              /*  CALLING CATALOG AGAIN.                    @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1159
*              DSAVCPL = CTGPL;                            /*@Y30SSFR*/
*                                                                  1159
@RF01117 DS    0H                                                  1159
@RC01104 L     @07,CTGPLPTR                                        1159
         MVC   DSAVCPL(28),CTGPL(@07)                              1159
*            END CATALOG;                                  /*@Y30SSFR*/
*                                                                  1160
@DE01055 TM    DEFINED,B'10000000'                                 1160
         BO    @DL01055                                            1160
*            /********************************************************/
*            /*                                              @Z40RSSA*/
*            /*  IF THE VSAM CATALOG RETURN CODE IS 110      @Z40RSSA*/
*            /*  PRINT THE REASON THE PROFILE COULD NOT BE   @Z40RSSA*/
*            /*  DELETED.                                    @Z40RSSA*/
*            /*         REASON CODE 4 - NO PROFILE           @Z40RSSA*/
*            /*         REASON CODE 8 - NOT DELETEABLE       @Z40RSSA*/
*            /*                                              @Z40RSSA*/
*            /*  IF NOT 110, SIMPLY PRINT THE VSAM RETURN CODE       */
*            /*                                              @Z40RSSA*/
*            /********************************************************/
*                                                                  1161
*               IF CATLGRC = PRNTDEL & (CTGFBFLG = NFRET          1161
*                 CTGFBFLG=NDRET) THEN                             1161
         CLC   CATLGRC(2),@CH01116                                 1161
         BNE   @RF01161                                            1161
         L     @07,CTGPLPTR                                        1161
         CLC   CTGFBFLG(2,@07),@CH00043                            1161
         BE    @RT01161                                            1161
         CLC   CTGFBFLG(2,@07),@CH00180                            1161
         BNE   @RF01161                                            1161
@RT01161 DS    0H                                                  1162
*                 DO;                                      /*@Z40RSSA*/
*                   DARGLIST=''B;                          /*@Z40RSSA*/
         L     @07,DDSTRU                                          1163
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1163
*                   DARGSMOD = DELMSG;                     /*@Z40RSSA*/
         MVC   DARGSMOD(3,@07),@CC00938                            1164
*                   IF CTGFBFLG = NFRET THEN                       1165
         L     @01,CTGPLPTR                                        1165
         CLC   CTGFBFLG(2,@01),@CH00043                            1165
         BNE   @RF01165                                            1165
*                     DARGSENT = PFNTFND;                  /*@Z40RSSA*/
         MVI   DARGSENT(@07),X'0D'                                 1166
*                   ELSE                                   /*@Z40RSSA*/
*                     DARGSENT = PFINUSE;                  /*@Z40RSSA*/
         B     @RC01165                                            1167
@RF01165 L     @07,DDSTRU                                          1167
         MVI   DARGSENT(@07),X'0C'                                 1167
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);  /*@Z40RSSA*/
@RC01165 L     @07,@PC00001                                        1168
         ST    @07,@AL00001                                        1168
         LA    @15,@CF00116                                        1168
         ST    @15,@AL00001+4                                      1168
         LA    @15,DDSTRU                                          1168
         ST    @15,@AL00001+8                                      1168
         MVI   @AL00001+8,X'80'                                    1168
         L     @15,GDTPRT(,@07)                                    1168
         LA    @01,@AL00001                                        1168
         BALR  @14,@15                                             1168
*                   SETRC = LASTCC04;                      /*@Z40RSSA*/
         MVC   SETRC(2),@CH00043                                   1169
*                 END;                                     /*@Z40RSSA*/
*              ELSE                                       /*@Z40RSSA*/
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  IF THE VSAM CATALOG RETURN IS NON-ZERO,     #Y30SSFR*/
*            /*  THERE IS AN ERROR CONDITION.  PRINT THE     #Y30SSFR*/
*            /*  VSAM CATALOG RETURN CODE PROBLEM            #Y30SSFR*/
*            /*  DETERMINATION MESSAGE PROVIDED THAT         #Y30SSFR*/
*            /*  CATALOG HAS SET THE MODULE ID IN THE        #Y30SSFR*/
*            /*  CTGFDBK FIELD OF THE CPL.  OTHERWISE, JUST  #Y30SSFR*/
*            /*  PRINT THE CATALOG RETURN CODE.              #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1171
*            IF CATLGRC ^= 0                               /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         B     @RC01161                                            1171
@RF01161 LH    @07,CATLGRC                                         1171
         LTR   @07,@07                                             1171
         BZ    @RF01171                                            1171
*ERCALL2:        DO;                                       /*@Y30SSFR*/
*                                                                  1172
ERCALL2  DS    0H                                                  1173
*               /*****************************************************/
*               /*                                           @Y30SSFR*/
*               /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE  @Y30SSFR*/
*               /*  ERROR CONVERSION TABLE.                  @Y30SSFR*/
*               /*                                           @Y30SSFR*/
*               /*****************************************************/
*                                                                  1173
*               ERRORTAB = ''B;                            /*@Y30SSFR*/
*                                                                  1173
         XC    ERRORTAB(32),ERRORTAB                               1173
*               /*****************************************************/
*               /*                                           @Y30SSFR*/
*               /*  SET ERCNVADR TO POINT TO THE STORAGE FOR @Y30SSFR*/
*               /*  THE ERROR CONVERSION TABLE.              @Y30SSFR*/
*               /*                                           @Y30SSFR*/
*               /*****************************************************/
*                                                                  1174
*               ERCNVADR = ADDR(ERRORTAB);                 /*@Y30SSFR*/
*                                                                  1174
         LA    @07,ERRORTAB                                        1174
         ST    @07,ERCNVADR                                        1174
*               /*****************************************************/
*               /*                                           @Y30SSFR*/
*               /*  SET ERCATLG TO ON TO INDICATE THAT THIS  @Y30SSFR*/
*               /*  IS A CATALOG ERROR.  THE CMS             @Y30SSFR*/
*               /*  FUNCTION BEING PERFORMED IS A DELETE.    @Y30SSFR*/
*               /*  SET THE ERCATDL BIT.                     @Y30SSFR*/
*               /*                                           @Y30SSFR*/
*               /*****************************************************/
*                                                                  1175
*               ERCATLG = ON;                              /*@Y30SSFR*/
         OI    ERCATLG(@07),B'10000000'                            1175
*               ERCATDL = ON;                              /*@Y30SSFR*/
*                                                                  1176
         OI    ERCATDL(@07),B'00100000'                            1176
*               /*****************************************************/
*               /*                                           @Y30SSFR*/
*               /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT  @Y30SSFR*/
*               /*  TO POINT TO THE CPL FOR THE CATALOG      @Y30SSFR*/
*               /*  OPERATION.                               @Y30SSFR*/
*               /*                                           @Y30SSFR*/
*               /*****************************************************/
*                                                                  1177
*               ERCATRC = CATLGRC;                         /*@Y30SSFR*/
         LH    @15,CATLGRC                                         1177
         ST    @15,ERCATRC(,@07)                                   1177
*               ERCPLPT = CTGPLPTR;                        /*@Y30SSFR*/
*                                                                  1178
         L     @15,CTGPLPTR                                        1178
         ST    @15,ERCPLPT(,@07)                                   1178
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  SET A POINTER TO THE ENTRY NAME IN THE    @Y30SSFR*/
*              /*  ERROR CONVERSION TABLE.                   @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1179
*              ERDSNM = CTGENT;                            /*@Y30SSFR*/
*                                                                  1179
         L     @15,CTGENT(,@15)                                    1179
         ST    @15,ERDSNM(,@07)                                    1179
*               /*****************************************************/
*               /*                                           @Y30SSFR*/
*               /*  INVOKE THE UERROR ROUTINE BY ISSUING THE @Y30SSFR*/
*               /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.  @Y30SSFR*/
*               /*                                           @Y30SSFR*/
*               /*****************************************************/
*                                                                  1180
*               CALL IDCTPER0(GDTTBL,ERCNVADR);            /*@Y30SSFR*/
*                                                                  1180
         L     @07,@PC00001                                        1180
         ST    @07,@AL00001                                        1180
         LA    @15,ERCNVADR                                        1180
         ST    @15,@AL00001+4                                      1180
         MVI   @AL00001+4,X'80'                                    1180
         L     @15,GDTERR(,@07)                                    1180
         LA    @01,@AL00001                                        1180
         BALR  @14,@15                                             1180
*               SETRC = LASTCC08;                          /*@Y30SSFR*/
         MVC   SETRC(2),@CH00180                                   1181
*               END ERCALL2;                               /*@Y30SSFR*/
*                                                                  1182
*             ELSE                                         /*@Y30SSFR*/
*                                                                  1183
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  MAKE SETRC EQUAL TO 0 TO INDICATE THAT  #Y30SSFR*/
*                /*  THE OBJECT HAS BEEN SUCCESSFULLY        #Y30SSFR*/
*                /*  DELETED.                                #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  1183
*                SETRC = LASTCC00;                         /*#Y30SSFR*/
*                                                                  1183
         B     @RC01171                                            1183
@RF01171 SLR   @07,@07                                             1183
         STH   @07,SETRC                                           1183
*            RETURN CODE(SETRC);                           /*#Y30SSFR*/
*                                                                  1184
@RC01171 DS    0H                                                  1184
@RC01161 LH    @15,SETRC                                           1184
         L     @14,@SA00008                                        1184
         LM    @00,@05,@SA00008+8                                  1184
         LM    @07,@12,@SA00008+32                                 1184
         BR    @14                                                 1184
*            END PERMEXP;                                  /*#Y30SSFR*/
*                                                                  1185
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1186
*        RETURN CODE(0);                                           1186
*                                                                  1186
@RF01040 SLR   @15,@15                                             1186
         L     @14,@SA00008                                        1186
         LM    @00,@05,@SA00008+8                                  1186
         LM    @07,@12,@SA00008+32                                 1186
         BR    @14                                                 1186
*END DELTPROC;                                                     1187
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - PUTPROC                                */
*        /*                                                          */
*        /*  FUNCTION - OUTPUT A RECORD TO THE PORTABILITY DATA SET  */
*        /*                                                          */
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */
*        /*                                                          */
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */
*        /*                                                          */
*        /************************************************************/
*                                                                  1188
*PUTPROC:  PROCEDURE(PLNINIT,          /*LENGTH OF RECORD            */
*                    PADINIT);         /*ADDRESS OF RECORD           */
*                                                                  1188
PUTPROC  STM   @14,@12,@SA00009                                    1188
         MVC   @PC00009(8),0(@01)                                  1188
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1189
*        DCL PLNINIT FIXED(31),                                    1189
*            PADINIT PTR(31);                                      1189
*                                                                  1189
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1190
*        DCL PLN FIXED(31);            /*LENGTH OF DATA YET TO OUTPUT*/
*        DCL PAD PTR(31);              /*ADDRESS OF DATA TO OUTPUT   */
*                                                                  1191
*        /************************************************************/
*        /*                                                          */
*        /*  SET UP IOCS FOR OUTPUT OF RECORD                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1192
*        OLDERID2 = NEWERID2;                                      1192
         L     @02,@PC00001                                        1192
         L     @02,GDTTR2(,@02)                                    1192
         MVC   @TS00001(95),NEWERID2(@02)                          1192
         MVC   OLDERID2(95,@02),@TS00001                           1192
*        NEWID2 = 'XPPP';                                          1193
         MVC   NEWID2(4,@02),@CC01283                              1193
*        IOCSPTR = POUTIOCS;                                       1194
         L     IOCSPTR,POUTIOCS                                    1194
*        PAD = PADINIT;                                            1195
         L     @02,@PC00009+4                                      1195
         L     PAD,PADINIT(,@02)                                   1195
*        PLN = PLNINIT;                                            1196
*                                                                  1196
         L     @02,@PC00009                                        1196
         L     PLN,PLNINIT(,@02)                                   1196
*        /************************************************************/
*        /*                                                          */
*        /*  SPLIT RECORD INTO SEGMENTS IF LARGER THAN OUTPUT        */
*        /*  LRECL LENGTH                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1197
*        DOCNTRL = ON;                                             1197
         OI    DOCNTRL,B'10000000'                                 1197
*PUTLP:  DO WHILE (DOCNTRL= ON);                                   1198
PUTLP    B     @DE01198                                            1198
@DL01198 DS    0H                                                  1199
*          IF PLN > IOCTRN                                         1199
*            THEN                                                  1199
         L     @02,IOCTRN(,IOCSPTR)                                1199
         CR    PLN,@02                                             1199
         BNH   @RF01199                                            1199
*              DO;                                                 1200
*              IOCDLN = IOCTRN;                                    1201
         ST    @02,IOCDLN(,IOCSPTR)                                1201
*              IOCDAD = PAD;                                       1202
         ST    PAD,IOCDAD(,IOCSPTR)                                1202
*              PAD = PAD + IOCTRN;                                 1203
         ALR   PAD,@02                                             1203
*              PLN = PLN - IOCTRN;                                 1204
         SLR   PLN,@02                                             1204
*              END;                                                1205
*            ELSE                                                  1206
*              DO;                                                 1206
         B     @RC01199                                            1206
@RF01199 DS    0H                                                  1207
*              IOCDLN = PLN;                                       1207
         ST    PLN,IOCDLN(,IOCSPTR)                                1207
*              IOCDAD = PAD;                                       1208
         ST    PAD,IOCDAD(,IOCSPTR)                                1208
*              DOCNTRL = OFF;                                      1209
         NI    DOCNTRL,B'01111111'                                 1209
*              END;                                                1210
*                                                                  1210
*                                                                  1210
*        /************************************************************/
*        /*                                                          */
*        /*  OUTPUT RECORD BY ISSUANCE OF THE UGET I/O ADAPTER       */
*        /*  INTERFACE.  IF AN ERROR OCCURS, THE RETURN CODE WILL    */
*        /*  BE SET TO INDICATE FAILURE. OTHERWISE, A GOOD RETURN    */
*        /*  CODE WILL BE SET AND CONTROL WILL RETURN TO THE CALLING */
*        /*  PROCESSOR.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1211
*        CALL IDCIOPT0 (GDTTBL,POUTIOCS);                          1211
*                                                                  1211
@RC01199 L     @15,@PC00001                                        1211
         ST    @15,@AL00001                                        1211
         LA    @14,POUTIOCS                                        1211
         ST    @14,@AL00001+4                                      1211
         MVI   @AL00001+4,X'80'                                    1211
         L     @15,GDTPUT(,@15)                                    1211
         LA    @01,@AL00001                                        1211
         BALR  @14,@15                                             1211
*        RESPECIFY RTNREG RSTD;                                    1212
*        TESTRC = RTNREG;                                          1213
         LR    TESTRC,RTNREG                                       1213
*        RESPECIFY RTNREG UNRSTD;                                  1214
*        IF TESTRC ^= 0                                            1215
*          THEN                                                    1215
         LTR   TESTRC,TESTRC                                       1215
         BZ    @RF01215                                            1215
*            IF IOCMSGOP = OFF                                     1216
*              THEN                                                1216
         TM    IOCMSGOP(IOCSPTR),B'00100000'                       1216
         BNZ   @RF01216                                            1216
*                RETURN CODE(LASTCC12);                            1217
*                                                                  1217
         LA    @15,12                                              1217
         L     @14,@SA00009                                        1217
         LM    @00,@12,@SA00009+8                                  1217
         BR    @14                                                 1217
*        END PUTLP;                                                1218
*                                                                  1218
@RF01216 DS    0H                                                  1218
@RF01215 DS    0H                                                  1218
@DE01198 TM    DOCNTRL,B'10000000'                                 1218
         BO    @DL01198                                            1218
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1219
*        RETURN CODE(0);                                           1219
*                                                                  1219
         SLR   @15,@15                                             1219
         L     @14,@SA00009                                        1219
         LM    @00,@12,@SA00009+8                                  1219
         BR    @14                                                 1219
*END PUTPROC;                                                      1220
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - RECPROC                                */
*        /*                                                          */
*        /*  FUNCTION - COPY THE DATA FROM THE DATA SET TO BE        */
*        /*  EXPORTED TO THE PORTABILITY DATA SET, RECORD BY         */
*        /*  RECORD.  THE VSAM CLUSTER IS OPENED BY OPENPROC,        */
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */
*        /*  UCLOSE MACRO.                                           */
*        /*                                                          */
*        /*  INPUT - NONE                                            */
*        /*                                                          */
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL CONTAIN THE      */
*        /*  RECORDS THAT COMPRISE THE EXPORTED DATA SET             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1221
*RECPROC:  PROCEDURE;                                              1221
*                                                                  1221
RECPROC  STM   @14,@05,@SA00010                                    1221
         STM   @07,@12,@SA00010+32                                 1221
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE OUT CONTROL RECORD IDENTIFYING TYPE OF EXPORT     */
*        /*  REORGANIZE OPTION, WHERE THE LOGICAL RECORDS            */
*        /*  COMPRISING THE CLUSTER ARE COPIED TO THE PORTABILITY    */
*        /*  DATA SET      ZERO FIELDS NOT USED                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1222
*        OLDERID2 = NEWERID2;                                      1222
         L     @07,@PC00001                                        1222
         L     @07,GDTTR2(,@07)                                    1222
         MVC   @TS00001(95),NEWERID2(@07)                          1222
         MVC   OLDERID2(95,@07),@TS00001                           1222
*        NEWID2 = 'XPRP';                                  /*@Y30SSFR*/
*                                                                  1223
         MVC   NEWID2(4,@07),@CC01289                              1223
*        HEADFLG2 = '00'X;                                         1224
         L     @07,CONRCPTR                                        1224
         MVI   HEADFLG2(@07),X'00'                                 1224
*        ASSRECLN = 0;                                             1225
         SLR   @15,@15                                             1225
         STH   @15,ASSRECLN(,@07)                                  1225
*        ASSRECNM = 0;                                             1226
         STH   @15,ASSRECNM(,@07)                                  1226
*        HEADLN = LENGTH(HEADER);                                  1227
         LA    @15,8                                               1227
         STH   @15,HEADLN(,@07)                                    1227
*        HEADFLG1 = HDFL1REO;                                      1228
         MVI   HEADFLG1(@07),X'01'                                 1228
*        TOTLEN = HEADLN;                                          1229
*                                                                  1229
         ST    @15,TOTLEN                                          1229
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            1230
*                                                                  1230
         LA    @07,TOTLEN                                          1230
         ST    @07,@AL00001                                        1230
         LA    @07,CONRCPTR                                        1230
         ST    @07,@AL00001+4                                      1230
         LA    @01,@AL00001                                        1230
         BAL   @14,PUTPROC                                         1230
*        RESPECIFY RTNREG RSTD;                                    1231
*        TESTRC = RTNREG;                                          1232
         LR    TESTRC,RTNREG                                       1232
*        RESPECIFY RTNREG UNRSTD;                                  1233
*        IF TESTRC ^= 0                                            1234
*          THEN                                                    1234
         LTR   TESTRC,TESTRC                                       1234
         BZ    @RF01234                                            1234
*            RETURN CODE(LASTCC12);                                1235
*                                                                  1235
         LA    @15,12                                              1235
         L     @14,@SA00010                                        1235
         LM    @00,@05,@SA00010+8                                  1235
         LM    @07,@12,@SA00010+32                                 1235
         BR    @14                                                 1235
*        /************************************************************/
*        /*                                                          */
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */
*        /*  FAILURE INDICATED                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1236
*    IF ADDR(INDD) ^= NULLPTR                                      1236
*      THEN                                                        1236
@RF01234 L     @07,@PC00001+4                                      1236
         L     @07,FDTPTR+4(,@07)                                  1236
         LTR   @07,@07                                             1236
         BZ    @RF01236                                            1236
*        CALL OPENPROC('I',ADDR(INDDVAL),NULLPARM,0,0,             1237
*          ADDR(PINIOCS));                                         1237
         MVC   @AL00001(20),@AL01237                               1237
         LA    @07,INDDVAL(,@07)                                   1237
         ST    @07,@AFTEMPS+20                                     1237
         LA    @07,@AFTEMPS+20                                     1237
         ST    @07,@AL00001+4                                      1237
         LA    @07,PINIOCS                                         1237
         ST    @07,@AFTEMPS+24                                     1237
         LA    @07,@AFTEMPS+24                                     1237
         ST    @07,@AL00001+20                                     1237
         LA    @01,@AL00001                                        1237
         BAL   @14,OPENPROC                                        1237
*      ELSE                                                        1238
*        CALL OPENPROC('I',ADDR(ALLDDN),NULLPARM,0,0,              1238
*          ADDR(PINIOCS));                                 /*@YL026UA*/
         B     @RC01236                                            1238
@RF01236 MVC   @AL00001(20),@AL01238                               1238
         L     @07,ALLPTR                                          1238
         LA    @07,ALLDDN(,@07)                                    1238
         ST    @07,@AFTEMPS+20                                     1238
         LA    @07,@AFTEMPS+20                                     1238
         ST    @07,@AL00001+4                                      1238
         LA    @07,PINIOCS                                         1238
         ST    @07,@AFTEMPS+24                                     1238
         LA    @07,@AFTEMPS+24                                     1238
         ST    @07,@AL00001+20                                     1238
         LA    @01,@AL00001                                        1238
         BAL   @14,OPENPROC                                        1238
*        RESPECIFY RTNREG RSTD;                                    1239
@RC01236 DS    0H                                                  1240
*        TESTRC = RTNREG;                                          1240
         LR    TESTRC,RTNREG                                       1240
*        RESPECIFY RTNREG UNRSTD;                                  1241
*        IF TESTRC ^= 0                                            1242
*          THEN                                                    1242
         LTR   TESTRC,TESTRC                                       1242
         BZ    @RF01242                                            1242
*            RETURN CODE(LASTCC12);                                1243
*                                                                  1243
         LA    @15,12                                              1243
         L     @14,@SA00010                                        1243
         LM    @00,@05,@SA00010+8                                  1243
         LM    @07,@12,@SA00010+32                                 1243
         BR    @14                                                 1243
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  COMPARE THE NAME OF THE DATA SET ACTUALLY       @Y30SSFR*/
*        /*  OPENED WITH THAT GIVEN AS THE NAME OF THE       @Y30SSFR*/
*        /*  OBJECT TO BE EXPORTED.  IF THEY ARE NOT         @Y30SSFR*/
*        /*  EQUAL, DETERMINE IF THE OBJECT OPENED IS        @Y30SSFR*/
*        /*  A PATH OVER THE OBJECT BEING EXPORTED.          @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1244
*        IOCSPTR = PINIOCS;                                /*@Y30SSFR*/
*                                                                  1244
@RF01242 L     IOCSPTR,PINIOCS                                     1244
*        IF DSNAME ^= ENTVAL                               /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         L     @07,IOCDSN(,IOCSPTR)                                1245
         L     @02,@PC00001+4                                      1245
         L     @02,FDTPTR(,@02)                                    1245
         CLC   DSNAME(44,@07),ENTVAL(@02)                          1245
         BE    @RF01245                                            1245
*NAMEOPEN:   DO;                                           /*@XO4SVFR*/
*                                                                  1246
NAMEOPEN DS    0H                                                  1247
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CALL LOCPROC TO BUILD A CPL AND FPL'S FOR A @Y30SSFR*/
*            /*  LOCATE ON THE NAME RETURNED IN THE IOCSTR.  @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1247
*            CALL LOCPROC(ADDR(DSNAME),NULLPARM,PTRCTACB,  /*@Y30SSFR*/
*               FLIST1,F1NUM,RCPCPLPT);                    /*@Y30SSFR*/
*                                                                  1247
         LA    @07,IOCDSN(,IOCSPTR)                                1247
         ST    @07,@AL00001                                        1247
         LA    @07,NULLPARM                                        1247
         ST    @07,@AL00001+4                                      1247
         LA    @07,PTRCTACB                                        1247
         ST    @07,@AL00001+8                                      1247
         LA    @07,FLIST1                                          1247
         ST    @07,@AL00001+12                                     1247
         LA    @07,F1NUM                                           1247
         ST    @07,@AL00001+16                                     1247
         LA    @07,RCPCPLPT                                        1247
         ST    @07,@AL00001+20                                     1247
         LA    @01,@AL00001                                        1247
         BAL   @14,LOCPROC                                         1247
*            RESPECIFY RTNREG RSTD;                                1248
*            TESTRC = RTNREG;                                      1249
         LR    TESTRC,RTNREG                                       1249
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  1250
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1251
         BZ    @RF01251                                            1251
*                RETURN CODE(LASTCC04);                    /*@Y30SSFR*/
*                                                                  1252
         LA    @15,4                                               1252
         L     @14,@SA00010                                        1252
         LM    @00,@05,@SA00010+8                                  1252
         LM    @07,@12,@SA00010+32                                 1252
         BR    @14                                                 1252
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  TURN ON CTGBYPSS SO THAT DOS WILL BYPASS    @Y30SSFR*/
*            /*  SECURITY.                                   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1253
*            CTGPLPTR = RCPCPLPT;                          /*@Y30SSFR*/
@RF01251 L     @07,RCPCPLPT                                        1253
         ST    @07,CTGPLPTR                                        1253
*            CTGBYPSS = ON;                                /*@Y30SSFR*/
*                                                                  1254
         OI    CTGBYPSS(@07),B'10000000'                           1254
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CALL CTLGPROC TO ISSUE A UCATLG TO DO THE   @Y30SSFR*/
*            /*  ACTUAL LOCATE.                              @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1255
*            CALL CTLGPROC(RCPCPLPT);                      /*@Y30SSFR*/
*                                                                  1255
         LA    @07,RCPCPLPT                                        1255
         ST    @07,@AL00001                                        1255
         LA    @01,@AL00001                                        1255
         BAL   @14,CTLGPROC                                        1255
*            RESPECIFY RTNREG RSTD;                                1256
*            TESTRC = RTNREG;                                      1257
         LR    TESTRC,RTNREG                                       1257
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  1258
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1259
         BZ    @RF01259                                            1259
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  1260
         LA    @15,12                                              1260
         L     @14,@SA00010                                        1260
         LM    @00,@05,@SA00010+8                                  1260
         LM    @07,@12,@SA00010+32                                 1260
         BR    @14                                                 1260
*            CTGFLPTR = CTGFIELD(KENTYPE);                 /*@Y30SSFR*/
*                                                                  1261
@RF01259 L     @07,CTGPLPTR                                        1261
         L     CTGFLPTR,CTGFIELD(,@07)                             1261
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  TEST TO BE SURE THAT THE OBJECT LOCATED     @Y30SSFR*/
*            /*  UPON IS A PATH.                             @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1262
*            IF FENTYPE ^= CTGTPTH                         /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              1262
         CLI   FENTYPE(@07),C'R'                                   1262
         BE    @RF01262                                            1262
*                DO;                                       /*@Y30SSFR*/
*                DARGSMOD = UNIVMSG;                       /*@Y30SSFR*/
         L     @07,DDSTRU                                          1264
         MVC   DARGSMOD(3,@07),@CC00930                            1264
*                DEFSTID = NOMATMSG;                       /*@Y30SSFR*/
         LA    DEFSTID,11                                          1265
*                DARGILP = LENGTH(ENTVAL);                 /*@Y30SSFR*/
         MVC   DARGILP(2,@07),@CH00604                             1266
*                DARGDBP = ADDR(ENTVAL);                   /*@Y30SSFR*/
         L     @15,@PC00001+4                                      1267
         L     @01,FDTPTR(,@15)                                    1267
         LA    @15,ENTVAL(,@01)                                    1267
         ST    @15,DARGDBP(,@07)                                   1267
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
         LA    @15,12                                              1268
         L     @14,@SA00010                                        1268
         LM    @00,@05,@SA00010+8                                  1268
         LM    @07,@12,@SA00010+32                                 1268
         BR    @14                                                 1268
*                END;                                      /*@Y30SSFR*/
*                                                                  1269
*              ELSE                                                1270
*                                                                  1270
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  DO ANOTHER LOCATE TO DETERMINE IF THE   @Y30SSFR*/
*                /*  PATH IS OVER THE OBJECT BEING EXPORTED. @Y30SSFR*/
*                /*  IF NOT, TERMINATE THE COMMAND.          @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  1270
*                DO;                                       /*@Y30SSFR*/
@RF01262 DS    0H                                                  1271
*                CTGFLPTR = CTGFIELD(KNAMEDS);             /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        1271
         L     CTGFLPTR,CTGFIELD+4(,@07)                           1271
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/
         L     FNMPTR,CTGFLPT(,CTGFLPTR)                           1272
*                IF FTYPE ^= CTGTCL & FTYPE ^= CTGTAIX     /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         CLI   FTYPE(FNMPTR),C'C'                                  1273
         BE    @RF01273                                            1273
         CLI   FTYPE(FNMPTR),C'G'                                  1273
         BE    @RF01273                                            1273
*                    DO;                                   /*@Y30SSFR*/
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/
         L     @07,DDSTRU                                          1275
         MVC   DARGSMOD(3,@07),@CC00930                            1275
*                    DEFSTID = NOMATMSG;                   /*@Y30SSFR*/
         LA    DEFSTID,11                                          1276
*                    DARGILP = LENGTH(ENTVAL);             /*@Y30SSFR*/
         MVC   DARGILP(2,@07),@CH00604                             1277
*                    DARGDBP = ADDR(ENTVAL);               /*@Y30SSFR*/
*                                                                  1278
         L     @15,@PC00001+4                                      1278
         L     @01,FDTPTR(,@15)                                    1278
         LA    @15,ENTVAL(,@01)                                    1278
         ST    @15,DARGDBP(,@07)                                   1278
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
*                                                                  1279
         LA    @15,12                                              1279
         L     @14,@SA00010                                        1279
         LM    @00,@05,@SA00010+8                                  1279
         LM    @07,@12,@SA00010+32                                 1279
         BR    @14                                                 1279
*                    END;                                  /*@Y30SSFR*/
*                                                                  1280
*                  ELSE                                    /*@Y30SSFR*/
*                                                                  1281
*                    DO;                                   /*@Y30SSFR*/
*                                                                  1281
@RF01273 DS    0H                                                  1282
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  CALL LOCPROC TO BUILD THE CPL AND   @Y30SSFR*/
*                    /*  FPL'S TO DO THE LOCATE.             @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1282
*                    CALL LOCPROC(NULLPARM,FNAME,PTRCTACB, /*@Y30SSFR*/
*                       FLIST2,F2NUM,RCPCPLPT);            /*@Y30SSFR*/
*                                                                  1282
         LA    @07,NULLPARM                                        1282
         ST    @07,@AL00001                                        1282
         LA    @07,FNAME(,FNMPTR)                                  1282
         ST    @07,@AL00001+4                                      1282
         LA    @07,PTRCTACB                                        1282
         ST    @07,@AL00001+8                                      1282
         LA    @07,FLIST2                                          1282
         ST    @07,@AL00001+12                                     1282
         LA    @07,F2NUM                                           1282
         ST    @07,@AL00001+16                                     1282
         LA    @07,RCPCPLPT                                        1282
         ST    @07,@AL00001+20                                     1282
         LA    @01,@AL00001                                        1282
         BAL   @14,LOCPROC                                         1282
*                    RESPECIFY RTNREG RSTD;                        1283
*                    TESTRC = RTNREG;                              1284
         LR    TESTRC,RTNREG                                       1284
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/
*                                                                  1285
*                    IF TESTRC ^= 0                        /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1286
         BZ    @RF01286                                            1286
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/
*                                                                  1287
         LA    @15,12                                              1287
         L     @14,@SA00010                                        1287
         LM    @00,@05,@SA00010+8                                  1287
         LM    @07,@12,@SA00010+32                                 1287
         BR    @14                                                 1287
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  SET CTGBYPSS TO ON TO CAUSE DOS TO  @Y30SSFR*/
*                    /*  BYPASS SECURITY VERIFICATION.       @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1288
*                    CTGBYPSS = ON;                        /*@Y30SSFR*/
*                                                                  1288
@RF01286 L     @07,CTGPLPTR                                        1288
         OI    CTGBYPSS(@07),B'10000000'                           1288
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  CALL VSAM CATALOG MANAGEMENT TO DO  @Y30SSFR*/
*                    /*  THE ACTUAL LOCATE.                  @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1289
*                    CALL CTLGPROC(RCPCPLPT);              /*@Y30SSFR*/
*                                                                  1289
         LA    @07,RCPCPLPT                                        1289
         ST    @07,@AL00001                                        1289
         LA    @01,@AL00001                                        1289
         BAL   @14,CTLGPROC                                        1289
*                    RESPECIFY RTNREG RSTD;                        1290
*                    TESTRC = RTNREG;                              1291
         LR    TESTRC,RTNREG                                       1291
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/
*                                                                  1292
*                    IF TESTRC ^= 0                        /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1293
         BZ    @RF01293                                            1293
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/
*                                                                  1294
         LA    @15,12                                              1294
         L     @14,@SA00010                                        1294
         LM    @00,@05,@SA00010+8                                  1294
         LM    @07,@12,@SA00010+32                                 1294
         BR    @14                                                 1294
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  COMPARE THE NAME OF THE OBJECT      @Y30SSFR*/
*                    /*  BEING EXPORTED WITH THAT ACTUALLY   @Y30SSFR*/
*                    /*  OPENED.  IF THEY ARE NOT EQUAL,     @Y30SSFR*/
*                    /*  SET UP TO PRINT AN ERROR MESSAGE,   @Y30SSFR*/
*                    /*  AND RETURN TO THE CALLING ROUTINE.  @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1295
*                    CTGFLPTR = CTGFIELD(KENTNAME);        /*@Y30SSFR*/
@RF01293 L     @07,CTGPLPTR                                        1295
         L     CTGFLPTR,CTGFIELD(,@07)                             1295
*                    IF FENTNAME ^= ENTVAL                 /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              1296
         L     @03,@PC00001+4                                      1296
         L     @03,FDTPTR(,@03)                                    1296
         CLC   FENTNAME(44,@07),ENTVAL(@03)                        1296
         BE    @RF01296                                            1296
*                        DO;                               /*@Y30SSFR*/
*                        DARGSMOD = UNIVMSG;               /*@Y30SSFR*/
         L     @07,DDSTRU                                          1298
         MVC   DARGSMOD(3,@07),@CC00930                            1298
*                        DEFSTID = NOMATMSG;               /*@Y30SSFR*/
         LA    DEFSTID,11                                          1299
*                        DARGDBP = ADDR(ENTVAL);           /*@Y30SSFR*/
         LA    @15,ENTVAL(,@03)                                    1300
         ST    @15,DARGDBP(,@07)                                   1300
*                        DARGILP = LENGTH(ENTVAL);         /*@Y30SSFR*/
*                                                                  1301
         MVC   DARGILP(2,@07),@CH00604                             1301
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/
*                                                                  1302
         LA    @15,12                                              1302
         L     @14,@SA00010                                        1302
         LM    @00,@05,@SA00010+8                                  1302
         LM    @07,@12,@SA00010+32                                 1302
         BR    @14                                                 1302
*                        END;                              /*@Y30SSFR*/
*                                                                  1303
*                    END;                                  /*@Y30SSFR*/
@RF01296 DS    0H                                                  1305
*                END;                                      /*@Y30SSFR*/
*            END NAMEOPEN;                                 /*@Y30SSFR*/
*                                                                  1306
*        /************************************************************/
*        /*                                                          */
*        /*  COPY DATA BY RECORD FROM THE CLUSTER TO THE PORTABILITY */
*        /*  DATA SET.  IF ANY ERRORS ARE ENCOUNTERED, RETURN TO THE */
*        /*  CALLING PROCESSOR WITH ERROR INDICATED                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1307
*        CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);                  1307
*                                                                  1307
@RF01245 L     @07,@PC00001                                        1307
         ST    @07,@AL00001                                        1307
         LA    @03,PINIOCS                                         1307
         ST    @03,@AL00001+4                                      1307
         LA    @03,POUTIOCS                                        1307
         ST    @03,@AL00001+8                                      1307
         MVI   @AL00001+8,X'80'                                    1307
         L     @15,GDTCPY(,@07)                                    1307
         LA    @01,@AL00001                                        1307
         BALR  @14,@15                                             1307
*        RESPECIFY RTNREG RSTD;                                    1308
*        TESTRC = RTNREG;                                          1309
         LR    TESTRC,RTNREG                                       1309
*        RESPECIFY RTNREG UNRSTD;                                  1310
*        IF TESTRC ^= 0                                            1311
*          THEN                                                    1311
         LTR   TESTRC,TESTRC                                       1311
         BZ    @RF01311                                            1311
*            RETURN CODE(LASTCC12);                                1312
*                                                                  1312
         LA    @15,12                                              1312
         L     @14,@SA00010                                        1312
         LM    @00,@05,@SA00010+8                                  1312
         LM    @07,@12,@SA00010+32                                 1312
         BR    @14                                                 1312
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE THE INPUT DATA SET (THE VSAM CLUSTER).  IF THE    */
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */
*        /*  INDICATED.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1313
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                           1313
*                                                                  1313
@RF01311 L     @07,@PC00001                                        1313
         ST    @07,@AL00001                                        1313
         LA    @03,PINIOCS                                         1313
         ST    @03,@AL00001+4                                      1313
         MVI   @AL00001+4,X'80'                                    1313
         L     @15,GDTCLS(,@07)                                    1313
         LA    @01,@AL00001                                        1313
         BALR  @14,@15                                             1313
*        RESPECIFY RTNREG RSTD;                                    1314
*        TESTRC = RTNREG;                                          1315
         LR    TESTRC,RTNREG                                       1315
*        RESPECIFY RTNREG UNRSTD;                                  1316
*        PINIOCS = NULLPTR;                                        1317
         SLR   @07,@07                                             1317
         ST    @07,PINIOCS                                         1317
*        IF TESTRC ^= 0                                            1318
*          THEN                                                    1318
         CR    TESTRC,@07                                          1318
         BE    @RF01318                                            1318
*            RETURN CODE(LASTCC12);                                1319
*                                                                  1319
         LA    @15,12                                              1319
         L     @14,@SA00010                                        1319
         LM    @00,@05,@SA00010+8                                  1319
         LM    @07,@12,@SA00010+32                                 1319
         BR    @14                                                 1319
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */
*        /*  COMPLETION INDICATED                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1320
*        RETURN CODE(LASTCC00);                                    1320
@RF01318 SLR   @15,@15                                             1320
         L     @14,@SA00010                                        1320
         LM    @00,@05,@SA00010+8                                  1320
         LM    @07,@12,@SA00010+32                                 1320
         BR    @14                                                 1320
*END RECPROC;                                                      1321
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  PROCEDURE NAME - MVDAPROC                       @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE @Y30SSFR*/
*        /*  TO ANOTHER AS SPECIFIED BY INPUT ARGUMENTS,     @Y30SSFR*/
*        /*  OR ZEROS OUT AN AREA OF CORE IF SPECIFIED BY    @Y30SSFR*/
*        /*  ITS ARGUMENTS.                                  @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  INPUT -                                         @Y30SSFR*/
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED           @Y30SSFR*/
*        /*    .MF1PTR- FROM LOCATION                        @Y30SSFR*/
*        /*    .MT1PTR- TO LOCATION                          @Y30SSFR*/
*        /*    .ZEROOUT - FLAG TO INDICATE WHETHER MDVAPROC  @Y30SSFR*/
*        /*        IS TO ZERO OUT CORE                       @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */
*        /*  THE "TO" AGRUMENT (MPTR) IF IT IS SPECIFIED.    @Y30SSFR*/
*        /*  IF ZEROOUT IS SET TO A NONZERO VALUE, THEN      @Y30SSFR*/
*        /*  THE AREA OF CORE STARTING AT MF1PTR AND         @Y30SSFR*/
*        /*  EXTENDING A LENGTH OF MSIZE IS ZEROED OUT.      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1322
*MVDAPROC: PROCEDURE(MSIZE,            /*SIZE OF DATA TO BE MOVED    */
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */
*                    MT1PTR,           /*LOCATION TO MOVE DATA INTO  */
*                    ZEROOUT);         /*FLAG INDICATING THAT@Y30SSFR*/
MVDAPROC STM   @14,@12,12(@13)                                     1322
         MVC   @PC00011(16),0(@01)                                 1322
*                                      /*THIS IS A REQUEST   @Y30SSFR*/
*                                      /*ZERO OUT CORE       @Y30SSFR*/
*                                                                  1323
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1323
*        DCL MSIZE    FIXED(15),                                   1323
*            MF1PTR   PTR(31),                                     1323
*            MT1PTR   PTR(31),                             /*@Y30SSFR*/
*            ZEROOUT CHAR(4);                              /*@Y30SSFR*/
*                                                                  1323
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOCAL DECLARATIONS                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1324
*        DCL MFPTR PTR(31);                                /*@Y30SSFR*/
*        DCL MTPTR PTR(31);                                /*@Y30SSFR*/
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                /*@Y30SSFR*/
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                /*@Y30SSFR*/
*        DCL M1SIZE FIXED(15);                             /*@Y30SSFR*/
*        DCL CNTRL  BIT(1);                                /*@Y30SSFR*/
*        DCL ZERO CHAR(256) INIT('00'X);                   /*@Y30SSFR*/
*                                      /*ZEROS USED TO ZERO  @Y30SSFR*/
*                                      /*OUT AN AREA         @Y30SSFR*/
*                                                                  1331
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  TEST TO SEE IF SETZERO HAS BEEN SPECIFIED AS    @Y30SSFR*/
*        /*  LAST ARGUMENT.  IF SO, ZERO OUT THE TARGET      @Y30SSFR*/
*        /*  AREA.                                           @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1331
*        IF ZEROOUT = SETZERO                              /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         L     @15,@PC00011+12                                     1331
         CLC   ZEROOUT(4,@15),SETZERO                              1331
         BNE   @RF01331                                            1331
*            DO;                                           /*@Y30SSFR*/
*                                                                  1332
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET MTPTR TO MT1PTR AND M1SIZE TO MSIZE.    @Y30SSFR*/
*            /*  SET CNTRL TO ON AND LOOP.                   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1333
*            MTPTR = MT1PTR;                               /*@Y30SSFR*/
         L     @15,@PC00011+8                                      1333
         L     MTPTR,MT1PTR(,@15)                                  1333
*            M1SIZE = MSIZE;                               /*@Y30SSFR*/
         L     @15,@PC00011                                        1334
         LH    M1SIZE,MSIZE(,@15)                                  1334
*            CNTRL = ON;                                   /*@Y30SSFR*/
         OI    CNTRL,B'10000000'                                   1335
*            DO WHILE (CNTRL = ON);                        /*@Y30SSFR*/
*                                                                  1336
         B     @DE01336                                            1336
@DL01336 DS    0H                                                  1337
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  TEST M1SIZE AGAINST 256.  IF M1SIZE > 256 @Y30SSFR*/
*              /*  THEN MOVE 256 BYTES OF ZEROS, AND LOOP    @Y30SSFR*/
*              /*  AGAIN.  OTHERWISE, ZERO THE REMAINING     @Y30SSFR*/
*              /*  AND SET CNTRL TO OFF.                     @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1337
*              IF M1SIZE > 256                             /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         LA    @15,256                                             1337
         CR    M1SIZE,@15                                          1337
         BNH   @RF01337                                            1337
*                  DO;                                     /*@Y30SSFR*/
*                  TOAREA(1:256) = ZERO(1:256);            /*@Y30SSFR*/
         MVC   TOAREA(256,MTPTR),ZERO                              1339
*                  M1SIZE = M1SIZE - 256;                  /*@Y30SSFR*/
         SLR   M1SIZE,@15                                          1340
*                  MTPTR = MTPTR + 256;                    /*@Y30SSFR*/
         ALR   MTPTR,@15                                           1341
*                  END;                                    /*@Y30SSFR*/
*                ELSE                                              1343
*                  DO;                                     /*@Y30SSFR*/
         B     @RC01337                                            1343
@RF01337 DS    0H                                                  1344
*                  TOAREA(1:M1SIZE) = ZERO(1:M1SIZE);      /*@Y30SSFR*/
         LR    @15,M1SIZE                                          1344
         BCTR  @15,0                                               1344
         EX    @15,@SM01375                                        1344
*                  CNTRL = OFF;                            /*@Y30SSFR*/
         NI    CNTRL,B'01111111'                                   1345
*                  END;                                    /*@Y30SSFR*/
*            END;                                          /*@Y30SSFR*/
@RC01337 DS    0H                                                  1347
@DE01336 TM    CNTRL,B'10000000'                                   1347
         BO    @DL01336                                            1347
*            END;                                          /*@Y30SSFR*/
*          ELSE                                                    1349
*                                                                  1349
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  LOOP MOVING 256 BYTES AT A TIME             @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*            DO;                                           /*@Y30SSFR*/
         B     @RC01331                                            1349
@RF01331 DS    0H                                                  1350
*            MFPTR = MF1PTR;                               /*@Y30SSFR*/
         L     @15,@PC00011+4                                      1350
         L     MFPTR,MF1PTR(,@15)                                  1350
*            MTPTR = MT1PTR;                               /*@Y30SSFR*/
         L     @05,@PC00011+8                                      1351
         L     MTPTR,MT1PTR(,@05)                                  1351
*            M1SIZE = MSIZE;                               /*@Y30SSFR*/
         L     @05,@PC00011                                        1352
         LH    M1SIZE,MSIZE(,@05)                                  1352
*            DOCNTRL = ON;                                 /*@Y30SSFR*/
         OI    DOCNTRL,B'10000000'                                 1353
*            DO WHILE (DOCNTRL = ON);                      /*@Y30SSFR*/
*                                                                  1354
         B     @DE01354                                            1354
@DL01354 DS    0H                                                  1355
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  CHECK FOR MORE THAN 256 BYTES TO MOVE     @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1355
*              IF M1SIZE > 256                             /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         LA    @05,256                                             1355
         CR    M1SIZE,@05                                          1355
         BNH   @RF01355                                            1355
*                  DO;                                     /*@Y30SSFR*/
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND  */
*                  /*  POINTER VARIABLES FOR NEXT ITERATION  @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1357
*                  TOAREA(1:256) = FROMAREA(1:256);        /*@Y30SSFR*/
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   1357
*                  M1SIZE = M1SIZE - 256;                  /*@Y30SSFR*/
         SLR   M1SIZE,@05                                          1358
*                  MTPTR = MTPTR +256;                     /*@Y30SSFR*/
         ALR   MTPTR,@05                                           1359
*                  MFPTR = MFPTR + 256;                    /*@Y30SSFR*/
         ALR   MFPTR,@05                                           1360
*                  END;                                    /*@Y30SSFR*/
*                                                                  1361
*                ELSE                                      /*@Y30SSFR*/
*                  DO;                                     /*@Y30SSFR*/
         B     @RC01355                                            1362
@RF01355 DS    0H                                                  1363
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  MOVE NUMBER OF BYTES INDICATED        @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1363
*                  TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);  /*@Y30SSFR*/
         LR    @05,M1SIZE                                          1363
         BCTR  @05,0                                               1363
         EX    @05,@SM01377                                        1363
*                  DOCNTRL = OFF;                          /*@Y30SSFR*/
         NI    DOCNTRL,B'01111111'                                 1364
*                  END;                                    /*@Y30SSFR*/
*              END;                                        /*@Y30SSFR*/
@RC01355 DS    0H                                                  1366
@DE01354 TM    DOCNTRL,B'10000000'                                 1366
         BO    @DL01354                                            1366
*            END;                                          /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1368
*        RETURN CODE(0);                                   /*@Y30SSFR*/
@RC01331 SLR   @15,@15                                             1368
         L     @14,12(,@13)                                        1368
         LM    @00,@12,20(@13)                                     1368
         BR    @14                                                 1368
*END MVDAPROC;                                             /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  PROCEDURE NAME - CONTRBL                        @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  FUNCTION - BUILD A DICTIONARY CONTROL RECORD    @Y30SSFR*/
*        /*  AND WRITE IT AND THE APPROPRIATE CATALOG        @Y30SSFR*/
*        /*  WORK AREA OUT THE PORTABILITY DATA SET.         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  INPUT - POINTER TO THE CPL USED TO LOCATE THE   @Y30SSFR*/
*        /*  INFORMATION TO BE WRITTEN OUT AND A FLAG        @Y30SSFR*/
*        /*  INDICATING WHETHER OR NOT THE OBJECT IS A PATH  @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL HAVE     @Y30SSFR*/
*        /*  A CATALOG DICTIONARY AND A CATALOG WORK AREA    @Y30SSFR*/
*        /*  ADDED TO ITS HEADING.                           @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1370
*CONTRBL: PROCEDURE(INDCTGPL,TYPE);                        /*@Y30SSFR*/
*                                                                  1370
CONTRBL  STM   @14,@05,@SA00012                                    1370
         STM   @07,@12,@SA00012+32                                 1370
         MVC   @PC00012(8),0(@01)                                  1370
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1371
*        DCL INDCTGPL FIXED(31); /*INDEX TO A CPL            @Y30SSFR*/
*        DCL TYPE CHAR(1);    /*TYPE OF CONTROL RECORD       @Y30SSFR*/
*                                                                  1372
*        DCL ICONTRBL FIXED(31);   /*INDEX FOR CLEARING      @Y30SSFR*/
*                                  /*DICTIONARY AREAS        @Y30SSFR*/
*        OLDERID2 = NEWERID2;                                      1374
         L     @07,@PC00001                                        1374
         L     @07,GDTTR2(,@07)                                    1374
         MVC   @TS00001(95),NEWERID2(@07)                          1374
         MVC   OLDERID2(95,@07),@TS00001                           1374
*        NEWID2 = 'XPCR';                                  /*@Y30SSFR*/
*                                                                  1375
         MVC   NEWID2(4,@07),@CC01318                              1375
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  CLEAR THE CONTROL RECORD BUFFER AND INITIALIZE  @Y30SSFR*/
*        /*  POINTERS.                                       @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1376
*        CALL MVDAPROC(LENGTH(CONREC),NULLPARM,CONRCPTR,   /*@Y30SSFR*/
*           SETZERO);                                      /*@Y30SSFR*/
         MVC   @AL00001(16),@AL01376                               1376
         LA    @07,CONRCPTR                                        1376
         ST    @07,@AL00001+8                                      1376
         LA    @01,@AL00001                                        1376
         BAL   @14,MVDAPROC                                        1376
*        CTGPLPTR = PTRCPL(INDCTGPL);                      /*@Y30SSFR*/
*                                                                  1377
         L     @07,@PC00012                                        1377
         L     @07,INDCTGPL(,@07)                                  1377
         SLA   @07,2                                               1377
         L     @07,PTRCPL-4(@07)                                   1377
         ST    @07,CTGPLPTR                                        1377
*        /***********************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SET HEADER FLAGS IN CONTROL RECORD TO INDICATE  @Y30SSFR*/
*        /*  A CATALOG RECORD AND ENTYPE                     @Y30SSFR*/
*        /*  ALSO SET LENGTH OF ASSOCIATED CATALOG RECORD    @Y30SSFR*/
*        /*  IF NO INFORMATION AVAILABLE ON THE ENTYPE - TERMINATE   */
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1378
*        HEADLN = LENGTH(CONREC);                          /*@Y30SSFR*/
         L     @03,CONRCPTR                                        1378
         MVC   HEADLN(2,@03),@CH00891                              1378
*        CTGFLPTR = CTGFIELD(IENTYPE);                     /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD(,@07)                             1379
*        HEADFLG1 = HDFL1CAT;                              /*@Y30SSFR*/
         MVI   HEADFLG1(@03),X'FF'                                 1380
*        IF CTGFLPT(1) = NULLPTR                           /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              1381
         LTR   @07,@07                                             1381
         BNZ   @RF01381                                            1381
*            DO;                                           /*@Y30SSFR*/
*            DEFSTID = NOCTFLD;                            /*@Y30SSFR*/
         LA    DEFSTID,4                                           1383
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/
         LA    @15,12                                              1384
         L     @14,@SA00012                                        1384
         LM    @00,@05,@SA00012+8                                  1384
         LM    @07,@12,@SA00012+32                                 1384
         BR    @14                                                 1384
*            END;                                          /*@Y30SSFR*/
*        HEADFLG2 = FENTYPE;                               /*@Y30SSFR*/
*                                                                  1386
@RF01381 L     @07,CONRCPTR                                        1386
         L     @03,CTGFLPT(,CTGFLPTR)                              1386
         MVC   HEADFLG2(1,@07),FENTYPE(@03)                        1386
*        ASSRECLN = RETURNLN + LENGTH(PATHREL);            /*@Y30SSFR*/
         L     @03,CTGPLPTR                                        1387
         L     @03,CTGWKA(,@03)                                    1387
         LA    @15,52                                              1387
         AH    @15,RETURNLN(,@03)                                  1387
         STH   @15,ASSRECLN(,@07)                                  1387
*        ASSRECNM = ASSRECLN / RECSZ;                      /*@Y30SSFR*/
         L     @03,RECSZ                                           1388
         LR    @00,@15                                             1388
         SRDA  @00,32                                              1388
         DR    @00,@03                                             1388
         STH   @01,ASSRECNM(,@07)                                  1388
*        ASSREMD = ASSRECLN // RECSZ;                      /*@Y30SSFR*/
         LR    @04,@15                                             1389
         SRDA  @04,32                                              1389
         DR    @04,@03                                             1389
         LR    ASSREMD,@04                                         1389
*        IF ASSREMD > 0                                    /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         LTR   ASSREMD,ASSREMD                                     1390
         BNP   @RF01390                                            1390
*            ASSRECNM = ASSRECNM + 1;                      /*@Y30SSFR*/
         AL    @01,@CF00220                                        1391
         STH   @01,ASSRECNM(,@07)                                  1391
*        DICTNM = (DIM(FIELDLST) - 2) + 11;                /*@Y30SSFR*/
*                                                                  1392
*                                                                  1392
@RF01390 L     @07,CONRCPTR                                        1392
         MVC   DICTNM+8(4,@07),@CF01346                            1392
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INTERROGATE FPL FIELDS SETTING UP THE           @Y30SSFR*/
*        /*  DICTIONARY FOR EACH COMPONENT.                  @Y30SSFR*/
*        /*  RGATTR WILL BE THE LAST ENTRY PROCESSED BY THE  @Z40RSSA*/
*        /*  DICTBLD PROCEDURE.                              @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        /************************************************************/
*                                                                  1393
*        DINDX = 1;                                        /*@Y30SSFR*/
*                                                                  1393
         LA    DINDX,1                                             1393
*DICTBLD: DO INDX = 1 TO IRGATTR;                          /*@Z40RSSA*/
DICTBLD  LA    INDX,1                                              1394
@DL01394 DS    0H                                                  1395
*          CTGFLPTR = CTGFIELD(INDX);                      /*@Y30SSFR*/
         LR    @07,INDX                                            1395
         SLA   @07,2                                               1395
         L     @01,CTGPLPTR                                        1395
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        1395
*          LGNFLD  = CTGFLNG(1);                           /*@Y30SSFR*/
*                                                                  1396
         L     @07,CTGFLNG(,CTGFLPTR)                              1396
         LR    LGNFLD,@07                                          1396
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  TEST FOR NON EXISTANT OR NON-INITIALIZED FIELDS       */
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1397
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  TEST FOR PASSWORD SUPPRESSION. IF PASSWORDS ARE       */
*          /*  BEING SUPPRESSED DUE TO INCORRECT LEVEL OF PASSWORD   */
*          /*  SUPPLIED TO LOCATE, AN INFORMATIONAL MESSAGE WILL     */
*          /*  BE ISSUED                                     @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1397
*          IF INDX = IPASSWOR                              /*@Y30SSFR*/
*            THEN                                          /*@Y30SSFR*/
         C     INDX,@CF00037                                       1397
         BNE   @RF01397                                            1397
*              IF CTGFLNG(1) = 1 &                         /*@Y30SSFR*/
*                  CTGFLPT(1) = NULLPTR                    /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         C     @07,@CF00220                                        1398
         BNE   @RF01398                                            1398
         L     @07,CTGFLPT(,CTGFLPTR)                              1398
         LTR   @07,@07                                             1398
         BNZ   @RF01398                                            1398
*                  SUPPRESS = ON;                          /*@Y30SSFR*/
*                                                                  1399
         OI    SUPPRESS,B'10000000'                                1399
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF A VARIABLE LENGTH CATALOG FIELD SUCH AS LOKEYV     */
*          /*  IS BEING INTERROGATED, THE FIRST TWO BYTES OF THE     */
*          /*  THE FIELD IS A LENGTH                         @Y30SSFR*/
*          /*  VARIABLE LENGTH CATALOG FIELDS ARE USERAREC,  @Y30SSFR*/
*          /*  LOKEYV, AND HIKEYV                            @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1400
*          IF (INDX = IUSRAREC                            /*@Y30SSFR*/
*              INDX = ILOKEYV                             /*@Y30SSFR*/
*              INDX = IHIKEYV)                             /*@Y30SSFR*/
*            THEN                                          /*@Y30SSFR*/
@RF01398 DS    0H                                                  1400
@RF01397 C     INDX,@CF00641                                       1400
         BE    @RT01400                                            1400
         C     INDX,@CF00229                                       1400
         BE    @RT01400                                            1400
         C     INDX,@CF00483                                       1400
         BNE   @RF01400                                            1400
@RT01400 DS    0H                                                  1401
*              IF LGNFLD = 0  FIELDLN = 0                 /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         SLR   @07,@07                                             1401
         CR    LGNFLD,@07                                          1401
         BE    @RT01401                                            1401
         L     @01,CTGFLPT(,CTGFLPTR)                              1401
         CH    @07,FIELDLN(,@01)                                   1401
         BNE   @RF01401                                            1401
@RT01401 DS    0H                                                  1402
*                  DO;                                     /*@Y30SSFR*/
*                                                                  1402
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF A VARIABLE LENGTH FIELD IS NOT     @Y30SSFR*/
*                  /*  INITIALIZED OR NON-EXISTANT, THE LENGTH       */
*                  /*  FIELD WITHIN THE DATA RETURNED BY LOCATE      */
*                  /*  IS ZERO.  SET THE DICTIONARY LENGTH AND       */
*                  /*  DISPLACEMENT TO ZERO.                 @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1403
*                  DICTLN(DINDX) = 0;                      /*@Y30SSFR*/
         SLR   @07,@07                                             1403
         LR    @05,DINDX                                           1403
         SLA   @05,3                                               1403
         LA    @02,8                                               1403
         AL    @02,CONRCPTR                                        1403
         LA    @01,0(@05,@02)                                      1403
         AL    @01,@CF01379                                        1403
         ST    @07,DICTLN-4(,@01)                                  1403
*                  DICTDL(DINDX) = NULLPTR;                /*@Y30SSFR*/
         ST    @07,DICTDL-8(@05,@02)                               1404
*                  END;                                    /*@Y30SSFR*/
*                                                                  1405
*                ELSE                                      /*@Y30SSFR*/
*                  DO;                                     /*@Y30SSFR*/
         B     @RC01401                                            1406
@RF01401 DS    0H                                                  1407
*                  DICTLN(DINDX) = CTGFLNG(1);             /*@Y30SSFR*/
         LR    @07,DINDX                                           1407
         SLA   @07,3                                               1407
         LA    @05,8                                               1407
         AL    @05,CONRCPTR                                        1407
         L     @15,CTGFLNG(,CTGFLPTR)                              1407
         LA    @14,0(@07,@05)                                      1407
         AL    @14,@CF01379                                        1407
         ST    @15,DICTLN-4(,@14)                                  1407
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;    /*@Y30SSFR*/
         L     @15,CTGFLPT(,CTGFLPTR)                              1408
         L     @14,CTGPLPTR                                        1408
         SL    @15,CTGWKA(,@14)                                    1408
         ST    @15,DICTDL-8(@07,@05)                               1408
*                  END;                                    /*@Y30SSFR*/
*                                                                  1409
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  FIELDS EXAMINED HERE ARE FIXED LENGTH FIELDS.       */
*            /*  IF THE FIELDS IS NON-EXISTANT OR NOT INITIALIZED    */
*            /*  THE ENTIRE FIELD WILL HAVE BEEN SET TO BINARY FF'S  */
*            /*  BY LOCATE.  SET DICTIONARY LENGTH AND DISPLACEMENT  */
*            /*  TO ZERO FOR SUCH FIELDS                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1410
*            ELSE                                          /*@Y30SSFR*/
*              DO;                                         /*@Y30SSFR*/
         B     @RC01400                                            1410
@RF01400 DS    0H                                                  1411
*              IF (CTGFLNG(1) = 0                         /*@Y30SSFR*/
*                  CTGFLPT(1) = NULLPTR                   /*@Y30SSFR*/
*                  FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))    /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         SLR   @07,@07                                             1411
         C     @07,CTGFLNG(,CTGFLPTR)                              1411
         BE    @RT01411                                            1411
         L     @15,CTGFLPT(,CTGFLPTR)                              1411
         CR    @15,@07                                             1411
         BE    @RT01411                                            1411
         LR    @07,LGNFLD                                          1411
         BCTR  @07,0                                               1411
         EX    @07,@SC01380                                        1411
         BNE   @RF01411                                            1411
@RT01411 DS    0H                                                  1412
*                  DO;                                     /*@Y30SSFR*/
*                  DICTLN(DINDX) = 0;                      /*@Y30SSFR*/
         SLR   @07,@07                                             1413
         LR    @05,DINDX                                           1413
         SLA   @05,3                                               1413
         LA    @02,8                                               1413
         AL    @02,CONRCPTR                                        1413
         LA    @01,0(@05,@02)                                      1413
         AL    @01,@CF01379                                        1413
         ST    @07,DICTLN-4(,@01)                                  1413
*                  DICTDL(DINDX) = NULLPTR;                /*@Y30SSFR*/
         ST    @07,DICTDL-8(@05,@02)                               1414
*                  END;                                    /*@Y30SSFR*/
*                ELSE                                      /*@Y30SSFR*/
*                  DO;                                     /*@Y30SSFR*/
         B     @RC01411                                            1416
@RF01411 DS    0H                                                  1417
*                  DICTLN(DINDX) = CTGFLNG(1);             /*@Y30SSFR*/
         LR    @07,DINDX                                           1417
         SLA   @07,3                                               1417
         LA    @05,8                                               1417
         AL    @05,CONRCPTR                                        1417
         L     @15,CTGFLNG(,CTGFLPTR)                              1417
         LA    @14,0(@07,@05)                                      1417
         AL    @14,@CF01379                                        1417
         ST    @15,DICTLN-4(,@14)                                  1417
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;    /*@Y30SSFR*/
*                                                                  1418
         L     @15,CTGFLPT(,CTGFLPTR)                              1418
         L     @14,CTGPLPTR                                        1418
         SL    @15,CTGWKA(,@14)                                    1418
         ST    @15,DICTDL-8(@07,@05)                               1418
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF THE TEMPORARY EXPORT FLAG IS ON, TURN      */
*                  /*  IT OFF.                               @Y30SSFR*/
*                  /*  IF THE INHIBIT UPDATE FLAG IS ON TURN @Y30SSFR*/
*                  /*  IT OFF AS WELL.                       @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  1419
*                  IF INDX = IDSATTR &                     /*@Y30SSFR*/
*                      (INDCTGPL = 2  INDCTGPL = 3)       /*@Y30SSFR*/
*                    THEN                                  /*@Y30SSFR*/
         LA    @07,3                                               1419
         CR    INDX,@07                                            1419
         BNE   @RF01419                                            1419
         L     @05,@PC00012                                        1419
         L     @05,INDCTGPL(,@05)                                  1419
         C     @05,@CF00154                                        1419
         BE    @RT01419                                            1419
         CR    @05,@07                                             1419
         BNE   @RF01419                                            1419
@RT01419 DS    0H                                                  1420
*                      DO;                                 /*@Y30SSFR*/
*                      FDSINHUP = OFF;                     /*@Y30SSFR*/
*                      FDSTMPEX = OFF;                     /*@Y30SSFR*/
         L     @07,CTGFLPT(,CTGFLPTR)                              1422
         NI    FDSINHUP(@07),B'11111001'                           1422
*                      END;                                /*@Y30SSFR*/
*                  END;                                    /*@Y30SSFR*/
*                                                                  1424
@RF01419 DS    0H                                                  1425
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  SPECIAL HANDLING IS REQUIRED FOR AMDSBCAT FIELD   */
*              /*  FIELDS NORMALLY DEFINED (VIA CATALOG DEFINE) ARE  */
*              /*  EXTRACTED AND A DICTIONARY ENTRY IS BUILT FOR     */
*              /*  EACH FIELD.                               @Y30SSFR*/
*              /*  IF NO INFORMATION IS RETURNED OR THE FIELDS ARE   */
*              /*  INITIALIZED(SET TO ALL X'FF') THEN THE    @Y30SSFR*/
*              /*  DICTIONARY ENTRIES ARE SET TO ZERO        @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1425
*              IF INDX = IAMDSB                            /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
@RC01411 C     INDX,@CF00610                                       1425
         BNE   @RF01425                                            1425
*                  DO;                                     /*@Y30SSFR*/
*                  CTGFLPTR = CTGFIELD(INDX);              /*@Y30SSFR*/
         L     @07,CTGPLPTR                                        1427
         LR    @15,INDX                                            1427
         SLA   @15,2                                               1427
         L     CTGFLPTR,CTGFIELD-4(@15,@07)                        1427
*                  DSCCATPT = CTGFLPT(1);                  /*@Y30SSFR*/
         L     @15,CTGFLPT(,CTGFLPTR)                              1428
         ST    @15,DSCCATPT                                        1428
*                  RESPECIFY IDAAMDSB BASED(DSCCATPT);     /*@Y30SSFR*/
*                                                                  1429
*                  LGNFLD = CTGFLNG(1);                    /*@Y30SSFR*/
         L     @14,CTGFLNG(,CTGFLPTR)                              1430
         LR    LGNFLD,@14                                          1430
*                  IF (CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR  &  1431
*                      FIELD(1:LGNFLD) ^= NOTINIT(1:LGNFLD))       1431
*                    THEN                                  /*@Y30SSFR*/
         SLR   @01,@01                                             1431
         CR    @14,@01                                             1431
         BE    @RF01431                                            1431
         CR    @15,@01                                             1431
         BE    @RF01431                                            1431
         LR    @14,LGNFLD                                          1431
         BCTR  @14,0                                               1431
         EX    @14,@SC01380                                        1431
         BE    @RF01431                                            1431
*                      DO;                                 /*@Y30SSFR*/
*                      DICTLN(DINDX+1) = LENGTH(AMDATTR);  /*@Y30SSFR*/
         LA    @05,1                                               1433
         LR    @02,DINDX                                           1433
         SLA   @02,3                                               1433
         LA    @14,8                                               1433
         L     @01,CONRCPTR                                        1433
         ALR   @01,@14                                             1433
         ST    @05,DICTLN(@02,@01)                                 1433
*                      DICTDL(DINDX+1) = ADDR(AMDATTR) - CTGWKA;   1434
         LA    @00,AMDATTR(,@15)                                   1434
         L     @07,CTGWKA(,@07)                                    1434
         SLR   @00,@07                                             1434
         ST    @00,DICTDL(@02,@01)                                 1434
*                      DICTLN(DINDX+2) = LENGTH(AMDRKP);   /*@Y30SSFR*/
         LA    @00,2                                               1435
         ST    @00,DICTLN+8(@02,@01)                               1435
*                      DICTDL(DINDX+2) = ADDR(AMDRKP) - CTGWKA;    1436
         LA    @07,AMDRKP(,@15)                                    1436
         L     @05,CTGPLPTR                                        1436
         L     @05,CTGWKA(,@05)                                    1436
         SLR   @07,@05                                             1436
         ST    @07,DICTDL+8(@02,@01)                               1436
*                      DICTLN(DINDX+3) = LENGTH(AMDKEYLN); /*@Y30SSFR*/
         ST    @00,DICTLN+16(@02,@01)                              1437
*                      DICTDL(DINDX+3) = ADDR(AMDKEYLN)-CTGWKA;    1438
         LA    @07,AMDKEYLN(,@15)                                  1438
         SLR   @07,@05                                             1438
         ST    @07,DICTDL+16(@02,@01)                              1438
*                      DICTLN(DINDX+4) = LENGTH(AMDCINV);  /*@Y30SSFR*/
         LA    @07,4                                               1439
         ST    @07,DICTLN+24(@02,@01)                              1439
*                      DICTDL(DINDX+4) = ADDR(AMDCINV) - CTGWKA;   1440
         LA    @07,AMDCINV(,@15)                                   1440
         SLR   @07,@05                                             1440
         ST    @07,DICTDL+24(@02,@01)                              1440
*                      DICTLN(DINDX+5) = LENGTH(AMDLRECL); /*@Y30SSFR*/
         LA    @07,4                                               1441
         ST    @07,DICTLN+32(@02,@01)                              1441
*                      DICTDL(DINDX+5) = ADDR(AMDLRECL) - CTGWKA;  1442
         LA    @07,AMDLRECL(,@15)                                  1442
         SLR   @07,@05                                             1442
         ST    @07,DICTDL+32(@02,@01)                              1442
*                      DICTLN(DINDX+6) = LENGTH(AMDPCTCA); /*@Y30SSFR*/
         LA    @07,1                                               1443
         ST    @07,DICTLN+40(@02,@01)                              1443
*                      DICTDL(DINDX+6) = ADDR(AMDPCTCA) - CTGWKA;  1444
         LA    @07,AMDPCTCA(,@15)                                  1444
         SLR   @07,@05                                             1444
         ST    @07,DICTDL+40(@02,@01)                              1444
*                      DICTLN(DINDX+7) = LENGTH(AMDPCTCI); /*@Y30SSFR*/
         LA    @07,1                                               1445
         ST    @07,DICTLN+48(@02,@01)                              1445
*                      DICTDL(DINDX+7) = ADDR(AMDPCTCI) - CTGWKA;  1446
         LA    @07,AMDPCTCI(,@15)                                  1446
         SLR   @07,@05                                             1446
         ST    @07,DICTDL+48(@02,@01)                              1446
*                      DICTLN(DINDX+8) = LENGTH(AMDATTR3); /*@Y30SSFR*/
         ST    @14,DICTLN+56(@02,@01)                              1447
*                      DICTDL(DINDX+8) = ADDR(AMDATTR3)-CTGWKA;    1448
         LA    @07,AMDATTR3(,@15)                                  1448
         SLR   @07,@05                                             1448
         ST    @07,DICTDL+56(@02,@01)                              1448
*                      DICTLN(DINDX+9) = LENGTH(AMDAXRKP); /*@Y30SSFR*/
         ST    @00,DICTLN+64(@02,@01)                              1449
*                      DICTDL(DINDX+9) = ADDR(AMDAXRKP)-CTGWKA;    1450
         LA    @07,AMDAXRKP(,@15)                                  1450
         SLR   @07,@05                                             1450
         ST    @07,DICTDL+64(@02,@01)                              1450
*                      END;                                /*@Y30SSFR*/
*                    ELSE                                  /*@Y30SSFR*/
*                      DO ICONTRBL = 1 TO 9;               /*@Y30SSFR*/
         B     @RC01431                                            1452
@RF01431 LA    ICONTRBL,1                                          1452
@DL01452 DS    0H                                                  1453
*                        DICTLN(DINDX+ICONTRBL) = 0;       /*@Y30SSFR*/
         SLR   @07,@07                                             1453
         LR    @05,DINDX                                           1453
         ALR   @05,ICONTRBL                                        1453
         SLA   @05,3                                               1453
         LA    @15,8                                               1453
         AL    @15,CONRCPTR                                        1453
         LA    @01,0(@05,@15)                                      1453
         AL    @01,@CF01379                                        1453
         ST    @07,DICTLN-4(,@01)                                  1453
*                        DICTDL(DINDX+ICONTRBL) = NULLPTR; /*@Y30SSFR*/
         ST    @07,DICTDL-8(@05,@15)                               1454
*                      END;                                /*@Y30SSFR*/
*                                                                  1455
         AL    ICONTRBL,@CF00220                                   1455
         C     ICONTRBL,@CF00038                                   1455
         BNH   @DL01452                                            1455
*                  DINDX = DINDX + 9;                      /*@Y30SSFR*/
@RC01431 AL    DINDX,@CF00038                                      1456
*                  END;                                    /*@Y30SSFR*/
*               END;                                       /*@Y30SSFR*/
*                                                                  1458
@RF01425 DS    0H                                                  1459
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INCREMENT INDEX INTO DICTIONARY                 @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1459
*          DINDX = DINDX + 1;                              /*@Y30SSFR*/
@RC01400 AL    DINDX,@CF00220                                      1459
*        END DICTBLD;                                      /*@Y30SSFR*/
*                                                                  1460
*                                                                  1460
         AL    INDX,@CF00220                                       1460
         C     INDX,@CF00625                                       1460
         BNH   @DL01394                                            1460
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF EXPORTING AN AIX, WRITE OUT THE RELATED      @Y30SSFR*/
*        /*  NAME.                                           @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1461
*        IF TYPE = CTGTAIX                                 /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         L     @07,@PC00012+4                                      1461
         CLI   TYPE(@07),C'G'                                      1461
         BNE   @RF01461                                            1461
*            DO;                                           /*@Y30SSFR*/
*            DICTLN(DINDX) = RELLEN;                       /*@Y30SSFR*/
         LR    @07,DINDX                                           1463
         SLA   @07,3                                               1463
         LA    @02,8                                               1463
         AL    @02,CONRCPTR                                        1463
         LA    @15,44                                              1463
         LA    @14,0(@07,@02)                                      1463
         AL    @14,@CF01379                                        1463
         ST    @15,DICTLN-4(,@14)                                  1463
*            DICTDL(DINDX) = ADDR(RELATE) - CTGWKA;        /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        1464
         L     @15,CTGWKA(,@01)                                    1464
         LH    @14,RETURNLN(,@15)                                  1464
         ALR   @14,@15                                             1464
         LCR   @15,@15                                             1464
         ALR   @15,@14                                             1464
         ST    @15,DICTDL-8(@07,@02)                               1464
*            RELATE = RELNAME;                             /*@Y30SSFR*/
         MVC   RELATE(44,@14),RELNAME                              1465
*            DICTLN(DINDX+1) = 0;                          /*@Y30SSFR*/
         SLR   @15,@15                                             1466
         ST    @15,DICTLN(@07,@02)                                 1466
*            DICTDL(DINDX+1) = NULLPTR;                    /*@Y30SSFR*/
         ST    @15,DICTDL(@07,@02)                                 1467
*            END;                                          /*@Y30SSFR*/
*                                                                  1468
*          ELSE                                            /*@Y30SSFR*/
*                                                                  1469
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  IF WRITING OUT A PATH RECORD, WRITE OUT THE   @Y30SSFR*/
*          /*  NAME AND PASSWORD OF THE DATA SET BEING       @Y30SSFR*/
*          /*  EXPORTED AS THE PATHENTRY AND PATHPASS        @Y30SSFR*/
*          /*  ENTRIES IN THE DICTIONARY.                    @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1469
*            IF TYPE = CTGTPTH                                     1469
*              THEN                                                1469
         B     @RC01461                                            1469
@RF01461 L     @07,@PC00012+4                                      1469
         CLI   TYPE(@07),C'R'                                      1469
         BNE   @RF01469                                            1469
*                DO;                                       /*@Y30SSFR*/
*                DICTLN(DINDX) = LENGTH(PATHENT);          /*@Y30SSFR*/
         LR    @07,DINDX                                           1471
         SLA   @07,3                                               1471
         LA    @02,8                                               1471
         L     @15,CONRCPTR                                        1471
         ALR   @15,@02                                             1471
         LA    @14,44                                              1471
         LA    @01,0(@07,@15)                                      1471
         AL    @01,@CF01379                                        1471
         ST    @14,DICTLN-4(,@01)                                  1471
*                DICTDL(DINDX) = ADDR(PATHENT) - CTGWKA;   /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        1472
         L     @14,CTGWKA(,@01)                                    1472
         LH    @05,RETURNLN(,@14)                                  1472
         ALR   @05,@14                                             1472
         LR    @04,@05                                             1472
         SLR   @04,@14                                             1472
         ST    @04,DICTDL-8(@07,@15)                               1472
*                PATHENT = PTRCPL(1) ->                    /*@Y30SSFR*/
*                   CTGFIELD(IENTNAME) -> CTGFLPT(1)       /*@Y30SSFR*/
*                   -> FENTNAME;                           /*@Y30SSFR*/
         L     @04,PTRCPL                                          1473
         L     @01,CTGFIELD+4(,@04)                                1473
         L     @01,CTGFLPT(,@01)                                   1473
         MVC   PATHENT(44,@05),FENTNAME(@01)                       1473
*                IF (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)     1474
*                  ^= NULLPTR) &                                   1474
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLNG(1)      1474
*                  ^= 0) &                                         1474
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)      1474
*                  ->FPASSMWR) ^= NOTINIT(1:8)                     1474
*                  THEN                                            1474
         SLR   @01,@01                                             1474
         L     @04,CTGFIELD+36(,@04)                               1474
         L     @00,CTGFLPT(,@04)                                   1474
         CR    @00,@01                                             1474
         BE    @RF01474                                            1474
         C     @01,CTGFLNG(,@04)                                   1474
         BE    @RF01474                                            1474
         LR    @01,@00                                             1474
         CLC   FPASSMWR(8,@01),NOTINIT                             1474
         BE    @RF01474                                            1474
*                    DO;                                   /*@Y30SSFR*/
*                    DICTLN(DINDX+1) = LENGTH(PATHPASS);   /*@Y30SSFR*/
         ST    @02,DICTLN(@07,@15)                                 1476
*                    DICTDL(DINDX+1) = ADDR(PATHPASS)      /*@Y30SSFR*/
*                       - CTGWKA;                          /*@Y30SSFR*/
         LA    @02,PATHPASS(,@05)                                  1477
         SLR   @02,@14                                             1477
         ST    @02,DICTDL(@07,@15)                                 1477
*                    PATHPASS = PTRCPL(1) ->               /*@Y30SSFR*/
*                       CTGFIELD(IPASSWOR) ->              /*@Y30SSFR*/
*                       CTGFLPT(1) -> FPASSMWR;            /*@Y30SSFR*/
         LR    @07,@00                                             1478
         MVC   PATHPASS(8,@05),FPASSMWR(@07)                       1478
*                    END;                                  /*@Y30SSFR*/
*                END;                                      /*@Y30SSFR*/
*                                                                  1480
*              ELSE                                                1481
*                                                                  1481
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  THE COMPONENT IS NEITHER AIX NOR PATH     @Y30SSFR*/
*              /*  ZERO OUT THE NEXT TWO FIELDS IN THE       @Z40RSSA*/
*              /*  DICTIONARY.                               @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1481
*                DO;                                       /*@Y30SSFR*/
         B     @RC01469                                            1481
@RF01469 DS    0H                                                  1482
*                DICTLN(DINDX) = 0;                        /*@Y30SSFR*/
         SLR   @07,@07                                             1482
         LR    @02,DINDX                                           1482
         SLA   @02,3                                               1482
         LA    @15,8                                               1482
         AL    @15,CONRCPTR                                        1482
         LA    @01,0(@02,@15)                                      1482
         AL    @01,@CF01379                                        1482
         ST    @07,DICTLN-4(,@01)                                  1482
*                DICTDL(DINDX) = NULLPTR;                  /*@Y30SSFR*/
         ST    @07,DICTDL-8(@02,@15)                               1483
*                DICTLN(DINDX+1) = 0;                      /*@Y30SSFR*/
         ST    @07,DICTLN(@02,@15)                                 1484
*                DICTDL(DINDX+1) = NULLPTR;                /*@Y30SSFR*/
         ST    @07,DICTDL(@02,@15)                                 1485
*                END;                                      /*@Y30SSFR*/
*                                                                  1486
*        DINDX = DINDX + 2;                                /*@Y30SSFR*/
*                                                                  1487
@RC01469 DS    0H                                                  1487
@RC01461 AL    DINDX,@CF00154                                      1487
*        /************************************************************/
*        /*                                                  @Z40RSSA*/
*        /*  INSERT THE REMAINING ENTRIES INTO THE DICTIONARY        */
*        /*  THESE ENTRIES WERE MADE AFTER RELEASE 2 OF VSAM @Z40RSSA*/
*        /*  NOTE, THAT THE DICTIONARY ENTIRES FOLLOW THE    @Z40RSSA*/
*        /*  PASSREL ENTRY WHILE THE WORK AREAS POINTED TO   @Z40RSSA*/
*        /*  BY THE DICT ENTRY PRECEDE THE RELATE OR PATHENTRY       */
*        /*                                                  @Z40RSSA*/
*        /************************************************************/
*                                                                  1488
*MORBILD: DO INDX =  ISECFLGS TO ONUM;                     /*@Z40RSSA*/
MORBILD  LA    INDX,21                                             1488
         B     @DE01488                                            1488
@DL01488 DS    0H                                                  1489
*           CTGFLPTR = CTGFIELD(INDX);                     /*@Z40RSSA*/
         LR    @07,INDX                                            1489
         SLA   @07,2                                               1489
         L     @01,CTGPLPTR                                        1489
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        1489
*           LGNFLD = CTGFLNG(1);                           /*@Z40RSSA*/
         L     @07,CTGFLNG(,CTGFLPTR)                              1490
         LR    LGNFLD,@07                                          1490
*           IF (CTGFLNG(1) = 0                            /*@Z40RSSA*/
*               CTGFLPT(1) = NULLPTR                      /*@Z40RSSA*/
*               FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))       /*@Z40RSSA*/
*           THEN                                           /*@Z40RSSA*/
         SLR   @15,@15                                             1491
         CR    @07,@15                                             1491
         BE    @RT01491                                            1491
         L     @07,CTGFLPT(,CTGFLPTR)                              1491
         CR    @07,@15                                             1491
         BE    @RT01491                                            1491
         LR    @15,LGNFLD                                          1491
         BCTR  @15,0                                               1491
         EX    @15,@SC01382                                        1491
         BNE   @RF01491                                            1491
@RT01491 DS    0H                                                  1492
*             DO;                                          /*@Z40RSSA*/
*             DICTLN(DINDX) = 0;                           /*@Z40RSSA*/
         SLR   @07,@07                                             1493
         LR    @05,DINDX                                           1493
         SLA   @05,3                                               1493
         LA    @02,8                                               1493
         AL    @02,CONRCPTR                                        1493
         LA    @01,0(@05,@02)                                      1493
         AL    @01,@CF01379                                        1493
         ST    @07,DICTLN-4(,@01)                                  1493
*             DICTDL(DINDX) = NULLPTR;                     /*@Z40RSSA*/
         ST    @07,DICTDL-8(@05,@02)                               1494
*             END;                                         /*@Z40RSSA*/
*           ELSE                                           /*@Z40RSSA*/
*             DO;                                          /*@Z40RSSA*/
         B     @RC01491                                            1496
@RF01491 DS    0H                                                  1497
*             DICTLN(DINDX) = CTGFLNG(1);                  /*@Z40RSSA*/
         LR    @07,DINDX                                           1497
         SLA   @07,3                                               1497
         LA    @05,8                                               1497
         AL    @05,CONRCPTR                                        1497
         L     @15,CTGFLNG(,CTGFLPTR)                              1497
         LA    @14,0(@07,@05)                                      1497
         AL    @14,@CF01379                                        1497
         ST    @15,DICTLN-4(,@14)                                  1497
*             DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;         /*@Z40RSSA*/
         L     @15,CTGFLPT(,CTGFLPTR)                              1498
         L     @14,CTGPLPTR                                        1498
         SL    @15,CTGWKA(,@14)                                    1498
         ST    @15,DICTDL-8(@07,@05)                               1498
*             DINDX = DINDX + 1;                           /*@Z40RSSA*/
         AL    DINDX,@CF00220                                      1499
*             END;                                         /*@Z40RSSA*/
*        END   MORBILD;                                    /*@Z40RSSA*/
@RC01491 AL    INDX,@CF00220                                       1501
@DE01488 SLR   @07,@07                                             1501
         IC    @07,ONUM                                            1501
         CR    INDX,@07                                            1501
         BNH   @DL01488                                            1501
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  WRITE CONTROL RECORD OUT TO PORTABILITY DATA SET        */
*        /*  THEN WRITE OUT THE WORK AREA AS A SEPARATE RECORD       */
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */
*        /*  CALLING PROCESSOR                               #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1502
*        OLDERID2 = NEWERID2;                                      1502
         L     @07,@PC00001                                        1502
         L     @07,GDTTR2(,@07)                                    1502
         MVC   @TS00001(95),NEWERID2(@07)                          1502
         MVC   OLDERID2(95,@07),@TS00001                           1502
*        NEWID2 = 'XPCW';                                  /*#Y30SSFR*/
         MVC   NEWID2(4,@07),@CC01324                              1503
*        TOTLEN = HEADLN;                                  /*#Y30SSFR*/
*                                                                  1504
*                                                                  1504
*                                                                  1504
         L     @07,CONRCPTR                                        1504
         LH    @07,HEADLN(,@07)                                    1504
         ST    @07,TOTLEN                                          1504
*        CALL PUTPROC(TOTLEN,CONRCPTR);                    /*@Y30SSFR*/
*                                                                  1505
         LA    @07,TOTLEN                                          1505
         ST    @07,@AL00001                                        1505
         LA    @07,CONRCPTR                                        1505
         ST    @07,@AL00001+4                                      1505
         LA    @01,@AL00001                                        1505
         BAL   @14,PUTPROC                                         1505
*        RESPECIFY RTNREG RSTD;                                    1506
*        TESTRC = RTNREG;                                          1507
         LR    TESTRC,RTNREG                                       1507
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/
*        IF TESTRC ^= 0                                    /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1509
         BZ    @RF01509                                            1509
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/
*                                                                  1510
         LA    @15,12                                              1510
         L     @14,@SA00012                                        1510
         LM    @00,@05,@SA00012+8                                  1510
         LM    @07,@12,@SA00012+32                                 1510
         BR    @14                                                 1510
*        TOTLEN = RETURNLN + LENGTH(PATHREL);              /*@Y30SSFR*/
@RF01509 L     @07,CTGPLPTR                                        1511
         L     @01,CTGWKA(,@07)                                    1511
         LA    @00,52                                              1511
         AH    @00,RETURNLN(,@01)                                  1511
         ST    @00,TOTLEN                                          1511
*        CALL PUTPROC(TOTLEN,CTGWKA);                      /*@Y30SSFR*/
*                                                                  1512
         LA    @15,TOTLEN                                          1512
         ST    @15,@AL00001                                        1512
         LA    @07,CTGWKA(,@07)                                    1512
         ST    @07,@AL00001+4                                      1512
         LA    @01,@AL00001                                        1512
         BAL   @14,PUTPROC                                         1512
*        RESPECIFY RTNREG RSTD;                                    1513
*        TESTRC = RTNREG;                                          1514
         LR    TESTRC,RTNREG                                       1514
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/
*        IF TESTRC ^= 0                                    /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1516
         BZ    @RF01516                                            1516
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/
*                                                                  1517
         LA    @15,12                                              1517
         L     @14,@SA00012                                        1517
         LM    @00,@05,@SA00012+8                                  1517
         LM    @07,@12,@SA00012+32                                 1517
         BR    @14                                                 1517
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RETURN TO THE CALLING PROCESSOR INDICATING      @Y30SSFR*/
*        /*  SUCCESS.                                        @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1518
*        RETURN CODE(LASTCC00);                            /*@Y30SSFR*/
*                                                                  1518
@RF01516 SLR   @15,@15                                             1518
         L     @14,@SA00012                                        1518
         LM    @00,@05,@SA00012+8                                  1518
         LM    @07,@12,@SA00012+32                                 1518
         BR    @14                                                 1518
*END CONTRBL;                                              /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  PROCEDURE NAME - MORESP                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  FUNCTION - HANDLE THE SITUATION IN WHICH VSAM   @Y30SSFR*/
*        /*  MANAGEMENT HAS USED ALL OF ITS WORK AREA        @Y30SSFR*/
*        /*  BY PRINTING THE NAMES OF THE                    @Y30SSFR*/
*        /*  ITEMS ALREADY DELETED.  THEN EITHER THE         @Y30SSFR*/
*        /*  WORK AREA IS CLEARED OR A NEW WORK AREA IS      @Y30SSFR*/
*        /*  OBTAINED.  VSAM CATALOG IS THEN INVOKED         @Y30SSFR*/
*        /*  AGAIN BY DELTPROC.                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  INPUT - A CPL BUILT BY CPLPROC, THE             @Y30SSFR*/
*        /*  WORK AREA USED BY VSAM CATALOG,                 @Y30SSFR*/
*        /*  AND THE NUMBER OF ENTRIES FOUND IN THE WORK     @Y30SSFR*/
*        /*  AREA BY CATCALL.                                @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /*  OUTPUT - EITHER THE SAME CATALOG WORKAREA       @Y30SSFR*/
*        /*  CLEARED OF THE NAMES PLACED THERE BY THE        @Y30SSFR*/
*        /*  PREVIOUS CALL TO CATALOG OR A NEW WORKAREA      @Y30SSFR*/
*        /*  POINTED TO BY AN UPDATED CTGWKA POINTER.        @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1520
*MORESP:  PROCEDURE(MMNOENT);                              /*@Y30SSFR*/
*                                                                  1520
MORESP   STM   @14,@12,@SA00013                                    1520
         MVC   @PC00013(4),0(@01)                                  1520
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ARGUMENT OF INVOCATION                          @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1521
*        DCL MMNOENT FIXED(31);        /*NUMBER OF VALID     @Y30SSFR*/
*                                      /*ENTRIES FOUND IN    @Y30SSFR*/
*                                      /*THE WORK AREA BY    @Y30SSFR*/
*                                      /*CATCALL             @Y30SSFR*/
*                                                                  1522
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOCAL DECLARATIONS FOR MORESP                   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1522
*        DCL J FIXED(31);              /*LOOP CONTROL        @Y30SSFR*/
*                                      /*FOR CLEARING        @Y30SSFR*/
*                                      /*CATALOG WORK AREA   @Y30SSFR*/
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORKAREA    @Y30SSFR*/
*                                      /*NEEDED              @Y30SSFR*/
*        DCL CURSIZE FIXED(15);        /*SIZE OF CURRENT     @Y30SSFR*/
*                                      /*WORK AREA           @Y30SSFR*/
*        DCL COREFLAG BIT(1);          /*FLAG TO INDICATE IF @Y30SSFR*/
*                                      /*CORE HAS BEEN       @Y30SSFR*/
*                                      /*GOTTEN FOR A CMS    @Y30SSFR*/
*                                      /*WORKAREA            @Y30SSFR*/
*        OLDERID2 = NEWERID2;                                      1526
         L     @03,@PC00001                                        1526
         L     @15,GDTTR2(,@03)                                    1526
         MVC   @TS00001(95),NEWERID2(@15)                          1526
         MVC   OLDERID2(95,@15),@TS00001                           1526
*        NEWID2 = 'DLMS';                                  /*@Y30SSFR*/
*                                                                  1527
         MVC   NEWID2(4,@15),@CC01334                              1527
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INTIALIZATIONS FOR THE PROCEDURE                @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1528
*        CURSIZE = AREALN;                                 /*@Y30SSFR*/
         L     @15,CTGPLPTR                                        1528
         L     @01,CTGWKA(,@15)                                    1528
         LH    CURSIZE,AREALN(,@01)                                1528
*        COREFLAG = OFF;                                   /*@Y30SSFR*/
*                                                                  1529
         NI    COREFLAG,B'01111111'                                1529
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RESTORE THE CPL.    SET CTGERASE TO OFF AND     @Y30SSFR*/
*        /*  CTGOVRID TO ON TO PREVENT CMS FROM REERASING    @Y30SSFR*/
*        /*  THE OBJECT ON SUBSEQUENT CALLS TO CATALOG.      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1530
*        CTGPL = DSAVCPL;                                  /*@Y30SSFR*/
         MVC   CTGPL(28,@15),DSAVCPL                               1530
*        CTGERASE = OFF;                                   /*@Y30SSFR*/
*        CTGOVRID = ON;                                    /*@Y30SSFR*/
*                                                                  1532
         OI    CTGOVRID(@15),B'00000100'                           1532
         NI    CTGERASE(@15),B'10111111'                           1532
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  COMPUTE THE SIZE NEEDED AND COMPARE THAT        @Y30SSFR*/
*        /*  TO THE CURRENT SIZE OF THE WORK AREA            @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1533
*        SIZENEED = RETURNLN - (LENGTH(ENTITEM)            /*@Y30SSFR*/
*                        * MMNOENT);                       /*@Y30SSFR*/
*                                                                  1533
         L     @01,CTGWKA(,@15)                                    1533
         L     @14,@PC00013                                        1533
         L     @00,MMNOENT(,@14)                                   1533
         MH    @00,@CH00912                                        1533
         LCR   @00,@00                                             1533
         AH    @00,RETURNLN(,@01)                                  1533
         ST    @00,SIZENEED                                        1533
*        IF SIZENEED > CURSIZE                             /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
*                                                                  1534
         CR    @00,CURSIZE                                         1534
         BNH   @RF01534                                            1534
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THE CURRENT WORK AREA IS GOTTEN          @Y30SSFR*/
*            /*  CORE, FREE IT.  THEN GET A WORK AREA OF     @Y30SSFR*/
*            /*  APPROPRIATE SIZE AND CHANGE THE CPL TO      @Y30SSFR*/
*            /*  POINT TO IT.                                @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1535
*            DO;                                           /*@Y30SSFR*/
*            IF COREFLAG = ON                              /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         TM    COREFLAG,B'10000000'                                1536
         BNO   @RF01536                                            1536
*                CALL IDCSAFS0(GDTTBL,CTGWKA);             /*@Y30SSFR*/
         ST    @03,@AL00001                                        1537
         LA    @02,CTGWKA(,@15)                                    1537
         ST    @02,@AL00001+4                                      1537
         L     @15,GDTFSP(,@03)                                    1537
         LA    @01,@AL00001                                        1537
         BALR  @14,@15                                             1537
*            COREFLAG = ON;                                /*@Y30SSFR*/
*                                                                  1538
@RF01536 OI    COREFLAG,B'10000000'                                1538
*            CALL IDCSAGP0(GDTTBL,SIZENEED,                /*@Y30SSFR*/
*                    CTGWKA,GPID,SETZERO);                 /*@Y30SSFR*/
*                                                                  1539
         L     @03,@PC00001                                        1539
         ST    @03,@AL00001                                        1539
         LA    @15,SIZENEED                                        1539
         ST    @15,@AL00001+4                                      1539
         L     @01,CTGPLPTR                                        1539
         LA    @15,CTGWKA(,@01)                                    1539
         ST    @15,@AL00001+8                                      1539
         LA    @15,GPID                                            1539
         ST    @15,@AL00001+12                                     1539
         LA    @15,SETZERO                                         1539
         ST    @15,@AL00001+16                                     1539
         MVI   @AL00001+16,X'80'                                   1539
         L     @15,GDTGPL(,@03)                                    1539
         LA    @01,@AL00001                                        1539
         BALR  @14,@15                                             1539
*            RESPECIFY RTNREG RSTD;                                1540
*            TESTRC = RTNREG;                                      1541
         LR    TESTRC,RTNREG                                       1541
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  1542
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         SLR   @03,@03                                             1543
         CR    TESTRC,@03                                          1543
         BE    @RF01543                                            1543
*                DO;                                       /*@Y30SSFR*/
*                DARGSMOD = UNIVMSG;                       /*@Y30SSFR*/
         L     @02,DDSTRU                                          1545
         MVC   DARGSMOD(3,@02),@CC00930                            1545
*                DARGSENT = NOSTORAG;                      /*@Y30SSFR*/
         MVI   DARGSENT(@02),X'04'                                 1546
*                DARGDBP = NULLPTR;                        /*@Y30SSFR*/
         ST    @03,DARGDBP(,@02)                                   1547
*                DARGILP = 0;                              /*@Y30SSFR*/
*                                                                  1548
         STH   @03,DARGILP(,@02)                                   1548
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Y30SSFR*/
*                                                                  1549
         L     @15,@PC00001                                        1549
         ST    @15,@AL00001                                        1549
         LA    @14,@CF00116                                        1549
         ST    @14,@AL00001+4                                      1549
         LA    @14,DDSTRU                                          1549
         ST    @14,@AL00001+8                                      1549
         MVI   @AL00001+8,X'80'                                    1549
         L     @15,GDTPRT(,@15)                                    1549
         LA    @01,@AL00001                                        1549
         BALR  @14,@15                                             1549
*                SETRC = LASTCC08;                         /*@Y30SSFR*/
         LA    @15,8                                               1550
         STH   @15,SETRC                                           1550
*                RETURN CODE(SETRC);                       /*@Y30SSFR*/
         L     @14,@SA00013                                        1551
         LM    @00,@12,@SA00013+8                                  1551
         BR    @14                                                 1551
*                END;                                      /*@Y30SSFR*/
*                                                                  1552
*            CURSIZE = SIZENEED;                           /*@Y30SSFR*/
@RF01543 L     CURSIZE,SIZENEED                                    1553
*            AREALN = CURSIZE;                             /*@Y30SSFR*/
*                                                                  1554
         L     @03,CTGPLPTR                                        1554
         L     @03,CTGWKA(,@03)                                    1554
         STH   CURSIZE,AREALN(,@03)                                1554
*            END;                                          /*@Y30SSFR*/
*                                                                  1555
*          ELSE                                                    1556
*                                                                  1556
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF CURRENT WORK AREA IS LARGE ENOUGH        @Y30SSFR*/
*            /*  FOR THE NEXT CALL TO CATALOG, CLEAR IT.     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1556
*              DO;                                         /*@Y30SSFR*/
         B     @RC01534                                            1556
@RF01534 DS    0H                                                  1557
*              RETURNLN = 0;                               /*@Y30SSFR*/
*                                                                  1557
         L     @01,CTGPLPTR                                        1557
         L     @01,CTGWKA(,@01)                                    1557
         SLR   @00,@00                                             1557
         STH   @00,RETURNLN(,@01)                                  1557
*              DO J = 1 TO LIMIT;                          /*@Y30SSFR*/
         LA    J,1                                                 1558
         B     @DE01558                                            1558
@DL01558 DS    0H                                                  1559
*                ENTLIST(J) = ''B;                         /*@Y30SSFR*/
         LR    @03,J                                               1559
         MH    @03,@CH00912                                        1559
         L     @01,CTGPLPTR                                        1559
         L     @01,CTGWKA(,@01)                                    1559
         ALR   @01,@03                                             1559
         AL    @01,@CF01373                                        1559
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1559
*              END;                                        /*@Y30SSFR*/
*                                                                  1560
         AL    J,@CF00220                                          1560
@DE01558 C     J,LIMIT                                             1560
         BNH   @DL01558                                            1560
*              END;                                        /*@Y30SSFR*/
*                                                                  1561
*        RETURN CODE(SETRC);                               /*@Y30SSFR*/
@RC01534 LH    @15,SETRC                                           1562
         L     @14,@SA00013                                        1562
         LM    @00,@12,@SA00013+8                                  1562
         BR    @14                                                 1562
*END MORESP;                                               /*@Y30SSFR*/
*END IDCXP01                                                       1564
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSXP )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*;                                                                 1564
@DATA    DS    0H
@CH00311 DC    H'24'
@CH00604 DC    H'44'
@CH01116 DC    H'110'
@CH01341 DC    H'588'
@CH00894 DC    H'1000'
@SM01375 MVC   TOAREA(0,MTPTR),ZERO
@SM01377 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)
@SC01380 CLC   FIELD(0,@15),NOTINIT
@SC01382 CLC   FIELD(0,@07),NOTINIT
         DS    0F
@AL00417 DC    A(NULLPARM)             LIST WITH   4 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(FIELDLST)
         DC    A(CNUM)
@AL00557 DC    A(@CF00891)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00635 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00659 DC    A(@CF00287)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00740)
@AL00645 DC    A(@CF01342)             LIST WITH   4 ARGUMENT(S)
         DC    A(NULLPARM)
         DS    F
         DC    A(SETZERO)
@AL00780 DC    A(@CF01342)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00990 DC    A(@CF01340)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL01237 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL01238 DC    A(@CC00728)             LIST WITH   5 ARGUMENT(S)
         DS    F
         DC    A(NULLPARM)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL01376 DC    A(@CF00891)             LIST WITH   4 ARGUMENT(S)
         DC    A(NULLPARM)
         DS    F
         DC    A(SETZERO)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00003 DS    14F
@SA00002 DS    14F
@SA00004 DS    14F
@PC00004 DS    6F
@SA00005 DS    14F
@PC00005 DS    1F
@SA00006 DS    15F
@PC00006 DS    6F
@SA00009 DS    15F
@PC00009 DS    2F
@SA00012 DS    14F
@PC00012 DS    2F
@PC00011 DS    4F
@SA00010 DS    14F
@SA00008 DS    14F
@PC00008 DS    3F
@SA00007 DS    14F
@PC00007 DS    1F
@SA00013 DS    15F
@PC00013 DS    1F
@AL00001 DS    6A
@AFTEMPS DS    7F
IDCXP01  CSECT
         DS    0F
@CF00116 DC    F'0'
@CF00220 DC    F'1'
@CH00220 EQU   @CF00220+2
@CF00154 DC    F'2'
@CH00154 EQU   @CF00154+2
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00287 DC    F'5'
@CF00180 DC    F'8'
@CH00180 EQU   @CF00180+2
@CF00038 DC    F'9'
@CF00037 DC    F'10'
@CF00641 DC    F'14'
@CF00229 DC    F'15'
@CF00483 DC    F'16'
@CF00988 DC    F'17'
@CF00610 DC    F'18'
@CF00625 DC    F'20'
@CF01340 DC    F'28'
@CH01340 EQU   @CF01340+2
@CF01346 DC    F'33'
@CF01110 DC    F'40'
@CH01110 EQU   @CF01110+2
@CF00912 DC    F'45'
@CH00912 EQU   @CF00912+2
@CF01112 DC    F'72'
@CF01114 DC    F'76'
@CF00891 DC    F'268'
@CH00891 EQU   @CF00891+2
@CF01342 DC    F'1052'
@CF01144 DC    F'2048'
@CF01373 DC    F'-41'
@CF01374 DC    F'-40'
@CF01368 DC    F'-8'
@CF01379 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CTGPLPTR DS    A
DSCCATPT DS    A
RECSZ    DS    F
BLKSIZ   DS    F
TOTLEN   DS    F
DCPLPTR  DS    A
RCPCPLPT DS    A
PINIOCS  DS    A
POUTIOCS DS    A
PTRCTACB DS    A
CONRCPTR DS    A
ALLPTR   DS    A
LIMIT    DS    F
INDXCPL  DS    F
A1CPLPTR DS    A
DSIZE    DS    F
MNOENT   DS    F
SIZENEED DS    F
CTGFVPTR DS    A
LISTPTR  DS    A
SETRC    DS    H
NUMASSOC DS    H
NUMOBJ   DS    H
SAPLLEN  DS    H
QUALLEN  DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
SUPPRESS DS    BL1
ERRORTAB DS    CL32
         DS    CL1
@NM00047 DS    CL10
         ORG   @NM00047
CATRTNID DS    CL8
CATLGRC  DS    FL2
         ORG   @NM00047+10
RELNAME  DS    CL44
DSAVCPL  DS    CL28
SAVEPL   DS    CL588
         ORG   SAVEPL
@NM00053 DS    CL28
@NM00054 DS    20CL4
@NM00055 DS    20CL24
         ORG   SAVEPL+588
DOCNTRL  DS    BL1
PORTTIME DS    CL8
PORTDATE DS    CL8
ALLLIST  DS    CL29
DEALLOC  DS    BL1
         DS    CL3
QUALLIST DS    CL12
         ORG   QUALLIST
QUALADDR DS    AL4
QUALCAT  DS    AL4
QUALPAS  DS    AL4
         ORG   QUALLIST+12
FLGS     DS    CL1
         ORG   FLGS
AIXFLAG  DS    BL1
KSDSFLAG EQU   FLGS+0
PATHFLAG EQU   FLGS+0
RRDSFLAG EQU   FLGS+0
FIRFLAG  EQU   FLGS+0
@NM00056 EQU   FLGS+0
         ORG   FLGS+1
         DS    CL3
OPENLIST DS    BL48
DEFINED  DS    BL1
CNTRL    DS    BL1
COREFLAG DS    BL1
DEFSTMOD DS    CL3
         DS    CL2
PRINTTAB DS    9F
PTRCPL   DS    5A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCXP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
MINRECSZ DC    F'268'
NULLPARM DC    A(0)
NMLENGTH DC    H'45'
ASSOBJNM DC    AL2(3-1)
CNUM     DC    AL1(24)
ONUM     DC    AL1(24-3)
RNUM     DC    AL1(2)
AIXNUM   DC    AL1(2)
F1NUM    DC    AL1(2)
F2NUM    DC    AL1(1)
@CC01209 DC    C'CATLGRTN'
@CC00896 DC    C'XP01'
@CC01134 DC    C'XPBG'
@CC01139 DC    C'XPFN'
@CC01140 DC    C'XPED'
@CC01145 DC    C'XPCP'
@CC01150 DC    C'XPAO'
@CC01156 DC    C'XPWC'
@CC01172 DC    C'XPPM'
@CC01176 DC    C'XPTM'
@CC01181 DC    C'XPUC'
@CC01200 DC    C'XPLP'
@CC01208 DC    C'XPSP'
@CC01210 DC    C'XPZZ'
@CC01230 DC    C'XPOP'
@CC01238 DC    C'XPAP'
@CC01254 DC    C'XPDP'
@CC01259 DC    C'XPZY'
@CC01283 DC    C'XPPP'
@CC01289 DC    C'XPRP'
@CC01318 DC    C'XPCR'
@CC01324 DC    C'XPCW'
@CC01334 DC    C'DLMS'
@CC00914 EQU   @CC00896
@CC00930 DC    C'UV0'
@CC00938 DC    C'DL0'
@CC00728 DC    C'I'
@CC00732 EQU   @CC00930
@CC00736 EQU   @CC01209
@CC00738 DC    C'G'
@CC00740 DC    C'R'
@CC01155 DC    C'O'
@CC01159 DC    C'N'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'XP01'
GPID     DC    CL4'XP01'
FIXAREA  DS    CL400
         ORG   FIXAREA
@NM00043 DS    CL256
         ORG   @NM00043
@NM00044 DC    256X'00'
         ORG   FIXAREA+256
@NM00045 DS    CL144
         ORG   @NM00045
@NM00046 DC    144X'00'
         ORG   FIXAREA+400
FLIST2   DC    CL8'ENTNAME '
NOTINIT  DS    CL255
         ORG   NOTINIT
@NM00051 DC    255X'FF'
         ORG   NOTINIT+255
EXPTYPE1 DC    X'F2'
CITYPEXT DC    CL8'ITYPEXT '
SSFLAG   DC    X'80'
ZERO     DC    X'00'
         DC    XL255'0'
FIELDLST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'DSATTR  '
         DC    CL8'OWNERID '
         DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'BUFSIZE '
         DC    CL8'LRECL   '
         DC    CL8'SPACPARM'
         DC    CL8'PASSWORD'
         DC    CL8'PASSPRMT'
         DC    CL8'PASSATMP'
         DC    CL8'USVRMDUL'
         DC    CL8'USERAREC'
         DC    CL8'LOKEYV  '
         DC    CL8'HIKEYV  '
         DC    CL8'VOLSER  '
         DC    CL8'AMDSBCAT'
         DC    CL8'EXCPEXIT'
         DC    CL8'RGATTR  '
         DC    CL8'SECFLAGS'
         DC    CL8'NAMEDS  '
         DC    CL8'CATACB  '
         DC    CL8'CATTR   '
FLIST1   DC    CL8'ENTYPE  '
         DC    CL8'NAMEDS  '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CURSIZE  EQU   @02
J        EQU   @02
ICONTRBL EQU   @02
M1SIZE   EQU   @02
MTPTR    EQU   @03
MFPTR    EQU   @04
PAD      EQU   @04
PLN      EQU   @05
IX       EQU   @02
IND1     EQU   @02
ALLOINDX EQU   @03
AFVTPTR  EQU   @02
WSIZE    EQU   @03
LGNFLD   EQU   @05
DINDX    EQU   @03
INDX     EQU   @04
I        EQU   @04
ENTRYNO  EQU   @02
ASSREMD  EQU   @02
CLRFDCTR EQU   @03
NUMOBJCT EQU   @05
NUMCPL   EQU   @05
FNMPTR   EQU   @03
DEFSTID  EQU   @06
CTGFLPTR EQU   @02
OPNPTR   EQU   @03
IOCSPTR  EQU   @03
TESTRC   EQU   @02
RTNREG   EQU   @15
REG15    EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSACA0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSAQL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPT0 EQU   0
IDCIOCO0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCTRN   EQU   IOCSTR+8
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMSF EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNTYPXM EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAX EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDEVDT EQU   OPNDEV
OPNREC   EQU   OPNAGL+32
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATAL  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
ENT      EQU   0
ENTPLN   EQU   ENT
ENTPAS   EQU   ENT+1
ENTFLG   EQU   ENT+10
ENTFUQ   EQU   ENTFLG
ENTLEN   EQU   ENT+20
ENTVAL   EQU   ENT+21
INDD     EQU   0
INDDVAL  EQU   INDD+1
OUT      EQU   0
OUTDS    EQU   0
OUTDSPLN EQU   OUTDS
OUTDSPAS EQU   OUTDS+1
OUTDSFLG EQU   OUTDS+10
OUTDSFUQ EQU   OUTDSFLG
OUTDSLEN EQU   OUTDS+20
OUTDSVAL EQU   OUTDS+21
OUTDD    EQU   0
OUTDDVAL EQU   OUTDD+1
ENVIR    EQU   0
PDEV     EQU   0
PDEVVAL  EQU   PDEV+1
BLKSZ    EQU   0
BLKSZVAL EQU   BLKSZ
PERM     EQU   0
INHBS    EQU   0
INHBT    EQU   0
ERASE    EQU   0
NOERS    EQU   0
PURGE    EQU   0
DISCT    EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGDISC  EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGTYPE  EQU   CTGPL+18
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDWA EQU   CTGFL+4
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVIND EQU   CTGFV+16
CTGFVENT EQU   CTGFV+20
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVATR EQU   CTGFV+60
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CTGFVPWD EQU   CTGFV+84
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDRRDS  EQU   AMDATTR
AMDNEST  EQU   IDAAMDSB+4
AMDAXRKP EQU   AMDNEST
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDPCTCA EQU   IDAAMDSB+10
AMDPCTCI EQU   IDAAMDSB+11
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
FENTYPE  EQU   0
FENTNAME EQU   0
FNAMEDS  EQU   0
FTYPE    EQU   FNAMEDS
FNAME    EQU   FNAMEDS+1
FCATACB  EQU   0
FDSATTR  EQU   0
FDSINHUP EQU   FDSATTR
FDSTMPEX EQU   FDSATTR
FDSNTUSE EQU   FDSATTR+1
FCATTR   EQU   0
PAGESPC  EQU   FCATTR
FPASSMWR EQU   0
FIELD    EQU   0
FIELDLN  EQU   FIELD
WORKAREA EQU   0
AREALN   EQU   WORKAREA
RETURNLN EQU   WORKAREA+2
ENTLIST  EQU   WORKAREA+4
ENTITEM  EQU   ENTLIST
ENTRYTYP EQU   ENTITEM
ENTRYNM  EQU   ENTITEM+1
PATHREL  EQU   0
RELATE   EQU   PATHREL
PATHENT  EQU   RELATE
@NM00052 EQU   PATHREL+44
PATHPASS EQU   @NM00052
CONREC   EQU   0
HEADER   EQU   CONREC
HEADLN   EQU   HEADER
HEADFLG1 EQU   HEADER+2
HEADFLG2 EQU   HEADER+3
ASSRECLN EQU   HEADER+4
ASSRECNM EQU   HEADER+6
VARDATA  EQU   CONREC+8
DICT     EQU   0
DICTNM   EQU   DICT
DICTEN   EQU   DICT+4
DICTLN   EQU   DICTEN
DICTDL   EQU   DICTEN+4
TIMESTMP EQU   0
TEXOJCT  EQU   TIMESTMP
TEXFLG   EQU   TIMESTMP+1
TEXINHTG EQU   TEXFLG
TEXASSOC EQU   TEXFLG
TEXBASE  EQU   TEXFLG
TEXFLG2  EQU   TIMESTMP+2
TIMEODAY EQU   TIMESTMP+4
TIMEDATE EQU   TIMESTMP+12
DSNAME   EQU   0
OIOCSPTR EQU   0
FROMAREA EQU   0
TOAREA   EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NINHS    EQU   0
NINHT    EQU   0
NPRG     EQU   0
TEMP     EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
LNAME    EQU   0
LCINUM   EQU   0
LCATACB  EQU   0
LFLDLST  EQU   0
LFLDNUM  EQU   0
LCPLPTR  EQU   0
SCPLPTR  EQU   0
OTYPE    EQU   0
ODD      EQU   0
ODSN     EQU   0
OREC     EQU   0
OBLK     EQU   0
OIOCS    EQU   0
ACPLPTR  EQU   0
DTYPE    EQU   0
DENTVAL  EQU   0
DCPL     EQU   0
PLNINIT  EQU   0
PADINIT  EQU   0
MSIZE    EQU   0
MF1PTR   EQU   0
MT1PTR   EQU   0
ZEROOUT  EQU   0
INDCTGPL EQU   0
TYPE     EQU   0
MMNOENT  EQU   0
@NM00037 EQU   CTGDDNM
CTGPROB  EQU   @NM00037
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
TEXRESV  EQU   TIMESTMP+3
TEXUNIQ  EQU   TEXFLG
FIELDCT  EQU   FIELD+2
@NM00050 EQU   FCATTR
@NM00049 EQU   FDSATTR+1
@NM00048 EQU   FDSATTR
FDSOTHER EQU   FDSATTR
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00042 EQU   IDAAMDSB+41
@NM00041 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
CTGFVWKA EQU   CTGFV+88
CTGFVCPP EQU   CTGFVPWD
CTGFVNAM EQU   CTGFV+80
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVLRS EQU   CTGFV+68
CTGFVBUF EQU   CTGFV+64
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
CTGFVDVT EQU   CTGFV+48
CTGFVRNG EQU   CTGFV+44
CTGFVVLT EQU   CTGFV+40
CTGFVCRE EQU   CTGFV+36
CTGFVEXP EQU   CTGFV+32
CTGFVOWN EQU   CTGFV+28
CTGFVSTY EQU   CTGFV+24
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00040 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00039 EQU   CTGFVPRO
CTGFVROF EQU   CTGFVPRO
CTGFVRON EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGFLDTS EQU   CTGFLDRE
@NM00038 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
@NM00036 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
@NM00035 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00034 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00033 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00032 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
PDEVLEN  EQU   PDEV
OUTDDLEN EQU   OUTDD
OUTDSMEM EQU   OUTDS+12
OUTDSMLN EQU   OUTDS+11
OUTDSPOS EQU   OUTDS+9
INDDLEN  EQU   INDD
ENTMEM   EQU   ENT+12
ENTMLN   EQU   ENT+11
ENTPOS   EQU   ENT+9
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATDE  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNDEVIX EQU   OPNDEV+4
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00434 EQU   @RC00431
@RC00432 EQU   @RC00431
@RC00508 EQU   @RC00470
@RF00507 EQU   @RC00470
@RF00598 EQU   @RC00592
@RC00618 EQU   @RC00617
@RF00663 EQU   @RC00617
@RF00711 EQU   @RC00701
@RC01401 EQU   @RC01400
@RF01474 EQU   @RC01469
@PB00013 EQU   @EL00001
@RF00437 EQU   @RC00434
@RC00513 EQU   @RC00508
@RF00523 EQU   @RC00508
@RF00639 EQU   @RC00618
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCXP01,(C'PLS0340',0701,77127)

         TITLE '*********  IDCSA03  SYSTEM ADAPTER PROL/UEPIL MODULE  **
               *********'
IDCSA03 CSECT
MAINENT DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(BEGIN-MAINENT)
        DC    C'IDCSA03 '
IDCSAPR DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAPR1-IDCSAPR)
        ENTRY IDCSAPR
IDCSAEP DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAEP1-IDCSAEP)
        ENTRY IDCSAEP
        DROP  REG15
PROLOG  AH    REG15,4(REG15)
        BR    REG15
BEGIN   DS    0H
*                                                            @Z40GSBF*/
*                                                                  0178
*                                                                  0178
*        /************************************************************/
*        /*                                                          */
*        /* PROL ROUTINE ENTRY POINT                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0179
*IDCSAPR:  ENTRY(MODIDX,PSIZEX);                                   0179
*                                                                  0179
@EC00179 DS    0H                                                  0180
*AMSSAPR1:                                                         0180
*                                                                  0180
*        /************************************************************/
*        /*                                                          */
*        /* PROLOG CODE FOR PROL ROUTINE                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0180
*        GEN;                                                      0180
*                                                                  0180
AMSSAPR1 DS    0H                                                  0180
        L     REG15,24(REG13)         REGISTER 1 FROM SAVEAREA
        L     REG15,0(REG15)          GDTTBL ADDRESS
        L     REG15,GDTSPR(REG15)     FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG15             DATA ADDRESSABILITY
        STM   REG2,REG12,PROLSAV      SAVE REGISTERS
        DROP  REG15
        L     REG2,24(REG13)          REGISTER 1 FROM SAVEAREA
        L     REG2,0(REG2)            GDTTBL ADDRESS
        LR    REG11,REG15             FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG11             DATA ADDRESSABILITY
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
        BALR  REG12,0
PSTART1 DS    0H
        USING PSTART1,REG12           CODE ADDRESSABILITY
*        /************************************************************/
*        /*                                                          */
*        /* BASE FOR THE GDTTBL IS ALREADY SET UP IN THE PROL CODE   */
*        /* FOR THIS ROUTINE--NOW SET UP BASE FOR MODID AND PSIZE    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0181
*        RESPECIFY (REG1,REG14) RSTD;                              0181
*        GEN(L     MODIDPR,0(REG1));                               0182
         L     MODIDPR,0(REG1)
*        GEN(L     SIZEPR,4(REG1));                                0183
         L     SIZEPR,4(REG1)
*        RESPECIFY (REG1) UNRSTD;                                  0184
*                                                                  0184
*        /************************************************************/
*        /*                                                          */
*        /* SAVE THE RETURN ADDRESS IN REGISTER 14                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0185
*        RTNADDR = REG14;                                          0185
         LR    RTNADDR,REG14                                       0185
*        RESPECIFY (REG14) UNRSTD;                                 0186
*                                                                  0186
*        TEMPID = MODID;                                           0187
*                                                                  0187
         MVC   TEMPID(4),MODID(MODIDPR)                            0187
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF MODULE ID IS CONTAINED IN           @YL026UK*/
*        /* STORAGE TABLE                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0188
*        DOCNTRL = ON;                                             0188
         OI    DOCNTRL,B'10000000'                                 0188
*PRDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);      /*@Y30LSMK*/
*                                                                  0189
PRDO     LA    I,1                                                 0189
@DL00189 TM    DOCNTRL,B'10000000'                                 0189
         BNO   @DC00189                                            0189
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF MODULE ID MATCHES ID IN           @YL026UK*/
*          /* STORAGE TABLE                                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0190
*          IF AREAID(I) = TEMPID                                   0190
*            THEN                                                  0190
         LR    @08,I                                               0190
         MH    @08,@CH00032                                        0190
         L     @07,GDTSAH(,GDTPR)                                  0190
         L     @07,AUTOPTR(,@07)                                   0190
         ALR   @07,@08                                             0190
         AL    @07,@CF00712                                        0190
         CLC   AREAID(4,@07),TEMPID                                0190
         BNE   @RF00190                                            0190
*              DOCNTRL = OFF;                                      0191
         NI    DOCNTRL,B'01111111'                                 0191
*        END PRDO;                                                 0192
*                                                                  0192
@RF00190 AL    I,@CF00213                                          0192
         C     I,@CF00635                                          0192
         BNH   @DL00189                                            0192
@DC00189 DS    0H                                                  0193
*        /************************************************************/
*        /*                                                          */
*        /* CHECK WHETHER OR NOT MODULE ID IS CONTAINED IN   @YL026UK*/
*        /* STORAGE TABLE                                    @YL026UK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0193
*        IF DOCNTRL = ON                                           0193
*          THEN                                                    0193
         TM    DOCNTRL,B'10000000'                                 0193
         BNO   @RF00193                                            0193
*            DO;                                                   0194
*                                                                  0194
*              /******************************************************/
*              /*                                                    */
*              /* MODULE ID IS NOT CONTAINED IN              @YL026UK*/
*              /* STORAGE TABLE SO CALL GETCORE ROUTINE TO GET CORE  */
*              /* PLUS 8 BYTES FOR CONTROL INFORMATION               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0195
*              TEMPSIZE = PSIZE + 8;                               0195
         LA    @08,8                                               0195
         AL    @08,PSIZE(,SIZEPR)                                  0195
         ST    @08,TEMPSIZE                                        0195
*              CALL GETCORE(TEMPSIZE,TEMPPTR);                     0196
*                                                                  0196
         LA    @08,TEMPSIZE                                        0196
         ST    @08,@AL00001                                        0196
         LA    @08,TEMPPTR                                         0196
         ST    @08,@AL00001+4                                      0196
         LA    @01,@AL00001                                        0196
         BAL   @14,GETCORE                                         0196
*              /******************************************************/
*              /*                                                    */
*              /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER 5 AND */
*              /* INSERT CONTROL INFORMATION IN FRONT OF AREA        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0197
*              RESPECIFY (REG5) RSTD;                              0197
*              REG5 = TEMPPTR + 8;                                 0198
         L     @08,TEMPPTR                                         0198
         LA    REG5,8                                              0198
         ALR   REG5,@08                                            0198
*              AUTOID = TEMPID;                                    0199
         MVC   AUTOID(4,@08),TEMPID                                0199
*              AUTOSIZE = TEMPSIZE;                                0200
         MVC   AUTOSIZE(4,@08),TEMPSIZE                            0200
*            END;                                                  0201
*          ELSE                                                    0202
*                                                                  0202
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS CONTAINED IN STORAGE TABLE SO   @YL026UK*/
*            /* USE THIS TABLE FOR AUTOMATIC STORAGE REQUEST         */
*            /* ALLOCATION                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0202
*            DO;                                                   0202
         B     @RC00193                                            0202
@RF00193 DS    0H                                                  0203
*              I = I -1;                                           0203
*                                                                  0203
         BCTR  I,0                                                 0203
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF STATUS IS ZERO, INDICATING THAT THE FROZEN*/
*              /* AREA IS NOT BEING USED                             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0204
*              IF STATUS(I) = 0                                    0204
*                THEN                                              0204
*                                                                  0204
         LR    @08,I                                               0204
         MH    @08,@CH00032                                        0204
         L     @07,GDTSAH(,GDTPR)                                  0204
         L     @07,AUTOPTR(,@07)                                   0204
         ST    @08,@TF00001                                        0204
         ALR   @08,@07                                             0204
         AL    @08,@CF00714                                        0204
         ICM   @08,12,STATUS-4(@08)                                0204
         SRA   @08,16                                              0204
         LTR   @08,@08                                             0204
         BNZ   @RF00204                                            0204
*                  /**************************************************/
*                  /*                                                */
*                  /* INSERT ADDRESS OF PREALLOCATED FROZEN          */
*                  /* AUTOMATIC STORAGE INTO REGISTER 5              */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0205
*                  REG5 = PTR1(I);                                 0205
         AL    @07,@TF00001                                        0205
         AL    @07,@CF00715                                        0205
         ICM   REG5,15,PTR1-8(@07)                                 0205
*                ELSE                                              0206
*                  DO;                                             0206
*                                                                  0206
         B     @RC00204                                            0206
@RF00204 DS    0H                                                  0207
*                    /************************************************/
*                    /*                                              */
*                    /* CALL GETCORE ROUTINE TO ALLOCATE STORAGE + 8 */
*                    /* BYTES FOR CONTROL INFORMATION                */
*                    /*                                              */
*                    /************************************************/
*                                                                  0207
*                    TEMPSIZE = PSIZE + 8;                         0207
         LA    @08,8                                               0207
         AL    @08,PSIZE(,SIZEPR)                                  0207
         ST    @08,TEMPSIZE                                        0207
*                    CALL GETCORE(TEMPSIZE,TEMPPTR);               0208
*                                                                  0208
         LA    @08,TEMPSIZE                                        0208
         ST    @08,@AL00001                                        0208
         LA    @08,TEMPPTR                                         0208
         ST    @08,@AL00001+4                                      0208
         LA    @01,@AL00001                                        0208
         BAL   @14,GETCORE                                         0208
*                    /************************************************/
*                    /*                                              */
*                    /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER */
*                    /* 5 (SO WON'T BE DESTROYED BY ANY CALLS)       */
*                    /* AND INSERT CONTROL INFORMATION IN FRONT OF   */
*                    /* AREA                                         */
*                    /*                                              */
*                    /************************************************/
*                                                                  0209
*                    REG5 = TEMPPTR + 8;                           0209
         L     @08,TEMPPTR                                         0209
         LA    REG5,8                                              0209
         ALR   REG5,@08                                            0209
*                    AUTOID = IDENT;                               0210
         MVC   AUTOID(4,@08),IDENT                                 0210
*                    AUTOSIZE = TEMPSIZE;                          0211
         MVC   AUTOSIZE(4,@08),TEMPSIZE                            0211
*                  END;                                            0212
*                                                                  0212
*              /******************************************************/
*              /*                                                    */
*              /* INCREMENT STATUS BY ONE                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0213
*              STATUS(I) = STATUS(I) + 1;                          0213
@RC00204 LR    @08,I                                               0213
         MH    @08,@CH00032                                        0213
         L     @07,GDTSAH(,GDTPR)                                  0213
         L     @07,AUTOPTR(,@07)                                   0213
         LA    @15,1                                               0213
         ST    @08,@TF00001                                        0213
         ALR   @08,@07                                             0213
         AL    @08,@CF00714                                        0213
         ICM   @08,12,STATUS-4(@08)                                0213
         SRA   @08,16                                              0213
         ALR   @15,@08                                             0213
         AL    @07,@TF00001                                        0213
         AL    @07,@CF00714                                        0213
         STCM  @15,3,STATUS-4(@07)                                 0213
*            END;                                                  0214
*                                                                  0214
*        /************************************************************/
*        /*                                                          */
*        /* UPDATE INTER MODULE TRACE TABLE WITH USER'S MODULE ID    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0215
*        OLDERID1 = NEWERID1;                                      0215
@RC00193 L     @08,GDTTR1(,GDTPR)                                  0215
         MVC   @TS00001(95),NEWERID1(@08)                          0215
         MVC   OLDERID1(95,@08),@TS00001                           0215
*        NEWID1 = TEMPID;                                          0216
*                                                                  0216
         MVC   NEWID1(4,@08),TEMPID                                0216
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE THE RETURN ADDRESS INTO REGISTER 14              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0217
*        RESPECIFY (REG14) RSTD;                                   0217
*        REG14 = RTNADDR;                                          0218
*                                                                  0218
         LR    REG14,RTNADDR                                       0218
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE SAVEAREA POINTER AND STORE USER'S MODULE ID INTO */
*        /* THE FIRST 4 BYTES OF THE SAVEAREA THAT HE SAVED IN       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0219
*        RESPECIFY (REG13) RSTD;                                   0219
*        GEN(L     REG13,4(REG13));                                0220
         L     REG13,4(REG13)
*        GEN(MVC   0(4,REG13),TEMPID);                             0221
         MVC   0(4,REG13),TEMPID
*        RESPECIFY (REG13) UNRSTD;                                 0222
*                                                                  0222
*        /************************************************************/
*        /*                                                          */
*        /* THE PROL ROUTINE AUTOMATIC STORAGE AREA DOESN'T NEED     */
*        /* TO BE RELEASED AS IT IS USED AGAIN--NOW LOAD THE ADDRESS */
*        /* OF THE GOTTEN CORE INTO REGISTER 1, RESTORE REGISTERS    */
*        /* 2 THROUGH 12 FROM THE SAVEAREA SAVED IN BY THIS ROUTINE  */
*        /* (PROLSAVE) AND BRANCH ON REGISTER 14 (RETURN TO THE      */
*        /* CALLER)                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0223
*        RESPECIFY (REG1) RSTD;                                    0223
*        REG1 = REG5;                                              0224
         LR    REG1,REG5                                           0224
*        RESPECIFY(REG5) UNRSTD;                                   0225
*        GEN(LM    REG2,REG12,PROLSAV);                            0226
         LM    REG2,REG12,PROLSAV
*        GEN(BR    REG14);                                         0227
         BR    REG14
*        RESPECIFY (REG1,REG14) UNRSTD;                            0228
*        /************************************************************/
*        /*                                                          */
*        /* UEPIL ROUTINE ENTRY POINT                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0229
*IDCSAEP:  ENTRY(GDTTBLX,MODIDX,RCODEX);                           0229
*                                                                  0229
@EC00229 DS    0H                                                  0230
*AMSSAEP1:                                                         0230
*                                                                  0230
*        /************************************************************/
*        /*                                                          */
*        /* PROLOG CODE FOR THE UEPIL ROUTINE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0230
*        GEN;                                                      0230
*                                                                  0230
AMSSAEP1 DS    0H                                                  0230
        BALR  REG12,0
PSTART2 SH    REG12,8(REG12)          CODE ADDRESSABILITY
        B     *+6
        DC    AL2(PSTART2-PSTART1)
        L     REG11,0(REG1)           GDTTBL ADDRESS
        L     REG11,GDTSPR(REG11)     FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG11             DATA ADDRESSABILITY
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
*        /************************************************************/
*        /*                                                          */
*        /* SET UP BASE FOR GDTTBL, MODID AND RCODE                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0231
*        RESPECIFY (REG1) RSTD;                                    0231
*        GEN(L     GDTPR,0(REG1));                                 0232
         L     GDTPR,0(REG1)
*        GEN(L     MODIDPR,4(REG1));                               0233
         L     MODIDPR,4(REG1)
*        GEN(L     RCODEPR,8(REG1));                               0234
*                                                                  0234
*                                                                  0234
         L     RCODEPR,8(REG1)
*                                                                  0235
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0235
*        GEN;                                                      0235
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0236
         LA    LISTLN,1                                            0236
@DL00236 L     @10,LISTSCAN                                        0236
         TM    LISTTEST(@10),B'10000000'                           0236
         BNZ   @DC00236                                            0236
*          LISTSCAN = LISTSCAN + 4;                                0237
         AL    @10,@CF00036                                        0237
         ST    @10,LISTSCAN                                        0237
*        END;                                                      0238
*                                                                  0238
         AL    LISTLN,@CF00213                                     0238
         C     LISTLN,@CF00676                                     0238
         BNH   @DL00236                                            0238
@DC00236 DS    0H                                                  0239
*        RESPECIFY (REG1) UNRSTD;                                  0239
*                                                                  0239
*        /************************************************************/
*        /*                                                          */
*        /* GET ADDRESS OF CALLER'S AUTOMATIC STORAGE (TEMPPTR),     */
*        /* GET ADDRESS OF SAVEAREA THAT THE CALLER SAVED REGISTERS  */
*        /* IN (RTNSAVE), AND ZERO THIS SAVEAREA FORWARD CHAIN       */
*        /* POINTER                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0240
*        RESPECIFY (REG13) RSTD;                                   0240
*        GEN(L     REG13,4(REG13));                                0241
         L     REG13,4(REG13)
*        TEMPPTR = REG13;                                          0242
         ST    REG13,TEMPPTR                                       0242
*        GEN(L     REG13,4(REG13));                                0243
         L     REG13,4(REG13)
*        RTNSAVE = REG13;                                          0244
         LR    RTNSAVE,REG13                                       0244
*        SAVEFWD = NULLPTR;                                        0245
         SLR   @08,@08                                             0245
         ST    @08,SAVEFWD+8(,SAVEPTR)                             0245
*        REG13 = TEMPPTR;                                          0246
         L     REG13,TEMPPTR                                       0246
*        GEN(L     REG13,8(REG13));                                0247
         L     REG13,8(REG13)
*        RESPECIFY (REG13) UNRSTD;                                 0248
*                                                                  0248
*        /************************************************************/
*        /*                                                          */
*        /* CALCULATE ADDRESS OF AREA TO BE FREED--USER'S AUTOMATIC  */
*        /* STORAGE AREA POINTER MINUS 8 (CONTROL INFORMATION)       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0249
*        TEMPPTR = TEMPPTR - 8;                                    0249
*                                                                  0249
         L     @08,TEMPPTR                                         0249
         SL    @08,@CF00173                                        0249
         ST    @08,TEMPPTR                                         0249
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF USER SPECIFIED A RETURN CODE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0250
*        IF LISTLN = 3                                             0250
*          THEN                                                    0250
         C     LISTLN,@CF00156                                     0250
         BNE   @RF00250                                            0250
*            SETRC = RCODE;                                        0251
         LH    SETRC,RCODE(,RCODEPR)                               0251
*          ELSE                                                    0252
*            SETRC = 0;                                            0252
*                                                                  0252
         B     @RC00250                                            0252
@RF00250 SLR   SETRC,SETRC                                         0252
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF MODULE ID IS CONTAINED IN           @YL026UK*/
*        /* STORAGE TABLE                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0253
*        DOCNTRL = ON;                                             0253
@RC00250 OI    DOCNTRL,B'10000000'                                 0253
*EPDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);      /*@Y30LSMK*/
*                                                                  0254
EPDO     LA    I,1                                                 0254
@DL00254 TM    DOCNTRL,B'10000000'                                 0254
         BNO   @DC00254                                            0254
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF MODULE ID MATCHES ID IN           @YL026UK*/
*          /* STORAGE TABLE                                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0255
*          IF AREAID(I) = MODID                                    0255
*            THEN                                                  0255
         LR    @08,I                                               0255
         MH    @08,@CH00032                                        0255
         L     @05,GDTSAH(,GDTPR)                                  0255
         L     @05,AUTOPTR(,@05)                                   0255
         ALR   @05,@08                                             0255
         AL    @05,@CF00712                                        0255
         CLC   AREAID(4,@05),MODID(MODIDPR)                        0255
         BNE   @RF00255                                            0255
*              DOCNTRL = OFF;                                      0256
         NI    DOCNTRL,B'01111111'                                 0256
*        END EPDO;                                                 0257
*                                                                  0257
@RF00255 AL    I,@CF00213                                          0257
         C     I,@CF00635                                          0257
         BNH   @DL00254                                            0257
@DC00254 DS    0H                                                  0258
*        /************************************************************/
*        /*                                                          */
*        /* RELEASE USER'S AUTOMATIC STORAGE AREA                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0258
*        IF DOCNTRL = ON                                           0258
*          THEN                                                    0258
*                                                                  0258
         TM    DOCNTRL,B'10000000'                                 0258
         BNO   @RF00258                                            0258
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS NOT CONTAINED IN                @YL026UK*/
*            /* STORAGE TABLE                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0259
*            DO;                                                   0259
*              RESPECIFY (REG0,REG1) RSTD;                         0260
*              REG0 = AUTOSIZE;                                    0261
         L     @08,TEMPPTR                                         0261
         ICM   REG0,15,AUTOSIZE(@08)                               0261
*              REG1 = TEMPPTR;                                     0262
         LR    REG1,@08                                            0262
*LFREM1:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));                 0263
LFREM1   FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;                       0264
*            END;                                                  0265
*          ELSE                                                    0266
*                                                                  0266
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS CONTAINED IN STORAGE            @YL026UK*/
*            /* TABLE SO USE THIS TABLE FOR RELEASE REQUEST          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0266
*            DO;                                                   0266
         B     @RC00258                                            0266
@RF00258 DS    0H                                                  0267
*              I = I - 1;                                          0267
*                                                                  0267
         BCTR  I,0                                                 0267
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF STATUS IS GREATER THAT ONE, INDICATING    */
*              /* THAT IT IS NOT THE FROZEN AREA TO BE RELEASED      */
*              /*                                                    */
*              /******************************************************/
*                                                                  0268
*              IF STATUS(I) > 1                                    0268
*                THEN                                              0268
*                                                                  0268
         LR    @08,I                                               0268
         MH    @08,@CH00032                                        0268
         L     @05,GDTSAH(,GDTPR)                                  0268
         L     @05,AUTOPTR(,@05)                                   0268
         ALR   @05,@08                                             0268
         AL    @05,@CF00714                                        0268
         ICM   @08,12,STATUS-4(@05)                                0268
         SRA   @08,16                                              0268
         C     @08,@CF00213                                        0268
         BNH   @RF00268                                            0268
*                  /**************************************************/
*                  /*                                                */
*                  /* IS NOT A FROZEN AREA SO FREE IT                */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0269
*                  DO;                                             0269
*                    RESPECIFY (REG0,REG1) RSTD;                   0270
*                    REG0 = AUTOSIZE;                              0271
         L     @08,TEMPPTR                                         0271
         ICM   REG0,15,AUTOSIZE(@08)                               0271
*                    REG1 = TEMPPTR;                               0272
         LR    REG1,@08                                            0272
*LFREM2:             GEN(FREEMAIN R,LV=(REG0),A=(REG1));           0273
LFREM2   FREEMAIN R,LV=(REG0),A=(REG1)
*                    RESPECIFY (REG0,REG1) UNRSTD;                 0274
*                  END;                                            0275
*                                                                  0275
*              /******************************************************/
*              /*                                                    */
*              /* DECREMENT STATUS BY 1                              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0276
*              STATUS(I) = STATUS(I) - 1;                          0276
@RF00268 LR    @08,I                                               0276
         MH    @08,@CH00032                                        0276
         L     @05,GDTSAH(,GDTPR)                                  0276
         L     @05,AUTOPTR(,@05)                                   0276
         ST    @08,@TF00001                                        0276
         ALR   @08,@05                                             0276
         AL    @08,@CF00714                                        0276
         ICM   @08,12,STATUS-4(@08)                                0276
         SRA   @08,16                                              0276
         BCTR  @08,0                                               0276
         AL    @05,@TF00001                                        0276
         AL    @05,@CF00714                                        0276
         STCM  @08,3,STATUS-4(@05)                                 0276
*            END;                                                  0277
*                                                                  0277
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /*  IF MODULE IS  ONE OF THE CSECTS OF THE MAIN LOAD        */
*        /*  MODULE IDCAMS (CAN TELL FROM THE MODID) THAT RECIEVES   */
*        /*  CONTROL MANY TIMES DURING AN EXECUTION THEN DONT LOOK   /*
*        /*  FOR IT IN LLBLK BECAUSE ITS NOT THERE SAVE TIME         /*
*        /*  SEARCHING BLOCKS.DB01 IS IN LIST BECAUSE IT IS  @Z40GSBF*/
*        /*  LOADED AND SHOULD NOT BE DELETED TILL AMS       @Z40GSBF*/
*        /*  IS COMPLETED (IT CONTAINS UDUMP ROUTINE)        @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                                  0278
*        IF MODID ^= 'SA02' & MODID ^= 'DB01' & MODID ^= 'SA03' &  0278
*           MODID ^= 'EX01' & MODID ^= 'TP01' & MODID ^= 'IO01'    0278
*                                                          /*@Z40GSBF*/
*          THEN                                            /*@Z40GSBF*/
@RC00258 CLC   MODID(4,MODIDPR),@CC00683                           0278
         BE    @RF00278                                            0278
         CLC   MODID(4,MODIDPR),@CC00684                           0278
         BE    @RF00278                                            0278
         CLC   MODID(4,MODIDPR),@CC00609                           0278
         BE    @RF00278                                            0278
         CLC   MODID(4,MODIDPR),@CC00685                           0278
         BE    @RF00278                                            0278
         CLC   MODID(4,MODIDPR),@CC00686                           0278
         BE    @RF00278                                            0278
         CLC   MODID(4,MODIDPR),@CC00687                           0278
         BE    @RF00278                                            0278
*            DO;                                           /*@Z40GSBF*/
*                                                                  0279
*              /******************************************************/
*              /*                                            @Z40GSBF*/
*              /*  BUILD MODULE NAME FOR SEARCH LLBLK RTN    @Z40GSBF*/
*              /*                                            @Z40GSBF*/
*              /******************************************************/
*                                                                  0280
*              TEMPEPN(1:8) = 'IDC     ';                  /*@Z40GSBF*/
         MVC   TEMPEPN(8),@CC00688                                 0280
*              TEMPEPN(4:7) = MODID(1:4);                  /*@Z40GSBF*/
*                                                                  0281
         MVC   TEMPEPN+3(4),MODID(MODIDPR)                         0281
*              /******************************************************/
*              /*                                            @Z40GSBF*/
*              /*  SEARCH LLBLK RTN WILL SEARCH LLBLK(S)     @Z40GSBF*/
*              /*  FOR MATCH OF NAME AND REDUCE USE CTR      @Z40GSBF*/
*              /*  BY ONE                                    @Z40GSBF*/
*              /*                                            @Z40GSBF*/
*              /******************************************************/
*                                                                  0282
*              IX = 0;                                     /*@Z40GSBF*/
         SLR   IX,IX                                               0282
*              CONTROL = OFF;                              /*@Z40GSBF*/
         NI    CONTROL,B'01111111'                                 0283
*              NAMEFND = OFF;                              /*@Z40GSBF*/
*                                                                  0284
         NI    NAMEFND,B'01111111'                                 0284
*              DO WHILE CONTROL = OFF;                     /*@Z40GSBF*/
         B     @DE00285                                            0285
@DL00285 DS    0H                                                  0286
*                IF IX = 0                                 /*@Z40GSBF*/
*                                                                  0286
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*    FIRST TIME USE POINTER IN SYSTEM      @Z40GSBF*/
*                /*    HIST SAVE AREA TO LOAD LIST BLOCK     @Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /****************************************************/
*                                                                  0286
*                  THEN                                    /*@Z40GSBF*/
         LTR   IX,IX                                               0286
         BNZ   @RF00286                                            0286
*                    P = LLBLKPTR;                         /*@Z40GSBF*/
         L     @06,GDTSAH(,GDTPR)                                  0287
         L     P,LLBLKPTR(,@06)                                    0287
*                  ELSE;                                   /*@Z40GSBF*/
@RF00286 DS    0H                                                  0289
*                DO IX = 1 TO LLSLTCNT BY 1 WHILE CONTROL = OFF;   0289
         LA    IX,1                                                0289
@DL00289 TM    CONTROL,B'10000000'                                 0289
         BNZ   @DC00289                                            0289
*                                                          /*@Z40GSBF*/
*                                                                  0290
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*    LOOK FOR MATCH OF NAME IN LLBLK       @Z40GSBF*/
*                /*    WHEN FOUND REDUCE USE CTR BY ONE      @Z40GSBF*/
*                /*  UNLESS IT IS ZERO.THIS SHOULD NOT BE.   @Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /****************************************************/
*                                                                  0290
*                  IF TEMPEPN = LLNAME(IX)                 /*@Z40GSBF*/
*                    THEN                                  /*@Z40GSBF*/
         LR    @08,IX                                              0290
         SLA   @08,4                                               0290
         ST    @08,@TF00001                                        0290
         ALR   @08,P                                               0290
         AL    @08,@CF00714                                        0290
         CLC   TEMPEPN(8),LLNAME-8(@08)                            0290
         BNE   @RF00290                                            0290
*                      DO;                                 /*@Z40GSBF*/
*                        CONTROL = ON;                     /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 0292
*                        NAMEFND = ON;                     /*@Z40GSBF*/
         OI    NAMEFND,B'10000000'                                 0293
*                          IF LLUSECTR(IX) = 0             /*@Z40GSBF*/
*                            THEN                          /*@Z40GSBF*/
         L     @08,@TF00001                                        0294
         SLR   @06,@06                                             0294
         IC    @06,LLUSECTR-16(@08,P)                              0294
         C     @06,@CF00109                                        0294
         BNE   @RF00294                                            0294
*                              NAMEFND = OFF;              /*@Z40GSBF*/
         NI    NAMEFND,B'01111111'                                 0295
*                            ELSE                          /*@Z40GSBF*/
*                              LLUSECTR(IX) = LLUSECTR(IX)-1;      0296
         B     @RC00294                                            0296
@RF00294 LR    @08,IX                                              0296
         SLA   @08,4                                               0296
         SLR   @06,@06                                             0296
         IC    @06,LLUSECTR-16(@08,P)                              0296
         BCTR  @06,0                                               0296
         STC   @06,LLUSECTR-16(@08,P)                              0296
*                                                          /*@Z40GSBF*/
*                      END;                                /*@Z40GSBF*/
*                    ELSE;                                 /*@Z40GSBF*/
@RF00290 DS    0H                                                  0299
*                END;                                      /*@Z40GSBF*/
*                                                                  0299
@RC00290 AL    IX,@CF00213                                         0299
         C     IX,@CF00302                                         0299
         BNH   @DL00289                                            0299
@DC00289 DS    0H                                                  0300
*                IF LLNXTBLK = 0                           /*@Z40GSBF*/
*                                                                  0300
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*  WHEN ZERO THIS IS LAST LLBLK            @Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /****************************************************/
*                                                                  0300
*                  THEN                                    /*@Z40GSBF*/
         L     @08,LLNXTBLK(,P)                                    0300
         LTR   @08,@08                                             0300
         BNZ   @RF00300                                            0300
*                    CONTROL = ON;                         /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 0301
*                  ELSE                                    /*@Z40GSBF*/
*                    P = LLNXTBLK;                         /*@Z40GSBF*/
         B     @RC00300                                            0302
@RF00300 L     P,LLNXTBLK(,P)                                      0302
*              END;                                        /*@Z40GSBF*/
@RC00300 DS    0H                                                  0303
@DE00285 TM    CONTROL,B'10000000'                                 0303
         BZ    @DL00285                                            0303
*            END;                                          /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE SAVE AREA POINTER TO SAVE AREA USER SAVED IN,    */
*        /* UPDATE INTER MODULE TRACE TABLE WITH MODULE ID OF MODULE */
*        /* TO BE RETURNED TO (FOUND IN THE FIRST 4 BYTES OF THE SAVE*/
*        /* AREA SAVED IN BY THE MODULE TO BE RETURNED TO)           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0305
*        OLDERID1 = NEWERID1;                                      0305
@RF00278 L     @06,GDTTR1(,GDTPR)                                  0305
         MVC   @TS00001(95),NEWERID1(@06)                          0305
         MVC   OLDERID1(95,@06),@TS00001                           0305
*        RESPECIFY (REG13) RSTD;                                   0306
*        REG13 = RTNSAVE;                                          0307
         LR    REG13,RTNSAVE                                       0307
*        GEN(L     REG13,4(REG13));                                0308
         L     REG13,4(REG13)
*        GEN(MVC   TEMPID(4),0(REG13));                            0309
         MVC   TEMPID(4),0(REG13)
*        GEN(L     REG13,8(REG13));                                0310
         L     REG13,8(REG13)
*        NEWID1 = TEMPID;                                          0311
*                                                                  0311
         L     @10,GDTTR1(,GDTPR)                                  0311
         MVC   NEWID1(4,@10),TEMPID                                0311
*        /************************************************************/
*        /*                                                          */
*        /* THE UEPIL ROUTINE AUTOMATIC STORAGE DOESN'T NEED TO BE   */
*        /* RELEASED AS IT IS USED OVER AGAIN--PLACE USER RETURN CODE*/
*        /* IN REGISTER 15, RESTORE REGISTERS FOR MODULE TO BE       */
*        /* RETURNED TO (EXCLUDING REGISTER 15), AND BRANCH          */
*        /* ON REGISTER 14 (RETURN TO THE MODULE THAT CALLED THE USER*/
*        /* OF THE UEPIL ROUTINE)                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0312
*        RESPECIFY (REG14,REG15) RSTD;                             0312
*        REG15 = SETRC;                                            0313
         LR    REG15,SETRC                                         0313
*        GEN(L     REG14,12(REG13));                               0314
         L     REG14,12(REG13)
*        GEN(LM    REG0,REG12,20(REG13));                          0315
         LM    REG0,REG12,20(REG13)
*        GEN(BR    REG14);                                         0316
         BR    REG14
*        RESPECIFY (REG13,REG14,REG15) UNRSTD;                     0317
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - GETCORE                                */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE GETS THE REQUESTED CORE AND   */
*        /*             PASSES BACK THE ADDRESS OF THIS CORE         */
*        /*                                                          */
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF THE    */
*        /*          SIZE ARGUMENT AND THE ADDRESS OF A VARIABLE TO  */
*        /*          CONTAIN THE ADDRESS OF THE ACQUIRED CORE        */
*        /*                                                          */
*        /*  OUTPUT - THE ADDRESS OF THE ACQUIRED CORE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0318
*GETCORE:  PROCEDURE(ZSIZE,ZPTR);                                  0318
*                                                                  0318
         B     @PB00002                                            0318
GETCORE  STM   @14,@08,@SA00002                                    0318
         STM   @10,@12,@SA00002+44                                 0318
         MVC   @PC00002(8),0(@01)                                  0318
*        DCL ZSIZE FIXED(31);          /* SIZE OF REQUESTED AREA     */
*                                                                  0319
*        DCL ZPTR PTR(31);             /* VARIABLE TO CONTAIN THE    */
*                                      /* ACQUIRED CORE ADDRESS      */
*                                                                  0321
*        /* GETMAIN MACRO LIST                                       */
*        DCL 1 GETLIST CHAR(10) BDY(WORD),                         0321
*              2 GETSZ FIXED(31),      /* GETMAIN SIZE               */
*              2 GETPT PTR(31),        /* ADDRESS OF AREA WHERE ADDR */
*                                      /* OF GOTTEN CORE IS TO BE PUT*/
*              2 GETFLG CHAR(2);       /* GETMAIN FLAGS              */
*                                                                  0321
*        DCL LIST1 GENERATED LABEL;    /* GETMAIN MACRO LIST LABEL   */
*                                                                  0322
*        DCL GETGEN CHAR(10) DEFINED(LIST1);                       0323
*                                      /* GENERATED LIST FORM OF     */
*                                      /* GETMAIN MACRO              */
*                                                                  0324
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0324
*        GETLIST = GETGEN;                                         0324
         MVC   GETLIST(10),GETGEN                                  0324
*        GETSZ = ZSIZE;                                            0325
         L     @10,@PC00002                                        0325
         L     @10,ZSIZE(,@10)                                     0325
         ST    @10,GETSZ                                           0325
*        GETPT = ADDR(ZPTR);                                       0326
         L     @10,@PC00002+4                                      0326
         ST    @10,GETPT                                           0326
*        RESPECIFY (REG1) RSTD;                                    0327
*        REG1 = ADDR(GETLIST);                                     0328
         LA    REG1,GETLIST                                        0328
*LGETM1: GEN(GETMAIN MF=(E,(REG1)));                               0329
LGETM1   GETMAIN MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                                  0330
*                                                                  0330
*        /************************************************************/
*        /*                                                          */
*        /* CHECK RETURN CODE FROM CORE REQUEST                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0331
*        RESPECIFY (RTNREG) RSTD;                                  0331
*        IF RTNREG ^= 0                                    /*@Z40GSBF*/
*          THEN                                            /*@Z40GSBF*/
         LTR   RTNREG,RTNREG                                       0332
         BZ    @RF00332                                            0332
*DELMOD:     DO;                                           /*@Z40GSBF*/
*                                                                  0333
DELMOD   DS    0H                                                  0334
*            /********************************************************/
*            /*                                              @Z40GSBF*/
*            /*  CORE IS NEEDED AND NOT AVAILABLE            @Z40GSBF*/
*            /*  FREE MODULES NOT IN USE (USE CTR WILL BE    @Z40GSBF*/
*            /*  ZERO) THEN TRY ONE MORE GETCORE             @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /********************************************************/
*                                                                  0334
*              IX = 0;                                     /*@Z40GSBF*/
         SLR   IX,IX                                               0334
*              CONTROL = OFF;                              /*@Z40GSBF*/
         NI    CONTROL,B'01111111'                                 0335
*                DO WHILE CONTROL = OFF;                   /*@Z40GSBF*/
*                                                                  0336
         B     @DE00336                                            0336
@DL00336 DS    0H                                                  0337
*                  IF IX = 0                               /*@Z40GSBF*/
*                    THEN                                  /*@Z40GSBF*/
         LTR   IX,IX                                               0337
         BNZ   @RF00337                                            0337
*                                                          /*@Z40GSBF*/
*                      /**********************************************/
*                      /*                                    @Z40GSBF*/
*                      /*   FIRST TIME USE POINTER IN        @Z40GSBF*/
*                      /*   SYSTEM HIST AREA TO LOAD         @Z40GSBF*/
*                      /*   LIST BLOCK                       @Z40GSBF*/
*                      /*                                    @Z40GSBF*/
*                      /**********************************************/
*                                                                  0338
*                      P = LLBLKPTR;                       /*@Z40GSBF*/
         L     @14,GDTSAH(,GDTPR)                                  0338
         L     P,LLBLKPTR(,@14)                                    0338
*                    ELSE;                                 /*@Z40GSBF*/
*                                                                  0339
@RF00337 DS    0H                                                  0340
*                  /*****************************************@Z40GSBF*/
*                  /*                                        @Z40GSBF*/
*                  /*  SEARCH EACH LOAD LIST BLOCK WHEN      @Z40GSBF*/
*                  /*  MODULE NAME IS IN SLOT AND  USE CTR   @Z40GSBF*/
*                  /*  IS ZERO THEN DELETE MODULE FROM CORE  @Z40GSBF*/
*                  /*                                        @Z40GSBF*/
*                  /*****************************************@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                  DO IX = 1 TO LLSLTCNT;                  /*@Z40GSBF*/
         LA    IX,1                                                0340
@DL00340 DS    0H                                                  0341
*                    IF LLNOMOD(IX) = 0  LLUSECTR(IX) ^= 0        0341
*                                                          /*@Z40GSBF*/
*                      THEN;                               /*@Z40GSBF*/
         SLR   @14,@14                                             0341
         LR    @10,IX                                              0341
         SLA   @10,4                                               0341
         ST    @10,@TF00001                                        0341
         ALR   @10,P                                               0341
         AL    @10,@CF00715                                        0341
         ICM   @08,15,LLNOMOD-12(@10)                              0341
         CR    @14,@08                                             0341
         BE    @RT00341                                            0341
         L     @10,@TF00001                                        0341
         SLR   @08,@08                                             0341
         IC    @08,LLUSECTR-16(@10,P)                              0341
         CR    @14,@08                                             0341
         BNE   @RT00341                                            0341
*                      ELSE                                /*@Z40GSBF*/
*                        DO;                               /*@Z40GSBF*/
*                          RFY REG0 RSTD;                  /*@Z40GSBF*/
*                          REG0 = ADDR(LLNAME(IX));        /*@Z40GSBF*/
         LR    @14,IX                                              0345
         SLA   @14,4                                               0345
         AL    @14,@CF00714                                        0345
         LA    REG0,LLNAME-8(@14,P)                                0345
*LDEL1:                    GEN(DELETE  EPLOC=(REG0));      /*@Z40GSBF*/
LDEL1    DELETE  EPLOC=(REG0)
*                          RFY REG0 UNRSTD;                /*@Z40GSBF*/
*                          LLNOMOD(IX) = 0;                /*@Z40GSBF*/
         LR    @14,IX                                              0348
         SLA   @14,4                                               0348
         SLR   @10,@10                                             0348
         ST    @14,@TF00001                                        0348
         ALR   @14,P                                               0348
         AL    @14,@CF00715                                        0348
         STCM  @10,15,LLNOMOD-12(@14)                              0348
*                          LLNXTSLT(IX) = LLFSTSLT;        /*@Z40GSBF*/
         L     @14,LLFSTSLT(,P)                                    0349
         LR    @10,P                                               0349
         AL    @10,@TF00001                                        0349
         AL    @10,@CF00714                                        0349
         STCM  @14,15,LLNXTSLT-8(@10)                              0349
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));  /*@Z40GSBF*/
         L     @14,@TF00001                                        0350
         AL    @14,@CF00714                                        0350
         LA    @14,LLNXTSLT-8(@14,P)                               0350
         ST    @14,LLFSTSLT(,P)                                    0350
*                        END;                              /*@Z40GSBF*/
*                  END;                                    /*@Z40GSBF*/
@RT00341 AL    IX,@CF00213                                         0352
         C     IX,@CF00302                                         0352
         BNH   @DL00340                                            0352
*                  IF LLNXTBLK = 0                         /*@Z40GSBF*/
*                    THEN                                  /*@Z40GSBF*/
         L     @14,LLNXTBLK(,P)                                    0353
         LTR   @14,@14                                             0353
         BNZ   @RF00353                                            0353
*                      CONTROL = ON;                       /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 0354
*                    ELSE                                  /*@Z40GSBF*/
*                      P = LLNXTBLK;                       /*@Z40GSBF*/
         B     @RC00353                                            0355
@RF00353 L     P,LLNXTBLK(,P)                                      0355
*                END;                                      /*@Z40GSBF*/
@RC00353 DS    0H                                                  0356
@DE00336 TM    CONTROL,B'10000000'                                 0356
         BZ    @DL00336                                            0356
*               /********************************************@Z40GSBF*/
*               /*                                           @Z40GSBF*/
*               /*  TRY TO GET CORE AGAIN NOW THAT           @Z40GSBF*/
*               /*  SOME MODULES HAVE BEEN DELETED           @Z40GSBF*/
*               /*                                           @Z40GSBF*/
*               /********************************************@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*               RESPECIFY (REG1) RSTD;                     /*@Z40GSBF*/
*               REG1 = ADDR(GETLIST);                      /*@Z40GSBF*/
         LA    REG1,GETLIST                                        0358
*LGETM1X:       GEN(GETMAIN MF=(E,(REG1)));                /*@Z40GSBF*/
LGETM1X  GETMAIN MF=(E,(REG1))
*               RESPECIFY (REG1) UNRSTD;                   /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                 /******************************************@Z40GSBF*/
*                 /*                                         @Z40GSBF*/
*                 /* CHECK RETURN CODE FROM GET CORE REQUEST @Z40GSBF*/
*                 /*                                         @Z40GSBF*/
*                 /******************************************@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                 IF RTNREG ^= 0                           /*@Z40GSBF*/
*                   THEN                                   /*@Z40GSBF*/
*                                                                  0361
         LTR   RTNREG,RTNREG                                       0361
         BZ    @RF00361                                            0361
*                     DO;                                          0362
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         0363
*                       REG15 = NOSPACE;                           0364
         LA    REG15,28                                            0364
*                       REG14 = GDTABT;                            0365
         L     REG14,GDTABT(,GDTPR)                                0365
*                       REG13 = GDTABH;                            0366
         L     REG13,GDTABH(,GDTPR)                                0366
*                       GEN(BR    REG14);                          0367
         BR    REG14
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        0368
*                     END;                     /*@Z40GSBF*/        0369
*                   ELSE;                                  /*@Z40GSBF*/
@RF00361 DS    0H                                                  0371
*            END DELMOD;                                   /*@Z40GSBF*/
*          ELSE;                                           /*@Z40GSBF*/
@RF00332 DS    0H                                                  0373
*        RESPECIFY (RTNREG) UNRSTD;                                0373
*                                                                  0373
*        END GETCORE;                                              0374
@EL00002 DS    0H                                                  0374
@EF00002 DS    0H                                                  0374
@ER00002 LM    @14,@08,@SA00002                                    0374
         LM    @10,@12,@SA00002+44                                 0374
         BR    @14                                                 0374
@PB00002 DS    0H                                                  0375
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF GETMAIN MACRO - MOVED INTO A DYNAMIC AREA   */
*        /* FOR USE                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0375
*        GENERATE DATA;                                            0375
*                                                                  0375
*        /************************************************************/
*        /*                                                          */
*        /* DECLARATIONS ALLOWING MODULE IDCSA01 ACCESS TO THIS      */
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0376
*        GENERATE DATA;                                            0376
*        RESPECIFY (REG2,REG3,REG4) UNRSTD;                        0377
*        END IDCSA03                                               0378
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF09 )                                        *
*;                                                                 0378
@EL00001 L     @13,4(,@13)                                         0378
@EF00001 L     @00,@SIZDATD                                        0378
         LR    @01,@11                                             0378
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0378
         BR    @14                                                 0378
@DATA    DS    0H
@CH00032 DC    H'12'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00002 DS    14F
@PC00002 DS    2F
@AL00001 DS    2A
@TF00001 DS    F
IDCSA03  CSECT
         DS    0F
@CF00109 DC    F'0'
@CF00213 DC    F'1'
@CF00156 DC    F'3'
@CF00036 DC    F'4'
@CF00173 DC    F'8'
@CF00635 DC    F'9'
@CF00302 DC    F'24'
@CF00676 DC    F'255'
@CF00712 DC    F'-12'
@CF00714 DC    F'-8'
@CF00715 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
TEMPSIZE DS    F
TEMPPTR  DS    A
DELPARM  DS    F
LISTPTR  DS    A
TESTRC   DS    H
@TS00001 DS    CL95
DOCNTRL  DS    BL1
TEMPEPN  DS    CL8
TEMPID   DS    CL4
NAMEFND  DS    BL1
CONTROL  DS    BL1
GETLIST  DS    CL10
         ORG   GETLIST
GETSZ    DS    FL4
GETPT    DS    AL4
GETFLG   DS    CL2
         ORG   GETLIST+10
         DS    CL2
PROLSAV  DS    CL44
IDCSA03  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00688 DC    C'IDC     '
@CC00609 DC    C'SA03'
@CC00683 DC    C'SA02'
@CC00684 DC    C'DB01'
@CC00685 DC    C'EX01'
@CC00686 DC    C'TP01'
@CC00687 DC    C'IO01'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
FIXAREA  DS    CL100
         ORG   FIXAREA
@NM00033 DC    100X'00'
         ORG   FIXAREA+100
IDENT    DC    CL4'SA03'
@DATD    DSECT
IDCSA03 CSECT
LIST1   GETMAIN EC,LV=8,A=LIST1,MF=L
@DATD    DSECT
IDCSA03 CSECT
IDCSAS3 DC    A(@SIZDATD)
        ENTRY IDCSAS3
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSA03  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
IX       EQU   @05
P        EQU   @09
I        EQU   @06
RTNADDR  EQU   @10
RTNSAVE  EQU   @10
SETRC    EQU   @07
LISTLN   EQU   @05
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
GDTPR    EQU   @02
MODIDPR  EQU   @03
SIZEPR   EQU   @04
RCODEPR  EQU   @04
SAVEPTR  EQU   @13
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTSAH   EQU   GDTTBL+32
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTSPR   EQU   GDTTBL+168
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
NEWID1   EQU   TRACE1+95
NEWERID1 EQU   5
TRACE2   EQU   0
LISTTEST EQU   0
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
DMPITM   EQU   0
DMPARY   EQU   0
MODID    EQU   0
PSIZE    EQU   0
RCODE    EQU   0
@NM00034 EQU   0
AUTOSIZE EQU   @NM00034
AUTOID   EQU   @NM00034+4
SAVEFWD  EQU   0
LLBLK    EQU   0
LLHDR    EQU   LLBLK
LLFSTSLT EQU   LLHDR
LLNXTBLK EQU   LLHDR+4
LLSLOT   EQU   LLBLK+8
LLNAME   EQU   LLSLOT
LLNXTSLT EQU   LLNAME
LLNOMOD  EQU   LLNAME+4
LLUSECTR EQU   LLSLOT+12
SAHIST   EQU   0
AUTOPTR  EQU   SAHIST+8
LLBLKPTR EQU   SAHIST+16
AUTOTBL  EQU   0
AUTOARAY EQU   AUTOTBL
AREAID   EQU   AUTOARAY
STATUS   EQU   AUTOARAY+4
PTR1     EQU   AUTOARAY+8
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCDB010 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAEP0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
NEWERID2 EQU   5
RESOLVE  EQU   0
MODIDX   EQU   0
PSIZEX   EQU   0
GDTTBLX  EQU   0
RCODEX   EQU   0
ZSIZE    EQU   0
ZPTR     EQU   0
GETGEN   EQU   LIST1
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ASIZE    EQU   AUTOARAY+6
SAHSTA   EQU   SAHIST+12
GPLAST   EQU   SAHIST+4
GPFIRST  EQU   SAHIST
LLMODSZ  EQU   LLSLOT+13
LLADDR   EQU   LLSLOT+8
@NM00032 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00031 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00030 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00029 EQU   ERCNVTAB+4
@NM00028 EQU   ERCNVTAB+3
@NM00027 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00026 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00025 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00024 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00023 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00022 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00021 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00020 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00019 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00018 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID2   EQU   TRACE2+95
OLDERID2 EQU   TRACE2
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00294 EQU   @RC00290
@ENDDATA EQU   *
         END   IDCSA03,(C'PLS2323',0701,76049)

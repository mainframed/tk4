         TITLE '**********  IDCSA02  SYSTEM ADAPTER SERVICE MODULE  ****
               ******** '
IDCSA02 CSECT
MAINENT DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(BEGIN-MAINENT)
        DC    C'IDCSA02 '
IDCSACL DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSACL1-IDCSACL)
        ENTRY IDCSACL
IDCSALD DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSALD1-IDCSALD)
        ENTRY IDCSALD
IDCSADE DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSADE1-IDCSADE)
        ENTRY IDCSADE
IDCSAGS DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAGS1-IDCSAGS)
        ENTRY IDCSAGS
IDCSAFS DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAFS1-IDCSAFS)
        ENTRY IDCSAFS
IDCSAGP DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAGP1-IDCSAGP)
        ENTRY IDCSAGP
IDCSAFP DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAFP1-IDCSAFP)
        ENTRY IDCSAFP
IDCSATI DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSATI1-IDCSATI)
        ENTRY IDCSATI
IDCSACA DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSACA1-IDCSACA)
        ENTRY IDCSACA
IDCSASN DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSASN1-IDCSASN)
        ENTRY IDCSASN
IDCSAPT DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAPT1-IDCSAPT)
        ENTRY IDCSAPT
IDCSAID DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAID1-IDCSAID)
        ENTRY IDCSAID
IDCSAQL DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAQL1-IDCSAQL)
        ENTRY IDCSAQL
IDCSAAL DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSAAL1-IDCSAAL)
        ENTRY IDCSAAL
IDCSADL DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSADL1-IDCSADL)
        ENTRY IDCSADL
IDCSACR DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSACR1-IDCSACR)
        ENTRY IDCSACR
IDCSALK DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(AMSSALK1-IDCSALK)
        ENTRY IDCSALK
        DROP  REG15
PROLOG  STM   REG14,REG12,12(REG13)
        BALR  REG9,0
PSTART  LA    REG10,4095(REG9)
        LA    REG12,4095(REG10)
        USING PSTART,REG9
        USING PSTART+4095,REG10
        USING PSTART+8190,REG12
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        LR    REG11,REG1
        USING @DATD,REG11
        LM    REG15,REG1,16(REG13)
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
        AH    REG15,4(REG15)
        BR    REG15
BEGIN   DS    0H
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UCALL ENTRY POINT                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0221
*AMSSACL:  ENTRY(GDTTBLX,CLNAMEX);                         /*@YL026UK*/
*                                                                  0221
@EC00221 DS    0H                                                  0222
*AMSSACL1:                                                         0222
*                                                                  0222
*        DCL CLNAME CHAR(8) BASED;     /* ENTRY POINT NAME FOR UCALL */
*                                                                  0222
AMSSACL1 DS    0H                                                  0223
*        RESPECIFY CLNAME BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE CLNAME        @YL026UK*/
*        DCL CLENTPT PTR(31);          /* ENTRY POINT CALLED RTN     */
*                                                          /*@Z40GSBF*/
*                                                                  0225
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0225
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0226
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0227
         ST    @00,PARMPTR2                                        0227
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0228
*        OLDERID2 = NEWERID2;                                      0229
         L     @01,GDTTR2(,GDTPR)                                  0229
         MVC   @TS00001(95),NEWERID2(@01)                          0229
         MVC   OLDERID2(95,@01),@TS00001                           0229
*        NEWID2 = 'SACL';                                  /*@YL026UK*/
*                                                                  0230
         MVC   NEWID2(4,@01),@CC01667                              0230
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /* ISSUE CALL TO FINDNAME RTN TO GET ENTRY POINT    @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                                  0231
*        TEMPEPN = CLNAME;                                 /*@YL026UK*/
         LR    @01,@00                                             0231
         MVC   TEMPEPN(8),CLNAME(@01)                              0231
*        RESPECIFY (REG0) RSTD;                            /*@YL026UK*/
*        CALL FINDNAME(TEMPEPN,CLENTPT);                   /*@Z40GSBF*/
         LA    @01,TEMPEPN                                         0233
         ST    @01,@AL00001                                        0233
         LA    @01,CLENTPT                                         0233
         ST    @01,@AL00001+4                                      0233
         LA    @01,@AL00001                                        0233
         BAL   @14,FINDNAME                                        0233
*        REG0 = CLENTPT;                                   /*@Z40GSBF*/
*                                                                  0234
         L     REG0,CLENTPT                                        0234
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* TEMPORARILY STORE THE ADDRESS OF THE ENTRY POINT TO BE   */
*        /* BRANCHED TO (CONTAINED IN REGISTER 0) INTO REGISTER 2,   */
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 7, AND CHECK*/
*        /* WHETHER OR NOT THIS MODULE'S AUTOMATIC STORAGE AREA IS TO*/
*        /* BE FREED--NOTE DEPENDENCY ON SA01 INITIALIZING TABLE     */
*        /* AUTOTBL WITH SA02 AS THE SECOND ENTRY            @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0235
*        RESPECIFY (REG2,REG7,REG13) RSTD;                 /*@YL026UK*/
*        REG2 = REG0;                                      /*@YL026UK*/
         LR    REG2,REG0                                           0236
*        GEN(L     REG7,4(REG13));                         /*@YL026UK*/
         L     REG7,4(REG13)
*        STATUS(2) = STATUS(2) - 1;                        /*@YL026UK*/
*                                                                  0238
         L     @01,GDTSAH(,GDTPR)                                  0238
         L     @06,AUTOPTR(,@01)                                   0238
         ICM   @03,12,STATUS+12(@06)                               0238
         SRA   @03,16                                              0238
         BCTR  @03,0                                               0238
         STCM  @03,3,STATUS+12(@06)                                0238
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK IF STATUS IS GREATER THAN ZERO             @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0239
*        IF STATUS(2) > 0                                          0239
*          THEN                                                    0239
*                                                                  0239
         LTR   @03,@03                                             0239
         BNP   @RF00239                                            0239
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* FREE THE AREA                                @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0240
*            DO;                                           /*@YL026UK*/
*              RESPECIFY (REG1,REG11) RSTD;                /*@YL026UK*/
*              TEMPPTR = REG11 - 8;                        /*@YL026UK*/
         LR    @06,REG11                                           0242
         SL    @06,@CF00175                                        0242
         ST    @06,TEMPPTR                                         0242
*              RESPECIFY (REG11) UNRSTD;                   /*@YL026UK*/
*              REG0 = AUTOSIZE;                            /*@YL026UK*/
         ICM   REG0,15,AUTOSIZE(@06)                               0244
*              REG1 = TEMPPTR;                             /*@YL026UK*/
         LR    REG1,@06                                            0245
*LFREM7:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*@YL026UK*/
LFREM7   FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/
*            END;                                          /*@YL026UK*/
*                                                                  0248
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RESTORE OLD SAVEAREA POINTER,                    @YL026UK*/
*        /* LOAD THE ADDRESS OF THE ENTRY POINT TO BE BRANCHED TO    */
*        /* INTO REGISTER 15, AND RESTORE REGISTERS EXCLUDING        */
*        /* REGISTER 15 WHICH IS USED IN THE BRANCH          @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0249
*        REG13 = REG7;                                     /*@YL026UK*/
@RF00239 LR    REG13,REG7                                          0249
*        RESPECIFY (REG7) UNRSTD;                          /*@YL026UK*/
*        RESPECIFY (REG15) RSTD;                           /*@YL026UK*/
*        REG15 = REG2;                                     /*@YL026UK*/
         LR    REG15,REG2                                          0252
*        RESPECIFY (REG2) UNRSTD;                          /*@YL026UK*/
*        GEN(L     REG14,12(REG13));                       /*@YL026UK*/
         L     REG14,12(REG13)
*        GEN(LM    REG0,REG12,20(REG13));                  /*@YL026UK*/
         LM    REG0,REG12,20(REG13)
*        RESPECIFY (REG13) UNRSTD;                         /*@YL026UK*/
*                                                                  0256
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* PREPARE FOR LINKAGE BY ADJUSTING THE ADDRESS LIST FOR THE*/
*        /* PARAMETER LIST RECEIVED (ADDRESS OF MODULE NAME FOR      */
*        /* MODULE TO BE CALLED IS NO LONGER NEEDED) AND EXECUTE A   */
*        /* BRANCH ON REGISTER 15                            @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0257
*        RESPECIFY(REG1) RSTD;                             /*@YL026UK*/
*        GEN(MVC   4(4,REG1),0(REG1));                     /*@YL026UK*/
         MVC   4(4,REG1),0(REG1)
*        GEN(LA    REG1,4(REG1));                          /*@YL026UK*/
         LA    REG1,4(REG1)
*        GEN(BR    REG15);                                 /*@YL026UK*/
         BR    REG15
*        RESPECIFY(REG1,REG15) UNRSTD;                     /*@YL026UK*/
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* ULOAD ENTRY POINT                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0262
*AMSSALD:  ENTRY(GDTTBLX,LDMODX,LDPOINTX);                 /*@YL026UK*/
*                                                                  0262
@EC00262 DS    0H                                                  0263
*AMSSALD1:                                                         0263
*                                                                  0263
*        DCL LDMOD CHAR(8) BASED;      /* MODULE NAME FOR ULOAD      */
*                                                                  0263
AMSSALD1 DS    0H                                                  0264
*        DCL LDPOINT PTR(31) BASED;    /* MODULE ADDRESS FOR ULOAD   */
*                                                                  0264
*        RESPECIFY LDMOD BASED(PARMPTR2);                  /*@YL026UK*/
*                                      /* BASE LDMOD         @YL026UK*/
*                                                                  0266
*        RESPECIFY LDPOINT BASED(PARMPTR3);                /*@YL026UK*/
*                                      /* BASE LDPOINT       @YL026UK*/
*                                                                  0267
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0267
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0268
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0269
         ST    @00,PARMPTR2                                        0269
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @15,ADDR3+8(,REG1PTR)                               0270
         ST    @15,PARMPTR3                                        0270
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0271
*        OLDERID2 = NEWERID2;                                      0272
         L     @14,GDTTR2(,GDTPR)                                  0272
         MVC   @TS00001(95),NEWERID2(@14)                          0272
         MVC   OLDERID2(95,@14),@TS00001                           0272
*        NEWID2 = 'SALD';                                  /*@YL026UK*/
*                                                                  0273
         MVC   NEWID2(4,@14),@CC01686                              0273
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /*  ISSUE CALL TO FINDNAME RTN TO GET MODULE ENRTY POINT    */
*        /*  IF MODULE IS LOADED THEN ONLY UP USE COUNT BY ONE       */
*        /*  IF NOT IN LOAD LIST LOAD THE MODULE MAKE USE COUNT      */
*        /*  ONE AND RETURN ENTRY POINT EITHER CONDITION             */
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                                  0274
*        TEMPEPN = LDMOD;                                  /*@YL026UK*/
         LR    @01,@00                                             0274
         MVC   TEMPEPN(8),LDMOD(@01)                               0274
*        CALL FINDNAME(TEMPEPN,LDPOINT);                   /*@Z40GSBF*/
*                                                                  0275
         LA    @14,TEMPEPN                                         0275
         ST    @14,@AL00001                                        0275
         ST    @15,@AL00001+4                                      0275
         LA    @01,@AL00001                                        0275
         BAL   @14,FINDNAME                                        0275
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN CONTROL TO THE ULOAD CALLER               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0276
*        CALL IDCSAEP0(GDTTBL,MODID);                              0276
         ST    GDTPR,@AL00001                                      0276
         LA    @15,MODID                                           0276
         ST    @15,@AL00001+4                                      0276
         MVI   @AL00001+4,X'80'                                    0276
         L     @15,GDTEPL(,GDTPR)                                  0276
         LA    @01,@AL00001                                        0276
         BALR  @14,@15                                             0276
*         /*@YL026UK*/                                             0277
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UDELETE ENTRY POINT                              @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0277
*AMSSADE:  ENTRY(GDTTBLX,DEMODX);                          /*@YL026UK*/
*                                                                  0277
@EC00277 DS    0H                                                  0278
*AMSSADE1:                                                         0278
*                                                                  0278
*        DCL DEMOD CHAR(8) BASED;      /* MODULE NAME FOR UDELETE    */
*                                                                  0278
AMSSADE1 DS    0H                                                  0279
*        RESPECIFY DEMOD BASED(PARMPTR2);                  /*@YL026UK*/
*                                      /* BASE DEMOD         @YL026UK*/
*                                                                  0280
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0280
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0281
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0282
         ST    @00,PARMPTR2                                        0282
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0283
*        OLDERID2 = NEWERID2;                                      0284
         L     @15,GDTTR2(,GDTPR)                                  0284
         MVC   @TS00001(95),NEWERID2(@15)                          0284
         MVC   OLDERID2(95,@15),@TS00001                           0284
*        NEWID2 = 'SADE';                                  /*@YL026UK*/
*                                                                  0285
*                                                                  0285
         MVC   NEWID2(4,@15),@CC01698                              0285
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /*  UDELETE RTN NOW WILL SEARCH LLBLK(S)            @Z40GSBF*/
*        /*  FOR MATCH OF NAME AND REDUCE USE CTR BY ONE     @Z40GSBF*/
*        /*  UNLESS ITS ZERO ALREADY.THIS SHOULD NOT HAPPEN. @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                                  0286
*        IX = 0;                                           /*@Z40GSBF*/
         SLR   @15,@15                                             0286
         ST    @15,IX                                              0286
*        CONTROL = OFF;                                    /*@Z40GSBF*/
         NI    CONTROL,B'01111111'                                 0287
*        NAMEFND = OFF;                                    /*@Z40GSBF*/
         NI    NAMEFND,B'01111111'                                 0288
*        DO WHILE CONTROL = OFF;                           /*@Z40GSBF*/
         B     @DE00289                                            0289
@DL00289 DS    0H                                                  0290
*          IF IX = 0                                       /*@Z40GSBF*/
*                                                                  0290
*          /**********************************************************/
*          /*                                                @Z40GSBF*/
*          /*    FIRST TIME USE POINTER IN SYSTEM            @Z40GSBF*/
*          /*    HIST SAVE AREA TO LOAD LIST BLOCK           @Z40GSBF*/
*          /*                                                @Z40GSBF*/
*          /**********************************************************/
*                                                                  0290
*            THEN                                          /*@Z40GSBF*/
         L     @15,IX                                              0290
         LTR   @15,@15                                             0290
         BNZ   @RF00290                                            0290
*              P = LLBLKPTR;                               /*@Z40GSBF*/
         L     @01,GDTSAH(,GDTPR)                                  0291
         L     @15,LLBLKPTR(,@01)                                  0291
         ST    @15,P                                               0291
*            ELSE;                                         /*@Z40GSBF*/
*                                                                  0292
@RF00290 DS    0H                                                  0293
*          DO IX = 1 TO LLSLTCNT BY 1 WHILE CONTROL = OFF; /*@Z40GSBF*/
*                                                                  0293
         LA    @15,1                                               0293
         ST    @15,IX                                              0293
@DL00293 TM    CONTROL,B'10000000'                                 0293
         BNZ   @DC00293                                            0293
*          /**********************************************************/
*          /*                                                @Z40GSBF*/
*          /*  LOOK FOR MATCH OF NAME IN LLBLK               @Z40GSBF*/
*          /*  WHEN FOUND REDUCE USE CTR BY ONE              @Z40GSBF*/
*          /*                                                @Z40GSBF*/
*          /**********************************************************/
*                                                                  0294
*            IF DEMOD = LLNAME(IX)                         /*@Z40GSBF*/
*              THEN                                        /*@Z40GSBF*/
         L     @14,P                                               0294
         SLA   @15,4                                               0294
         L     @01,PARMPTR2                                        0294
         ST    @15,@TF00001                                        0294
         ALR   @15,@14                                             0294
         AL    @15,@CF02460                                        0294
         CLC   DEMOD(8,@01),LLNAME-8(@15)                          0294
         BNE   @RF00294                                            0294
*                DO;                                       /*@Z40GSBF*/
*                  CONTROL = ON;                           /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 0296
*                  NAMEFND = ON;                           /*@Z40GSBF*/
         OI    NAMEFND,B'10000000'                                 0297
*                    IF LLUSECTR(IX) = 0                   /*@Z40GSBF*/
*                      THEN                                /*@Z40GSBF*/
         L     @15,@TF00001                                        0298
         SLR   @07,@07                                             0298
         IC    @07,LLUSECTR-16(@15,@14)                            0298
         C     @07,@CF00111                                        0298
         BNE   @RF00298                                            0298
*                        NAMEFND = OFF;                    /*@Z40GSBF*/
         NI    NAMEFND,B'01111111'                                 0299
*                      ELSE                                /*@Z40GSBF*/
*                        LLUSECTR(IX) = LLUSECTR(IX)-1;    /*@Z40GSBF*/
         B     @RC00298                                            0300
@RF00298 L     @15,P                                               0300
         L     @14,IX                                              0300
         SLA   @14,4                                               0300
         SLR   @07,@07                                             0300
         IC    @07,LLUSECTR-16(@14,@15)                            0300
         BCTR  @07,0                                               0300
         STC   @07,LLUSECTR-16(@14,@15)                            0300
*                END;                                      /*@Z40GSBF*/
*              ELSE;                                       /*@Z40GSBF*/
@RF00294 DS    0H                                                  0303
*          END;                                            /*@Z40GSBF*/
@RC00294 LA    @15,1                                               0303
         AL    @15,IX                                              0303
         ST    @15,IX                                              0303
         C     @15,@CF00306                                        0303
         BNH   @DL00293                                            0303
@DC00293 DS    0H                                                  0304
*            IF LLNXTBLK = 0                               /*@Z40GSBF*/
*                                                                  0304
*            /********************************************************/
*            /*                                              @Z40GSBF*/
*            /*     WHEN ZERO THIS IS LAST LLBLK             @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /********************************************************/
*                                                                  0304
*              THEN                                        /*@Z40GSBF*/
         L     @01,P                                               0304
         L     @15,LLNXTBLK(,@01)                                  0304
         LTR   @15,@15                                             0304
         BNZ   @RF00304                                            0304
*                CONTROL = ON;                             /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 0305
*              ELSE                                        /*@Z40GSBF*/
*                P = LLNXTBLK;                             /*@Z40GSBF*/
         B     @RC00304                                            0306
@RF00304 L     @01,P                                               0306
         L     @15,LLNXTBLK(,@01)                                  0306
         ST    @15,P                                               0306
*        END;                                              /*@Z40GSBF*/
*                                                                  0307
@RC00304 DS    0H                                                  0307
@DE00289 TM    CONTROL,B'10000000'                                 0307
         BZ    @DL00289                                            0307
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /*   RETURN TO THE UDELETE CALLER                   @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0308
*        CALL IDCSAEP0(GDTTBL,MODID);                              0308
         ST    GDTPR,@AL00001                                      0308
         LA    @15,MODID                                           0308
         ST    @15,@AL00001+4                                      0308
         MVI   @AL00001+4,X'80'                                    0308
         L     @15,GDTEPL(,GDTPR)                                  0308
         LA    @01,@AL00001                                        0308
         BALR  @14,@15                                             0308
*         /*@YL026UK*/                                             0309
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UGSPACE ENTRY POINT                              @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0309
*AMSSAGS:  ENTRY(GDTTBLX,GSSIZEX,GSPOINTX,GSINITX,GSSPIDX);/*@Y30LSMK*/
*                                                                  0309
@EC00309 DS    0H                                                  0310
*AMSSAGS1:                                                         0310
*                                                                  0310
*        DCL GSSIZE FIXED(31) BASED;   /* SPACE SIZE FOR UGSPACE     */
*                                                                  0310
AMSSAGS1 DS    0H                                                  0311
*        DCL GSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */
*                                                                  0311
*        DCL GSINIT CHAR(4) BASED;     /* UGSPACE INIT ARGUMENT      */
*                                                                  0312
*        DCL GSSPID FIXED(8) BASED;    /* UGSPACE SUBPOOL ID @Y30LSMK*/
*                                                                  0313
*        RESPECIFY GSSIZE BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE GSSIZE        @YL026UK*/
*                                                                  0315
*        RESPECIFY GSPOINT BASED(PARMPTR3);                /*@YL026UK*/
*                                      /* BASE GSPOINT       @YL026UK*/
*                                                                  0316
*        RESPECIFY GSINIT BASED(PARMPTR4);                 /*@YL026UK*/
*                                      /* BASE GSINIT        @YL026UK*/
*                                                                  0317
*        RESPECIFY GSSPID BASED(PARMPTR5);                 /*@Y30LSMK*/
*                                      /* BASE GSSID         @Y30LSMK*/
*                                                                  0318
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0318
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0319
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0320
         ST    @00,PARMPTR2                                        0320
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0321
         ST    @00,PARMPTR3                                        0321
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/
         L     @00,ADDR4+12(,REG1PTR)                              0322
         ST    @00,PARMPTR4                                        0322
*        PARMPTR5 = ADDR5;                                 /*@Y30LSMK*/
         L     @00,ADDR5+16(,REG1PTR)                              0323
         ST    @00,PARMPTR5                                        0323
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0324
*                                                                  0324
*                                                                  0325
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0325
*        GEN;                                                      0325
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0326
         LA    @15,1                                               0326
         STC   @15,LISTLN                                          0326
@DL00326 L     @14,LISTSCAN                                        0326
         TM    LISTTEST(@14),B'10000000'                           0326
         BNZ   @DC00326                                            0326
*          LISTSCAN = LISTSCAN + 4;                                0327
         AL    @14,@CF00038                                        0327
         ST    @14,LISTSCAN                                        0327
*        END;                                                      0328
*                                                                  0328
         AL    @15,@CF00215                                        0328
         STC   @15,LISTLN                                          0328
         C     @15,@CF01724                                        0328
         BNH   @DL00326                                            0328
@DC00326 DS    0H                                                  0329
*        OLDERID2 = NEWERID2;                                      0329
         L     @15,GDTTR2(,GDTPR)                                  0329
         MVC   @TS00001(95),NEWERID2(@15)                          0329
         MVC   OLDERID2(95,@15),@TS00001                           0329
*        NEWID2 = 'SAGS';                                  /*@YL026UK*/
*                                                                  0330
         MVC   NEWID2(4,@15),@CC01725                              0330
*        RESPECIFY (REG4) RSTD;                            /*@YL026UK*/
*        REG4 = GSSIZE + 8;                                /*@YL026UK*/
*                                                                  0332
         LA    REG4,8                                              0332
         L     @05,PARMPTR2                                        0332
         AL    REG4,GSSIZE(,@05)                                   0332
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE PLUS CONTROL      */
*        /* INFORMATION AREA                                 @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0333
*        GETLIST = GETGEN;                                 /*@YL026UK*/
         MVC   GETLIST(10),GETGEN                                  0333
*        GETSZ = REG4;                                     /*@YL026UK*/
         ST    REG4,GETSZ                                          0334
*        GETPT = ADDR(TEMPPTR);                            /*@YL026UK*/
         LA    @05,TEMPPTR                                         0335
         ST    @05,GETPT                                           0335
*        IF LISTLN = 5                                             0336
*          THEN                                                    0336
*                                                                  0336
         CLI   LISTLN,5                                            0336
         BNE   @RF00336                                            0336
*            /********************************************************/
*            /*                                              @Y30LSMK*/
*            /* IF A SPECIFIC SUBPOOL WAS REQUESTED, INSERT THE      */
*            /* SUBPOOL ID IN THE GETMAIN PARAMETER LIST.    @Y30LSMK*/
*            /*                                              @Y30LSMK*/
*            /********************************************************/
*                                                                  0337
*              GETSP = GSSPID;                             /*@Y30LSMK*/
*                                                                  0337
         L     @05,PARMPTR5                                        0337
         IC    @15,GSSPID(,@05)                                    0337
         STC   @15,GETSP                                           0337
*        RESPECIFY (REG1) RSTD;                            /*#YL026UK*/
@RF00336 DS    0H                                                  0339
*        REG1 = ADDR(GETLIST);                             /*#YL026UK*/
         LA    REG1,GETLIST                                        0339
*LGETM3: GEN(GETMAIN MF=(E,(REG1)));                       /*#YL026UK*/
LGETM3   GETMAIN MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                          /*#YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    0342
*        TESTRC = RTNREG;                                          0343
         STH   RTNREG,TESTRC                                       0343
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/
*                                                                  0344
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK RETURN CODE FROM CORE REQUEST              #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0345
*        IF TESTRC ^= 0                                            0345
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /* IF NO CORE AVAILABLE FREE MODULES NOT IN USE     @Z40GSBF*/
*        /* AND TRY TO GETCORE AGAIN                         @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                                  0345
*          THEN                                                    0345
         LH    @05,TESTRC                                          0345
         LTR   @05,@05                                             0345
         BZ    @RF00345                                            0345
*            DO;                                           /*#YL026UK*/
*              CALL RELECORE;                              /*@Z40GSBF*/
         BAL   @14,RELECORE                                        0347
*              RESPECIFY (REG1) RSTD;                      /*@Z40GSBF*/
*              REG1 = ADDR(GETLIST);                       /*@Z40GSBF*/
         LA    REG1,GETLIST                                        0349
*LGETM3X:      GEN(GETMAIN MF=(E,(REG1)));                 /*@Z40GSBF*/
LGETM3X  GETMAIN MF=(E,(REG1))
*              RESPECIFY (REG1) UNRSTD;                    /*@Z40GSBF*/
*              RESPECIFY RTNREG RSTD;                              0352
*              TESTRC = RTNREG;                                    0353
         STH   RTNREG,TESTRC                                       0353
*              RESPECIFY RTNREG UNRSTD;                    /*@Z40GSBF*/
*                                                                  0354
*              /******************************************************/
*              /*                                            @Z40GSBF*/
*              /* CHECK RETURN CODE FROM CORE REQUEST        @Z40GSBF*/
*              /*                                            @Z40GSBF*/
*              /******************************************************/
*                                                                  0355
*              IF TESTRC ^= 0                              /*@Z40GSBF*/
*                THEN                                      /*@Z40GSBF*/
         LH    @05,TESTRC                                          0355
         SLR   @15,@15                                             0355
         CR    @05,@15                                             0355
         BE    @RF00355                                            0355
*                  DO;                                     /*@Z40GSBF*/
*                    SETRC = 4;                            /*@Z40GSBF*/
         MVC   SETRC(2),@CH00038                                   0357
*                    GSPOINT = 0;                          /*@Z40GSBF*/
         L     @05,PARMPTR3                                        0358
         ST    @15,GSPOINT(,@05)                                   0358
*                  END;                                    /*@Z40GSBF*/
*                ELSE                                      /*@Z40GSBF*/
*                  SETRC = 0;                              /*@Z40GSBF*/
         B     @RC00355                                            0360
@RF00355 SLR   @05,@05                                             0360
         STH   @05,SETRC                                           0360
*            END;                                          /*@Z40GSBF*/
*          ELSE                                            /*@Z40GSBF*/
*            SETRC = 0;                                    /*@Z40GSBF*/
         B     @RC00345                                            0362
@RF00345 SLR   @05,@05                                             0362
         STH   @05,SETRC                                           0362
*        IF SETRC = 0                                      /*@Z40GSBF*/
*          THEN                                            /*@Z40GSBF*/
@RC00345 LH    @05,SETRC                                           0363
         LTR   @05,@05                                             0363
         BNZ   @RF00363                                            0363
*            DO;                                           /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* INITIALIZE THE UGSPACE AREA CONTROL INFORMATION,   */
*              /* AND INITIALIZE THE UGSPACE AREA POINTER RETURNED   */
*              /* TO THE USER                                @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  0365
*              GSLEN = REG4;                               /*@YL026UK*/
         L     @05,TEMPPTR                                         0365
         ST    REG4,GSLEN(,@05)                                    0365
*              RESPECIFY (REG4) UNRSTD;                    /*@YL026UK*/
*              GSID = ' ';                                 /*@YL026UK*/
         MVI   GSID+1(@05),C' '                                    0367
         MVC   GSID+2(2,@05),GSID+1(@05)                           0367
         MVI   GSID(@05),C' '                                      0367
*              GSPOINT = TEMPPTR + 8;                      /*@YL026UK*/
*                                                                  0368
         LA    @04,8                                               0368
         ALR   @04,@05                                             0368
         L     @01,PARMPTR3                                        0368
         ST    @04,GSPOINT(,@01)                                   0368
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* BEFORE SETTING SUBPOOL ID, CHECK IF FIFTH  @Y30LSMK*/
*              /* ARGUMENT IS SPECIFIED.                     @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  0369
*              IF LISTLN = 5                                       0369
*                THEN                                              0369
         CLI   LISTLN,5                                            0369
         BNE   @RF00369                                            0369
*                  GSSUBPID = GSSPID;                      /*@Y30LSMK*/
         L     @01,PARMPTR5                                        0370
         IC    @00,GSSPID(,@01)                                    0370
         STC   @00,GSSUBPID(,@05)                                  0370
*                ELSE                                              0371
*                  GSSUBPID = 0;                           /*@Y30LSMK*/
*                                                                  0371
         B     @RC00369                                            0371
@RF00369 L     @01,TEMPPTR                                         0371
         MVI   GSSUBPID(@01),X'00'                                 0371
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK IF CORE INITIALIZATION REQUESTED BY CHECKING */
*              /* FOR FOURTH ARGUMENT                        #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0372
*              IF LISTLN >= 4                                      0372
*                THEN                                              0372
@RC00369 CLI   LISTLN,4                                            0372
         BL    @RF00372                                            0372
*                  DO;                                     /*#YL026UK*/
*                                                                  0373
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* PREPARE FOR CORE INITIALIZATION      #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0374
*                    INITSIZE = GSSIZE;                    /*#YL026UK*/
         L     @01,PARMPTR2                                        0374
         L     @15,GSSIZE(,@01)                                    0374
         ST    @15,INITSIZE                                        0374
*                    INITPTR = GSPOINT;                    /*#YL026UK*/
*                                                                  0375
         L     @01,PARMPTR3                                        0375
         L     @15,GSPOINT(,@01)                                   0375
         ST    @15,INITPTR                                         0375
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* CHECK FOR INVALID LAST ARGUMENT, ABORT       */
*                    /* IF INVALID                           #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0376
*                    IF GSINIT ^= 'ZERO' & GSINIT ^= 'BLNK'        0376
*                      &  GSINIT ^= 'NSET'                         0376
*                      THEN                                        0376
*                                                                  0376
         L     @15,PARMPTR4                                        0376
         CLC   GSINIT(4,@15),@CC00167                              0376
         BE    @RF00376                                            0376
         CLC   GSINIT(4,@15),@CC00169                              0376
         BE    @RF00376                                            0376
         CLC   GSINIT(4,@15),@CC00171                              0376
         BE    @RF00376                                            0376
*                        DO;                                       0377
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0378
*                          REG15 = ARGERR;                         0379
         LA    REG15,40                                            0379
*                          REG14 = GDTABT;                         0380
         L     REG14,GDTABT(,GDTPR)                                0380
*                          REG13 = GDTABH;                         0381
         L     REG13,GDTABH(,GDTPR)                                0381
*                          GEN(BR    REG14);                       0382
         BR    REG14
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0383
*                        END;                   /*#YL026UK*/       0384
*                                                                  0384
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0385
*                    IF GSINIT = 'ZERO'                            0385
*                      THEN                                        0385
*                                                                  0385
@RF00376 L     @01,PARMPTR4                                        0385
         CLC   GSINIT(4,@01),@CC00167                              0385
         BNE   @RF00385                                            0385
*                        /********************************************/
*                        /*                                  #YL026UK*/
*                        /* ZERO AREA                        #YL026UK*/
*                        /*                                  #YL026UK*/
*                        /********************************************/
*                                                                  0386
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0386
         LA    @15,INITSIZE                                        0386
         ST    @15,@AL00001                                        0386
         LA    @15,INITPTR                                         0386
         ST    @15,@AL00001+4                                      0386
         LA    @15,SET0                                            0386
         ST    @15,@AL00001+8                                      0386
         LA    @01,@AL00001                                        0386
         BAL   @14,COREINIT                                        0386
*                      ELSE                                        0387
*                                                                  0387
*                        /********************************************/
*                        /*                                  @Y30LSMK*/
*                        /* CHECK FOR BLANK INITIALIZATION   @Y30LSMK*/
*                        /*                                  @Y30LSMK*/
*                        /********************************************/
*                                                                  0387
*                        IF GSINIT = 'BLNK'                        0387
*                          THEN                                    0387
*                                                                  0387
         B     @RC00385                                            0387
@RF00385 L     @01,PARMPTR4                                        0387
         CLC   GSINIT(4,@01),@CC00169                              0387
         BNE   @RF00387                                            0387
*                            /****************************************/
*                            /*                              @Y30LSMK*/
*                            /* BLANK AREA                   @Y30LSMK*/
*                            /*                              @Y30LSMK*/
*                            /****************************************/
*                                                                  0388
*                            CALL COREINIT(INITSIZE,INITPTR,SETB); 0388
         LA    @15,INITSIZE                                        0388
         ST    @15,@AL00001                                        0388
         LA    @15,INITPTR                                         0388
         ST    @15,@AL00001+4                                      0388
         LA    @15,SETB                                            0388
         ST    @15,@AL00001+8                                      0388
         LA    @01,@AL00001                                        0388
         BAL   @14,COREINIT                                        0388
*                  END;                                    /*#YL026UK*/
*            END;                                          /*#YL026UK*/
*          ELSE;                                           /*@Z40GSBF*/
*                                                                  0391
@RF00363 DS    0H                                                  0392
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* RETURN TO THE UGSPACE CALLER                     #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0392
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0392
@RC00363 ST    GDTPR,@AL00001                                      0392
         LA    @15,MODID                                           0392
         ST    @15,@AL00001+4                                      0392
         LA    @15,SETRC                                           0392
         ST    @15,@AL00001+8                                      0392
         MVI   @AL00001+8,X'80'                                    0392
         L     @15,GDTEPL(,GDTPR)                                  0392
         LA    @01,@AL00001                                        0392
         BALR  @14,@15                                             0392
*        /*#YL026UK*/                                              0393
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* UFSPACE ENTRY POINT                              #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0393
*AMSSAFS:  ENTRY(GDTTBLX,FSPOINTX);                        /*#YL026UK*/
*                                                                  0393
@EC00393 DS    0H                                                  0394
*AMSSAFS1:                                                         0394
*                                                                  0394
*        DCL FSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */
*                                                                  0394
AMSSAFS1 DS    0H                                                  0395
*        RESPECIFY FSPOINT BASED(PARMPTR2);                /*#YL026UK*/
*                                      /* BASE FSPOINT       #YL026UK*/
*                                                                  0396
*        DCL SPIDPTR  PTR(31);         /* PTR TO SUBPOOL ID  @Y30LSMK*/
*                                                                  0396
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0397
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/
*        GDTPR = ADDR1;                                    /*#YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0398
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/
         LA    @15,4                                               0399
         LR    @14,REG1PTR                                         0399
         ALR   @14,@15                                             0399
         L     @00,ADDR2(,@14)                                     0399
         ST    @00,PARMPTR2                                        0399
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/
*                                                                  0400
*        OLDERID2 = NEWERID2;                                      0401
         L     @14,GDTTR2(,GDTPR)                                  0401
         MVC   @TS00001(95),NEWERID2(@14)                          0401
         MVC   OLDERID2(95,@14),@TS00001                           0401
*        NEWID2 = 'SAFS';                                  /*#YL026UK*/
*                                                                  0402
         MVC   NEWID2(4,@14),@CC01745                              0402
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK IF AREA TO BE FREED IS A UGSPACE OR UGPOOL AREA    */
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0403
*        TEMPPTR = FSPOINT - 4;                            /*#YL026UK*/
         LR    @01,@00                                             0403
         L     @14,FSPOINT(,@01)                                   0403
         SLR   @14,@15                                             0403
         ST    @14,TEMPPTR                                         0403
*        IF FREEID(1:3) = '   '                                    0404
*          THEN                                                    0404
         CLC   FREEID(3,@14),@CC01746                              0404
         BNE   @RF00404                                            0404
*            DO;                                           /*#YL026UK*/
*                                                                  0405
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* FREE UGSPACE AREA                          #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0406
*              SPIDPTR = TEMPPTR - 4;                      /*@Y30LSMK*/
         LCR   @15,@15                                             0406
         ALR   @15,@14                                             0406
         ST    @15,SPIDPTR                                         0406
*              SPIDPTR -> GSLENID = FREEID(4:4);           /*@Y30LSMK*/
         IC    @07,FREEID+3(,@14)                                  0407
         STC   @07,GSLENID(,@15)                                   0407
*              TEMPPTR = TEMPPTR - 4;                      /*#YL026UK*/
         ST    @15,TEMPPTR                                         0408
*              RESPECIFY (REG0,REG1) RSTD;                 /*#YL026UK*/
*              REG0 = GSLEN;                               /*#YL026UK*/
         L     REG0,GSLEN(,@15)                                    0410
*              REG1 = TEMPPTR;                             /*#YL026UK*/
*                                                                  0411
         LR    REG1,@15                                            0411
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* ISSUE FREEMAIN MACRO TO FREE CORE          #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0412
*LFREM8:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*#YL026UK*/
LFREM8   FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/
*            END;                                          /*#YL026UK*/
*          ELSE                                                    0415
*            DO;                                           /*#YL026UK*/
*                                                                  0415
         B     @RC00404                                            0415
@RF00404 DS    0H                                                  0416
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA  */
*              /* IN THE UGPOOL CHAIN                        #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0416
*              TEMPPTR = TEMPPTR - 12;                     /*#YL026UK*/
         L     @15,TEMPPTR                                         0416
         SL    @15,@CF00034                                        0416
         ST    @15,TEMPPTR                                         0416
*              IF GPLAST = TEMPPTR                                 0417
*                THEN                                              0417
         L     @14,GDTSAH(,GDTPR)                                  0417
         C     @15,GPLAST(,@14)                                    0417
         BNE   @RF00417                                            0417
*                  DO;                                     /*#YL026UK*/
*                                                                  0418
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* UPDATE FORWARD CHAIN POINTER AND LAST UGPOOL */
*                    /* AREA POINTER                         #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0419
*                    PREFWD = 0;                           /*#YL026UK*/
         L     @15,GPBACK(,@15)                                    0419
         SLR   @07,@07                                             0419
         ST    @07,PREFWD(,@15)                                    0419
*                    GPLAST = GPBACK;                      /*#YL026UK*/
         ST    @15,GPLAST(,@14)                                    0420
*                  END;                                    /*#YL026UK*/
*                ELSE                                              0422
*                  DO;                                     /*#YL026UK*/
*                                                                  0422
         B     @RC00417                                            0422
@RF00417 DS    0H                                                  0423
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS   */
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0423
*                    PREFWD = GPFORWRD;                    /*#YL026UK*/
         L     @15,TEMPPTR                                         0423
         L     @14,GPBACK(,@15)                                    0423
         L     @15,GPFORWRD(,@15)                                  0423
         ST    @15,PREFWD(,@14)                                    0423
*                    PASBACK = GPBACK;                     /*#YL026UK*/
         ST    @14,PASBACK(,@15)                                   0424
*                  END;                                    /*#YL026UK*/
*                                                                  0425
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* FREE UGPOOL AREA                           #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0426
*              RESPECIFY (REG0,REG1) RSTD;                 /*#YL026UK*/
@RC00417 DS    0H                                                  0427
*              REG0 = GPLEN;                               /*#YL026UK*/
         L     @15,TEMPPTR                                         0427
         L     REG0,GPLEN(,@15)                                    0427
*              REG1 = TEMPPTR;                             /*#YL026UK*/
*                                                                  0428
         LR    REG1,@15                                            0428
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* ISSUE FREEMAIN MACRO TO FREE CORE          @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  0429
*LFREM9:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*@YL026UK*/
LFREM9   FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/
*            END;                                          /*@YL026UK*/
*                                                                  0431
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE UFSPACE CALLER                     @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0432
*        CALL IDCSAEP0(GDTTBL,MODID);                              0432
@RC00404 ST    GDTPR,@AL00001                                      0432
         LA    @15,MODID                                           0432
         ST    @15,@AL00001+4                                      0432
         MVI   @AL00001+4,X'80'                                    0432
         L     @15,GDTEPL(,GDTPR)                                  0432
         LA    @01,@AL00001                                        0432
         BALR  @14,@15                                             0432
*         /*@YL026UK*/                                             0433
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UGPOOL ENTRY POINT                               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0433
*AMSSAGP:  ENTRY(GDTTBLX,GPSIZEX,GPPOINTX,GPIDVARX,GPINITX);       0433
*                                                                  0433
@EC00433 DS    0H                                                  0434
*AMSSAGP1:                                                         0434
*                                                                  0434
*        DCL GPSIZE FIXED(31) BASED;   /* SIZE FOR UGPOOL    @YL026UK*/
*                                                                  0434
AMSSAGP1 DS    0H                                                  0435
*        DCL GPPOINT PTR(31) BASED;    /* ADDR FOR UGPOOL    @YL026UK*/
*                                                                  0435
*        DCL GPIDVAR CHAR(4) BASED;    /* ID FOR UGPOOL      @YL026UK*/
*                                                                  0436
*        DCL GPINIT CHAR(4) BASED;     /* UGPOOL INIT ARGUMENT       */
*                                                                  0437
*        DCL GPFCHAIN PTR(31) BASED(GPLAST);               /*@YL026UK*/
*                                      /* UGPOOL FORWARD CHAIN       */
*                                                                  0439
*        RESPECIFY GPSIZE BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE GPSIZE        @YL026UK*/
*                                                                  0440
*        RESPECIFY GPPOINT BASED(PARMPTR3);                /*@YL026UK*/
*                                      /* BASE GPPOINT       @YL026UK*/
*                                                                  0441
*        RESPECIFY GPIDVAR BASED(PARMPTR4);                /*@YL026UK*/
*                                      /* BASE GPIDVAR       @YL026UK*/
*                                                                  0442
*        RESPECIFY GPINIT BASED(PARMPTR5);                 /*@YL026UK*/
*                                      /* BASE GPINIT        @YL026UK*/
*                                                                  0443
*        DCL PGCNTPTR PTR(31);         /* PTR TO 24-BYTE CONTROL INFO
*                                                            @Y30LSMK*/
*                                                                  0443
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0444
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/
*        GDTPR = ADDR1;                                    /*#YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0445
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0446
         ST    @00,PARMPTR2                                        0446
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0447
         ST    @00,PARMPTR3                                        0447
*        PARMPTR4 = ADDR4;                                 /*#YL026UK*/
         L     @00,ADDR4+12(,REG1PTR)                              0448
         ST    @00,PARMPTR4                                        0448
*        PARMPTR5 = ADDR5;                                 /*#YL026UK*/
         L     @00,ADDR5+16(,REG1PTR)                              0449
         ST    @00,PARMPTR5                                        0449
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/
*                                                                  0450
*                                                                  0450
*                                                                  0451
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0451
*        GEN;                                                      0451
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0452
         LA    @15,1                                               0452
         STC   @15,LISTLN                                          0452
@DL00452 L     @14,LISTSCAN                                        0452
         TM    LISTTEST(@14),B'10000000'                           0452
         BNZ   @DC00452                                            0452
*          LISTSCAN = LISTSCAN + 4;                                0453
         AL    @14,@CF00038                                        0453
         ST    @14,LISTSCAN                                        0453
*        END;                                                      0454
*                                                                  0454
         AL    @15,@CF00215                                        0454
         STC   @15,LISTLN                                          0454
         C     @15,@CF01724                                        0454
         BNH   @DL00452                                            0454
@DC00452 DS    0H                                                  0455
*        OLDERID2 = NEWERID2;                                      0455
         L     @15,GDTTR2(,GDTPR)                                  0455
         MVC   @TS00001(95),NEWERID2(@15)                          0455
         MVC   OLDERID2(95,@15),@TS00001                           0455
*        NEWID2 = 'SAGP';                                  /*#YL026UK*/
*                                                                  0456
         MVC   NEWID2(4,@15),@CC01776                              0456
*        RESPECIFY (REG4) RSTD;                            /*#YL026UK*/
*                                                                  0457
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY, IF YES, */
*        /* A GETMAIN MUST BE ISSUED FOR THE PAGE BOUNDARY   @Y30LSMK*/
*        /* CORE WITH NO CONTROL INFORMATION AREA, OTHERWISE @Y30LSMK*/
*        /* THE CONTROL INFORMATION IS ADDED TO THE GETMAIN  @Y30LSMK*/
*        /* REQUEST.                                         @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0458
*        IF GPIDVAR(3:4) = 'PG'                                    0458
*          THEN                                                    0458
         L     @05,PARMPTR4                                        0458
         CLC   GPIDVAR+2(2,@05),@CC01777                           0458
         BNE   @RF00458                                            0458
*            DO;                                           /*@Y30LSMK*/
*              REG4 = GPSIZE;                              /*@Y30LSMK*/
         L     @01,PARMPTR2                                        0460
         L     REG4,GPSIZE(,@01)                                   0460
*              GETLIST = GETGENPG;                         /*@Y30LSMK*/
         MVC   GETLIST(10),GETGENPG                                0461
*            END;                                          /*@Y30LSMK*/
*          ELSE                                                    0463
*            DO;                                           /*@Y30LSMK*/
         B     @RC00458                                            0463
@RF00458 DS    0H                                                  0464
*              REG4 = GPSIZE + 16;                         /*@Y30LSMK*/
         LA    REG4,16                                             0464
         L     @05,PARMPTR2                                        0464
         AL    REG4,GPSIZE(,@05)                                   0464
*              GETLIST = GETGEN;                           /*@Y30LSMK*/
         MVC   GETLIST(10),GETGEN                                  0465
*            END;                                          /*@Y30LSMK*/
*                                                                  0466
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE           @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0467
*        GETSZ = REG4;                                     /*@Y30LSMK*/
@RC00458 ST    REG4,GETSZ                                          0467
*        GETPT = ADDR(TEMPPTR);                            /*@Y30LSMK*/
         LA    @05,TEMPPTR                                         0468
         ST    @05,GETPT                                           0468
*        RESPECIFY (REG1) RSTD;                            /*@Y30LSMK*/
*        REG1 = ADDR(GETLIST);                             /*@Y30LSMK*/
         LA    REG1,GETLIST                                        0470
*LGETM4: GEN(GETMAIN MF=(E,(REG1)));                       /*@Y30LSMK*/
LGETM4   GETMAIN MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                          /*@Y30LSMK*/
*        RESPECIFY RTNREG RSTD;                                    0473
*        TESTRC = RTNREG;                                          0474
         STH   RTNREG,TESTRC                                       0474
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LSMK*/
*                                                                  0475
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* CHECK RETURN CODE FROM CORE REQUEST              @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                          /*@Z40SGBF*/
*        IF TESTRC ^= 0                                    /*@Z40SGBF*/
*          THEN                                            /*@Z40SGBF*/
         LH    @05,TESTRC                                          0476
         LTR   @05,@05                                             0476
         BZ    @RF00476                                            0476
*            DO;                                           /*@Z40SGBF*/
*              /******************************************************/
*              /*                                            @Z40SGBF*/
*              /* NO CORE AVAILABLE DELETE MODULES NOT IN    @Z40SGBF*/
*              /* USE AND TRY GET CORE AGAIN                 @Z40SGBF*/
*              /*                                            @Z40SGBF*/
*              /******************************************************/
*              CALL RELECORE;                              /*@Z40SGBF*/
         BAL   @14,RELECORE                                        0478
*              RESPECIFY (REG1) RSTD;                      /*@Z40SGBF*/
*              REG1 = ADDR(GETLIST);                       /*@Z40SGBF*/
         LA    REG1,GETLIST                                        0480
*LGETM4X:      GEN(GETMAIN MF=(E,(REG1)));                 /*@Z40SGBF*/
LGETM4X  GETMAIN MF=(E,(REG1))
*              RESPECIFY (REG1) UNRSTD;                    /*@Z40SGBF*/
*              RESPECIFY RTNREG RSTD;                              0483
*              TESTRC = RTNREG;                                    0484
         STH   RTNREG,TESTRC                                       0484
*              RESPECIFY RTNREG UNRSTD;                    /*@Z40SGBF*/
*                                                          /*@Z40SGBF*/
*              /******************************************************/
*              /*                                            @Z40SGBF*/
*              /* CHECK RETURN CODE FROM CORE REQUEST        @Z40SGBF*/
*              /*                                            @Z40SGBF*/
*              /******************************************************/
*                                                          /*@Z40SGBF*/
*              IF TESTRC ^= 0                              /*@Z40SGBF*/
*                THEN                                      /*@Z40SGBF*/
         LH    @05,TESTRC                                          0486
         SLR   @15,@15                                             0486
         CR    @05,@15                                             0486
         BE    @RF00486                                            0486
*                  DO;                                     /*@Z40SGBF*/
*                    SETRC = 4;                            /*@Z40SGBF*/
         MVC   SETRC(2),@CH00038                                   0488
*                    GPPOINT = 0;                          /*@Z40SGBF*/
         L     @05,PARMPTR3                                        0489
         ST    @15,GPPOINT(,@05)                                   0489
*                  END;                                    /*@Z40SGBF*/
*                ELSE                                      /*@Z40SGBF*/
*                  SETRC = 0;                              /*@Z40SGBF*/
         B     @RC00486                                            0491
@RF00486 SLR   @05,@05                                             0491
         STH   @05,SETRC                                           0491
*            END;                                          /*@Z40SGBF*/
*          ELSE                                            /*@Z40SGBF*/
*            SETRC = 0;                                    /*@Z40SGBF*/
         B     @RC00476                                            0493
@RF00476 SLR   @05,@05                                             0493
         STH   @05,SETRC                                           0493
*        IF TESTRC = 0                                     /*@Z40SGBF*/
*          THEN                                            /*@Z40SGBF*/
@RC00476 LH    @05,TESTRC                                          0494
         LTR   @05,@05                                             0494
         BNZ   @RF00494                                            0494
*            DO;                                           /*@Z40SGBF*/
*                                                          /*@Z40SGBF*/
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY,   */
*              /* IF YES, ISSUE GETMAIN FOR A 24-BYTE        @Y30LSMK*/
*              /* CONTROL INFORMATION AREA.                  @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  0496
*              IF GPIDVAR(3:4) = 'PG'                              0496
*                THEN                                              0496
         L     @05,PARMPTR4                                        0496
         CLC   GPIDVAR+2(2,@05),@CC01777                           0496
         BNE   @RF00496                                            0496
*PGCNTRL:          DO;                                     /*@Y30LSMK*/
PGCNTRL  DS    0H                                                  0498
*                    RESPECIFY (REG5) RSTD;                /*@Y30LSMK*/
*                    REG5 = 24;                            /*@Y30LSMK*/
         LA    REG5,24                                             0499
*                    GETLIST = GETGEN;                     /*@Y30LSMK*/
         MVC   GETLIST(10),GETGEN                                  0500
*                    GETSZ = REG5;                         /*@Y30LSMK*/
         ST    REG5,GETSZ                                          0501
*                    GETPT = ADDR(PGCNTPTR);               /*@Y30LSMK*/
         LA    @15,PGCNTPTR                                        0502
         ST    @15,GETPT                                           0502
*                    RESPECIFY (REG1) RSTD;                /*@Y30LSMK*/
*                    REG1 = ADDR(GETLIST);                 /*@Y30LSMK*/
         LA    REG1,GETLIST                                        0504
*LGETM5:             GEN(GETMAIN MF=(E,(REG1)));           /*@Y30LSMK*/
LGETM5   GETMAIN MF=(E,(REG1))
*                    RESPECIFY (REG1) UNRSTD;              /*@Y30LSMK*/
*                    RESPECIFY RTNREG RSTD;                        0507
*                    TESTRC = RTNREG;                              0508
         STH   RTNREG,TESTRC                                       0508
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30LSMK*/
*                                                                  0509
*                    /************************************************/
*                    /*                                      @Z40GSBF*/
*                    /* CKECK RETURN CODE FROM CORE REQUEST  @Z40GSBF*/
*                    /*                                      @Z40GSBF*/
*                    /************************************************/
*                                                                  0510
*                    IF TESTRC ^= 0                        /*@Z40GSBF*/
*                      THEN                                /*@Z40GSBF*/
         LH    @15,TESTRC                                          0510
         LTR   @15,@15                                             0510
         BZ    @RF00510                                            0510
*                        DO;                               /*@Z40GSBF*/
*                                                                  0511
*                          /******************************************/
*                          /*                                @Z40GSBF*/
*                          /* NO CORE AVAILABLE DELETE MODULES     0512
*                          /* NOT IN USE AND TRY TO GET CORE AGAIN 0512
*                          /*                                @Z40GSBF*/
*                          /******************************************/
*                                                                  0512
*                          CALL RELECORE;                  /*@Z40GSBF*/
         BAL   @14,RELECORE                                        0512
*                          RESPECIFY (REG1) RSTD;          /*@Z40GSBF*/
*                          REG1 = ADDR(GETLIST);           /*@Z40GSBF*/
         LA    REG1,GETLIST                                        0514
*LGETM5X:                  GEN(GETMAIN MF=(E,(REG1)));     /*@Z40GSBF*/
LGETM5X  GETMAIN MF=(E,(REG1))
*                          RESPECIFY (REG1) UNRSTD;        /*@Z40GSBF*/
*                          RESPECIFY RTNREG RSTD;                  0517
*                          TESTRC = RTNREG;                        0518
         STH   RTNREG,TESTRC                                       0518
*                          RESPECIFY RTNREG UNRSTD;        /*@Z40GSBF*/
*                                                                  0519
*                            IF TESTRC ^= 0                /*@Z40GSBF*/
*                              THEN                        /*@Z40GSBF*/
         LH    @15,TESTRC                                          0520
         SLR   @14,@14                                             0520
         CR    @15,@14                                             0520
         BE    @RF00520                                            0520
*                                DO;                       /*@Z40GSBF*/
*                                  /**********************************/
*                                  /*                        @Z40GSBF*/
*                                  /* THE REQUEST FOR MAIN STORAGE   */
*                                  /* FAILED,SET THE RETURN CODE,ZERO*/
*                                  /* OUT USER GETPOOL PTR, FREE THE */
*                                  /* PAGE BOUNDARY CORE AND RETURN  */
*                                  /* TO THE UGPOOL CALLER.          */
*                                  /*                        @Z40GSBF*/
*                                  /**********************************/
*                                                                  0522
*                                  SETRC = 4;              /*@Z40GSBF*/
         MVC   SETRC(2),@CH00038                                   0522
*                                  GPPOINT = 0;            /*@Z40GSBF*/
         L     @15,PARMPTR3                                        0523
         ST    @14,GPPOINT(,@15)                                   0523
*                                  RESPECIFY (REG0,REG1) RSTD;     0524
*                                                          /*@Z40GSBF*/
*                                  REG1 = TEMPPTR;         /*@Z40GSBF*/
         L     REG1,TEMPPTR                                        0525
*                                  REG0 = REG4;            /*@Z40GSBF*/
         LR    REG0,REG4                                           0526
*LFREM12:                          GEN(FREEMAIN R,LV=(REG0),A=(REG1));
LFREM12  FREEMAIN R,LV=(REG0),A=(REG1)
*                                                          /*@Z40GSBF*/
*                                  RESPECIFY (REG0,REG1) UNRSTD;   0528
*                                                          /*@Z40GSBF*/
*                                  CALL IDCSAEP0(GDTTBL,MODID,SETRC);
         ST    GDTPR,@AL00001                                      0529
         LA    @15,MODID                                           0529
         ST    @15,@AL00001+4                                      0529
         LA    @15,SETRC                                           0529
         ST    @15,@AL00001+8                                      0529
         MVI   @AL00001+8,X'80'                                    0529
         L     @15,GDTEPL(,GDTPR)                                  0529
         LA    @01,@AL00001                                        0529
         BALR  @14,@15                                             0529
*        /*@Z40GSBF*/                                              0530
*                                END;                      /*@Z40GSBF*/
*                        END;                              /*@Z40GSBF*/
@RF00520 DS    0H                                                  0532
*                  END PGCNTRL;                                    0532
*                                                                  0532
@RF00510 DS    0H                                                  0533
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* INITIALIZE THE UGPOOL AREA CONTROL INFORMATION,    */
*              /* AND INITIALIZE THE UGPOOL AREA POINTER RETURNED TO */
*              /* THE USER                                   @Y30LSMK*/
*              /* NOTE - FOR A 24-BYTE CONTROL INFORMATION   @Y30LSMK*/
*              /* AREA, THE ADDR AND LEN OF THE PAGE BOUNDARY        */
*              /* CORE IS STORED IN WORDS 5 AND 6.           @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  0533
*              IF GPIDVAR(3:4) = 'PG'                              0533
*                THEN                                              0533
@RF00496 L     @01,PARMPTR4                                        0533
         CLC   GPIDVAR+2(2,@01),@CC01777                           0533
         BNE   @RF00533                                            0533
*                  DO;                                     /*@Y30LSMK*/
*                    PGCNTPTR->GPADRPG = TEMPPTR;          /*@Y30LSMK*/
         L     @15,TEMPPTR                                         0535
         L     @14,PGCNTPTR                                        0535
         ST    @15,GPADRPG(,@14)                                   0535
*                    PGCNTPTR->GPLENPG = REG4;             /*@Y30LSMK*/
         ST    REG4,GPLENPG(,@14)                                  0536
*                    PGCNTPTR->GPLEN = REG5;               /*@Y30LSMK*/
         ST    REG5,GPLEN(,@14)                                    0537
*                    RESPECIFY (REG5) UNRSTD;              /*@Y30LSMK*/
*                    GPPOINT = TEMPPTR;                    /*@Y30LSMK*/
         L     @05,PARMPTR3                                        0539
         ST    @15,GPPOINT(,@05)                                   0539
*                    TEMPPTR = PGCNTPTR;                   /*@Y30LSMK*/
         ST    @14,TEMPPTR                                         0540
*                  END;                                    /*@Y30LSMK*/
*                ELSE                                              0542
*                  DO;                                     /*@Y30LSMK*/
         B     @RC00533                                            0542
@RF00533 DS    0H                                                  0543
*                    GPLEN = REG4;                         /*@Y30LSMK*/
         L     @05,TEMPPTR                                         0543
         ST    REG4,GPLEN(,@05)                                    0543
*                    RESPECIFY (REG4) UNRSTD;              /*@Y30LSMK*/
*                    GPPOINT = TEMPPTR + 16;               /*@Y30LSMK*/
         AL    @05,@CF00478                                        0545
         L     @04,PARMPTR3                                        0545
         ST    @05,GPPOINT(,@04)                                   0545
*                  END;                                    /*@Y30LSMK*/
*                                                                  0546
*              GPFORWRD = 0;                               /*@Y30LSMK*/
@RC00533 L     @15,TEMPPTR                                         0547
         SLR   @14,@14                                             0547
         ST    @14,GPFORWRD(,@15)                                  0547
*              GPID = GPIDVAR;                             /*@Y30LSMK*/
         L     @14,PARMPTR4                                        0548
         MVC   GPID(4,@15),GPIDVAR(@14)                            0548
*              GPBACK = GPLAST;                            /*@Y30LSMK*/
         L     @14,GDTSAH(,GDTPR)                                  0549
         L     @07,GPLAST(,@14)                                    0549
         ST    @07,GPBACK(,@15)                                    0549
*              GPFCHAIN = TEMPPTR;                         /*@Y30LSMK*/
         ST    @15,GPFCHAIN(,@07)                                  0550
*              GPLAST = TEMPPTR;                           /*@Y30LSMK*/
*                                                                  0551
         ST    @15,GPLAST(,@14)                                    0551
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK IF CORE INITIALIZATION REQUESTED     #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  0552
*              IF LISTLN = 5                                       0552
*                THEN                                              0552
         CLI   LISTLN,5                                            0552
         BNE   @RF00552                                            0552
*                  DO;                                     /*#YL026UK*/
*                                                                  0553
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* PREPARE FOR CORE INITIALIZATION      #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0554
*                    INITSIZE = GPSIZE;                    /*#YL026UK*/
         L     @01,PARMPTR2                                        0554
         L     @15,GPSIZE(,@01)                                    0554
         ST    @15,INITSIZE                                        0554
*                    INITPTR = GPPOINT;                    /*#YL026UK*/
*                                                                  0555
         L     @01,PARMPTR3                                        0555
         L     @15,GPPOINT(,@01)                                   0555
         ST    @15,INITPTR                                         0555
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* CHECK FOR INVALID LAST ARGUMENT      #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0556
*                    IF GPINIT ^= 'BLNK' & GPINIT ^= 'ZERO'        0556
*                      THEN                                        0556
*                                                                  0556
         L     @15,PARMPTR5                                        0556
         CLC   GPINIT(4,@15),@CC00169                              0556
         BE    @RF00556                                            0556
         CLC   GPINIT(4,@15),@CC00167                              0556
         BE    @RF00556                                            0556
*                        DO;                                       0557
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0558
*                          REG15 = ARGERR;                         0559
         LA    REG15,40                                            0559
*                          REG14 = GDTABT;                         0560
         L     REG14,GDTABT(,GDTPR)                                0560
*                          REG13 = GDTABH;                         0561
         L     REG13,GDTABH(,GDTPR)                                0561
*                          GEN(BR    REG14);                       0562
         BR    REG14
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0563
*                        END;                   /*#YL026UK*/       0564
*                                                                  0564
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  0565
*                    IF GPINIT = 'ZERO'                            0565
*                      THEN                                        0565
*                                                                  0565
@RF00556 L     @01,PARMPTR5                                        0565
         CLC   GPINIT(4,@01),@CC00167                              0565
         BNE   @RF00565                                            0565
*                        /********************************************/
*                        /*                                  #YL026UK*/
*                        /* ZERO AREA                        #YL026UK*/
*                        /*                                  #YL026UK*/
*                        /********************************************/
*                                                                  0566
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0566
         LA    @15,INITSIZE                                        0566
         ST    @15,@AL00001                                        0566
         LA    @15,INITPTR                                         0566
         ST    @15,@AL00001+4                                      0566
         LA    @15,SET0                                            0566
         ST    @15,@AL00001+8                                      0566
         LA    @01,@AL00001                                        0566
         BAL   @14,COREINIT                                        0566
*                      ELSE                                        0567
*                                                                  0567
*                        /********************************************/
*                        /*                                  @YL026UK*/
*                        /* BLANK AREA                       @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /********************************************/
*                                                                  0567
*                        CALL COREINIT(INITSIZE,INITPTR,SETB);     0567
         B     @RC00565                                            0567
@RF00565 LA    @15,INITSIZE                                        0567
         ST    @15,@AL00001                                        0567
         LA    @15,INITPTR                                         0567
         ST    @15,@AL00001+4                                      0567
         LA    @15,SETB                                            0567
         ST    @15,@AL00001+8                                      0567
         LA    @01,@AL00001                                        0567
         BAL   @14,COREINIT                                        0567
*                  END;                                    /*@YL026UK*/
*            END;                                          /*@YL026UK*/
*          ELSE;                                           /*@Z40GSBF*/
*                                                                  0570
@RF00494 DS    0H                                                  0571
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE UGPOOL CALLER                      @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0571
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0571
@RC00494 ST    GDTPR,@AL00001                                      0571
         LA    @15,MODID                                           0571
         ST    @15,@AL00001+4                                      0571
         LA    @15,SETRC                                           0571
         ST    @15,@AL00001+8                                      0571
         MVI   @AL00001+8,X'80'                                    0571
         L     @15,GDTEPL(,GDTPR)                                  0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*        /*@YL026UK*/                                              0572
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UFPOOL ENTRY POINT                               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0572
*AMSSAFP:  ENTRY(GDTTBLX,FPIDVARX,FPALLX);                 /*@YL026UK*/
*                                                                  0572
@EC00572 DS    0H                                                  0573
*AMSSAFP1:                                                         0573
*                                                                  0573
*        DCL FPIDVAR CHAR(4) BASED;    /* SPACE ID FOR UFPOOL        */
*                                                                  0573
AMSSAFP1 DS    0H                                                  0574
*        DCL FPALL CHAR(3) BASED;      /* UFPOOL ALL ARGUMENT        */
*                                                                  0574
*        RESPECIFY FPIDVAR BASED(PARMPTR2);                /*@YL026UK*/
*                                      /* BASE FPIDVAR       @YL026UK*/
*                                                                  0576
*        RESPECIFY FPALL BASED(PARMPTR3);                  /*@YL026UK*/
*                                      /* BASE FPALL         @YL026UK*/
*                                                                  0577
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0577
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0578
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0579
         ST    @00,PARMPTR2                                        0579
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0580
         ST    @00,PARMPTR3                                        0580
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0581
*                                                                  0581
*                                                                  0582
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0582
*        GEN;                                                      0582
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0583
         LA    @15,1                                               0583
         STC   @15,LISTLN                                          0583
@DL00583 L     @14,LISTSCAN                                        0583
         TM    LISTTEST(@14),B'10000000'                           0583
         BNZ   @DC00583                                            0583
*          LISTSCAN = LISTSCAN + 4;                                0584
         AL    @14,@CF00038                                        0584
         ST    @14,LISTSCAN                                        0584
*        END;                                                      0585
*                                                                  0585
         AL    @15,@CF00215                                        0585
         STC   @15,LISTLN                                          0585
         C     @15,@CF01724                                        0585
         BNH   @DL00583                                            0585
@DC00583 DS    0H                                                  0586
*        OLDERID2 = NEWERID2;                                      0586
         L     @15,GDTTR2(,GDTPR)                                  0586
         MVC   @TS00001(95),NEWERID2(@15)                          0586
         MVC   OLDERID2(95,@15),@TS00001                           0586
*        NEWID2 = 'SAFP';                                  /*@YL026UK*/
*                                                                  0587
         MVC   NEWID2(4,@15),@CC01805                              0587
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK FOR INVALID LAST ARGUMENT                  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0588
*        IF LISTPTR = 3 & FPALL ^= 'ALL'                           0588
*          THEN                                                    0588
*                                                                  0588
         CLC   LISTPTR(4),@CF00158                                 0588
         BNE   @RF00588                                            0588
         L     @01,PARMPTR3                                        0588
         CLC   FPALL(3,@01),@CC00159                               0588
         BE    @RF00588                                            0588
*            DO;                                                   0589
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0590
*              REG15 = ARGERR;                                     0591
         LA    REG15,40                                            0591
*              REG14 = GDTABT;                                     0592
         L     REG14,GDTABT(,GDTPR)                                0592
*              REG13 = GDTABH;                                     0593
         L     REG13,GDTABH(,GDTPR)                                0593
*              GEN(BR    REG14);                                   0594
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0595
*            END;                               /*@YL026UK*/       0596
*                                                                  0596
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK FOR NO UGPOOL AREAS TO FREE                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0597
*        IF GPFIRST = 0                                            0597
*          THEN                                                    0597
@RF00588 L     @01,GDTSAH(,GDTPR)                                  0597
         L     @15,GPFIRST(,@01)                                   0597
         LTR   @15,@15                                             0597
         BNZ   @RF00597                                            0597
*            DO;                                           /*@YL026UK*/
*              CALL IDCSAEP0(GDTTBL,MODID);                        0599
         ST    GDTPR,@AL00001                                      0599
         LA    @15,MODID                                           0599
         ST    @15,@AL00001+4                                      0599
         MVI   @AL00001+4,X'80'                                    0599
         L     @15,GDTEPL(,GDTPR)                                  0599
         LA    @01,@AL00001                                        0599
         BALR  @14,@15                                             0599
*         /*@YL026UK*/                                             0600
*            END;                                          /*@YL026UK*/
*                                                                  0600
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* SCAN UGPOOL AREAS AND RELEASE AREAS TO BE RELEASED       */
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0601
*        DOCNTRL = ON;                                     /*@YL026UK*/
@RF00597 OI    DOCNTRL,B'10000000'                                 0601
*        TEMPPTR = GPFIRST;                                /*@YL026UK*/
         L     @01,GDTSAH(,GDTPR)                                  0602
         L     @15,GPFIRST(,@01)                                   0602
         ST    @15,TEMPPTR                                         0602
*FPDO:   DO WHILE (DOCNTRL = ON);                          /*@YL026UK*/
*                                                                  0603
FPDO     B     @DE00603                                            0603
@DL00603 DS    0H                                                  0604
*          /**********************************************************/
*          /*                                                @YL026UK*/
*          /* CHECK IF THIS AREA IS TO BE FREED              @YL026UK*/
*          /*                                                @YL026UK*/
*          /**********************************************************/
*                                                                  0604
*          IF (LISTLN=3 & GPID(1:2)=FPIDVAR(1:2))  (GPID=FPIDVAR) 0604
*            THEN                                                  0604
         CLI   LISTLN,3                                            0604
         BNE   @GL00005                                            0604
         L     @01,TEMPPTR                                         0604
         L     @15,PARMPTR2                                        0604
         CLC   GPID(2,@01),FPIDVAR(@15)                            0604
         BE    @RT00604                                            0604
@GL00005 L     @01,TEMPPTR                                         0604
         L     @15,PARMPTR2                                        0604
         CLC   GPID(4,@01),FPIDVAR(@15)                            0604
         BNE   @RF00604                                            0604
@RT00604 DS    0H                                                  0605
*              DO;                                         /*@YL026UK*/
*                                                                  0605
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA*/
*                /* IN THE UGPOOL CHAIN                      @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                                                                  0606
*                IF GPLAST = TEMPPTR                               0606
*                  THEN                                            0606
         L     @15,TEMPPTR                                         0606
         L     @14,GDTSAH(,GDTPR)                                  0606
         C     @15,GPLAST(,@14)                                    0606
         BNE   @RF00606                                            0606
*                    DO;                                   /*@YL026UK*/
*                                                                  0607
*                      /**********************************************/
*                      /*                                    @YL026UK*/
*                      /* UPDATE FORWARD CHAIN POINTER AND LAST      */
*                      /* UGPOOL AREA POINTER, AND SET DOCNTRL TO    */
*                      /* FALL OUT OF DO WHILE LOOP          @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /**********************************************/
*                                                                  0608
*                      DOCNTRL = OFF;                      /*@YL026UK*/
         NI    DOCNTRL,B'01111111'                                 0608
*                      PREFWD = 0;                         /*@YL026UK*/
         L     @15,GPBACK(,@15)                                    0609
         SLR   @07,@07                                             0609
         ST    @07,PREFWD(,@15)                                    0609
*                      GPLAST = GPBACK;                    /*@YL026UK*/
         ST    @15,GPLAST(,@14)                                    0610
*                    END;                                  /*@YL026UK*/
*                  ELSE                                            0612
*                    DO;                                   /*@YL026UK*/
*                                                                  0612
         B     @RC00606                                            0612
@RF00606 DS    0H                                                  0613
*                      /**********************************************/
*                      /*                                    @YL026UK*/
*                      /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS */
*                      /*                                    @YL026UK*/
*                      /**********************************************/
*                                                                  0613
*                      PREFWD = GPFORWRD;                  /*@YL026UK*/
         L     @15,TEMPPTR                                         0613
         L     @14,GPBACK(,@15)                                    0613
         L     @15,GPFORWRD(,@15)                                  0613
         ST    @15,PREFWD(,@14)                                    0613
*                      PASBACK = GPBACK;                   /*@YL026UK*/
         ST    @14,PASBACK(,@15)                                   0614
*                    END;                                  /*@YL026UK*/
*                                                                  0615
*                /****************************************************/
*                /*                                          @Y30LSMK*/
*                /* CHECK FOR A 24-BYTE CONTROL INFORMATION AREA     */
*                /* REQUIRED FOR THE SPACE GOTTEN ON THE PAGE        */
*                /* BOUNDARY.                                @Y30LSMK*/
*                /*                                          @Y30LSMK*/
*                /****************************************************/
*                                                                  0616
*                IF GPID(3:4) = 'PG'                               0616
*                  THEN                                            0616
*                                                                  0616
@RC00606 L     @15,TEMPPTR                                         0616
         CLC   GPID+2(2,@15),@CC01777                              0616
         BNE   @RF00616                                            0616
*                    /************************************************/
*                    /*                                      @Y30LSMK*/
*                    /* FREE THE PAGE BOUNDARY AREA.  THE SPACE      */
*                    /* TO BE FREED IS POINTED TO BY THE 5-WORD      */
*                    /* OF THE 24-BYTE CONTROL INFORMATION   @Y30LSMK*/
*                    /* AREA.                                @Y30LSMK*/
*                    /*                                      @Y30LSMK*/
*                    /************************************************/
*                                                                  0617
*                    DO;                                   /*@Y30LSMK*/
*                      RESPECIFY (REG0,REG1) RSTD;         /*@Y30LSMK*/
*                      REG1 = GPADRPG;                     /*@Y30LSMK*/
         L     REG1,GPADRPG(,@15)                                  0619
*                      REG0 = GPLENPG;                     /*@Y30LSMK*/
*                                                                  0620
         L     REG0,GPLENPG(,@15)                                  0620
*                      /**********************************************/
*                      /*                                    @Y30LSMK*/
*                      /* ISSUE FREEMAIN MACRO TO FREE PAGE  @Y30LSMK*/
*                      /* BOUNDARY CORE.                     @Y30LSMK*/
*                      /*                                    @Y30LSMK*/
*                      /**********************************************/
*                                                                  0621
*LFREM13:              GEN(FREEMAIN R,LV=(REG0),A=(REG1)); /*@Y30LSMK*/
LFREM13  FREEMAIN R,LV=(REG0),A=(REG1)
*                      RESPECIFY (REG0,REG1) UNRSTD;       /*@Y30LSMK*/
*                    END;                                  /*@Y30LSMK*/
*                                                                  0623
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* FREE UGPOOL AREA                         #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  0624
*                RESPECIFY (REG0,REG1) RSTD;               /*#YL026UK*/
@RF00616 DS    0H                                                  0625
*                REG1 = TEMPPTR;                           /*#YL026UK*/
         L     @15,TEMPPTR                                         0625
         LR    REG1,@15                                            0625
*                REG0 = GPLEN;                             /*#YL026UK*/
         L     REG0,GPLEN(,@15)                                    0626
*                TEMPPTR = GPFORWRD;                       /*#YL026UK*/
*                                                                  0627
         L     @15,GPFORWRD(,@15)                                  0627
         ST    @15,TEMPPTR                                         0627
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* ISSUE FREEMAIN MACRO TO FREE CORE        @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                                                                  0628
*LFREM10:        GEN(FREEMAIN R,LV=(REG0),A=(REG1));       /*@YL026UK*/
LFREM10  FREEMAIN R,LV=(REG0),A=(REG1)
*                RESPECIFY (REG0,REG1) UNRSTD;             /*@YL026UK*/
*              END;                                        /*@YL026UK*/
*            ELSE                                                  0631
*              DO;                                         /*@YL026UK*/
*                                                                  0631
         B     @RC00604                                            0631
@RF00604 DS    0H                                                  0632
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* CHECK IF UGPOOL AREA EXAMINED IS THE LAST AREA   */
*                /* IN THE UGPOOL CHAIN                      @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                                                                  0632
*                IF GPLAST = TEMPPTR                               0632
*                  THEN                                            0632
*                                                                  0632
         L     @01,GDTSAH(,GDTPR)                                  0632
         CLC   GPLAST(4,@01),TEMPPTR                               0632
         BNE   @RF00632                                            0632
*                    /************************************************/
*                    /*                                      @YL026UK*/
*                    /* SET DOCNTRL TO FALL OUT OF DO WHILE LOOP     */
*                    /*                                      @YL026UK*/
*                    /************************************************/
*                                                                  0633
*                    DOCNTRL = OFF;                        /*@YL026UK*/
         NI    DOCNTRL,B'01111111'                                 0633
*                  ELSE                                            0634
*                                                                  0634
*                    /************************************************/
*                    /*                                      @YL026UK*/
*                    /* UPDATE UGPOOL AREA SCAN POINTER FOR NEXT     */
*                    /* ITERATION                            @YL026UK*/
*                    /*                                      @YL026UK*/
*                    /************************************************/
*                                                                  0634
*                    TEMPPTR = GPFORWRD;                   /*@YL026UK*/
         B     @RC00632                                            0634
@RF00632 L     @01,TEMPPTR                                         0634
         L     @15,GPFORWRD(,@01)                                  0634
         ST    @15,TEMPPTR                                         0634
*              END;                                        /*@YL026UK*/
@RC00632 DS    0H                                                  0636
*        END FPDO;                                         /*@YL026UK*/
*                                                                  0636
@RC00604 DS    0H                                                  0636
@DE00603 TM    DOCNTRL,B'10000000'                                 0636
         BO    @DL00603                                            0636
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE UFPOOL CALLER                      @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        CALL IDCSAEP0(GDTTBL,MODID);                              0637
         ST    GDTPR,@AL00001                                      0637
         LA    @15,MODID                                           0637
         ST    @15,@AL00001+4                                      0637
         MVI   @AL00001+4,X'80'                                    0637
         L     @15,GDTEPL(,GDTPR)                                  0637
         LA    @01,@AL00001                                        0637
         BALR  @14,@15                                             0637
*         /*@YL026UK*/                                             0638
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UTIME ENTRY POINT                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0638
*AMSSATI:  ENTRY(GDTTBLX,TITIMEX,TIDATEX,TIFORMX);         /*@YL026UK*/
*                                                                  0638
@EC00638 DS    0H                                                  0639
*AMSSATI1:                                                         0639
*                                                                  0639
*        DCL TIDATE CHAR(8) BASED;     /* DATE FOR UTIME     @YL026UK*/
*                                                                  0639
AMSSATI1 DS    0H                                                  0640
*        DCL TITIME CHAR(8) BASED;     /* TIME FOR UTIME     @YL026UK*/
*                                                                  0640
*        DCL TIFORM CHAR(4) BASED;     /* FORMAT FOR UTIME   @YL026UK*/
*                                                                  0641
*        RESPECIFY TIDATE BASED(PARMPTR3);                 /*@YL026UK*/
*                                      /* BASE TIDATE        @YL026UK*/
*                                                                  0643
*        RESPECIFY TITIME BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE TITIME        @YL026UK*/
*                                                                  0644
*        RESPECIFY TIFORM BASED(PARMPTR4);                 /*@YL026UK*/
*                                      /* BASE TIFORM        @YL026UK*/
*                                                                  0645
*        /* DATE AND TIME OF DAY ENTRY NAME                  @YL026UK*/
*        DCL IDCSA05 ENTRY;                                /*@YL026UK*/
*                                                                  0645
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0646
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0647
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0648
         ST    @00,PARMPTR2                                        0648
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0649
         ST    @00,PARMPTR3                                        0649
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/
         L     @00,ADDR4+12(,REG1PTR)                              0650
         ST    @00,PARMPTR4                                        0650
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0651
*                                                                  0651
*                                                                  0652
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0652
*        GEN;                                                      0652
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0653
         LA    @15,1                                               0653
         STC   @15,LISTLN                                          0653
@DL00653 L     @14,LISTSCAN                                        0653
         TM    LISTTEST(@14),B'10000000'                           0653
         BNZ   @DC00653                                            0653
*          LISTSCAN = LISTSCAN + 4;                                0654
         AL    @14,@CF00038                                        0654
         ST    @14,LISTSCAN                                        0654
*        END;                                                      0655
*                                                                  0655
         AL    @15,@CF00215                                        0655
         STC   @15,LISTLN                                          0655
         C     @15,@CF01724                                        0655
         BNH   @DL00653                                            0655
@DC00653 DS    0H                                                  0656
*        OLDERID2 = NEWERID2;                                      0656
         L     @15,GDTTR2(,GDTPR)                                  0656
         MVC   @TS00001(95),NEWERID2(@15)                          0656
         MVC   OLDERID2(95,@15),@TS00001                           0656
*        NEWID2 = 'SATI';                                  /*@YL026UK*/
*                                                                  0657
         MVC   NEWID2(4,@15),@CC01832                              0657
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CALL THE UTIME MODULE IDCSA05                    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0658
*        CALL IDCSA05(GDTTBL,TITIME,TIDATE,TIFORM,LISTLN); /*@YL026UK*/
*                                                                  0658
         ST    GDTPR,@AL00001                                      0658
         L     @01,PARMPTR2                                        0658
         ST    @01,@AL00001+4                                      0658
         L     @01,PARMPTR3                                        0658
         ST    @01,@AL00001+8                                      0658
         L     @01,PARMPTR4                                        0658
         ST    @01,@AL00001+12                                     0658
         LA    @15,LISTLN                                          0658
         ST    @15,@AL00001+16                                     0658
         L     @15,@CV01831                                        0658
         LA    @01,@AL00001                                        0658
         BALR  @14,@15                                             0658
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE UTIME CALLER                       @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0659
*        CALL IDCSAEP0(GDTTBL,MODID);                              0659
         ST    GDTPR,@AL00001                                      0659
         LA    @15,MODID                                           0659
         ST    @15,@AL00001+4                                      0659
         MVI   @AL00001+4,X'80'                                    0659
         L     @15,GDTEPL(,GDTPR)                                  0659
         LA    @01,@AL00001                                        0659
         BALR  @14,@15                                             0659
*         /*@YL026UK*/                                             0660
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UCATLG ENTRY POINT                               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0660
*AMSSACA:  ENTRY(GDTTBLX,CPLPTRX);                         /*@YL026UK*/
*                                                                  0660
@EC00660 DS    0H                                                  0661
*AMSSACA1:                                                         0661
*                                                                  0661
*        DCL CPLPTR PTR(31) BASED;     /* CATALOG PARAMETER LIST PTR */
*                                                                  0661
AMSSACA1 DS    0H                                                  0662
*        RESPECIFY CPLPTR BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE CPLPTR        @YL026UK*/
*                                                                  0663
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0663
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0664
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0665
         ST    @00,PARMPTR2                                        0665
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0666
*        OLDERID2 = NEWERID2;                                      0667
         L     @15,GDTTR2(,GDTPR)                                  0667
         MVC   @TS00001(95),NEWERID2(@15)                          0667
         MVC   OLDERID2(95,@15),@TS00001                           0667
*        NEWID2 = 'SACA';                                  /*@YL026UK*/
         MVC   NEWID2(4,@15),@CC01844                              0668
*        IF GDTDBG = NULLPTR                                       0669
*          THEN;                                                   0669
         L     @15,GDTDBG(,GDTPR)                                  0669
         LTR   @15,@15                                             0669
         BZ    @RT00669                                            0669
*          ELSE                                                    0671
*            CALL IDCDB010(GDTTBL,'ZZCA');                         0671
         ST    GDTPR,@AL00001                                      0671
         LA    @15,@CC01845                                        0671
         ST    @15,@AL00001+4                                      0671
         MVI   @AL00001+4,X'80'                                    0671
         L     @15,GDTDBG(,GDTPR)                                  0671
         LA    @01,@AL00001                                        0671
         BALR  @14,@15                                             0671
*                                                          /*@YL026UK*/
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/
@RT00669 DS    0H                                                  0673
*        REG1 = CPLPTR;                                    /*@YL026UK*/
*                                                                  0673
         L     @15,PARMPTR2                                        0673
         L     REG1,CPLPTR(,@15)                                   0673
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* ISSUE CATLG MACRO                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0674
*LCATLG1:GEN(CATLG MF=(E,(REG1)));                         /*@YL026UK*/
LCATLG1  CATLG MF=(E,(REG1))
*        RESPECIFY (RTNREG) RSTD;                          /*@YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    0676
*        TESTRC = RTNREG;                                          0677
         STH   RTNREG,TESTRC                                       0677
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/
*        RESPECIFY (RTNREG) UNRSTD;                        /*@YL026UK*/
*        IF GDTDBG = NULLPTR                                       0680
*          THEN;                                                   0680
         L     @00,GDTDBG(,GDTPR)                                  0680
         LTR   @00,@00                                             0680
         BZ    @RT00680                                            0680
*          ELSE                                                    0682
*            CALL IDCDB010(GDTTBL,'ZZCA');                         0682
         ST    GDTPR,@AL00001                                      0682
         LA    @00,@CC01845                                        0682
         ST    @00,@AL00001+4                                      0682
         MVI   @AL00001+4,X'80'                                    0682
         L     @15,GDTDBG(,GDTPR)                                  0682
         LA    @01,@AL00001                                        0682
         BALR  @14,@15                                             0682
*                                                          /*@YL026UK*/
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/
*                                                                  0683
@RT00680 DS    0H                                                  0684
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE UCATLG CALLER                      @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0684
*        CALL IDCSAEP0(GDTTBL,MODID,TESTRC);                       0684
         ST    GDTPR,@AL00001                                      0684
         LA    @15,MODID                                           0684
         ST    @15,@AL00001+4                                      0684
         LA    @15,TESTRC                                          0684
         ST    @15,@AL00001+8                                      0684
         MVI   @AL00001+8,X'80'                                    0684
         L     @15,GDTEPL(,GDTPR)                                  0684
         LA    @01,@AL00001                                        0684
         BALR  @14,@15                                             0684
*        /*@YL026UK*/                                              0685
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* USNAP ENTRY POINT                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0685
*AMSSASN:  ENTRY(GDTTBLX,SNAPIDX);                         /*@YL026UK*/
*                                                                  0685
@EC00685 DS    0H                                                  0686
*AMSSASN1:                                                         0686
*                                                                  0686
*        DCL SNAPID FIXED(15) BASED;   /* SNAP IDENTIFIER    @YL026UK*/
*                                                                  0686
AMSSASN1 DS    0H                                                  0687
*        RESPECIFY SNAPID BASED(PARMPTR2);                 /*@YL026UK*/
*                                      /* BASE SNAPID        @YL026UK*/
*                                                                  0688
*        /* OPEN MACRO LIST                                  @YL026UK*/
*        DCL 1 OPENLIST CHAR(4) BDY(WORD),                         0688
*              2 OPENOPT CHAR(1),      /* OPEN OPTIONS       @YL026UK*/
*              2 OPENADDR PTR(24);     /* DCB ADDRESS        @YL026UK*/
*                                                                  0688
*        /* SNAP MACRO LIST                                  @YL026UK*/
*        DCL 1 SNAPLIST CHAR(20) BDY(WORD),                        0689
*              2 SNAPIDEN FIXED(8),    /* SNAP ID            @YL026UK*/
*              2 SNAPOPT CHAR(7),      /* SNAP OPTIONS       @YL026UK*/
*              2 SNAPPTR PTR(31),      /* SNAP DCB ADDRESS   @YL026UK*/
*              2 SNAPTCB PTR(31),      /* SNAP TCB ADDRESS   @YL026UK*/
*              2 SNAPLST PTR(31);      /* SNAP-SHOT LIST ADDR        */
*                                                                  0689
*        DCL DUMPDCB CHAR(90) BDY(WORD);                   /*@YL026UK*/
*                                      /* FULL REGION (SNAP) DUMP DCB*/
*                                                                  0691
*        /* DCB ADDRESS FOR CLOSING                          @YL026UK*/
*        DCL 1 SADCBACB PTR(31) BDY(WORD),                         0691
*              2 BLOCKFLG BIT(1);      /* CONTROL BLOCK ADDRESS FLAG */
*                                                                  0691
*        DCL LIST3 GENERATED LABEL;    /* OPEN MACRO LIST LABEL      */
*                                                                  0692
*        DCL LIST4 GENERATED LABEL;    /* SNAP MACRO LIST LABEL      */
*                                                                  0693
*        DCL SNAPDCB GENERATED LABEL;  /* SNAP DCB LABEL     @YL026UK*/
*                                                                  0694
*        DCL OPENGEN CHAR(4) DEFINED(LIST3);               /*@YL026UK*/
*                                      /* GENERATED LIST FORM OF     */
*                                      /* OPEN               @YL026UK*/
*                                                                  0696
*        DCL SNAPGEN CHAR(20) DEFINED(LIST4);              /*@YL026UK*/
*                                      /* GENERATED LIST FORM OF SNAP*/
*                                                                  0697
*        DCL DCBFORM CHAR(90) DEFINED(SNAPDCB);            /*@YL026UK*/
*                                      /* GENERATED SNAP DCB @YL026UK*/
*                                                                  0698
*        DCL BADSNAP FIXED(31) CONSTANT(44);               /*@YL026UK*/
*                                      /* UABORT MESSAGE FOR @YL026UK*/
*                                      /* UNSUCCESSFUL SNAP  @YL026UK*/
*                                                                  0699
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0699
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0700
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0701
         ST    @00,PARMPTR2                                        0701
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0702
*        OLDERID2 = NEWERID2;                                      0703
         L     @15,GDTTR2(,GDTPR)                                  0703
         MVC   @TS00001(95),NEWERID2(@15)                          0703
         MVC   OLDERID2(95,@15),@TS00001                           0703
*        NEWID2 = 'SASN';                                  /*@YL026UK*/
*                                                                  0704
         MVC   NEWID2(4,@15),@CC01879                              0704
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* MOVE DCB AND OPEN LISTS INTO DYNAMIC STORAGE AND OPEN    */
*        /* THE SNAP DCB FOR PROCESSING                      @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0705
*        DUMPDCB = DCBFORM;                                /*@YL026UK*/
         MVC   DUMPDCB(90),DCBFORM                                 0705
*        OPENLIST = OPENGEN;                               /*@YL026UK*/
         MVC   OPENLIST(4),OPENGEN                                 0706
*        OPENADDR = ADDR(DUMPDCB);                         /*@YL026UK*/
         LA    @15,DUMPDCB                                         0707
         STCM  @15,7,OPENADDR                                      0707
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/
*        REG1 = ADDR(OPENLIST);                            /*@YL026UK*/
         LA    REG1,OPENLIST                                       0709
*LOPEN2: GEN(OPEN  MF=(E,(REG1)));                         /*@YL026UK*/
LOPEN2   OPEN  MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/
*                                                                  0711
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* MOVE SNAP MACRO LIST INTO DYNAMIC STORAGE AND ISSUE THE  */
*        /* SNAP MACRO FOR A FULL REGION DUMP                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0712
*        SNAPLIST = SNAPGEN;                               /*@YL026UK*/
         MVC   SNAPLIST(20),SNAPGEN                                0712
*        SNAPPTR = ADDR(DUMPDCB);                          /*@YL026UK*/
         LA    @15,DUMPDCB                                         0713
         ST    @15,SNAPPTR                                         0713
*        SNAPIDEN = SNAPID;                                /*@YL026UK*/
         L     @01,PARMPTR2                                        0714
         LH    @15,SNAPID(,@01)                                    0714
         STC   @15,SNAPIDEN                                        0714
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/
*        REG1 = ADDR(SNAPLIST);                            /*@YL026UK*/
         LA    REG1,SNAPLIST                                       0716
*LSNAP2: GEN(SNAP  MF=(E,(REG1)));                         /*@YL026UK*/
LSNAP2   SNAP  MF=(E,(REG1))
*        RESPECIFY (REG15) RSTD;                           /*@YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    0719
*        TESTRC = RTNREG;                                          0720
         STH   RTNREG,TESTRC                                       0720
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/
*        RESPECIFY (REG15) UNRSTD;                         /*@YL026UK*/
*                                                                  0722
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CLOSE THE SNAP DCB                               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0723
*        SADCBACB = ADDR(DUMPDCB);                         /*@YL026UK*/
         LA    @00,DUMPDCB                                         0723
         ST    @00,SADCBACB                                        0723
*        BLOCKFLG = ON;                                    /*@YL026UK*/
         OI    BLOCKFLG,B'10000000'                                0724
*        REG1 = ADDR(SADCBACB);                            /*@YL026UK*/
         LA    REG1,SADCBACB                                       0725
*LCLOSE3:GEN(CLOSE MF=(E,(REG1)));                         /*@YL026UK*/
LCLOSE3  CLOSE MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/
*                                                                  0727
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK RETURN CODE FROM SNAP MACRO AND ABORT IF IT IS BAD */
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0728
*        IF TESTRC ^= 0                                            0728
*          THEN                                                    0728
*                                                                  0728
         LH    @15,TESTRC                                          0728
         LTR   @15,@15                                             0728
         BZ    @RF00728                                            0728
*            DO;                                                   0729
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0730
*              REG15 = BADSNAP;                                    0731
         LA    REG15,44                                            0731
*              REG14 = GDTABT;                                     0732
         L     REG14,GDTABT(,GDTPR)                                0732
*              REG13 = GDTABH;                                     0733
         L     REG13,GDTABH(,GDTPR)                                0733
*              GEN(BR    REG14);                                   0734
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0735
*            END;                              /*@YL026UK*/        0736
*                                                                  0736
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN TO THE USNAP CALLER                       @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0737
*        CALL IDCSAEP0(GDTTBL,MODID);                              0737
@RF00728 ST    GDTPR,@AL00001                                      0737
         LA    @15,MODID                                           0737
         ST    @15,@AL00001+4                                      0737
         MVI   @AL00001+4,X'80'                                    0737
         L     @15,GDTEPL(,GDTPR)                                  0737
         LA    @01,@AL00001                                        0737
         BALR  @14,@15                                             0737
*         /*@YL026UK*/                                             0738
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UPROMPT ENTRY POINT                              @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0738
*AMSSAPT:  ENTRY(GDTTBLX,PTTEXTPX,PTTEXTLX,PTREPLPX,               0738
*                PTREPLLX);                                /*@YL026UK*/
*                                                                  0738
@EC00738 DS    0H                                                  0739
*AMSSAPT1:                                                         0739
*                                                                  0739
*        DCL PTTEXTP PTR(31) BASED;    /* TEXT POINTER       @YL026UK*/
*                                                                  0739
AMSSAPT1 DS    0H                                                  0740
*        DCL PTTEXTL FIXED(15) BASED;  /* TEXT LENGTH        @YL026UK*/
*                                                                  0740
*        DCL PTREPLP PTR(31) BASED;    /* REPLY POINTER      @YL026UK*/
*                                                                  0741
*        DCL PTREPLL FIXED(15) BASED;  /* REPLY LENGTH       @YL026UK*/
*                                                                  0742
*        RESPECIFY PTTEXTP BASED(PARMPTR2);                /*@YL026UK*/
*                                      /* BASE TEXT POINTER  @YL026UK*/
*                                                                  0744
*        RESPECIFY PTTEXTL BASED(PARMPTR3);                /*@YL026UK*/
*                                      /* BASE TEXT LENGTH   @YL026UK*/
*                                                                  0745
*        RESPECIFY PTREPLP BASED(PARMPTR4);                /*@YL026UK*/
*                                      /* BASE REPLY POINTER @YL026UK*/
*                                                                  0746
*        RESPECIFY PTREPLL BASED(PARMPTR5);                /*@YL026UK*/
*                                      /* BASE REPLY LENGTH  @YL026UK*/
*                                                                  0747
*        DCL INVMSG FIXED(31) CONSTANT(48);                /*@YL026UK*/
*                                      /* UABORT CODE FOR    @YL026UK*/
*                                      /* INVALID LENGTH     @YL026UK*/
*                                      /* UPROMPT MESSAGE    @YL026UK*/
*                                                                  0748
*        /* PUTGET LINE BUFFER                               @YL026UK*/
*        DCL 1 PGLB CHAR(76) BDY(WORD),                            0748
*              2 PGLNG FIXED(15),      /* LENGTH VALUE       @YL026UK*/
*              2 PGOFF FIXED(15),      /* OFFSET VALUE       @YL026UK*/
*              2 PGLINE CHAR(72);      /* TEXT LINE          @YL026UK*/
*                                                                  0748
*        /* UPROMPT MESSAGE TEXT                             @YL026UK*/
*        DCL UPMSG CHAR(72) BASED(PTTEXTP);                /*@YL026UK*/
*                                                                  0749
*        /* PUTGET PARAMETER BLOCK                           @YL026UK*/
*        DCL 1 PUTGETPB CHAR(16) BDY(WORD),                        0750
*              2 PGFLG1 CHAR(4),       /* FLAGS              @YL026UK*/
*              2 PGOLD PTR(31),        /* ADDRESS OF OUTPUT  @YL026UK*/
*                                      /* LINE DESCRIPTOR    @YL026UK*/
*              2 PGFLG2 CHAR(4),       /* FLAGS              @YL026UK*/
*              2 PGINBUF PTR(31);      /* ADDR OF INPUT      @YL026UK*/
*                                      /* BUFFER             @YL026UK*/
*                                                                  0751
*        DCL LIST5 GENERATED LABEL;    /* PUTGET MACRO LIST  @YL026UK*/
*                                      /* LABEL              @YL026UK*/
*                                                                  0752
*        /* GENERATED LIST FORM OF PUTGET MACRO              @YL026UK*/
*        DCL PGLIST CHAR(16) DEFINED(LIST5);               /*@YL026UK*/
*                                                                  0752
*        /* TSO INPUT OUTPUT PARAMETER LIST                  @YL026UK*/
*        DCL 1 TSOIOPL CHAR(16) BDY(WORD),                         0753
*              2 TSOUPT PTR(31),       /* ADDR OF USER       @YL026UK*/
*                                      /* PROFILE TABLE      @YL026UK*/
*              2 TSOECT PTR(31),       /* ADDR OF ENVIRON-   @YL026UK*/
*                                      /* MENT CONTROL TBL   @YL026UK*/
*              2 TSOECB PTR(31),       /* ADDR OF EVENT      @YL026UK*/
*                                      /* CONTROL BLOCK      @YL026UK*/
*              2 TSOPGPB PTR(31);      /* ADDR OF PUTGET     @YL026UK*/
*                                      /* PARAMETER BLOCK    @YL026UK*/
*                                                                  0754
*        /* TSO COMMAND PROCESSOR EVENT CONTROL BLOCK        @YL026UK*/
*        DCL CPECB FIXED(31);                              /*@YL026UK*/
*                                                                  0754
*        /* LENGTH OF REPLY TEXT INCLUDING HEADER WORD       @YL026UK*/
*        DCL INBUFLN FIXED(15) BASED(PGINBUF);             /*@YL026UK*/
*                                                                  0755
*        /* TSO OUTPUT LINE DESCRIPTOR                       @YL026UK*/
*        DCL 1 TSOOLD CHAR(8) BDY(WORD),                           0756
*              2 TSOSEGNO FIXED(31),   /* NUMBER OF SEGMENTS @YL026UK*/
*              2 TSOSEGAD PTR(31);     /* ADDR OF SEGMENT    @YL026UK*/
*                                                                  0756
*        /* STID NUMBER FOR PUTGET ERROR CODE                @YL026UK*/
*        DCL PGSTID FIXED(8) CONSTANT(12);                 /*@YL026UK*/
*                                                                  0757
*        /* PUTGET PROFILE NOPROMPT RETURN CODE              @Y30SSMK*/
*        DCL PGNOPRC FIXED(8) CONSTANT(12);                /*@Y30SSMK*/
*                                                                  0758
*        /* UPROMPT PROFILE NOPROMPT RETURN CODE             @Y30SSMK*/
*        DCL UPNOPRC FIXED(8) CONSTANT(8);                 /*@Y30SSMK*/
*                                                                  0759
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0760
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/
*        GDTPR = ADDR1;                                    /*#YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0761
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0762
         ST    @00,PARMPTR2                                        0762
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0763
         ST    @00,PARMPTR3                                        0763
*        PARMPTR4 = ADDR4;                                 /*#YL026UK*/
         L     @00,ADDR4+12(,REG1PTR)                              0764
         ST    @00,PARMPTR4                                        0764
*        PARMPTR5 = ADDR5;                                 /*#YL026UK*/
         L     @00,ADDR5+16(,REG1PTR)                              0765
         ST    @00,PARMPTR5                                        0765
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/
*                                                                  0766
*        OLDERID2 = NEWERID2;                                      0767
         L     @15,GDTTR2(,GDTPR)                                  0767
         MVC   @TS00001(95),NEWERID2(@15)                          0767
         MVC   OLDERID2(95,@15),@TS00001                           0767
*        NEWID2 = 'SAPT';                                  /*#YL026UK*/
*                                                                  0768
         MVC   NEWID2(4,@15),@CC01938                              0768
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  #YL026UK*/
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           #YL026UK*/
*        /* ENVIRONMENT CONTROL TABLE                        #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0769
*        IF GDTECT = 0                                             0769
*          THEN                                                    0769
*                                                                  0769
         L     @15,GDTECT(,GDTPR)                                  0769
         LTR   @15,@15                                             0769
         BNZ   @RF00769                                            0769
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* AMS WAS NOT INVOKED VIA TSO--CALL PROCEDURE  #YL026UK*/
*            /* NOSUPP TO PRINT OUT ERROR MESSAGE, SET       #YL026UK*/
*            /* RETURN CODE, AND RETURN TO CALLER            #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  0770
*            DO;                                           /*#YL026UK*/
*              CALL NOSUPP;                                /*#YL026UK*/
         BAL   @14,NOSUPP                                          0771
*              SETRC = 4;                                  /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   0772
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0773
         ST    GDTPR,@AL00001                                      0773
         LA    @15,MODID                                           0773
         ST    @15,@AL00001+4                                      0773
         LA    @15,SETRC                                           0773
         ST    @15,@AL00001+8                                      0773
         MVI   @AL00001+8,X'80'                                    0773
         L     @15,GDTEPL(,GDTPR)                                  0773
         LA    @01,@AL00001                                        0773
         BALR  @14,@15                                             0773
*        /*#YL026UK*/                                              0774
*            END;                                          /*#YL026UK*/
*                                                                  0774
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK FOR AN INVALID LENGTH UPROMPT MESSAGE AND  #YL026UK*/
*        /* UABORT IF LENGTH IS INVALID                      #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0775
*        IF PTTEXTL < 1  PTTEXTL > 72                             0775
*          THEN                                                    0775
*                                                                  0775
@RF00769 L     @01,PARMPTR3                                        0775
         LH    @15,PTTEXTL(,@01)                                   0775
         LTR   @15,@15                                             0775
         BNP   @RT00775                                            0775
         C     @15,@CF01916                                        0775
         BNH   @RF00775                                            0775
@RT00775 DS    0H                                                  0776
*            DO;                                                   0776
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0777
*              REG15 = INVMSG;                                     0778
         LA    REG15,48                                            0778
*              REG14 = GDTABT;                                     0779
         L     REG14,GDTABT(,GDTPR)                                0779
*              REG13 = GDTABH;                                     0780
         L     REG13,GDTABH(,GDTPR)                                0780
*              GEN(BR    REG14);                                   0781
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0782
*            END;                               /*#YL026UK*/       0783
*                                                                  0783
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* MOVE THE UPROMPT MESSAGE TEXT INTO THE PUTGET    #YL026UK*/
*        /* LINE BUFFER AND INITIALIZE THE HEADER WORD OF    #YL026UK*/
*        /* THIS BUFFER                                      #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0784
*        PGLINE(1:PTTEXTL) = UPMSG(1:PTTEXTL);             /*#YL026UK*/
@RF00775 L     @01,PARMPTR3                                        0784
         LH    @15,PTTEXTL(,@01)                                   0784
         LR    @14,@15                                             0784
         BCTR  @14,0                                               0784
         L     @01,PARMPTR2                                        0784
         L     @01,PTTEXTP(,@01)                                   0784
         EX    @14,@SM02462                                        0784
*        PGOFF = 0;                                        /*#YL026UK*/
         SLR   @14,@14                                             0785
         STH   @14,PGOFF                                           0785
*        PGLNG = PTTEXTL + 4;                              /*#YL026UK*/
*                                                                  0786
         LA    @15,4(,@15)                                         0786
         STH   @15,PGLNG                                           0786
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* MOVE PUTGET MACRO LIST INTO DYNAMIC STORAGE      #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0787
*        PUTGETPB = PGLIST;                                /*#YL026UK*/
*                                                                  0787
         MVC   PUTGETPB(16),PGLIST                                 0787
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* INITIALIZE THE EVENT CONTROL BLOCK TO ZERO AND   #YL026UK*/
*        /* INITIALIZE THE TSO INPUT OUTPUT PARAMETER LIST   #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0788
*        CPECB = 0;                                        /*#YL026UK*/
         ST    @14,CPECB                                           0788
*        TSOUPT = GDTUPT;                                  /*#YL026UK*/
         L     @15,GDTUPT(,GDTPR)                                  0789
         ST    @15,TSOUPT                                          0789
*        TSOECT = GDTECT;                                  /*#YL026UK*/
         L     @15,GDTECT(,GDTPR)                                  0790
         ST    @15,TSOECT                                          0790
*        TSOECB = ADDR(CPECB);                             /*#YL026UK*/
         LA    @15,CPECB                                           0791
         ST    @15,TSOECB                                          0791
*        TSOPGPB = ADDR(PUTGETPB);                         /*#YL026UK*/
*                                                                  0792
         LA    @15,PUTGETPB                                        0792
         ST    @15,TSOPGPB                                         0792
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* INITIALIZE THE TSO OUTPUT LINE DESCRIPTOR        #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0793
*        TSOSEGNO = 1;                                     /*#YL026UK*/
         MVC   TSOSEGNO(4),@CF00215                                0793
*        TSOSEGAD = ADDR(PGLB);                            /*#YL026UK*/
*                                                                  0794
         LA    @15,PGLB                                            0794
         ST    @15,TSOSEGAD                                        0794
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* ISSUE EXECUTE FORM OF THE TSO PUTGET MACRO       #YL026UK*/
*        /* WHERE:                                           #YL026UK*/
*        /* TSOOLD - OUTPUT ADDRESS                          #YL026UK*/
*        /* SINGLE - SINGLE LEVEL OUTPUT MESSAGE             #YL026UK*/
*        /* PROMPT - THE OUTPUT MESSAGE IS A PROMPT MESSAGE  #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0795
*LPUTG1: GEN(PUTGET OUTPUT=(TSOOLD,SINGLE,PROMPT),MF=(E,TSOIOPL)); 0795
*                                                                  0795
LPUTG1   PUTGET OUTPUT=(TSOOLD,SINGLE,PROMPT),MF=(E,TSOIOPL)
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK RETURN CODE FROM PUTGET MACRO              #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0796
*        RESPECIFY (RTNREG) RSTD;                          /*#YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    0797
*        TESTRC = RTNREG;                                          0798
         STH   RTNREG,TESTRC                                       0798
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/
*        RESPECIFY (RTNREG) UNRSTD;                        /*#YL026UK*/
*                                                                  0800
*        IF (TESTRC ^= 0  &  TESTRC ^= PGNOPRC)                    0801
*          THEN                                                    0801
*                                                                  0801
         LH    @15,TESTRC                                          0801
         LTR   @15,@15                                             0801
         BZ    @RF00801                                            0801
         C     @15,@CF00034                                        0801
         BE    @RF00801                                            0801
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* BAD RETURN CODE FROM PUTGET--PRINT ERROR     #YL026UK*/
*            /* MESSAGE AND SET RETURN CODE TO 4             #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  0802
*            DO;                                           /*#YL026UK*/
*              DDSTRU = ADDR(MSGAREA);                     /*#YL026UK*/
         LA    @15,MSGAREA                                         0803
         ST    @15,DDSTRU                                          0803
*              DARGLIST = '0'B;                            /*#YL026UK*/
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0804
         MVI   DARGLIST(@15),B'00000000'                           0804
*              DARGSMOD = RI1MOD;                          /*#YL026UK*/
         MVC   DARGSMOD(3,@15),@CC01350                            0805
*              DARGSENT = PGSTID;                          /*#YL026UK*/
         MVI   DARGSENT(@15),X'0C'                                 0806
*              DARGDBP = ADDR(TESTRC);                     /*#YL026UK*/
         LA    @14,TESTRC                                          0807
         ST    @14,DARGDBP(,@15)                                   0807
*              DARGILP = 2;                                /*#YL026UK*/
*                                                                  0808
         MVC   DARGILP(2,@15),@CH00149                             0808
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*#YL026UK*/
*                                                                  0809
         ST    GDTPR,@AL00001                                      0809
         LA    @15,@CF00111                                        0809
         ST    @15,@AL00001+4                                      0809
         LA    @15,DDSTRU                                          0809
         ST    @15,@AL00001+8                                      0809
         MVI   @AL00001+8,X'80'                                    0809
         L     @15,GDTPRT(,GDTPR)                                  0809
         LA    @01,@AL00001                                        0809
         BALR  @14,@15                                             0809
*              SETRC = 4;                                  /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   0810
*            END;                                          /*#YL026UK*/
*          ELSE                                                    0812
*                                                                  0812
*            /********************************************************/
*            /*                                              @Y30SSMK*/
*            /* A RETURN CODE 12 INDICATES A PROFILE         @Y30SSMK*/
*            /* NOPROMPT WAS REQUESTED.  SET THE RETURN CODE @Y30SSMK*/
*            /* TO 8.                                        @Y30SSMK*/
*            /*                                              @Y30SSMK*/
*            /********************************************************/
*                                                                  0812
*            IF TESTRC = PGNOPRC                                   0812
*              THEN                                                0812
         B     @RC00801                                            0812
@RF00801 CLC   TESTRC(2),@CH00034                                  0812
         BNE   @RF00812                                            0812
*                SETRC = UPNOPRC;                          /*@Y30SSMK*/
         MVC   SETRC(2),@CH00175                                   0813
*              ELSE                                                0814
*                                                                  0814
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* GOOD RETURN CODE FROM PUTGET MACRO.      #YL026UK*/
*                /* RETURN THE ADDRESS OF THE REPLY TEXT     #YL026UK*/
*                /* (INCLUDING THE HEADER WORD), RETURN THE  #YL026UK*/
*                /* LENGTH OF THE REPLY TEXT (NOT INCLUDING  #YL026UK*/
*                /* THE HEADER WORD), AND SET RETURN CODE    #YL026UK*/
*                /* TO 0.                                    @Y30SSMK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  0814
*                DO;                                       /*#YL026UK*/
         B     @RC00812                                            0814
@RF00812 DS    0H                                                  0815
*                  SETRC = 0;                              /*#YL026UK*/
         SLR   @15,@15                                             0815
         STH   @15,SETRC                                           0815
*                  PTREPLP = PGINBUF;                      /*#YL026UK*/
         L     @15,PGINBUF                                         0816
         L     @14,PARMPTR4                                        0816
         ST    @15,PTREPLP(,@14)                                   0816
*                  PTREPLL = INBUFLN - 4;                  /*#YL026UK*/
         LH    @15,INBUFLN(,@15)                                   0817
         SL    @15,@CF00038                                        0817
         L     @14,PARMPTR5                                        0817
         STH   @15,PTREPLL(,@14)                                   0817
*                END;                                      /*#YL026UK*/
*                                                                  0818
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* RETURN CONTROL TO THE UPROMPT CALLER             #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  0819
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0819
@RC00812 DS    0H                                                  0819
@RC00801 ST    GDTPR,@AL00001                                      0819
         LA    @15,MODID                                           0819
         ST    @15,@AL00001+4                                      0819
         LA    @15,SETRC                                           0819
         ST    @15,@AL00001+8                                      0819
         MVI   @AL00001+8,X'80'                                    0819
         L     @15,GDTEPL(,GDTPR)                                  0819
         LA    @01,@AL00001                                        0819
         BALR  @14,@15                                             0819
*        /*#YL026UK*/                                              0820
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* UID ENTRY POINT                                  #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0820
*AMSSAID:  ENTRY(GDTTBLX,USERIDX,USERIDLX);                /*#YL026UK*/
*                                                                  0820
@EC00820 DS    0H                                                  0821
*AMSSAID1:                                                         0821
*                                                                  0821
*        DCL USERID CHAR(7) BASED;     /* USERID FIELD       #YL026UK*/
*                                                                  0821
AMSSAID1 DS    0H                                                  0822
*        DCL USERIDL FIXED(15) BASED;  /* USERID LENGTH      #YL026UK*/
*                                                                  0822
*        RESPECIFY USERID BASED(PARMPTR2);                 /*#YL026UK*/
*                                      /* BASE USERID FIELD  #YL026UK*/
*                                                                  0824
*        RESPECIFY USERIDL BASED(PARMPTR3);                /*#YL026UK*/
*                                      /* BASE USERID LENGTH #YL026UK*/
*                                                                  0825
*        DCL UPTPTR PTR(31);           /* PTR TO TSO UPT     #Y30LSMK*/
*                                                                  0825
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* STRUCTURE FOR ADDRESSING IN THE TSO USER PROFILE @YL026UK*/
*        /* TABLE                                            @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0826
* /* *************************************************************** */
* /* THE USER PROFILE TABLE (UPT) IS BUILT BY THE LOGON/LOGOFF       */
* /* SCHEDULER FROM INFORMATION STORED IN THE UADS AND FROM THE      */
* /* LOGON COMMAND.  IT IS IN CORE SHARED BY THE TMP AND THE         */
* /* LOGON/LOGOFF SCHEDULER.  CP'S AND SERVICE ROUTINES CAN MODIFY   */
* /* THE UPT, BUT THEY CANNOT FREE IT.                               */
* /* *************************************************************** */
* DECLARE                                                          0826
*   1 UPT BASED(UPTPTR),                                           0826
*    2 *        CHAR(2) BDY(WORD),   /* RESERVED                     */
*    2 UPTUSER  CHAR(10),            /* RESERVED FOR INSTALLATION    */
*    2 UPTSWS   CHAR(1),             /* USERS ENVIRONMENT SWITCHES   */
*     3 UPTRCVR  BIT(1),             /* EDIT RECOVER OPTION IS     0826
*                                       REQUESTED DEFAULT    @Z40NQKG*/
*     3 UPTNPRM  BIT(1),             /* NO PROMPTING TO BE DONE      */
*     3 UPTMID   BIT(1),             /* PRINT MESSAGE IDENTIFIERS    */
*     3 UPTNCOM  BIT(1),             /* NO USER COMMUNICATION      0826
*                                       ALLOWED VIA SEND COMMAND     */
*     3 UPTPAUS  BIT(1),             /* PAUSE FOR '?' WHEN IN NON- 0826
*                                       INTERACTIVE MODE             */
*     3 UPTALD   BIT(1),             /* ATTN HAS BEEN SPECIFIED AS 0826
*                                       THE LINE DELETE CHARACTER    */
*     3 UPTMODE  BIT(1),             /* MODE MESSAGES DESIRED  Y01676*/
*     3 UPTWTP   BIT(1),             /* WRITE TO PROGRAMMER    Y02669*/
*                                    /* MSGS ARE TO BE PUT OUT Y02669*/
*    2 UPTCDEL  CHAR(1),             /* CHAR DELETE CHARACTER        */
*    2 UPTLDEL  CHAR(1),             /* LINE DELETE CHARACTER        */
*    2 *        CHAR(1),             /* RESERVED                     */
*    2 UPTPREFX CHAR(7),             /* DSNAME PREFIX          Y02669*/
*    2 UPTPREFL PTR(8);              /* DSNAME PREFIX LENGTH   Y02669*/
*                                                                  0826
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0827
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0828
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         LA    @15,4                                               0829
         LR    @14,REG1PTR                                         0829
         ALR   @14,@15                                             0829
         L     @00,ADDR2(,@14)                                     0829
         ST    @00,PARMPTR2                                        0829
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @14,ADDR3+8(,REG1PTR)                               0830
         ST    @14,PARMPTR3                                        0830
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0831
*        OLDERID2 = NEWERID2;                                      0832
         L     @01,GDTTR2(,GDTPR)                                  0832
         MVC   @TS00001(95),NEWERID2(@01)                          0832
         MVC   OLDERID2(95,@01),@TS00001                           0832
*        NEWID2 = 'SAID';                                  /*@YL026UK*/
*                                                                  0833
         MVC   NEWID2(4,@01),@CC01975                              0833
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  @YL026UK*/
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           @YL026UK*/
*        /* ENVIRONMENT CONTROL TABLE                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0834
*        IF GDTECT = 0                                             0834
*          THEN                                                    0834
*                                                                  0834
         SLR   @01,@01                                             0834
         C     @01,GDTECT(,GDTPR)                                  0834
         BNE   @RF00834                                            0834
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* AMS WAS NOT INVOKED VIA TSO--BLANK USERID  @YL026UK  */
*            /* FIELD, SET USERID LENGTH TO ZERO, SET RETURN @YL026UK*/
*            /* CODE TO FOUR, AND RETURN TO THE CALLER       @YL026UK*/
*            /*                                              @YL026UK*/
*            /******************************************************/
*                                                                  0835
*            DO;                                           /*@YL026UK*/
*              USERID = ' ';                               /*@YL026UK*/
         LR    @07,@00                                             0836
         MVI   USERID+1(@07),C' '                                  0836
         MVC   USERID+2(5,@07),USERID+1(@07)                       0836
         MVI   USERID(@07),C' '                                    0836
*              USERIDL = 0;                                /*@YL026UK*/
         STH   @01,USERIDL(,@14)                                   0837
*              SETRC = 4;                                  /*@YL026UK*/
         STH   @15,SETRC                                           0838
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0839
         ST    GDTPR,@AL00001                                      0839
         LA    @15,MODID                                           0839
         ST    @15,@AL00001+4                                      0839
         LA    @15,SETRC                                           0839
         ST    @15,@AL00001+8                                      0839
         MVI   @AL00001+8,X'80'                                    0839
         L     @15,GDTEPL(,GDTPR)                                  0839
         LA    @01,@AL00001                                        0839
         BALR  @14,@15                                             0839
*        /*@YL026UK*/                                              0840
*            END;                                          /*@YL026UK*/
*                                                                  0840
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* MOVE TSO USERID FIELD INTO VARIABLE USERID AND THE       */
*        /* LENGTH OF THE NON-BLANK PART OF THIS USERID INTO @YL026UK*/
*        /* THE VARIABLE USERIDL                             @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0841
*        UPTPTR = GDTUPT;                                  /*@YL026UK*/
@RF00834 L     @15,GDTUPT(,GDTPR)                                  0841
         ST    @15,UPTPTR                                          0841
*        USERID = UPTPREFX;                                /*@YL026UK*/
         L     @01,PARMPTR2                                        0842
         MVC   USERID(7,@01),UPTPREFX(@15)                         0842
*        USERIDL = UPTPREFL;                               /*@YL026UK*/
*                                                                  0843
         SLR   @14,@14                                             0843
         IC    @14,UPTPREFL(,@15)                                  0843
         L     @15,PARMPTR3                                        0843
         STH   @14,USERIDL(,@15)                                   0843
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* SET RETURN CODE AND RETURN TO THE UID CALLER     @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0844
*        SETRC = 0;                                        /*@YL026UK*/
         SLR   @15,@15                                             0844
         STH   @15,SETRC                                           0844
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0845
         ST    GDTPR,@AL00001                                      0845
         LA    @15,MODID                                           0845
         ST    @15,@AL00001+4                                      0845
         LA    @15,SETRC                                           0845
         ST    @15,@AL00001+8                                      0845
         MVI   @AL00001+8,X'80'                                    0845
         L     @15,GDTEPL(,GDTPR)                                  0845
         LA    @01,@AL00001                                        0845
         BALR  @14,@15                                             0845
*       /*@YL026UK*/                                               0846
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UQUAL ENTRY POINT                                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0846
*AMSSAQL:  ENTRY(GDTTBLX,DSNPX,DSNSX,CATNPX,PWDPX);        /*@YL026UK*/
*                                                                  0846
@EC00846 DS    0H                                                  0847
*AMSSAQL1:                                                         0847
*                                                                  0847
*        DCL DSNS FIXED(15) BASED;     /* DSNAME SIZE        @YL026UK*/
*                                                                  0847
AMSSAQL1 DS    0H                                                  0848
*        DCL DSNP PTR(31) BASED;       /* DSNAME POINTER     @YL026UK*/
*                                                                  0848
*        DCL CATNP PTR(31) BASED;      /* CATALOG NAME PTR   @YL026UK*/
*                                                                  0849
*        DCL PWDP PTR(31) BASED;       /* PASSWORD           @YL026UK*/
*                                      /* POINTER            @YL026UK*/
*                                                                  0851
*        RESPECIFY DSNS BASED(PARMPTR3);                   /*@YL026UK*/
*                                      /* BASE DSNAME SIZE   @YL026UK*/
*                                                                  0852
*        RESPECIFY DSNP BASED(PARMPTR2);                   /*@YL026UK*/
*                                      /* BASE DSNAME PTR    @YL026UK*/
*                                                                  0853
*        RESPECIFY CATNP BASED(PARMPTR4);                  /*@YL026UK*/
*                                      /* BASE CATALOG NAME  @YL026UK*/
*                                      /* PTR                @YL026UK*/
*                                                                  0854
*        RESPECIFY PWDP BASED(PARMPTR5);                   /*@YL026UK*/
*                                      /* BASE               @YL026UK*/
*                                      /* PASSWORD PTR       @YL026UK*/
*                                                                  0855
*         /* DATA SET NAME BUFFER                            @YL026UK*/
*        DCL 1 DSNBUF CHAR(46) BDY(WORD),                          0855
*              2 DSNLEN FIXED(15),     /* DSNAME LENGTH      @YL026UK*/
*              2 DSNFLD CHAR(44);      /* DSNAME             @YL026UK*/
*                                                                  0855
*        /* UNQUALIFIED DATA SET NAME ON INPUT--QUALIFIED    @YL026UK*/
*        /* DATA SET NAME ON OUTPUT                          @YL026UK*/
*        DCL UNDSN CHAR(44) BASED(DSNP);                   /*@YL026UK*/
*                                                                  0856
*        /* TSO DEFAULT PARAMETER BLOCK                      @YL026UK*/
*        DCL 1 TSODFPB CHAR(20) BDY(WORD),                         0857
*              2 TSOENTRY CHAR(1),     /* ENTRY CODE         @YL026UK*/
*              2 TSOBUF PTR(24),       /* ADDR OF DATA SET   @YL026UK*/
*                                      /* NAME BUFFER        @YL026UK*/
*              2 TSOCONT CHAR(1),      /* CONTROL CODE       @YL026UK*/
*              2 TSOPROT PTR(24),      /* ADDR OF PROTECTED  @YL026UK*/
*                                      /* STEP CONTROL BLOCK @YL026UK*/
*              2 TSOLOC FIXED(8),      /* LOCATE RETURN CODE @YL026UK*/
*              2 TSODEQ PTR(24),       /* DEFAULT QUALIFIER  @YL026UK*/
*              2 TSOCAT PTR(31),       /* ADDR CATALOG DSN   @YL026UK*/
*              2 TSOPSD PTR(31);       /* ADDR CAT PASSWORD  @YL026UK*/
*                                                                  0857
*        /* TSO DEFAULT PARAMETER LIST                       @YL026UK*/
*        DCL 1 TSODFPL CHAR(16) BDY(WORD),                         0858
*              2 TSOUSE PTR(31),       /* ADDR USER PROFILE  @YL026UK*/
*                                      /* TABLE              @YL026UK*/
*              2 TSOENV PTR(31),       /* ADDR ENVIRONMENT   @YL026UK*/
*                                      /* CONTROL TABLE      @YL026UK*/
*              2 TSOEVE PTR(31),       /* ADDR EVENT CONTROL @YL026UK*/
*                                      /* BLOCK              @YL026UK*/
*              2 TSODEF PTR(31);       /* ADDR DEFAULT       @YL026UK*/
*                                      /* PARAMETER BLOCK    @YL026UK*/
*                                                                  0859
*        /* EVENT CONTROL BLOCK                              @YL026UK*/
*        DCL ECBLOCK FIXED(31);                            /*@YL026UK*/
*                                                                  0859
*        /* DEFAULT SERVICE ROUTINE AND LOCATE RETURN CODES  @YL026UK*/
*        /* AREA FOR UPRINT                                  @YL026UK*/
*        DCL 1 DSRERR CHAR(4) BDY(WORD),                           0860
*              2 DSRRC FIXED(15),      /* DEFAULT SERVICE    @YL026UK*/
*                                      /* ROUTINE RETURN     @YL026UK*/
*                                      /* CODE               @YL026UK*/
*              2 DSRLC FIXED(15);      /* LOCATE RETURN CODE @YL026UK*/
*                                                                  0860
*        /* STID NUMBER FOR ERROR QUALIFYING MESSAGE         @YL026UK*/
*        DCL DSR1STID FIXED(8) CONSTANT(13);               /*@YL026UK*/
*                                                                  0861
*        /* STID NUMBER FOR DEFAULT ERROR CODES MESSAGE      @YL026UK*/
*        DCL DSR2STID FIXED(8) CONSTANT(14);               /*@YL026UK*/
*                                                                  0862
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0863
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0864
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0865
         ST    @00,PARMPTR2                                        0865
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               0866
         ST    @00,PARMPTR3                                        0866
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/
         L     @00,ADDR4+12(,REG1PTR)                              0867
         ST    @00,PARMPTR4                                        0867
*        PARMPTR5 = ADDR5;                                 /*@YL026UK*/
         L     @00,ADDR5+16(,REG1PTR)                              0868
         ST    @00,PARMPTR5                                        0868
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0869
*                                                                  0869
*                                                                  0870
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0870
*        GEN;                                                      0870
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0871
         LA    @15,1                                               0871
         STC   @15,LISTLN                                          0871
@DL00871 L     @14,LISTSCAN                                        0871
         TM    LISTTEST(@14),B'10000000'                           0871
         BNZ   @DC00871                                            0871
*          LISTSCAN = LISTSCAN + 4;                                0872
         AL    @14,@CF00038                                        0872
         ST    @14,LISTSCAN                                        0872
*        END;                                                      0873
*                                                                  0873
         AL    @15,@CF00215                                        0873
         STC   @15,LISTLN                                          0873
         C     @15,@CF01724                                        0873
         BNH   @DL00871                                            0873
@DC00871 DS    0H                                                  0874
*        OLDERID2 = NEWERID2;                                      0874
         L     @15,GDTTR2(,GDTPR)                                  0874
         MVC   @TS00001(95),NEWERID2(@15)                          0874
         MVC   OLDERID2(95,@15),@TS00001                           0874
*        NEWID2 = 'SAQL';                                  /*@YL026UK*/
*                                                                  0875
         MVC   NEWID2(4,@15),@CC02025                              0875
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  @YL026UK*/
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           @YL026UK*/
*        /* ENVIRONMENT CONTROL TABLE                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0876
*        IF GDTECT = 0                                             0876
*          THEN                                                    0876
*                                                                  0876
         L     @15,GDTECT(,GDTPR)                                  0876
         LTR   @15,@15                                             0876
         BNZ   @RF00876                                            0876
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* AMS WAS NOT INVOKED VIA TSO--CALL PROCEDURE  @YL026UK*/
*            /* NOSUPP TO PRINT OUT ERROR MESSAGE, SET       @YL026UK*/
*            /* RETURN CODE, AND RETURN TO THE CALLER        @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0877
*            DO;                                           /*@YL026UK*/
*              CALL NOSUPP;                                /*@YL026UK*/
         BAL   @14,NOSUPP                                          0878
*              SETRC = 4;                                  /*@YL026UK*/
         MVC   SETRC(2),@CH00038                                   0879
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0880
         ST    GDTPR,@AL00001                                      0880
         LA    @15,MODID                                           0880
         ST    @15,@AL00001+4                                      0880
         LA    @15,SETRC                                           0880
         ST    @15,@AL00001+8                                      0880
         MVI   @AL00001+8,X'80'                                    0880
         L     @15,GDTEPL(,GDTPR)                                  0880
         LA    @01,@AL00001                                        0880
         BALR  @14,@15                                             0880
*        /*@YL026UK*/                                              0881
*            END;                                          /*@YL026UK*/
*                                                                  0881
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CONSTRUCT PARTIALLY QUALIFIED DATA SET NAME      @YL026UK*/
*        /* BUFFER                                           @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0882
*        DSNFLD (1:44) = UNDSN (1:44);                     /*@YL026UK*/
@RF00876 L     @01,PARMPTR2                                        0882
         L     @01,DSNP(,@01)                                      0882
         MVC   DSNFLD(44),UNDSN(@01)                               0882
*        DSNLEN = DSNS;                                    /*@YL026UK*/
*                                                                  0883
         L     @01,PARMPTR3                                        0883
         LH    @15,DSNS(,@01)                                      0883
         STH   @15,DSNLEN                                          0883
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* INITIALIZE THE TSO DEFAULT PARAMETER BLOCK       @YL026UK*/
*        /* INCLUDING THE ADDRESS OF A CATALOG DSNAME        @YL026UK*/
*        /* IF SPECIFIED, AND THE ADDRESS OF A CATALOG       @YL026UK*/
*        /* PASSWORD IF SPECIFIED.  THE TSO ENTRY CODE       @YL026UK*/
*        /* REQUESTS FINDING A QUALIFIER.  IF MORE THAN ONE  @YL026UK*/
*        /* EXISTS, PROMPT THE TERMINAL USER TO CHOOSE ONE.  @YL026UK*/
*        /* NO TSO CONTROL CODE IS CODED.                    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0884
*        TSOENTRY = '84'X;                                 /*@YL026UK*/
         MVI   TSOENTRY,X'84'                                      0884
*        TSOBUF = ADDR(DSNBUF);                            /*@YL026UK*/
         LA    @15,DSNBUF                                          0885
         STCM  @15,7,TSOBUF                                        0885
*        TSOCONT = '00'X;                                  /*@YL026UK*/
         MVI   TSOCONT,X'00'                                       0886
*        TSOPROT = GDTPSB;                                 /*@YL026UK*/
         MVC   TSOPROT(3),GDTPSB+1(GDTPR)                          0887
*        TSOLOC = '00'X;                                   /*@YL026UK*/
         MVI   TSOLOC,X'00'                                        0888
*        TSODEQ = 0;                                       /*@YL026UK*/
*                                                                  0889
         SLR   @15,@15                                             0889
         STCM  @15,7,TSODEQ                                        0889
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK WHETHER OR NOT THE ADDRESS OF A CATALOG    @YL026UK*/
*        /* DSNAME HAS BEEN SPECIFIED                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0890
*        IF LISTLN > 3                                             0890
*          THEN                                                    0890
*                                                                  0890
         CLI   LISTLN,3                                            0890
         BNH   @RF00890                                            0890
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* THE ADDRESS OF A CATALOG DSNAME HAS BEEN     @YL026UK*/
*            /* SPECIFIED                                    @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0891
*            DO;                                           /*@YL026UK*/
*              TSOCAT = CATNP;                             /*@YL026UK*/
*                                                                  0892
         L     @01,PARMPTR4                                        0892
         L     @15,CATNP(,@01)                                     0892
         ST    @15,TSOCAT                                          0892
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* CHECK WHETHER OR NOT THE ADDRESS OF A      @YL026UK*/
*              /* PASSWORD HAS BEEN SPECIFIED.               @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  0893
*              IF LISTLN > 4                                       0893
*                THEN                                              0893
*                                                                  0893
         CLI   LISTLN,4                                            0893
         BNH   @RF00893                                            0893
*                  /**************************************************/
*                  /*                                        @YL026UK*/
*                  /* THE ADDRESS OF A PASSWORD HAS          @YL026UK*/
*                  /* BEEN SPECIFIED.                        @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /**************************************************/
*                                                                  0894
*                  TSOPSD = PWDP;                          /*@YL026UK*/
*                                                                  0894
         L     @01,PARMPTR5                                        0894
         L     @15,PWDP(,@01)                                      0894
         ST    @15,TSOPSD                                          0894
*                ELSE                                              0895
*                                                                  0895
*                  /**************************************************/
*                  /*                                        @YL026UK*/
*                  /* THE ADDRESS OF A PASSWORD              @YL026UK*/
*                  /* HAS NOT BEEN SPECIFIED                 @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /**************************************************/
*                                                                  0895
*                  TSOPSD = 0;                             /*@YL026UK*/
         B     @RC00893                                            0895
@RF00893 SLR   @15,@15                                             0895
         ST    @15,TSOPSD                                          0895
*            END;                                          /*@YL026UK*/
*          ELSE                                                    0897
*                                                                  0897
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* THE ADDRESS OF A CATALOG DSNAME HAS NOT      @YL026UK*/
*            /* BEEN SPECIFIED--THEREFORE NO                 @YL026UK*/
*            /* PASSWORD EITHER                              @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0897
*            DO;                                           /*@YL026UK*/
         B     @RC00890                                            0897
@RF00890 DS    0H                                                  0898
*              TSOCAT = 0;                                 /*@YL026UK*/
         SLR   @15,@15                                             0898
         ST    @15,TSOCAT                                          0898
*              TSOPSD = 0;                                 /*@YL026UK*/
         ST    @15,TSOPSD                                          0899
*            END;                                          /*@YL026UK*/
*                                                                  0900
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* INITIALIZE THE EVENT CONTROL BLOCK TO ZERO AND   @YL026UK*/
*        /* INITIALIZE THE TSO DEFAULT PARAMETER LIST        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0901
*        ECBLOCK = 0;                                      /*@YL026UK*/
@RC00890 SLR   @15,@15                                             0901
         ST    @15,ECBLOCK                                         0901
*        TSOUSE = GDTUPT;                                  /*@YL026UK*/
         L     @14,GDTUPT(,GDTPR)                                  0902
         ST    @14,TSOUSE                                          0902
*        TSOENV = GDTECT;                                  /*@YL026UK*/
         L     @14,GDTECT(,GDTPR)                                  0903
         ST    @14,TSOENV                                          0903
*        TSOEVE = ADDR(ECBLOCK);                           /*@YL026UK*/
         LA    @14,ECBLOCK                                         0904
         ST    @14,TSOEVE                                          0904
*        TSODEF = ADDR(TSODFPB);                           /*@YL026UK*/
*                                                                  0905
         LA    @14,TSODFPB                                         0905
         ST    @14,TSODEF                                          0905
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* ISSUE CALLTSSR TO ENTRY POINT IKJDFLT            @Z40GSJG*/
*        /* (MODULE IKJEHDEF) WITH THE DEFAULT PARAMETER     @YL026UK*/
*        /* LIST PASSED AS AN ARGUMENT                       @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0906
*        DO; /*CALLTSSR EP(IKJEHDEF)MF(E,TSODFPL)*/                0906
*          RESPECIFY GPR01P RSTD;                                  0907
*          GPR01P = ADDR(TSODFPL);                                 0908
         LA    GPR01P,TSODFPL                                      0908
*          IF CVTEHDEF = 0                                         0909
*            THEN                                                  0909
         L     @14,CVTPTR                                          0909
         C     @15,CVTEHDEF(,@14)                                  0909
         BNE   @RF00909                                            0909
*              GEN(LINK EP=IKJEHDEF);                              0910
         LINK EP=IKJEHDEF
*            ELSE                                                  0911
*              CALL CVTEHDEF;                                      0911
         B     @RC00909                                            0911
@RF00909 L     @14,CVTPTR                                          0911
         L     @15,CVTEHDEF(,@14)                                  0911
         BALR  @14,@15                                             0911
*          RESPECIFY GPR01P UNRSTD;                                0912
@RC00909 DS    0H                                                  0913
*        END;              /*@Z40GSJG*/                            0913
*                                                                  0913
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK RETURN CODE FROM DEFAULT SERVICE ROUTINE   @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0914
*        RESPECIFY (RTNREG) RSTD;                          /*@YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    0915
*        TESTRC = RTNREG;                                          0916
         STH   RTNREG,TESTRC                                       0916
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/
*        RESPECIFY (RTNREG) UNRSTD;                        /*@YL026UK*/
*                                                                  0918
*        IF TESTRC ^= 0                                            0919
*          THEN                                                    0919
*                                                                  0919
         LH    @15,TESTRC                                          0919
         LTR   @15,@15                                             0919
         BZ    @RF00919                                            0919
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* BAD RETURN CODE FROM THE DEFAULT SERVICE     @YL026UK*/
*            /* ROUTINE--PRINT ERROR MESSAGES AND SET        @YL026UK*/
*            /* RETURN CODE TO 4                             @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0920
*            DO;                                           /*@YL026UK*/
*                                                                  0920
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* PRINT MESSAGE CONTAINING THE UNQUALIFIED   @YL026UK*/
*              /* DATA SET NAME                              @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  0921
*              DDSTRU = ADDR(MSGAREA);                     /*@YL026UK*/
         LA    @15,MSGAREA                                         0921
         ST    @15,DDSTRU                                          0921
*              DARGLIST = '0'B;                            /*@YL026UK*/
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0922
         MVI   DARGLIST(@15),B'00000000'                           0922
*              DARGSMOD = RI1MOD;                          /*@YL026UK*/
         MVC   DARGSMOD(3,@15),@CC01350                            0923
*              DARGSENT = DSR1STID;                        /*@YL026UK*/
         MVI   DARGSENT(@15),X'0D'                                 0924
*              DARGDBP = DSNP;                             /*@YL026UK*/
         L     @01,PARMPTR2                                        0925
         L     @14,DSNP(,@01)                                      0925
         ST    @14,DARGDBP(,@15)                                   0925
*              DARGILP = 44;                               /*@YL026UK*/
*                                                                  0926
         MVC   DARGILP(2,@15),@CH01652                             0926
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UK*/
*                                                                  0927
         ST    GDTPR,@AL00001                                      0927
         LA    @15,@CF00111                                        0927
         ST    @15,@AL00001+4                                      0927
         LA    @15,DDSTRU                                          0927
         ST    @15,@AL00001+8                                      0927
         MVI   @AL00001+8,X'80'                                    0927
         L     @15,GDTPRT(,GDTPR)                                  0927
         LA    @01,@AL00001                                        0927
         BALR  @14,@15                                             0927
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* PRINT MESSAGE CONTAINING THE DEFAULT       @YL026UK*/
*              /* SERVICE ROUTINE RETURN CODE AND THE LOCATE @YL026UK*/
*              /* RETURN CODE                                @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  0928
*              DSRRC = TESTRC;                             /*@YL026UK*/
         LH    @15,TESTRC                                          0928
         STH   @15,DSRRC                                           0928
*              DSRLC = TSOLOC;                             /*@YL026UK*/
         SLR   @15,@15                                             0929
         IC    @15,TSOLOC                                          0929
         STH   @15,DSRLC                                           0929
*              DDSTRU = ADDR(MSGAREA);                     /*@YL026UK*/
         LA    @15,MSGAREA                                         0930
         ST    @15,DDSTRU                                          0930
*              DARGLIST = '0'B;                            /*@YL026UK*/
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0931
         MVI   DARGLIST(@15),B'00000000'                           0931
*              DARGSMOD = RI1MOD;                          /*@YL026UK*/
         MVC   DARGSMOD(3,@15),@CC01350                            0932
*              DARGSENT = DSR2STID;                        /*@YL026UK*/
         MVI   DARGSENT(@15),X'0E'                                 0933
*              DARGDBP = ADDR(DSRERR);                     /*@YL026UK*/
         LA    @14,DSRERR                                          0934
         ST    @14,DARGDBP(,@15)                                   0934
*              DARGILP = 4;                                /*@YL026UK*/
*                                                                  0935
         MVC   DARGILP(2,@15),@CH00038                             0935
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UK*/
*                                                                  0936
         ST    GDTPR,@AL00001                                      0936
         LA    @15,@CF00111                                        0936
         ST    @15,@AL00001+4                                      0936
         LA    @15,DDSTRU                                          0936
         ST    @15,@AL00001+8                                      0936
         MVI   @AL00001+8,X'80'                                    0936
         L     @15,GDTPRT(,GDTPR)                                  0936
         LA    @01,@AL00001                                        0936
         BALR  @14,@15                                             0936
*              SETRC = 4;                                  /*@YL026UK*/
         MVC   SETRC(2),@CH00038                                   0937
*            END;                                          /*@YL026UK*/
*          ELSE                                                    0939
*                                                                  0939
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* GOOD RETURN CODE FROM THE DEFAULT SERVICE    @YL026UK*/
*            /* ROUTINE--RETURN THE LENGTH OF THE FULLY      @YL026UK*/
*            /* QUALIFIED DATA SET NAME, RETURN THE FULLY    @YL026UK*/
*            /* QUALIFIED DATA SET NAME, AND SET A RETURN    @YL026UK*/
*            /* CODE OF 0                                    @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  0939
*            DO;                                           /*@YL026UK*/
         B     @RC00919                                            0939
@RF00919 DS    0H                                                  0940
*              SETRC = 0;                                  /*@YL026UK*/
         SLR   @15,@15                                             0940
         STH   @15,SETRC                                           0940
*              DSNS = DSNLEN;                              /*@YL026UK*/
         LH    @15,DSNLEN                                          0941
         L     @14,PARMPTR3                                        0941
         STH   @15,DSNS(,@14)                                      0941
*              UNDSN(1:DSNLEN) = DSNFLD(1:DSNLEN);         /*@YL026UK*/
         L     @01,PARMPTR2                                        0942
         L     @01,DSNP(,@01)                                      0942
         BCTR  @15,0                                               0942
         EX    @15,@SM02464                                        0942
*            END;                                          /*@YL026UK*/
*                                                                  0943
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN CONTROL TO THE UQUAL CALLER               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0944
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0944
@RC00919 ST    GDTPR,@AL00001                                      0944
         LA    @15,MODID                                           0944
         ST    @15,@AL00001+4                                      0944
         LA    @15,SETRC                                           0944
         ST    @15,@AL00001+8                                      0944
         MVI   @AL00001+8,X'80'                                    0944
         L     @15,GDTEPL(,GDTPR)                                  0944
         LA    @01,@AL00001                                        0944
         BALR  @14,@15                                             0944
*        /*@YL026UK*/                                              0945
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UALLOC ENTRY POINT                               @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0945
*AMSSAAL:  ENTRY(GDTTBLX,ALLAGLX);                         /*@YL026UK*/
*                                                                  0945
@EC00945 DS    0H                                                  0946
*AMSSAAL1:                                                         0946
*                                                                  0946
*        RESPECIFY ALLAGL BASED(PARMPTR2);                 /*@YL026UK*/
AMSSAAL1 DS    0H                                                  0947
*                                      /* BASE ALLOCATION    @YL026UK*/
*                                      /* ARGUMENT LIST      @YL026UK*/
*                                                                  0947
*        /* VOLSER LIST ADDRESSED IN ALLAGL                  @YL026UK*/
*        DCL 1 AGLVOL BASED(ALLVLP),                               0947
*              2 VOLCNT FIXED(15),     /* NUMBER OF ENTRIES  @YL026UK*/
*              2 * (*) CHAR(8),        /* ENTRIES            @YL026UK*/
*                3 VOLLEN FIXED(15),   /* LENGTH OF VOLSER   @YL026UK*/
*                3 VOLVAL CHAR(6);     /* VOLSER             @YL026UK*/
*                                                                  0947
*        /* UNIT LIST ADDRESSED IN ALLAGL                    @YL026UK*/
*        DCL 1 AGLUNT BASED(ALLULP),                               0948
*              2 UNTCNT FIXED(15),     /* NUMBER OF ENTRIES  @YL026UK*/
*              2 * (*) CHAR(10),       /* ENTRIES            @YL026UK*/
*                3 UNTLEN FIXED(15),   /* LENGTH OF UNIT     @YL026UK*/
*                3 UNTVAL CHAR(8);     /* UNIT               @YL026UK*/
*                                                                  0948
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR UNIT            @YL026UK*/
*        /* DESCRIPTION                                      @YL026UK*/
*        DCL TEXTUNT CHAR(14) BDY(HWORD);                  /*@YL026UK*/
*                                                                  0949
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR VOLSER          @YL026UK*/
*        /* DESCRIPTION                                      @YL026UK*/
*        DCL TEXTVOL CHAR(12) BDY(HWORD);                  /*@YL026UK*/
*                                                                  0950
*        /* DDNAME TEXT UNIT POINTER FOR CONCATENATION       @YL026UK*/
*        DCL DDLISTPT PTR(31);                             /*@YL026UK*/
*                                                                  0951
*        /* DDNAME DYNAMIC ALLOCATION TEXT UNIT FOR          @YL026UK*/
*        /* CONCATENATION                                    @YL026UK*/
*        DCL 1 TEXTCON BASED(DDLISTPT),                            0952
*              2 CONKEY CHAR(2),       /* KEY                @YL026UK*/
*              2 CONNUM FIXED(15),     /* NO OF ENTRIES      @YL026UK*/
*              2 CONENT(*) CHAR(10),   /* ENTRIES            @YL026UK*/
*                3 CONLN FIXED(15),    /* ENTRY LENGTH       @YL026UK*/
*                3 CONDDN CHAR(8);     /* DDNAME ENTRY       @YL026UK*/
*                                                                  0952
*        /* DDNAME TEXT UNIT SIZE FOR CONCATENATION          @YL026UK*/
*        DCL DDLISTSZ FIXED(31);                           /*@YL026UK*/
*                                                                  0953
*        /* UABORT NO AVAILABLE SPACE MESSAGE                @YL026UK*/
*        DCL NOSPACE FIXED(31) CONSTANT (28);              /*@YL026UK*/
*                                                                  0954
*        /* PTR FOR MULTIPLE VOLSER TEXT UNIT                @YL026UK*/
*        DCL TEXTVOLP PTR(31);                             /*@YL026UK*/
*                                                                  0955
*        /* MULTIPLE VOLSER TEXT UNIT                        @YL026UK*/
*        DCL MTEXTVOL CHAR(*) BASED(TEXTVOLP);             /*@YL026UK*/
*                                                                  0956
*        /* MULTIPLE VOLSER TEXT UNIT SIZE                   @YL026UK*/
*        DCL TEXTVOLS FIXED(31);                           /*@YL026UK*/
*                                                                  0957
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR PERMANENT       @YL026UK*/
*        /* CONCATENATION ATTRIBUTE                          @YL026UK*/
*        DCL TEXTPER CHAR(4) BDY(HWORD);                   /*@YL026UK*/
*                                                                  0958
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR PRIVATE VOLUME  @Y30LSMK*/
*        /* USE ATTRIBUTE                                    @Y30LSMK*/
*        DCL TEXTPRI CHAR(4) BDY(HWORD);                   /*@Y30LSMK*/
*                                                                  0959
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR UNIT COUNT      @Y30LSMK*/
*        DCL TEXTUCNT CHAR(7) BDY(HWORD);                  /*@Y30LSMK*/
*                                                                  0960
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR VOLUME COUNT    @Y30LSMK*/
*        DCL TEXTVCNT CHAR(7) BDY(HWORD);                  /*@Y30LSMK*/
*                                                                  0961
*        DCL 1 UNTCOUNT FIXED(8),      /* UNIT COUNT         @Y30LSMK*/
*              2 UNITCNT CHAR(1);                          /*@Y30LSMK*/
*                                                                  0962
*        DCL 1 VOLCOUNT FIXED(8),      /* VOLUME COUNT       @Y30LSMK*/
*              2 VOLUMCNT CHAR(1);                         /*@Y30LSMK*/
*                                                                  0963
*        /* STID NUMBER FOR ERROR DURING DYNAMIC             @YL026UK*/
*        /* CONCATENATION                                    @YL026UK*/
*        DCL CONSTID FIXED(8) CONSTANT(31);                /*@YL026UK*/
*                                                                  0964
*        /* STID NUMBER FOR ERROR DURING ALLOCATION OF       @YL026UK*/
*        /* VOLUMES                                          @YL026UK*/
*        DCL VOLSTID FIXED(8) CONSTANT(30);                /*@YL026UK*/
*                                                                  0965
*        /* STID NUMBER FOR ERROR WHILE ALLOCATING DSNAME    @YL026UK*/
*        DCL DSNSTID FIXED(8) CONSTANT(27);                /*@YL026UK*/
*                                                                  0966
*        DCL I FIXED(15);              /* IDX IN UNIT LIST   @Y30LSMK*/
*                                                                  0967
*        DCL J FIXED(15);              /* IDX IN VOLUME LIST @Y30LSMK*/
*                                                                  0968
*        DCL S99TUFP PTR(31);          /* PTR TO MULT TEXT UNIT    0969
*                                                            @Y30LSMK*/
*        DCL BLANKDDN CHAR(8) CONSTANT('        ');        /*@Y30SSMK*/
*                                      /* BLANK OUT DDNAME   @Y30SSMK*/
*                                                                  0971
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0971
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               0972
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               0973
         ST    @00,PARMPTR2                                        0973
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  0974
*        OLDERID2 = NEWERID2;                                      0975
         L     @01,GDTTR2(,GDTPR)                                  0975
         MVC   @TS00001(95),NEWERID2(@01)                          0975
         MVC   OLDERID2(95,@01),@TS00001                           0975
*        NEWID2 = 'SAAL';                                  /*@YL026UK*/
         MVC   NEWID2(4,@01),@CC02079                              0976
*        ERRORTAB = ''B;                                   /*@Z40GSBF*/
*                                                                  0977
         XC    ERRORTAB(32),ERRORTAB                               0977
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK FOR CONDITION WHERE BOTH VOLUME MOUNT AND  @YL026UK*/
*        /* DATA SET ALLOCATION IS REQUESTED, OR WHERE       @YL026UK*/
*        /* NEITHER IS REQUESTED--UABORT IF EITHER CONDITION @YL026UK*/
*        /* IS DETECTED.                                     @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0978
*        IF (ALLOPTVL = OFF & ALLOPTDS = OFF)                     0978
*           (ALLOPTVL = ON & ALLOPTDS = ON)                        0978
*          THEN                                                    0978
*                                                                  0978
         LR    @01,@00                                             0978
         TM    ALLOPTVL(@01),B'11000000'                           0978
         BZ    @RT00978                                            0978
         L     @01,PARMPTR2                                        0978
         TM    ALLOPTVL(@01),B'11000000'                           0978
         BNO   @RF00978                                            0978
@RT00978 DS    0H                                                  0979
*            DO;                                                   0979
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0980
*              REG15 = ARGERR;                                     0981
         LA    REG15,40                                            0981
*              REG14 = GDTABT;                                     0982
         L     REG14,GDTABT(,GDTPR)                                0982
*              REG13 = GDTABH;                                     0983
         L     REG13,GDTABH(,GDTPR)                                0983
*              GEN(BR    REG14);                                   0984
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0985
*            END;                               /*@YL026UK*/       0986
*                                                                  0986
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* CHECK FOR CONDITION WERE A VOLUME MOUNT WAS      @Y30LSMK*/
*        /* REQUESTED WITH A VOLUME LIST COUNT LESS THAN     @Y30LSMK*/
*        /* THE UNIT LIST COUNT, OR UNIT COUNT LESS THAN     @Y30LSMK*/
*        /* UNIT LIST COUNT, OR VOLUME COUNT LESS THAN       @Y30LSMK*/
*        /* VOLUME LIST COUNT. -- UABORT IF ANY OF ABOVE     @Y30LSMK*/
*        /* CONDITIONS ARE MET.                              @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0987
*        IF ALLOPTVL = ON                                          0987
*          THEN                                                    0987
@RF00978 L     @15,PARMPTR2                                        0987
         TM    ALLOPTVL(@15),B'10000000'                           0987
         BNO   @RF00987                                            0987
*            IF ALLUNCNT ^= 0    ALLVLCNT ^= 0                    0988
*              THEN                                                0988
         CLI   ALLUNCNT(@15),0                                     0988
         BNE   @RT00988                                            0988
         CLI   ALLVLCNT(@15),0                                     0988
         BE    @RF00988                                            0988
@RT00988 DS    0H                                                  0989
*                IF VOLCNT < UNTCNT    ALLUNCNT < UNTCNT         0989
*                  ALLVLCNT < VOLCNT                               0989
*                  THEN                                            0989
*                                                                  0989
         L     @15,PARMPTR2                                        0989
         L     @01,ALLVLP(,@15)                                    0989
         LH    @14,VOLCNT(,@01)                                    0989
         L     @01,ALLULP(,@15)                                    0989
         LH    @07,UNTCNT(,@01)                                    0989
         CR    @14,@07                                             0989
         BL    @RT00989                                            0989
         SLR   @06,@06                                             0989
         IC    @06,ALLUNCNT(,@15)                                  0989
         CR    @07,@06                                             0989
         BH    @RT00989                                            0989
         SLR   @07,@07                                             0989
         IC    @07,ALLVLCNT(,@15)                                  0989
         CR    @14,@07                                             0989
         BNH   @RF00989                                            0989
@RT00989 DS    0H                                                  0990
*                    DO;                                           0990
*                      RESPECIFY(REG13,REG14,REG15) RSTD;          0991
*                      REG15 = ARGERR;                             0992
         LA    REG15,40                                            0992
*                      REG14 = GDTABT;                             0993
         L     REG14,GDTABT(,GDTPR)                                0993
*                      REG13 = GDTABH;                             0994
         L     REG13,GDTABH(,GDTPR)                                0994
*                      GEN(BR    REG14);                           0995
         BR    REG14
*                      RESPECIFY(REG13,REG14,REG15)UNRSTD;         0996
*                    END;                       /*@Y30LSMK*/       0997
*                                                                  0997
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* ZERO TEXT UNIT POINTER LIST AND REQUEST BLOCK    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  0998
*        TUPL = '00'X;                                     /*@YL026UK*/
@RF00989 DS    0H                                                  0998
@RF00988 DS    0H                                                  0998
@RF00987 XC    TUPL+1(31),TUPL+1                                   0998
         MVI   TUPL,X'00'                                          0998
*        S99RB = '00'X;                                    /*@YL026UK*/
         XC    S99RB+1(19),S99RB+1                                 0999
         MVI   S99RB,X'00'                                         0999
*        RESPECIFY S99TUPL BASED(ADDR(TUPL));              /*@YL026UK*/
*                                                                  1000
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK FOR TYPE REQUEST                           @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1001
*        IF ALLOPTVL = ON                                          1001
*          THEN                                                    1001
*                                                                  1001
         L     @15,PARMPTR2                                        1001
         TM    ALLOPTVL(@15),B'10000000'                           1001
         BNO   @RF01001                                            1001
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* REQUEST IS FOR VOLUME MOUNT                  @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  1002
*            DO;                                           /*@YL026UK*/
*                                                                  1002
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* BUILD DDNAME RETURN TEXT UNIT AND INSERT   @YL026UK*/
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    @YL026UK*/
*              /* UNIT POINTER LIST                          @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  1003
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*@YL026UK*/
*              S99TUKEY = DALRTDDN;                        /*@YL026UK*/
         LA    @14,TEXTDDN                                         1004
         MVC   S99TUKEY(2,@14),@CB01581                            1004
*              S99TUNUM = 1;                               /*@YL026UK*/
         LA    @07,1                                               1005
         STCM  @07,3,S99TUNUM(@14)                                 1005
*              S99TULNG = 8;                               /*@YL026UK*/
         MVC   S99TULNG(2,@14),@CH00175                            1006
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*@YL026UK*/
*                                                                  1007
         LA    @06,TUPL                                            1007
         ST    @14,S99TUPTR+4(,@06)                                1007
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* BUILD STATUS TEXT UNIT OF OLD AND INSERT   @YL026UK*/
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    @YL026UK*/
*              /* UNIT POINTER LIST                          @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  1008
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTSTS));    /*@YL026UK*/
*              S99TUKEY = DALSTATS;                        /*@YL026UK*/
         LA    @14,TEXTSTS                                         1009
         MVC   S99TUKEY(2,@14),@CB01419                            1009
*              S99TUNUM = 1;                               /*@YL026UK*/
         STCM  @07,3,S99TUNUM(@14)                                 1010
*              S99TULNG = 1;                               /*@YL026UK*/
         STCM  @07,3,S99TULNG(@14)                                 1011
*              S99TUPAR(1) = '01'X;                        /*@YL026UK*/
         MVI   S99TUPAR(@14),X'01'                                 1012
*              S99TUPTR(4) = ADDR(TEXTSTS);                /*@YL026UK*/
*                                                                  1013
         ST    @14,S99TUPTR+12(,@06)                               1013
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* BUILD DISPOSITION TEXT UNIT OF KEEP AND    @YL026UK*/
*              /* INSERT ITS ADDR IN CORRESPONDING ENTRY OF  @YL026UK*/
*              /* TEXT UNIT POINTER LIST                     @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  1014
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*@YL026UK*/
*              S99TUKEY = DALNDISP;                        /*@YL026UK*/
         LA    @14,TEXTDSP                                         1015
         MVC   S99TUKEY(2,@14),@CB01421                            1015
*              S99TUNUM = 1;                               /*@YL026UK*/
         STCM  @07,3,S99TUNUM(@14)                                 1016
*              S99TULNG = 1;                               /*@YL026UK*/
         STCM  @07,3,S99TULNG(@14)                                 1017
*              S99TUPAR(1) = '08'X;                        /*@YL026UK*/
         MVI   S99TUPAR(@14),X'08'                                 1018
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*@YL026UK*/
*                                                                  1019
         ST    @14,S99TUPTR+16(,@06)                               1019
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* IF REQUEST IS FOR THE PRIVATE VOLUME USE   @Y30LSMK*/
*              /* ATTRIBUTE, BUILD THE PRIVATE VOLUME TEXT   @Y30LSMK*/
*              /* UNIT AND INSERT ITS ADDR IN CORRESPONDING  @Y30LSMK*/
*              /* ENTRY IN TEXT UNIT POINTER LIST.           @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  1020
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTPRI));    /*@Y30LSMK*/
*              IF ALLOPTPV = ON                                    1021
*               THEN                                               1021
         TM    ALLOPTPV(@15),B'00100000'                           1021
         BNO   @RF01021                                            1021
*                 DO;                                      /*@Y30LSMK*/
*                   S99TUKEY = DALPRIVT;                   /*@Y30LSMK*/
         LA    @07,TEXTPRI                                         1023
         MVC   S99TUKEY(2,@07),@CB01445                            1023
*                   S99TUNUM = 0;                          /*@Y30LSMK*/
         SLR   @15,@15                                             1024
         STCM  @15,3,S99TUNUM(@07)                                 1024
*                   S99TUPTR(6) = ADDR(TEXTPRI);           /*@Y30LSMK*/
         ST    @07,S99TUPTR+20(,@06)                               1025
*                 END;                                     /*@Y30LSMK*/
*                                                                  1026
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* GET CORE FOR DDNAME DYNAMIC ALLOCATION     @YL026UK*/
*              /* TEXT UNIT FOR CONCATENATION IF MORE THAN   @YL026UK*/
*              /* ONE UNIT IS IN THE UNIT DESCRIPTOR LIST    @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  1027
*              IF UNTCNT > 1                                       1027
*                THEN                                              1027
*                                                                  1027
@RF01021 L     @01,PARMPTR2                                        1027
         L     @01,ALLULP(,@01)                                    1027
         LH    @15,UNTCNT(,@01)                                    1027
         C     @15,@CF00215                                        1027
         BNH   @RF01027                                            1027
*                  /**************************************************/
*                  /*                                        @YL026UK*/
*                  /* MORE THAN ONE UNIT IN THE UNIT         @YL026UK*/
*                  /* DESCRIPTOR LIST                        @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /**************************************************/
*                                                                  1028
*                  DO;                                     /*@YL026UK*/
*                    DDLISTSZ = (10 * UNTCNT) + 4;         /*@YL026UK*/
         MH    @15,@CH00033                                        1029
         AL    @15,@CF00038                                        1029
         ST    @15,DDLISTSZ                                        1029
*                    CALL IDCSAGS0(GDTTBL,DDLISTSZ,DDLISTPT);/*    1030
*                                                            @YL026UK*/
*                                                                  1030
         ST    GDTPR,@AL00001                                      1030
         LA    @15,DDLISTSZ                                        1030
         ST    @15,@AL00001+4                                      1030
         LA    @15,DDLISTPT                                        1030
         ST    @15,@AL00001+8                                      1030
         MVI   @AL00001+8,X'80'                                    1030
         L     @15,GDTGSP(,GDTPR)                                  1030
         LA    @01,@AL00001                                        1030
         BALR  @14,@15                                             1030
*                    /************************************************/
*                    /*                                      @YL026UK*/
*                    /* CHECK RETURN CODE FROM UGSPACE AND   @YL026UK*/
*                    /* UABORT IF UGSPACE FAILED             @YL026UK*/
*                    /*                                      @YL026UK*/
*                    /************************************************/
*                                                                  1031
*                    RESPECIFY (REG15) RSTD;               /*@YL026UK*/
*                    IF REG15 ^= 0                                 1032
*                      THEN                                        1032
*                                                                  1032
         LTR   REG15,REG15                                         1032
         BZ    @RF01032                                            1032
*                        DO;                                       1033
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      1034
*                          REG15 = NOSPACE;                        1035
         LA    REG15,28                                            1035
*                          REG14 = GDTABT;                         1036
         L     REG14,GDTABT(,GDTPR)                                1036
*                          REG13 = GDTABH;                         1037
         L     REG13,GDTABH(,GDTPR)                                1037
*                          GEN(BR    REG14);                       1038
         BR    REG14
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     1039
*                        END;                  /*@YL026UK*/        1040
*                    RESPECIFY (REG15) UNRSTD;             /*@YL026UK*/
@RF01032 DS    0H                                                  1042
*                  END;                                    /*@YL026UK*/
*                                                                  1042
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* IF A UNIT AND VOLUME COUNT HAVE BEEN       @Y30LSMK*/
*              /* REQUESTED, SAVE THE UNIT AND VOLUME COUNTS @Y30LSMK*/
*              /* TO BE USED IN THE LAST CALL TO DYNAMIC     @Y30LSMK*/
*              /* ALLOCATION.                                @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  1043
*              IF ALLUNCNT ^= 0                                    1043
*                THEN                                              1043
@RF01027 L     @15,PARMPTR2                                        1043
         CLI   ALLUNCNT(@15),0                                     1043
         BE    @RF01043                                            1043
*                  DO;                                     /*@Y30LSMK*/
*                    UNTCOUNT = ALLUNCNT;                  /*@Y30LSMK*/
         IC    @14,ALLUNCNT(,@15)                                  1045
         STC   @14,UNTCOUNT                                        1045
*                    VOLCOUNT = ALLVLCNT;                  /*@Y30LSMK*/
         IC    @14,ALLVLCNT(,@15)                                  1046
         STC   @14,VOLCOUNT                                        1046
*                  END;                                    /*@Y30LSMK*/
*                                                                  1047
*              /******************************************************/
*              /*                                            @YL026UK*/
*              /* FOR EACH UNIT IN THE UNIT DESCRIPTOR LIST, @YL026UK*/
*              /* REQUEST THAT THE CORRESPONDING VOLUME(S)   @YL026UK*/
*              /* (BY THEIR VOLUME SERIAL NUMBERS) BE        @YL026UK*/
*              /* MOUNTED                                    @YL026UK*/
*              /*                                            @YL026UK*/
*              /******************************************************/
*                                                                  1048
*MOUNTDO:      DO I = 1 TO UNTCNT;                         /*@YL026UK*/
*                                                                  1048
@RF01043 DS    0H                                                  1048
MOUNTDO  LA    @15,1                                               1048
         B     @DE01048                                            1048
@DL01048 DS    0H                                                  1049
*                /****************************************************/
*                /*                                          @Y30LSMK*/
*                /* IF THE UNIT AND VOLUME COUNTS WERE       @Y30LSMK*/
*                /* REQUESTED, DECREMENT BOTH COUNTS ON EACH @Y30LSMK*/
*                /* CALL TO DYNAMIC ALLOCATION.              @Y30LSMK*/
*                /*                                          @Y30LSMK*/
*                /****************************************************/
*                                                                  1049
*                IF ALLUNCNT ^= 0  &  I ^= UNTCNT                  1049
*                  THEN                                            1049
         L     @14,PARMPTR2                                        1049
         CLI   ALLUNCNT(@14),0                                     1049
         BE    @RF01049                                            1049
         L     @01,ALLULP(,@14)                                    1049
         CH    @15,UNTCNT(,@01)                                    1049
         BE    @RF01049                                            1049
*                    DO;                                   /*@Y30LSMK*/
*                      UNTCOUNT = UNTCOUNT - 1;            /*@Y30LSMK*/
         SLR   @15,@15                                             1051
         IC    @15,UNTCOUNT                                        1051
         BCTR  @15,0                                               1051
         STC   @15,UNTCOUNT                                        1051
*                      VOLCOUNT = VOLCOUNT - 1;            /*@Y30LSMK*/
         SLR   @15,@15                                             1052
         IC    @15,VOLCOUNT                                        1052
         BCTR  @15,0                                               1052
         STC   @15,VOLCOUNT                                        1052
*                    END;                                  /*@Y30LSMK*/
*                                                                  1053
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* BUILD UNIT DESCRIPTOR TEXT UNIT AND      @YL026UK*/
*                /* INSERT ITS ADDR IN CORRESPONDING ENTRY   @YL026UK*/
*                /* OF TEXT UNIT POINTER LIST                @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                                                                  1054
*                RESPECIFY S99TUNIT BASED(ADDR(TEXTUNT));  /*@YL026UK*/
@RF01049 DS    0H                                                  1055
*                S99TUKEY = DALUNIT;                       /*@YL026UK*/
         LA    @15,TEXTUNT                                         1055
         MVC   S99TUKEY(2,@15),@CB01453                            1055
*                S99TUNUM = 1;                             /*@YL026UK*/
         MVC   S99TUNUM(2,@15),@CH00215                            1056
*                S99TULNG = UNTLEN(I);                     /*@YL026UK*/
         LH    @14,I                                               1057
         LR    @07,@14                                             1057
         MH    @07,@CH00033                                        1057
         L     @06,PARMPTR2                                        1057
         L     @05,ALLULP(,@06)                                    1057
         ST    @07,@TF00001                                        1057
         ALR   @07,@05                                             1057
         AL    @07,@CF02460                                        1057
         ICM   @07,12,UNTLEN-2(@07)                                1057
         SRA   @07,16                                              1057
         STCM  @07,3,S99TULNG(@15)                                 1057
*                S99TUPAR(1:S99TULNG) = UNTVAL(I,1:S99TULNG);      1058
         BCTR  @07,0                                               1058
         LR    @04,@05                                             1058
         AL    @04,@TF00001                                        1058
         AL    @04,@CF02466                                        1058
         EX    @07,@SM02467                                        1058
*                S99TUPTR(7) = ADDR(TEXTUNT);              /*@YL026UK*/
*                                                                  1059
         LA    @07,TUPL                                            1059
         ST    @15,S99TUPTR+24(,@07)                               1059
*                /****************************************************/
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* BUILD VOLSER DESCRIPTOR TEXT UNIT AND    @YL026UK*/
*                /* INSERT ITS ADDR IN CORRESPONDING ENTRY   @YL026UK*/
*                /* OF TEXT UNIT POINTER LIST                @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                /****************************************************/
*                                                                  1060
*                /****************************************************/
*                /*                                          @YL026UK*/
*                /* CHECK FOR MORE THAN ONE VOLSER ENTRY TO  @YL026UK*/
*                /* BE BUILT IN THE VOLSER DESCRIPTOR TEXT   @YL026UK*/
*                /* UNIT                                     @YL026UK*/
*                /*                                          @YL026UK*/
*                /****************************************************/
*                                                                  1060
*                IF (I = UNTCNT & VOLCNT > UNTCNT)                1060
*                  (I = UNTCNT  &  (ALLUNCNT > UNTCNT             1060
*                  ALLVLCNT > VOLCNT))                             1060
*                  THEN                                            1060
*                                                                  1060
         LH    @15,UNTCNT(,@05)                                    1060
         CR    @14,@15                                             1060
         BNE   @GL00014                                            1060
         L     @01,ALLVLP(,@06)                                    1060
         CH    @15,VOLCNT(,@01)                                    1060
         BL    @RT01060                                            1060
@GL00014 L     @15,PARMPTR2                                        1060
         L     @01,ALLULP(,@15)                                    1060
         LH    @14,UNTCNT(,@01)                                    1060
         CH    @14,I                                               1060
         BNE   @RF01060                                            1060
         SLR   @07,@07                                             1060
         IC    @07,ALLUNCNT(,@15)                                  1060
         CR    @14,@07                                             1060
         BL    @RT01060                                            1060
         L     @01,ALLVLP(,@15)                                    1060
         SLR   @14,@14                                             1060
         IC    @14,ALLVLCNT(,@15)                                  1060
         CH    @14,VOLCNT(,@01)                                    1060
         BNH   @RF01060                                            1060
@RT01060 DS    0H                                                  1061
*                    /************************************************/
*                    /*                                      @YL026UK*/
*                    /* MORE THAN ONE VOLSER ENTRY TO BE     @YL026UK*/
*                    /* BUILT IN THE VOLSER DESCRIPTOR TEXT  @YL026UK*/
*                    /* UNIT                                 @YL026UK*/
*                    /*                                      @YL026UK*/
*                    /************************************************/
*                                                                  1061
*                    DO;                                   /*@YL026UK*/
*                                                                  1061
*                        /********************************************/
*                        /*                                  @YL026UK*/
*                        /* GET CORE FOR MULTIPLE VOLSER     @YL026UK*/
*                        /* TEXT UNIT                        @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /********************************************/
*                                                                  1062
*                        TEXTVOLS = (VOLCNT - UNTCNT + 1) * 8 + 4; 1062
         L     @15,PARMPTR2                                        1062
         L     @01,ALLVLP(,@15)                                    1062
         L     @15,ALLULP(,@15)                                    1062
         LH    @14,VOLCNT(,@01)                                    1062
         SH    @14,UNTCNT(,@15)                                    1062
         AL    @14,@CF00215                                        1062
         SLA   @14,3                                               1062
         AL    @14,@CF00038                                        1062
         ST    @14,TEXTVOLS                                        1062
*                        CALL IDCSAGS0(GDTTBL,TEXTVOLS,TEXTVOLP);/*
*                                                            @YL026UK*/
*                                                                  1063
         ST    GDTPR,@AL00001                                      1063
         LA    @15,TEXTVOLS                                        1063
         ST    @15,@AL00001+4                                      1063
         LA    @15,TEXTVOLP                                        1063
         ST    @15,@AL00001+8                                      1063
         MVI   @AL00001+8,X'80'                                    1063
         L     @15,GDTGSP(,GDTPR)                                  1063
         LA    @01,@AL00001                                        1063
         BALR  @14,@15                                             1063
*                        /********************************************/
*                        /*                                  @YL026UK*/
*                        /* CHECK RETURN CODE FROM UGSPACE   @YL026UK*/
*                        /* AND UABORT IF UGSPACE FAILED     @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /********************************************/
*                                                                  1064
*                        RESPECIFY (REG15) RSTD;           /*@YL026UK*/
*                        IF REG15 ^= 0                             1065
*                          THEN                                    1065
*                                                                  1065
         LTR   REG15,REG15                                         1065
         BZ    @RF01065                                            1065
*                            DO;                                   1066
*                              RESPECIFY(REG13,REG14,REG15) RSTD;  1067
*                              REG15 = NOSPACE;                    1068
         LA    REG15,28                                            1068
*                              REG14 = GDTABT;                     1069
         L     REG14,GDTABT(,GDTPR)                                1069
*                              REG13 = GDTABH;                     1070
         L     REG13,GDTABH(,GDTPR)                                1070
*                              GEN(BR    REG14);                   1071
         BR    REG14
*                              RESPECIFY(REG13,REG14,REG15)UNRSTD; 1072
*                            END;              /*@YL026UK*/        1073
*                        RESPECIFY (REG15) UNRSTD;         /*@YL026UK*/
*                                                                  1074
@RF01065 DS    0H                                                  1075
*                        /********************************************/
*                        /********************************************/
*                        /*                                  @YL026UK*/
*                        /* BUILD VOLSER TEXT UNIT, INSERT   @YL026UK*/
*                        /* ITS ADDR IN THE CORRESPONDING    @YL026UK*/
*                        /* ENTRY OF THE TEXT UNIT POINTER   @YL026UK*/
*                        /* LIST, AND TURN THE HIGH ORDER    @YL026UK*/
*                        /* BIT OF THIS ADDR ON              @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /********************************************/
*                        /********************************************/
*                                                                  1075
*                                                                  1075
*                        RESPECIFY S99TUNIT BASED(TEXTVOLP);       1075
*                        S99TUKEY = DALVLSER;              /*@YL026UK*/
         L     @15,TEXTVOLP                                        1076
         MVC   S99TUKEY(2,@15),@CB01443                            1076
*                        S99TUNUM = VOLCNT - UNTCNT + 1;   /*@YL026UK*/
         L     @14,PARMPTR2                                        1077
         L     @01,ALLVLP(,@14)                                    1077
         L     @14,ALLULP(,@14)                                    1077
         LH    @07,VOLCNT(,@01)                                    1077
         SH    @07,UNTCNT(,@14)                                    1077
         AL    @07,@CF00215                                        1077
         STCM  @07,3,S99TUNUM(@15)                                 1077
*                        S99TUFP = TEXTVOLP + 4;           /*@YL026UK*/
*                                                                  1078
         AL    @15,@CF00038                                        1078
         ST    @15,S99TUFP                                         1078
*                        /********************************************/
*                        /*                                  @YL026UK*/
*                        /* DO LOOP FOR VOLSER'S             @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /********************************************/
*                                                                  1079
*SERDO:                  DO J = I TO VOLCNT;               /*@YL026UK*/
SERDO    LH    @15,I                                               1079
         B     @DE01079                                            1079
@DL01079 DS    0H                                                  1080
*                          S99TULEN = VOLLEN(J);           /*@YL026UK*/
         L     @14,S99TUFP                                         1080
         LR    @07,@15                                             1080
         SLA   @07,3                                               1080
         L     @01,PARMPTR2                                        1080
         L     @06,ALLVLP(,@01)                                    1080
         ST    @07,@TF00001                                        1080
         ALR   @07,@06                                             1080
         AL    @07,@CF02466                                        1080
         ICM   @07,12,VOLLEN-2(@07)                                1080
         SRA   @07,16                                              1080
         STCM  @07,3,S99TULEN(@14)                                 1080
*                          S99TUPRM(1:S99TULEN) =                  1081
*                            VOLVAL(J,1:S99TULEN);         /*@YL026UK*/
         LR    @05,@07                                             1081
         BCTR  @05,0                                               1081
         AL    @06,@TF00001                                        1081
         AL    @06,@CF02469                                        1081
         EX    @05,@SM02470                                        1081
*                          S99TUFP = S99TUFP + S99TULEN            1082
*                            + 2;                          /*@YL026UK*/
         ALR   @14,@07                                             1082
         AL    @14,@CF00149                                        1082
         ST    @14,S99TUFP                                         1082
*                        END SERDO;                        /*@YL026UK*/
*                                                                  1083
         AL    @15,@CF00215                                        1083
@DE01079 STH   @15,J                                               1083
         L     @14,PARMPTR2                                        1083
         L     @14,ALLVLP(,@14)                                    1083
         CH    @15,VOLCNT(,@14)                                    1083
         BNH   @DL01079                                            1083
*                        S99TUPTR(8) = TEXTVOLP;           /*@YL026UK*/
         LA    @15,TUPL                                            1084
         L     @14,TEXTVOLP                                        1084
         ST    @14,S99TUPTR+28(,@15)                               1084
*                        S99TUPLN(8) = ON;                 /*@YL026UK*/
*                                                                  1085
         OI    S99TUPLN+28(@15),B'10000000'                        1085
*                        /********************************************/
*                        /*                                  @Y30LSMK*/
*                        /* IF THE UNIT COUNT IS GREATER     @Y30LSMK*/
*                        /* THAN THE UNIT COUNT IN THE UNIT  @Y30LSMK*/
*                        /* LIST, OR THE VOLUME COUNT        @Y30LSMK*/
*                        /* GREATER THAN THE VOLUME          @Y30LSMK*/
*                        /* COUNT IN THE VOLUME              @Y30LSMK*/
*                        /* LIST, BUILD THE UNIT COUNT TEXT  @Y30LSMK*/
*                        /* UNIT AND VOLUME COUNT TEXT UNIT  @Y30LSMK*/
*                        /* AND INSERT THEIR ADDRS IN THE    @Y30LSMK*/
*                        /* CORRESPONDING ENTRY IN THE TEXT  @Y30LSMK*/
*                        /* UNIT POINTER LIST.               @Y30LSMK*/
*                        /*                                  @Y30LSMK*/
*                        /********************************************/
*                                                                  1086
*                        IF ALLUNCNT > UNTCNT    ALLVLCNT > VOLCNT
*                          THEN                                    1086
         L     @15,PARMPTR2                                        1086
         L     @01,ALLULP(,@15)                                    1086
         SLR   @14,@14                                             1086
         IC    @14,ALLUNCNT(,@15)                                  1086
         CH    @14,UNTCNT(,@01)                                    1086
         BH    @RT01086                                            1086
         L     @01,ALLVLP(,@15)                                    1086
         SLR   @14,@14                                             1086
         IC    @14,ALLVLCNT(,@15)                                  1086
         CH    @14,VOLCNT(,@01)                                    1086
         BNH   @RF01086                                            1086
@RT01086 DS    0H                                                  1087
*                            DO;                           /*@Y30LSMK*/
*                              RESPECIFY S99TUNIT BASED(ADDR(TEXTUCNT))
*                              S99TUKEY = DALUNCNT;        /*@Y30LSMK*/
         LA    @15,TEXTUCNT                                        1089
         MVC   S99TUKEY(2,@15),@CB01455                            1089
*                              S99TUNUM = 1;               /*@Y30LSMK*/
         LA    @14,1                                               1090
         STCM  @14,3,S99TUNUM(@15)                                 1090
*                              S99TULNG = 1;               /*@Y30LSMK*/
         STCM  @14,3,S99TULNG(@15)                                 1091
*                              S99TUPAR(1:1) = UNITCNT;    /*@Y30LSMK*/
         MVC   S99TUPAR(1,@15),UNITCNT                             1092
*                              S99TUPTR(1) = ADDR(TEXTUCNT);       1093
*                                                                  1093
         LA    @07,TUPL                                            1093
         ST    @15,S99TUPTR(,@07)                                  1093
*                              RESPECIFY S99TUNIT BASED(ADDR(TEXTVCNT))
*                              S99TUKEY = DALVLCNT;        /*@Y30LSMK*/
         LA    @15,TEXTVCNT                                        1095
         MVC   S99TUKEY(2,@15),@CB01449                            1095
*                              S99TUNUM = 1;               /*@Y30LSMK*/
         STCM  @14,3,S99TUNUM(@15)                                 1096
*                              S99TULNG = 1;               /*@Y30LSMK*/
         STCM  @14,3,S99TULNG(@15)                                 1097
*                              S99TUPAR(1:1) = VOLUMCNT;   /*@Y30LSMK*/
         MVC   S99TUPAR(1,@15),VOLUMCNT                            1098
*                              S99TUPTR(3) = ADDR(TEXTVCNT);       1099
         ST    @15,S99TUPTR+8(,@07)                                1099
*                            END;                          /*@Y30LSMK*/
*                                                                  1100
*                    END;                                  /*#YL026UK*/
*                  ELSE                                            1102
*                                                                  1102
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* ONLY ONE VOLSER ENTRY TO BE BUILT    #YL026UK*/
*                    /* IN THE VOLUME DESCRIPTOR TEXT UNIT   #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1102
*                    DO;                                   /*#YL026UK*/
*                                                                  1102
         B     @RC01060                                            1102
@RF01060 DS    0H                                                  1103
*                      /**********************************************/
*                      /*                                    #YL026UK*/
*                      /* BUILD VOLSER TEXT UNIT, INSERT     #YL026UK*/
*                      /* ITS ADDR IN THE CORRESPONDING      #YL026UK*/
*                      /* ENTRY OF THE TEXT UNIT POINTER     #YL026UK*/
*                      /* LIST, AND TURN THE HIGH ORDER      #YL026UK*/
*                      /* BIT OF THIS ADDR ON                #YL026UK*/
*                      /*                                    #YL026UK*/
*                      /**********************************************/
*                                                                  1103
*                      RESPECIFY S99TUNIT BASED(ADDR(TEXTVOL));    1103
*                      S99TUKEY = DALVLSER;                /*#YL026UK*/
         LA    @15,TEXTVOL                                         1104
         MVC   S99TUKEY(2,@15),@CB01443                            1104
*                      S99TUNUM = 1;                       /*#YL026UK*/
         MVC   S99TUNUM(2,@15),@CH00215                            1105
*                      S99TULNG = VOLLEN(I);               /*#YL026UK*/
         LH    @14,I                                               1106
         SLA   @14,3                                               1106
         L     @01,PARMPTR2                                        1106
         L     @07,ALLVLP(,@01)                                    1106
         ST    @14,@TF00001                                        1106
         ALR   @14,@07                                             1106
         AL    @14,@CF02466                                        1106
         ICM   @14,12,VOLLEN-2(@14)                                1106
         SRA   @14,16                                              1106
         STCM  @14,3,S99TULNG(@15)                                 1106
*                      S99TUPAR(1:S99TULNG) = VOLVAL(I,1:S99TULNG);
         BCTR  @14,0                                               1107
         AL    @07,@TF00001                                        1107
         AL    @07,@CF02469                                        1107
         EX    @14,@SM02472                                        1107
*                      S99TUPTR(8) = ADDR(TEXTVOL);        /*#YL026UK*/
         LA    @14,TUPL                                            1108
         ST    @15,S99TUPTR+28(,@14)                               1108
*                      S99TUPLN(8) = ON;                   /*#YL026UK*/
         OI    S99TUPLN+28(@14),B'10000000'                        1109
*                    END;                                  /*#YL026UK*/
*                                                                  1110
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* INITIALIZE THE REQUEST BLOCK             #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1111
*                S99RBLN = '14'X;                          /*#YL026UK*/
@RC01060 MVI   S99RBLN,X'14'                                       1111
*                S99VERB = S99VRBAL;                       /*#YL026UK*/
         MVI   S99VERB,X'01'                                       1112
*                S99TXTPP = ADDR(TUPL);                    /*#YL026UK*/
*                                                                  1113
         LA    @15,TUPL                                            1113
         ST    @15,S99TXTPP                                        1113
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* INITIALIZE THE REQUEST BLOCK POINTER     #YL026UK*/
*                /* WITH THE HIGH ORDER BIT TURNED ON        #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1114
*                S99RBPTR = ADDR(S99RB);                   /*#YL026UK*/
         LA    @15,S99RB                                           1114
         ST    @15,S99RBPTR                                        1114
*                S99RBPND = ON;                            /*#YL026UK*/
*                                                                  1115
         OI    S99RBPND,B'10000000'                                1115
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* LOAD REGISTER 1 WITH THE ADDR OF THE     #YL026UK*/
*                /* REQUEST BLOCK POINTER AND ISSUE THE      #YL026UK*/
*                /* DYNAMIC ALLOCATION REQUEST               #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1116
*                IF GDTDBG = NULLPTR                               1116
*                  THEN;                                           1116
         L     @15,GDTDBG(,GDTPR)                                  1116
         LTR   @15,@15                                             1116
         BZ    @RT01116                                            1116
*                  ELSE                                            1118
*                    CALL IDCDB010(GDTTBL,'ZZAL');                 1118
         ST    GDTPR,@AL00001                                      1118
         LA    @15,@CC02106                                        1118
         ST    @15,@AL00001+4                                      1118
         MVI   @AL00001+4,X'80'                                    1118
         L     @15,GDTDBG(,GDTPR)                                  1118
         LA    @01,@AL00001                                        1118
         BALR  @14,@15                                             1118
*                                                          /*#YL026UK*/
*                RESPECIFY (REG1) RSTD;                    /*#YL026UK*/
@RT01116 DS    0H                                                  1120
*                REG1 = ADDR(S99RBPTR);                    /*#YL026UK*/
         LA    REG1,S99RBPTR                                       1120
*L99SVC1:        GEN(SVC   99);                            /*#YL026UK*/
L99SVC1  SVC   99
*                RESPECIFY (REG1) UNRSTD;                  /*#YL026UK*/
*                                                                  1122
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* CHECK THE RETURN CODE FROM DYNAMIC       #YL026UK*/
*                /* ALLOCATION                               #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1123
*                RESPECIFY (RTNREG) RSTD;                  /*#YL026UK*/
*                RESPECIFY RTNREG RSTD;                            1124
*                TESTRC = RTNREG;                                  1125
         STH   RTNREG,TESTRC                                       1125
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UK*/
*                RESPECIFY (RTNREG) UNRSTD;                /*#YL026UK*/
*                IF GDTDBG = NULLPTR                               1128
*                  THEN;                                           1128
         L     @15,GDTDBG(,GDTPR)                                  1128
         LTR   @15,@15                                             1128
         BZ    @RT01128                                            1128
*                  ELSE                                            1130
*                    CALL IDCDB010(GDTTBL,'ZZAL');                 1130
         ST    GDTPR,@AL00001                                      1130
         LA    @15,@CC02106                                        1130
         ST    @15,@AL00001+4                                      1130
         MVI   @AL00001+4,X'80'                                    1130
         L     @15,GDTDBG(,GDTPR)                                  1130
         LA    @01,@AL00001                                        1130
         BALR  @14,@15                                             1130
*                                                          /*#YL026UK*/
*                IF TESTRC = 0                                     1131
*                  THEN                                            1131
*                                                                  1131
@RT01128 LH    @15,TESTRC                                          1131
         LTR   @15,@15                                             1131
         BNZ   @RF01131                                            1131
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* DYNAMIC ALLOCATION WAS SUCCESSFUL    #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1132
*                    DO;                                   /*#YL026UK*/
*                                                                  1132
*                      /**********************************************/
*                      /*                                    #YL026UK*/
*                      /* IF MORE THAN ONE UNIT WAS IN THE   #YL026UK*/
*                      /* UNIT DESCRIPTOR LIST, THEN MOVE    #YL026UK*/
*                      /* THE DDNAME RETURNED BY DYNAMIC     #YL026UK*/
*                      /* ALLOCATION TO THE DDNAME           #YL026UK*/
*                      /* DYNAMIC ALLOCATION TEXT UNIT FOR   #YL026UK*/
*                      /* CONCATENATION AND SET THE DDNAME   #YL026UK*/
*                      /* LENGTH                             #YL026UK*/
*                      /*                                    #YL026UK*/
*                      /**********************************************/
*                                                                  1133
*                      IF UNTCNT > 1                               1133
*                        THEN                                      1133
         L     @01,PARMPTR2                                        1133
         L     @01,ALLULP(,@01)                                    1133
         LH    @15,UNTCNT(,@01)                                    1133
         C     @15,@CF00215                                        1133
         BNH   @RF01133                                            1133
*                          DO;                             /*#YL026UK*/
*                            RESPECIFY S99TUNIT                    1135
*                              BASED(ADDR(TEXTDDN));       /*#YL026UK*/
*                            CONDDN(I) = S99TUPAR(1:8);    /*#YL026UK*/
         L     @15,DDLISTPT                                        1136
         LH    @14,I                                               1136
         MH    @14,@CH00033                                        1136
         ST    @14,@TF00001                                        1136
         ALR   @14,@15                                             1136
         AL    @14,@CF02469                                        1136
         LA    @07,TEXTDDN                                         1136
         MVC   CONDDN-6(8,@14),S99TUPAR(@07)                       1136
*                            CONLN(I) = 8;                 /*#YL026UK*/
         LA    @14,8                                               1137
         AL    @15,@TF00001                                        1137
         AL    @15,@CF02466                                        1137
         STCM  @14,3,CONLN-4(@15)                                  1137
*                          END;                            /*#YL026UK*/
*                    END;                                  /*#YL026UK*/
*                  ELSE                                            1140
*                                                                  1140
*                    /************************************************/
*                    /*                                      @Z40GSBF*/
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1140
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1140
*                    /* CODE TO 4 AND RETURN TO CALLER             1140
*                    /*                                      @Z40GSBF*/
*                    /************************************************/
*                                                                  1140
*                    DO;                                   /*@Z40GSBF*/
         B     @RC01131                                            1140
@RF01131 DS    0H                                                  1141
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/
         LA    @15,ERRORTAB                                        1141
         ST    @15,ERCNVADR                                        1141
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/
         L     @14,S99RBPTR                                        1142
         ST    @14,ERDARBPT(,@15)                                  1142
*                      ERDYNAL = ON;                       /*@Z40GSBF*/
         OI    ERDYNAL(@15),B'00100000'                            1143
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/
         LH    @14,TESTRC                                          1144
         ST    @14,ERDYNRC(,@15)                                   1144
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/
         ST    GDTPR,@AL00001                                      1145
         LA    @15,ERCNVADR                                        1145
         ST    @15,@AL00001+4                                      1145
         MVI   @AL00001+4,X'80'                                    1145
         L     @15,GDTERR(,GDTPR)                                  1145
         LA    @01,@AL00001                                        1145
         BALR  @14,@15                                             1145
*                      SETRC = 4;                          /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   1146
*                      CALL IDCSAEP0(GDTTBL,MODID,SETRC);          1147
         ST    GDTPR,@AL00001                                      1147
         LA    @15,MODID                                           1147
         ST    @15,@AL00001+4                                      1147
         LA    @15,SETRC                                           1147
         ST    @15,@AL00001+8                                      1147
         MVI   @AL00001+8,X'80'                                    1147
         L     @15,GDTEPL(,GDTPR)                                  1147
         LA    @01,@AL00001                                        1147
         BALR  @14,@15                                             1147
*        /*#YL026UK*/                                              1148
*                    END;                                  /*#YL026UK*/
*              END MOUNTDO;                                /*#YL026UK*/
*                                                                  1149
@RC01131 LA    @15,1                                               1149
         AH    @15,I                                               1149
@DE01048 STH   @15,I                                               1149
         L     @14,PARMPTR2                                        1149
         L     @14,ALLULP(,@14)                                    1149
         CH    @15,UNTCNT(,@14)                                    1149
         BNH   @DL01048                                            1149
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* FREE CORE FOR MULTIPLE VOLSER TEXT UNIT    #YL026UK*/
*              /* IF MORE THAN ONE VOLSER ENTRY WAS BUILT    #YL026UK*/
*              /* IN THE VOLSER DESCRIPTOR TEXT UNIT         #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1150
*              IF VOLCNT > UNTCNT    ALLUNCNT > UNTCNT           1150
*                ALLVLCNT > VOLCNT                                 1150
*                THEN                                              1150
         L     @15,PARMPTR2                                        1150
         L     @01,ALLVLP(,@15)                                    1150
         LH    @14,VOLCNT(,@01)                                    1150
         L     @01,ALLULP(,@15)                                    1150
         LH    @07,UNTCNT(,@01)                                    1150
         CR    @14,@07                                             1150
         BH    @RT01150                                            1150
         SLR   @06,@06                                             1150
         IC    @06,ALLUNCNT(,@15)                                  1150
         CR    @07,@06                                             1150
         BL    @RT01150                                            1150
         SLR   @07,@07                                             1150
         IC    @07,ALLVLCNT(,@15)                                  1150
         CR    @14,@07                                             1150
         BNL   @RF01150                                            1150
@RT01150 DS    0H                                                  1151
*                  CALL IDCSAFS0(GDTTBL,TEXTVOLP);         /*#YL026UK*/
*                                                                  1151
         ST    GDTPR,@AL00001                                      1151
         LA    @15,TEXTVOLP                                        1151
         ST    @15,@AL00001+4                                      1151
         L     @15,GDTFSP(,GDTPR)                                  1151
         LA    @01,@AL00001                                        1151
         BALR  @14,@15                                             1151
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK IF PERMANENT CONCATENATION IS        #YL026UK*/
*              /* REQUIRED--I.E., THERE IS MORE THAN ONE     #YL026UK*/
*              /* UNIT IN THE UNIT DESCRIPTOR LIST           #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1152
*              IF UNTCNT > 1                                       1152
*                THEN                                              1152
*                                                                  1152
@RF01150 L     @01,PARMPTR2                                        1152
         L     @01,ALLULP(,@01)                                    1152
         LH    @15,UNTCNT(,@01)                                    1152
         C     @15,@CF00215                                        1152
         BNH   @RF01152                                            1152
*                  /**************************************************/
*                  /*                                        #YL026UK*/
*                  /* PERMANENT CONCATENATION IS REQUIRED    #YL026UK*/
*                  /*                                        #YL026UK*/
*                  /**************************************************/
*                                                                  1153
*                  DO;                                     /*#YL026UK*/
*                                                                  1153
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* BUILD DDNAME TEXT UNIT FOR           #YL026UK*/
*                    /* CONCATENATION AND INSERT ITS ADDRESS #YL026UK*/
*                    /* IN CORRESPONDING ENTRY OF TEXT UNIT  #YL026UK*/
*                    /* POINTER LIST                         #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1154
*                    CONKEY = DCCDDNAM;                    /*#YL026UK*/
         L     @14,DDLISTPT                                        1154
         MVC   CONKEY(2,@14),@CB01413                              1154
*                    CONNUM = UNTCNT;                      /*#YL026UK*/
         STH   @15,CONNUM(,@14)                                    1155
*                    S99TUPTR(1) = ADDR(TEXTCON);          /*#YL026UK*/
*                                                                  1156
         LA    @15,TUPL                                            1156
         ST    @14,S99TUPTR(,@15)                                  1156
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* BUILD PERMANENT CONCATENATION TEXT   #YL026UK*/
*                    /* UNIT FOR CONCATENATION, INSERT ITS   #YL026UK*/
*                    /* ADDR IN CORRESPONDING ENTRY OF TEXT  #YL026UK*/
*                    /* UNIT POINTER LIST, AND TURN ON THE   #YL026UK*/
*                    /* HIGH ORDER BIT OF THIS ADDR          #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1157
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTPER));      1157
*                    S99TUKEY = DCCPERMC;                  /*#YL026UK*/
         LA    @14,TEXTPER                                         1158
         MVC   S99TUKEY(2,@14),@CB01419                            1158
*                    S99TUNUM = 0;                         /*#YL026UK*/
         SLR   @07,@07                                             1159
         STCM  @07,3,S99TUNUM(@14)                                 1159
*                    S99TUPTR(2) = ADDR(TEXTPER);          /*#YL026UK*/
         ST    @14,S99TUPTR+4(,@15)                                1160
*                    S99TUPLN(2) = ON;                     /*#YL026UK*/
*                                                                  1161
         OI    S99TUPLN+4(@15),B'10000000'                         1161
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* INITIALIZE THE REQUEST BLOCK         #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1162
*                    S99RBLN = '14'X;                      /*#YL026UK*/
         MVI   S99RBLN,X'14'                                       1162
*                    S99VERB = S99VRBCC;                   /*#YL026UK*/
         MVI   S99VERB,X'03'                                       1163
*                    S99TXTPP = ADDR(TUPL);                /*#YL026UK*/
*                                                                  1164
         ST    @15,S99TXTPP                                        1164
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* INITIALIZE THE REQUEST BLOCK POINTER #YL026UK*/
*                    /* WITH THE HIGH ORDER BIT TURNED ON    #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1165
*                    S99RBPTR = ADDR(S99RB);               /*#YL026UK*/
         LA    @06,S99RB                                           1165
         ST    @06,S99RBPTR                                        1165
*                    S99RBPND = ON;                        /*#YL026UK*/
*                                                                  1166
         OI    S99RBPND,B'10000000'                                1166
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* LOAD REGISTER 1 WITH THE ADDR OF THE #YL026UK*/
*                    /* REQUEST BLOCK POINTER AND ISSUE THE  #YL026UK*/
*                    /* DYNAMIC ALLOCATION REQUEST           #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1167
*                    IF GDTDBG = NULLPTR                           1167
*                      THEN;                                       1167
         C     @07,GDTDBG(,GDTPR)                                  1167
         BE    @RT01167                                            1167
*                      ELSE                                        1169
*                        CALL IDCDB010(GDTTBL,'ZZAL');             1169
         ST    GDTPR,@AL00001                                      1169
         LA    @15,@CC02106                                        1169
         ST    @15,@AL00001+4                                      1169
         MVI   @AL00001+4,X'80'                                    1169
         L     @15,GDTDBG(,GDTPR)                                  1169
         LA    @01,@AL00001                                        1169
         BALR  @14,@15                                             1169
*                                                          /*#YL026UK*/
*                    RESPECIFY (REG1) RSTD;                /*#YL026UK*/
@RT01167 DS    0H                                                  1171
*                    REG1 = ADDR(S99RBPTR);                /*#YL026UK*/
         LA    REG1,S99RBPTR                                       1171
*L99SVC2:            GEN(SVC   99);                        /*#YL026UK*/
L99SVC2  SVC   99
*                    RESPECIFY (REG1) UNRSTD;              /*#YL026UK*/
*                                                                  1173
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* CHECK THE RETURN CODE FROM DYNAMIC   #YL026UK*/
*                    /* ALLOCATION                           #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1174
*                    RESPECIFY (RTNREG) RSTD;              /*#YL026UK*/
*                    RESPECIFY RTNREG RSTD;                        1175
*                    TESTRC = RTNREG;                              1176
         STH   RTNREG,TESTRC                                       1176
*                    RESPECIFY RTNREG UNRSTD;              /*#YL026UK*/
*                    RESPECIFY (RTNREG) UNRSTD;            /*#YL026UK*/
*                    IF GDTDBG = NULLPTR                           1179
*                      THEN;                                       1179
         L     @15,GDTDBG(,GDTPR)                                  1179
         LTR   @15,@15                                             1179
         BZ    @RT01179                                            1179
*                      ELSE                                        1181
*                        CALL IDCDB010(GDTTBL,'ZZAL');             1181
         ST    GDTPR,@AL00001                                      1181
         LA    @15,@CC02106                                        1181
         ST    @15,@AL00001+4                                      1181
         MVI   @AL00001+4,X'80'                                    1181
         L     @15,GDTDBG(,GDTPR)                                  1181
         LA    @01,@AL00001                                        1181
         BALR  @14,@15                                             1181
*                                                          /*#YL026UK*/
*                    IF TESTRC = 0                                 1182
*                      THEN                                        1182
*                                                                  1182
@RT01179 LH    @15,TESTRC                                          1182
         LTR   @15,@15                                             1182
         BNZ   @RF01182                                            1182
*                        /********************************************/
*                        /*                                  #YL026UK*/
*                        /* DYNAMIC ALLOCATION CONCATENATION #YL026UK*/
*                        /* WAS SUCCESSFUL--RETURN THE       #YL026UK*/
*                        /* DDNAME FOR THIS CONCATENATION,   #YL026UK*/
*                        /* FREE DDNAME DYNAMIC ALLOCATION   #YL026UK*/
*                        /* TEXT UNIT FOR CONCATENATION, AND #YL026UK*/
*                        /* SET A RETURN CODE OF 0           #YL026UK*/
*                        /*                                  #YL026UK*/
*                        /********************************************/
*                                                                  1183
*                        DO;                               /*#YL026UK*/
*                          ALLDDN(1:8) = CONDDN(1);        /*#YL026UK*/
         L     @01,PARMPTR2                                        1184
         L     @15,DDLISTPT                                        1184
         MVC   ALLDDN(8,@01),CONDDN(@15)                           1184
*                          CALL IDCSAFS0(GDTTBL,DDLISTPT); /*#YL026UK*/
         ST    GDTPR,@AL00001                                      1185
         LA    @15,DDLISTPT                                        1185
         ST    @15,@AL00001+4                                      1185
         L     @15,GDTFSP(,GDTPR)                                  1185
         LA    @01,@AL00001                                        1185
         BALR  @14,@15                                             1185
*                          SETRC = 0;                      /*#YL026UK*/
         SLR   @15,@15                                             1186
         STH   @15,SETRC                                           1186
*                        END;                              /*#YL026UK*/
*                      ELSE                                        1188
*                                                                  1188
*                                                                  1188
*                    /************************************************/
*                    /*                                      @Z40GSBF*/
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1188
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1188
*                    /* CODE TO 4 AND RETURN TO CALLER             1188
*                    /*                                      @Z40GSBF*/
*                    /************************************************/
*                                                                  1188
*                    DO;                                   /*@Z40GSBF*/
         B     @RC01182                                            1188
@RF01182 DS    0H                                                  1189
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/
         LA    @15,ERRORTAB                                        1189
         ST    @15,ERCNVADR                                        1189
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/
         L     @14,S99RBPTR                                        1190
         ST    @14,ERDARBPT(,@15)                                  1190
*                      ERDYNAL = ON;                       /*@Z40GSBF*/
         OI    ERDYNAL(@15),B'00100000'                            1191
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/
         LH    @14,TESTRC                                          1192
         ST    @14,ERDYNRC(,@15)                                   1192
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/
         ST    GDTPR,@AL00001                                      1193
         LA    @15,ERCNVADR                                        1193
         ST    @15,@AL00001+4                                      1193
         MVI   @AL00001+4,X'80'                                    1193
         L     @15,GDTERR(,GDTPR)                                  1193
         LA    @01,@AL00001                                        1193
         BALR  @14,@15                                             1193
*                      SETRC = 4;                          /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   1194
*                    END;                                  /*#YL026UK*/
*                  END;                                    /*#YL026UK*/
*                ELSE                                              1197
*                                                                  1197
*                  /**************************************************/
*                  /*                                        #YL026UK*/
*                  /* PERMANENT CONCATENATION NOT REQUIRED   #YL026UK*/
*                  /*                                        #YL026UK*/
*                  /**************************************************/
*                                                                  1197
*                  DO;                                     /*#YL026UK*/
*                                                                  1197
         B     @RC01152                                            1197
@RF01152 DS    0H                                                  1198
*                    /************************************************/
*                    /*                                      #YL026UK*/
*                    /* RETURN THE DDNAME AND SET A RETURN   #YL026UK*/
*                    /* CODE OF 0                            #YL026UK*/
*                    /*                                      #YL026UK*/
*                    /************************************************/
*                                                                  1198
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));      1198
*                    ALLDDN(1:8) = BLANKDDN;               /*@Y30SSMK*/
         L     @15,PARMPTR2                                        1199
         MVC   ALLDDN(8,@15),@CC02078                              1199
*                    ALLDDN(1:S99TULNG) = S99TUPAR(1:8);   /*@ZA00133*/
         LA    @14,TEXTDDN                                         1200
         ICM   @07,12,S99TULNG(@14)                                1200
         SRA   @07,16                                              1200
         BCTR  @07,0                                               1200
         EX    @07,@SM02475                                        1200
*                    SETRC = 0;                               /*@YL026U
*                                                            #YL026UK*/
         SLR   @15,@15                                             1201
         STH   @15,SETRC                                           1201
*                  END;                                    /*#YL026UK*/
*                                                                  1202
*            END;                                          /*#YL026UK*/
*          ELSE                                                    1204
*                                                                  1204
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* REQUEST IS FOR DATA SET ALLOCATION           #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  1204
*            DO;                                           /*#YL026UK*/
*                                                                  1204
         B     @RC01001                                            1204
@RF01001 DS    0H                                                  1205
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* BUILD DSNAME TEXT UNIT AND INSERT ITS ADDR #YL026UK*/
*              /* IN CORRESPONDING ENTRY OF TEXT UNIT        #YL026UK*/
*              /* POINTER LIST                               #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1205
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSN));    /*#YL026UK*/
*              S99TUKEY = DALDSNAM;                        /*#YL026UK*/
         LA    @15,TEXTDSN                                         1206
         MVC   S99TUKEY(2,@15),@CB01415                            1206
*              S99TUNUM = 1;                               /*#YL026UK*/
         LA    @14,1                                               1207
         STCM  @14,3,S99TUNUM(@15)                                 1207
*              S99TULNG = 44;                              /*#YL026UK*/
         MVC   S99TULNG(2,@15),@CH01652                            1208
*              S99TUPAR(1:44) = AGLDSN(1:44);              /*#YL026UK*/
         L     @07,PARMPTR2                                        1209
         L     @01,ALLDSN(,@07)                                    1209
         MVC   S99TUPAR(44,@15),AGLDSN(@01)                        1209
*              S99TUPTR(1) = ADDR(TEXTDSN);                /*#YL026UK*/
*                                                                  1210
         LA    @06,TUPL                                            1210
         ST    @15,S99TUPTR(,@06)                                  1210
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* BUILD DDNAME RETURN TEXT UNIT AND INSERT   #YL026UK*/
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    #YL026UK*/
*              /* UNIT POINTER LIST                          #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1211
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*#YL026UK*/
*              S99TUKEY = DALRTDDN;                        /*#YL026UK*/
         LA    @15,TEXTDDN                                         1212
         MVC   S99TUKEY(2,@15),@CB01581                            1212
*              S99TUNUM = 1;                               /*#YL026UK*/
         STCM  @14,3,S99TUNUM(@15)                                 1213
*              S99TULNG = 8;                               /*#YL026UK*/
         LA    @05,8                                               1214
         STCM  @05,3,S99TULNG(@15)                                 1214
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*#YL026UK*/
*                                                                  1215
         ST    @15,S99TUPTR+4(,@06)                                1215
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK IF A PASSWORD HAS BEEN SPECIFIED     #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1216
*              IF ALLPWD ^= 0                                      1216
*                THEN                                              1216
*                                                                  1216
         L     @15,ALLPWD(,@07)                                    1216
         LTR   @15,@15                                             1216
         BZ    @RF01216                                            1216
*                  /**************************************************/
*                  /*                                        #YL026UK*/
*                  /* A PASSWORD HAS BEEN SPECIFIED--BUILD   #YL026UK*/
*                  /* PASSWORD TEXT UNIT AND INSERT ITS ADDR #YL026UK*/
*                  /* IN CORRESPONDING ENTRY OF TEXT UNIT    #YL026UK*/
*                  /* POINTER LIST                           #YL026UK*/
*                  /*                                        #YL026UK*/
*                  /**************************************************/
*                                                                  1217
*                  DO;                                     /*#YL026UK*/
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTPWD));      1218
*                    S99TUKEY = DALPASSW;                  /*#YL026UK*/
         LA    @07,TEXTPWD                                         1219
         MVC   S99TUKEY(2,@07),@CB01571                            1219
*                    S99TUNUM = 1;                         /*#YL026UK*/
         STCM  @14,3,S99TUNUM(@07)                                 1220
*                    S99TULNG = 8;                         /*#YL026UK*/
         STCM  @05,3,S99TULNG(@07)                                 1221
*                    S99TUPAR(1:8) = AGLPWD(1:8);          /*#YL026UK*/
         MVC   S99TUPAR(8,@07),AGLPWD(@15)                         1222
*                    S99TUPTR(3) = ADDR(TEXTPWD);          /*#YL026UK*/
         ST    @07,S99TUPTR+8(,@06)                                1223
*                  END;                                    /*#YL026UK*/
*                                                                  1224
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* BUILD STATUS TEXT UNIT AND INSERT ITS ADDR #YL026UK*/
*              /* IN CORRESPONDING ENTRY OF TEXT UNIT        #YL026UK*/
*              /* POINTER LIST                               #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1225
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTSTS));    /*#YL026UK*/
@RF01216 DS    0H                                                  1226
*              S99TUKEY = DALSTATS;                        /*#YL026UK*/
         LA    @15,TEXTSTS                                         1226
         MVC   S99TUKEY(2,@15),@CB01419                            1226
*              S99TUNUM = 1;                               /*#YL026UK*/
         LA    @14,1                                               1227
         STCM  @14,3,S99TUNUM(@15)                                 1227
*              S99TULNG = 1;                               /*#YL026UK*/
         STCM  @14,3,S99TULNG(@15)                                 1228
*              S99TUPAR(1) = ALLSTS(1);                    /*#YL026UK*/
         L     @07,PARMPTR2                                        1229
         MVC   S99TUPAR(1,@15),ALLSTS(@07)                         1229
*              S99TUPTR(4) = ADDR(TEXTSTS);                /*#YL026UK*/
*                                                                  1230
         LA    @06,TUPL                                            1230
         ST    @15,S99TUPTR+12(,@06)                               1230
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* BUILD DISPOSITION TEXT UNIT AND INSERT ITS #YL026UK*/
*              /* ADDR IN CORRESPONDING ENTRY OF TEXT UNIT   #YL026UK*/
*              /* POINTER LIST                               #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1231
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*#YL026UK*/
*              S99TUKEY = DALNDISP;                        /*#YL026UK*/
         LA    @15,TEXTDSP                                         1232
         MVC   S99TUKEY(2,@15),@CB01421                            1232
*              S99TUNUM = 1;                               /*#YL026UK*/
         STCM  @14,3,S99TUNUM(@15)                                 1233
*              S99TULNG = 1;                               /*#YL026UK*/
         STCM  @14,3,S99TULNG(@15)                                 1234
*              S99TUPAR(1) = ALLDSP(1);                    /*#YL026UK*/
         MVC   S99TUPAR(1,@15),ALLDSP(@07)                         1235
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*#YL026UK*/
*                                                                  1236
         ST    @15,S99TUPTR+16(,@06)                               1236
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* BUILD DSORG RETURN TEXT UNIT, INSERT ITS   #YL026UK*/
*              /* ADDR IN CORRESPONDING ENTRY OF TEXT UNIT   #YL026UK*/
*              /* POINTER LIST, AND TURN THE HIGH ORDER BIT  #YL026UK*/
*              /* OF THIS ADDR ON                            #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1237
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTORG));    /*#YL026UK*/
*              S99TUKEY = DALRTORG;                        /*#YL026UK*/
         LA    @15,TEXTORG                                         1238
         MVC   S99TUKEY(2,@15),@CB01585                            1238
*              S99TUNUM = 1;                               /*#YL026UK*/
         STCM  @14,3,S99TUNUM(@15)                                 1239
*              S99TULNG = 2;                               /*#YL026UK*/
         MVC   S99TULNG(2,@15),@CH00149                            1240
*              S99TUPTR(6) = ADDR(TEXTORG);                /*#YL026UK*/
*                                                                  1241
         ST    @15,S99TUPTR+20(,@06)                               1241
*              /******************************************************/
*              /*                                            @Y30LSMK*/
*              /* IF A DEVICE TYPE IS REQUESTED, BUILD THE   @Y30LSMK*/
*              /* UNIT DESCRIPTOR TEXT UNIT AND INSERT ITS   @Y30LSMK*/
*              /* ADDR IN THE CORRESPONDING ENTRY OF TEXT    @Y30LSMK*/
*              /* UNIT POINTER LIST.                         @Y30LSMK*/
*              /*                                            @Y30LSMK*/
*              /******************************************************/
*                                                                  1242
*              IF ALLULP = NULLPTR                                 1242
*                THEN                                              1242
         L     @07,ALLULP(,@07)                                    1242
         LTR   @07,@07                                             1242
         BNZ   @RF01242                                            1242
*                  S99TUPLN(6) = ON;                       /*@Y30LSMK*/
         OI    S99TUPLN+20(@06),B'10000000'                        1243
*                ELSE                                              1244
*                  DO;                                     /*@Y30LSMK*/
         B     @RC01242                                            1244
@RF01242 DS    0H                                                  1245
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTUNT));      1245
*                    S99TUKEY = DALUNIT;                   /*@Y30LSMK*/
         LA    @15,TEXTUNT                                         1246
         MVC   S99TUKEY(2,@15),@CB01453                            1246
*                    S99TUNUM = 1;                         /*@Y30LSMK*/
         MVC   S99TUNUM(2,@15),@CH00215                            1247
*                    S99TULNG = UNTLEN(1);                 /*@Y30LSMK*/
         L     @01,PARMPTR2                                        1248
         L     @14,ALLULP(,@01)                                    1248
         ICM   @07,12,UNTLEN(@14)                                  1248
         SRA   @07,16                                              1248
         STCM  @07,3,S99TULNG(@15)                                 1248
*                    S99TUPAR(1:S99TULNG) = UNTVAL(1,1:S99TULNG);  1249
         BCTR  @07,0                                               1249
         EX    @07,@SM02477                                        1249
*                    S99TUPTR(7) = ADDR(TEXTUNT);          /*@Y30LSMK*/
         LA    @14,TUPL                                            1250
         ST    @15,S99TUPTR+24(,@14)                               1250
*                    S99TUPLN(7) = ON;                     /*@Y30LSMK*/
         OI    S99TUPLN+24(@14),B'10000000'                        1251
*                  END;                                    /*@Y30LSMK*/
*                                                                  1252
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* INITIALIZE THE REQUEST BLOCK               #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1253
*              S99RBLN = '14'X;                            /*#YL026UK*/
@RC01242 MVI   S99RBLN,X'14'                                       1253
*              S99VERB = S99VRBAL;                         /*#YL026UK*/
         MVI   S99VERB,X'01'                                       1254
*              S99TXTPP = ADDR(TUPL);                      /*#YL026UK*/
*                                                                  1255
         LA    @15,TUPL                                            1255
         ST    @15,S99TXTPP                                        1255
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* INITIALIZE THE REQUEST BLOCK POINTER WITH  #YL026UK*/
*              /* THE HIGH ORDER BIT TURNED ON               #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1256
*              S99RBPTR = ADDR(S99RB);                     /*#YL026UK*/
         LA    @15,S99RB                                           1256
         ST    @15,S99RBPTR                                        1256
*              S99RBPND = ON;                              /*#YL026UK*/
*                                                                  1257
         OI    S99RBPND,B'10000000'                                1257
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* LOAD REGISTER 1 WITH THE ADDR OF THE       #YL026UK*/
*              /* REQUEST BLOCK POINTER AND ISSUE THE        #YL026UK*/
*              /* DYNAMIC ALLOCATION REQUEST                 #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1258
*              IF GDTDBG = NULLPTR                                 1258
*                THEN;                                             1258
         L     @15,GDTDBG(,GDTPR)                                  1258
         LTR   @15,@15                                             1258
         BZ    @RT01258                                            1258
*                ELSE                                              1260
*                  CALL IDCDB010(GDTTBL,'ZZAL');                   1260
         ST    GDTPR,@AL00001                                      1260
         LA    @15,@CC02106                                        1260
         ST    @15,@AL00001+4                                      1260
         MVI   @AL00001+4,X'80'                                    1260
         L     @15,GDTDBG(,GDTPR)                                  1260
         LA    @01,@AL00001                                        1260
         BALR  @14,@15                                             1260
*                                                          /*#YL026UK*/
*              RESPECIFY (REG1) RSTD;                      /*#YL026UK*/
@RT01258 DS    0H                                                  1262
*              REG1 = ADDR(S99RBPTR);                      /*#YL026UK*/
         LA    REG1,S99RBPTR                                       1262
*L99SVC3:      GEN(SVC   99);                              /*#YL026UK*/
L99SVC3  SVC   99
*              RESPECIFY (REG1) UNRSTD;                    /*#YL026UK*/
*                                                                  1264
*              /******************************************************/
*              /*                                            #YL026UK*/
*              /* CHECK THE RETURN CODE FROM DYNAMIC         #YL026UK*/
*              /* ALLOCATION                                 #YL026UK*/
*              /*                                            #YL026UK*/
*              /******************************************************/
*                                                                  1265
*              RESPECIFY (RTNREG) RSTD;                    /*#YL026UK*/
*              RESPECIFY RTNREG RSTD;                              1266
*              TESTRC = RTNREG;                                    1267
         STH   RTNREG,TESTRC                                       1267
*              RESPECIFY RTNREG UNRSTD;                    /*#YL026UK*/
*              RESPECIFY (RTNREG) UNRSTD;                  /*#YL026UK*/
*              IF GDTDBG = NULLPTR                                 1270
*                THEN;                                             1270
         L     @15,GDTDBG(,GDTPR)                                  1270
         LTR   @15,@15                                             1270
         BZ    @RT01270                                            1270
*                ELSE                                              1272
*                  CALL IDCDB010(GDTTBL,'ZZAL');                   1272
         ST    GDTPR,@AL00001                                      1272
         LA    @15,@CC02106                                        1272
         ST    @15,@AL00001+4                                      1272
         MVI   @AL00001+4,X'80'                                    1272
         L     @15,GDTDBG(,GDTPR)                                  1272
         LA    @01,@AL00001                                        1272
         BALR  @14,@15                                             1272
*                                                          /*#YL026UK*/
*              IF TESTRC = 0                                       1273
*                THEN                                              1273
*                                                                  1273
@RT01270 SLR   @15,@15                                             1273
         CH    @15,TESTRC                                          1273
         BNE   @RF01273                                            1273
*                  /**************************************************/
*                  /*                                        #YL026UK*/
*                  /* DYNAMIC ALLOCATION WAS SUCCESSFUL--    #YL026UK*/
*                  /* RETURN THE DDNAME, THE DSORG AND SET   #YL026UK*/
*                  /* A RETURN CODE OF 0                     #YL026UK*/
*                  /*                                        #YL026UK*/
*                  /**************************************************/
*                                                                  1274
*                  DO;                                     /*#YL026UK*/
*                    SETRC = 0;                            /*#YL026UK*/
         STH   @15,SETRC                                           1275
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));      1276
*                    ALLDDN(1:8) = BLANKDDN;               /*@Y30SSMK*/
         L     @15,PARMPTR2                                        1277
         MVC   ALLDDN(8,@15),@CC02078                              1277
*                    ALLDDN(1:S99TULNG) = S99TUPAR(1:8);   /*@ZA00133*/
         LA    @14,TEXTDDN                                         1278
         ICM   @07,12,S99TULNG(@14)                                1278
         SRA   @07,16                                              1278
         BCTR  @07,0                                               1278
         EX    @07,@SM02475                                        1278
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTORG));      1279
*                    ALLORG(1:2) = S99TUPAR(1:2);          /*#YL026UK*/
         LA    @14,TEXTORG                                         1280
         MVC   ALLORG(2,@15),S99TUPAR(@14)                         1280
*                  END;                                    /*#YL026UK*/
*                ELSE                                              1282
*                                                                  1282
*                                                                  1282
*                    /************************************************/
*                    /*                                      @Z40GSBF*/
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1282
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1282
*                    /* CODE TO 4 AND RETURN TO CALLER             1282
*                    /*                                      @Z40GSBF*/
*                    /************************************************/
*                                                                  1282
*                    DO;                                   /*@Z40GSBF*/
         B     @RC01273                                            1282
@RF01273 DS    0H                                                  1283
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/
         LA    @15,ERRORTAB                                        1283
         ST    @15,ERCNVADR                                        1283
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/
         L     @14,S99RBPTR                                        1284
         ST    @14,ERDARBPT(,@15)                                  1284
*                      ERDYNAL = ON;                       /*@Z40GSBF*/
         OI    ERDYNAL(@15),B'00100000'                            1285
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/
         LH    @14,TESTRC                                          1286
         ST    @14,ERDYNRC(,@15)                                   1286
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/
         ST    GDTPR,@AL00001                                      1287
         LA    @15,ERCNVADR                                        1287
         ST    @15,@AL00001+4                                      1287
         MVI   @AL00001+4,X'80'                                    1287
         L     @15,GDTERR(,GDTPR)                                  1287
         LA    @01,@AL00001                                        1287
         BALR  @14,@15                                             1287
*                      SETRC = 4;                          /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   1288
*                    END;                                  /*#YL026UK*/
*            END;                                          /*#YL026UK*/
*                                                                  1290
@RC01273 DS    0H                                                  1291
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* RETURN CONTROL TO THE UALLOC CALLER              #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1291
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        1291
@RC01001 ST    GDTPR,@AL00001                                      1291
         LA    @15,MODID                                           1291
         ST    @15,@AL00001+4                                      1291
         LA    @15,SETRC                                           1291
         ST    @15,@AL00001+8                                      1291
         MVI   @AL00001+8,X'80'                                    1291
         L     @15,GDTEPL(,GDTPR)                                  1291
         LA    @01,@AL00001                                        1291
         BALR  @14,@15                                             1291
*        /*#YL026UK*/                                              1292
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* UDEALLOC ENTRY POINT                             #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  1292
*AMSSADL:  ENTRY(GDTTBLX,ALLAGLY);                         /*#YL026UK*/
*                                                                  1292
@EC01292 DS    0H                                                  1293
*AMSSADL1:                                                         1293
*                                                                  1293
*        RESPECIFY ALLAGL BASED(PARMPTR2);                 /*#YL026UK*/
AMSSADL1 DS    0H                                                  1294
*                                      /* BASE ALLOCATION    #YL026UK*/
*                                      /* ARGUMENT LIST      #YL026UK*/
*                                                                  1294
*        /* DSNAME OR DDNAME TO BE PRINTED IN UDEALLOC ERROR #YL026UK*/
*        /* MESSAGE                                          #YL026UK*/
*        DCL DEMSGT CHAR(44);                              /*#YL026UK*/
*                                                                  1294
*        /* STID FOR ERROR DURING UNALLOCATION               #YL026UK*/
*        DCL DEALSTID FIXED(8) CONSTANT(28);               /*#YL026UK*/
*                                                                  1295
*        /* UNALLOCATE STEPCAT RETURN CODE                   @Y30SSMK*/
*        DCL STEPRC FIXED(15) CONSTANT(12);                /*@Y30SSMK*/
*                                                                  1296
*        /* UNALLOCATE STEPCAT ERROR CODE                    @Y30SSMK*/
*        DCL STEPERR BIT(16) CONSTANT('0364'X);            /*@Y30SSMK*/
*                                                                  1297
*        /* UNALLOCATE STEPCAT INFO CODE                     @Y30SSMK*/
*        DCL STEPINFO BIT(16) CONSTANT('0004'X);           /*@Y30SSMK*/
*                                                                  1298
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1299
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/
*        GDTPR = ADDR1;                                    /*#YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               1300
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               1301
         ST    @00,PARMPTR2                                        1301
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/
*                                                                  1302
*        OLDERID2 = NEWERID2;                                      1303
         L     @01,GDTTR2(,GDTPR)                                  1303
         MVC   @TS00001(95),NEWERID2(@01)                          1303
         MVC   OLDERID2(95,@01),@TS00001                           1303
*        NEWID2 = 'SADL';                                  /*#YL026UK*/
*                                                                  1304
         MVC   NEWID2(4,@01),@CC02153                              1304
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* ZERO TEXT UNIT POINTER LIST AND REQUEST BLOCK    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1305
*        TUPL = '00'X;                                     /*#YL026UK*/
         XC    TUPL+1(31),TUPL+1                                   1305
         MVI   TUPL,X'00'                                          1305
*        S99RB = '00'X;                                    /*#YL026UK*/
         XC    S99RB+1(19),S99RB+1                                 1306
         MVI   S99RB,X'00'                                         1306
*        RESPECIFY S99TUPL BASED(ADDR(TUPL));              /*#YL026UK*/
*                                                                  1307
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK IF A DSNAME HAS BEEN SPECIFIED FOR         #YL026UK*/
*        /* UNALLOCATION                                     #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1308
*        IF ALLDSN ^= 0                                            1308
*          THEN                                                    1308
*                                                                  1308
         LR    @01,@00                                             1308
         L     @15,ALLDSN(,@01)                                    1308
         LTR   @15,@15                                             1308
         BZ    @RF01308                                            1308
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* BUILD DSNAME TEXT UNIT AND INSERT ITS ADDR   #YL026UK*/
*            /* IN CORRESPONDING ENTRY OF TEXT UNIT PTR LIST #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  1309
*            DO;                                           /*#YL026UK*/
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSN));    /*#YL026UK*/
*              S99TUKEY = DUNDSNAM;                        /*#YL026UK*/
         LA    @14,TEXTDSN                                         1311
         MVC   S99TUKEY(2,@14),@CB01415                            1311
*              S99TUNUM = 1;                               /*#YL026UK*/
         MVC   S99TUNUM(2,@14),@CH00215                            1312
*              S99TULNG = 44;                              /*#YL026UK*/
         MVC   S99TULNG(2,@14),@CH01652                            1313
*              S99TUPAR(1:44) = AGLDSN(1:44);              /*#YL026UK*/
         MVC   S99TUPAR(44,@14),AGLDSN(@15)                        1314
*              S99TUPTR(1) = ADDR(TEXTDSN);                /*#YL026UK*/
         LA    @15,TUPL                                            1315
         ST    @14,S99TUPTR(,@15)                                  1315
*            END;                                          /*#YL026UK*/
*          ELSE                                                    1317
*                                                                  1317
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* BUILD DDNAME TEXT UNIT AND INSERT ITS ADDR   #YL026UK*/
*            /* IN CORRESPONDING ENTRY OF TEXT UNIT PTR LIST #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  1317
*            DO;                                           /*#YL026UK*/
         B     @RC01308                                            1317
@RF01308 DS    0H                                                  1318
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*#YL026UK*/
*              S99TUKEY = DUNDDNAM;                        /*#YL026UK*/
         LA    @15,TEXTDDN                                         1319
         MVC   S99TUKEY(2,@15),@CB01413                            1319
*              S99TUNUM = 1;                               /*#YL026UK*/
         MVC   S99TUNUM(2,@15),@CH00215                            1320
*              S99TULNG = 8;                               /*#YL026UK*/
         MVC   S99TULNG(2,@15),@CH00175                            1321
*              S99TUPAR(1:8) = ALLDDN(1:8);                /*#YL026UK*/
         L     @14,PARMPTR2                                        1322
         MVC   S99TUPAR(8,@15),ALLDDN(@14)                         1322
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*#YL026UK*/
         LA    @14,TUPL                                            1323
         ST    @15,S99TUPTR+4(,@14)                                1323
*            END;                                          /*#YL026UK*/
*                                                                  1324
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK WHETHER OR NOT AN OVERRIDING DISPOSITION   #YL026UK*/
*        /* WAS SPECIFIED                                    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1325
*        IF ALLDSP = '00'X                                         1325
*          THEN                                                    1325
@RC01308 L     @01,PARMPTR2                                        1325
         CLI   ALLDSP(@01),X'00'                                   1325
         BE    @RT01325                                            1325
*              ;                                           /*#YM06134*/
*          ELSE                                                    1327
*                                                                  1327
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* AN OVERRIDING DISPOSITION EXISTS--BUILD A    #YL026UK*/
*            /* DISPOSITION TEXT UNIT. INSERT ITS ADDR IN    #YM06134*/
*            /* THE CORRESPONDING ENTRY OF THE TEXT UNIT     #YL026UK*/
*            /* POINTER LIST.                                #YM06134*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  1327
*            DO;                                           /*@YL026UK*/
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*@YL026UK*/
*              S99TUKEY = DUNOVDSP;                        /*@YL026UK*/
         LA    @15,TEXTDSP                                         1329
         MVC   S99TUKEY(2,@15),@CB01421                            1329
*              S99TUNUM = 1;                               /*@YL026UK*/
         LA    @14,1                                               1330
         STCM  @14,3,S99TUNUM(@15)                                 1330
*              S99TULNG = 1;                               /*@YL026UK*/
         STCM  @14,3,S99TULNG(@15)                                 1331
*              S99TUPAR(1) = ALLDSP(1);                    /*@YL026UK*/
         L     @14,PARMPTR2                                        1332
         MVC   S99TUPAR(1,@15),ALLDSP(@14)                         1332
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*@YL026UK*/
         LA    @14,TUPL                                            1333
         ST    @15,S99TUPTR+16(,@14)                               1333
*            END;                                          /*@YL026UK*/
*                                                                  1334
*        /************************************************************/
*        /*                                                  @YM06134*/
*        /*  IF THE UNALLOCATE OPTION HAS BEEN REQUESTED,    @Y30SSMK*/
*        /*  SET UP THE TEXT UNIT NEEDED TO OVERIDE THE      @YM06134*/
*        /*  PERMANENT ALLOCATION OF DATA SETS USED BY       @YM06134*/
*        /*  THE ALLOC COMMAND OF TSO.                       @Y30SSMK*/
*        /*  INSERT THE ADDR OF THIS UNIT IN THE POINTER     @YM06134*/
*        /*  LIST AT THE PROPER LOCATION.                    @YM06134*/
*        /*                                                  @YM06134*/
*        /************************************************************/
*                                                                  1335
*        IF ALLOPTUN = ON                                          1335
*          THEN                                                    1335
@RT01325 L     @01,PARMPTR2                                        1335
         TM    ALLOPTUN(@01),B'00010000'                           1335
         BNO   @RF01335                                            1335
*            DO;                                           /*@Y30SSMK*/
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTPERM));   /*#YM06134*/
*              S99TUKEY = DUNUNALC;                        /*#YM06134*/
         LA    @15,TEXTPERM                                        1338
         MVC   S99TUKEY(2,@15),@CB01425                            1338
*              S99TUNUM = 0;                               /*@YM06134*/
         SLR   @14,@14                                             1339
         STCM  @14,3,S99TUNUM(@15)                                 1339
*              S99TUPTR(7) = ADDR(TEXTPERM);               /*@YM06134*/
         LA    @14,TUPL                                            1340
         ST    @15,S99TUPTR+24(,@14)                               1340
*              S99TUPLN(7) = ON;                           /*@YM06134*/
         OI    S99TUPLN+24(@14),B'10000000'                        1341
*            END;                                          /*@Y30SSMK*/
*          ELSE                                                    1343
*            DO;                                           /*@Y30SSMK*/
         B     @RC01335                                            1343
@RF01335 DS    0H                                                  1344
*              IF ALLDSP = '00'X                                   1344
*                THEN                                              1344
         L     @15,PARMPTR2                                        1344
         CLI   ALLDSP(@15),X'00'                                   1344
         BNE   @RF01344                                            1344
*                  DO;                                     /*@Y30SSMK*/
*                    IF ALLDSN ^= NULLPTR                          1346
*                      THEN                                        1346
         L     @15,ALLDSN(,@15)                                    1346
         LTR   @15,@15                                             1346
         BZ    @RF01346                                            1346
*                        S99TUPLN(1) = ON;                 /*@Y30SSMK*/
         LA    @15,TUPL                                            1347
         OI    S99TUPLN(@15),B'10000000'                           1347
*                      ELSE                                        1348
*                        S99TUPLN(2) = ON;                 /*@Y30SSMK*/
         B     @RC01346                                            1348
@RF01346 LA    @15,TUPL                                            1348
         OI    S99TUPLN+4(@15),B'10000000'                         1348
*                  END;                                    /*@Y30SSMK*/
*                ELSE                                              1350
*                  S99TUPLN(5) = ON;                       /*@Y30SSMK*/
         B     @RC01344                                            1350
@RF01344 LA    @15,TUPL                                            1350
         OI    S99TUPLN+16(@15),B'10000000'                        1350
*            END;                                          /*@Y30SSMK*/
*                                                                  1351
@RC01344 DS    0H                                                  1352
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* INITIALIZE THE REQUEST BLOCK                     #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1352
*        S99RBLN = '14'X;                                  /*#YL026UK*/
@RC01335 MVI   S99RBLN,X'14'                                       1352
*        S99VERB = S99VRBUN;                               /*#YL026UK*/
         MVI   S99VERB,X'02'                                       1353
*        S99TXTPP = ADDR(TUPL);                            /*#YL026UK*/
*                                                                  1354
         LA    @15,TUPL                                            1354
         ST    @15,S99TXTPP                                        1354
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* INITIALIZE THE REQUEST BLOCK POINTER NOW WITH    #YL026UK*/
*        /* THE HIGH ORDER BIT TURNED ON                     #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1355
*        S99RBPTR = ADDR(S99RB);                           /*#YL026UK*/
         LA    @15,S99RB                                           1355
         ST    @15,S99RBPTR                                        1355
*        S99RBPND = ON;                                    /*#YL026UK*/
*                                                                  1356
         OI    S99RBPND,B'10000000'                                1356
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* LOAD REGISTER 1 WITH THE ADDRESS OF THE REQUEST  #YL026UK*/
*        /* BLOCK POINTER AND ISSUE THE DYNAMIC UNALLOCATE   #YL026UK*/
*        /* REQUEST                                          #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1357
*        IF GDTDBG = NULLPTR                                       1357
*          THEN;                                                   1357
         L     @15,GDTDBG(,GDTPR)                                  1357
         LTR   @15,@15                                             1357
         BZ    @RT01357                                            1357
*          ELSE                                                    1359
*            CALL IDCDB010(GDTTBL,'ZZDL');                         1359
         ST    GDTPR,@AL00001                                      1359
         LA    @15,@CC02164                                        1359
         ST    @15,@AL00001+4                                      1359
         MVI   @AL00001+4,X'80'                                    1359
         L     @15,GDTDBG(,GDTPR)                                  1359
         LA    @01,@AL00001                                        1359
         BALR  @14,@15                                             1359
*                                                          /*#YL026UK*/
*        RESPECIFY (REG1) RSTD;                            /*#YL026UK*/
@RT01357 DS    0H                                                  1361
*        REG1 = ADDR(S99RBPTR);                            /*#YL026UK*/
         LA    REG1,S99RBPTR                                       1361
*L99SVC4:GEN(SVC   99);                                    /*#YL026UK*/
L99SVC4  SVC   99
*        RESPECIFY (REG1) UNRSTD;                          /*#YL026UK*/
*                                                                  1363
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK THE RETURN CODE                            #YL026UK*/
*        /* FROM DYNAMIC ALLOCATION TO SEE IF ERROR MESSAGES #YL026UK*/
*        /* ARE TO BE PRINTED.                               #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1364
*        RESPECIFY (RTNREG) RSTD;                          /*#YL026UK*/
*        RESPECIFY RTNREG RSTD;                                    1365
*        TESTRC = RTNREG;                                          1366
         STH   RTNREG,TESTRC                                       1366
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/
*        RESPECIFY (RTNREG) UNRSTD;                        /*#YL026UK*/
*        IF GDTDBG = NULLPTR                                       1369
*          THEN;                                                   1369
         L     @15,GDTDBG(,GDTPR)                                  1369
         LTR   @15,@15                                             1369
         BZ    @RT01369                                            1369
*          ELSE                                                    1371
*            CALL IDCDB010(GDTTBL,'ZZDL');                         1371
         ST    GDTPR,@AL00001                                      1371
         LA    @15,@CC02164                                        1371
         ST    @15,@AL00001+4                                      1371
         MVI   @AL00001+4,X'80'                                    1371
         L     @15,GDTDBG(,GDTPR)                                  1371
         LA    @01,@AL00001                                        1371
         BALR  @14,@15                                             1371
*                                                          /*#YL026UK*/
*        IF (TESTRC ^= 0) & (TESTRC ^= 4)                  /*@YM07819*/
*          THEN                                                    1372
@RT01369 LH    @15,TESTRC                                          1372
         SLR   @14,@14                                             1372
         CR    @15,@14                                             1372
         BE    @RF01372                                            1372
         C     @15,@CF00038                                        1372
         BE    @RF01372                                            1372
*            DO;                                                   1373
*                                                                  1373
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* ERROR MESSAGES ARE TO BE PRINTED             #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  1374
*            IF (TESTRC = STEPRC  &  S99ERROR = STEPERR  &         1374
*              S99INFO = STEPINFO)                                 1374
*              THEN                                                1374
*                                                                  1374
         C     @15,@CF00034                                        1374
         BNE   @RF01374                                            1374
         CLC   S99ERROR(2),@CB02151                                1374
         BNE   @RF01374                                            1374
         CLC   S99INFO(2),@CB01419                                 1374
         BNE   @RF01374                                            1374
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /* THE DATA SET THAT WAS UNALLOCATED WAS    @Y30SSMK*/
*                /* ALSO A STEPCAT.  DO NOT CONSIDER THIS    @Y30SSMK*/
*                /* AS AN ERROR SINCE DYNAMIC ALLOCATION     @Y30SSMK*/
*                /* WILL NOT UNALLOCATE IT.                  @Y30SSMK*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  1375
*                SETRC = 0;                                /*@Y30SSMK*/
         STH   @14,SETRC                                           1375
*              ELSE                                                1376
*                                                                  1376
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*     TEST FOR TSO IF IT IS THEN CALL UERROR     1376
*                /*     TO PRINT ERROR MESSAGES AND SET RETURN     1376
*                /*     CODE TO 4 AND RETURN TO CALLER             1376
*                /*                                          @Z40GSBF*/
*                /****************************************************/
*                                                                  1376
*                DO;                                       /*@Z40GSBF*/
         B     @RC01374                                            1376
@RF01374 DS    0H                                                  1377
*                  ERRORTAB = ''B;                         /*@ZM43202*/
         XC    ERRORTAB(32),ERRORTAB                               1377
*                  ERCNVADR = ADDR(ERRORTAB);              /*@Z40GSBF*/
         LA    @15,ERRORTAB                                        1378
         ST    @15,ERCNVADR                                        1378
*                  ERDARBPT = S99RBPTR;                    /*@Z40GSBF*/
         L     @14,S99RBPTR                                        1379
         ST    @14,ERDARBPT(,@15)                                  1379
*                  ERDYNAL = ON;                           /*@Z40GSBF*/
         OI    ERDYNAL(@15),B'00100000'                            1380
*                  ERDYNRC = TESTRC;                       /*@Z40GSBF*/
         LH    @14,TESTRC                                          1381
         ST    @14,ERDYNRC(,@15)                                   1381
*                  CALL IDCTPER0(GDTTBL,ERCNVADR);         /*@Z40GSBF*/
         ST    GDTPR,@AL00001                                      1382
         LA    @15,ERCNVADR                                        1382
         ST    @15,@AL00001+4                                      1382
         MVI   @AL00001+4,X'80'                                    1382
         L     @15,GDTERR(,GDTPR)                                  1382
         LA    @01,@AL00001                                        1382
         BALR  @14,@15                                             1382
*                  SETRC = 4;                              /*#YL026UK*/
         MVC   SETRC(2),@CH00038                                   1383
*                END;                                              1384
*                                                                  1384
*            END;                                          /*@YL026UK*/
*          ELSE                                                    1386
*                                                                  1386
*            /********************************************************/
*            /*                                              @YL026UK*/
*            /* NO ERROR MEGGAGES ARE TO BE PRINTED          @YL026UK*/
*            /*                                              @YL026UK*/
*            /********************************************************/
*                                                                  1386
*            SETRC = 0;                                    /*@YL026UK*/
*                                                                  1386
         B     @RC01372                                            1386
@RF01372 SLR   @15,@15                                             1386
         STH   @15,SETRC                                           1386
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* RETURN CONTROL TO THE UDEALLOC CALLER WITH THE   @YL026UK*/
*        /* RETURN CODE FROM UDEALLOC                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1387
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        1387
@RC01372 ST    GDTPR,@AL00001                                      1387
         LA    @15,MODID                                           1387
         ST    @15,@AL00001+4                                      1387
         LA    @15,SETRC                                           1387
         ST    @15,@AL00001+8                                      1387
         MVI   @AL00001+8,X'80'                                    1387
         L     @15,GDTEPL(,GDTPR)                                  1387
         LA    @01,@AL00001                                        1387
         BALR  @14,@15                                             1387
*        /*@YL026UK*/                                              1388
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* UCIR ENTRY POINT                                 @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  1388
*AMSSACR:  ENTRY(GDTTBLX,CIRAGLX);                         /*@YL026UK*/
*                                                                  1388
@EC01388 DS    0H                                                  1389
*AMSSACR1:                                                         1389
*                                                                  1389
*        RESPECIFY CIRAGL BASED(PARMPTR2);                 /*@YL026UK*/
AMSSACR1 DS    0H                                                  1390
*                                      /* BASE CATALOG       @YL026UK*/
*                                      /* INTERFACE ARGUMENT @YL026UK*/
*                                      /* LIST               @YL026UK*/
*                                                                  1390
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1390
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/
*        GDTPR = ADDR1;                                    /*@YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               1391
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               1392
         ST    @00,PARMPTR2                                        1392
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/
*                                                                  1393
*        OLDERID2 = NEWERID2;                                      1394
         L     @15,GDTTR2(,GDTPR)                                  1394
         MVC   @TS00001(95),NEWERID2(@15)                          1394
         MVC   OLDERID2(95,@15),@TS00001                           1394
*        NEWID2 = 'SACR';                                  /*@YL026UK*/
         MVC   NEWID2(4,@15),@CC02177                              1395
*        IF GDTDBG = NULLPTR                                       1396
*          THEN;                                                   1396
         L     @15,GDTDBG(,GDTPR)                                  1396
         LTR   @15,@15                                             1396
         BZ    @RT01396                                            1396
*          ELSE                                                    1398
*            CALL IDCDB010(GDTTBL,'ZZCR');                         1398
         ST    GDTPR,@AL00001                                      1398
         LA    @15,@CC02178                                        1398
         ST    @15,@AL00001+4                                      1398
         MVI   @AL00001+4,X'80'                                    1398
         L     @15,GDTDBG(,GDTPR)                                  1398
         LA    @01,@AL00001                                        1398
         BALR  @14,@15                                             1398
*                                                          /*@YL026UK*/
*                                                                  1399
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* DECLARES USED BY THE UCIR ROUTINE                @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1399
*        /* ADDRESS OF VSAM CATALOG PARAMETER LIST           @YL026UK*/
*        DCL CTGPLPTR PTR (31);                            /*@YL026UK*/
*                                                                  1399
@RT01396 DS    0H                                                  1400
*        /* INCLUDE CATALOG PARAMETER LIST STRUCTURE         @YL026UK*/
*/********************************************************************/
*/*                                                                  */
*/*   MACRO NAME = IEZCTGPL                                          */
*/*                                                                  */
*/*   DESCRIPTIVE NAME = CATALOG PARAMETER LIST                      */
*/*                                                                  */
*/*   FUNCTION = THE CATALOG PARAMETER LIST (CTGPL) DEFINES THE      */
*/*              CATALOG MANAGEMENT REQUEST AND ITS OPTIONS, THE     */
*/*              CATALOG RECORD TO BE PROCESSED, AND THE VSAM        */
*/*              CATALOG THAT CONTAINES THE RECORD.  THE CTGPL IS    */
*/*              BUILT BEFORE AN OS/VS COMPONENT ISSUES THE CATLG    */
*/*              MACRO INSTRUCTION (SVC 26) TO PROCESS A CATALOG     */
*/*              RECORD.  WHEN THE CATALOG MANAGEMENT ROUTINES       */
*/*              BUILD A CCA TO SUPPORT THE REQUEST, THE ADDRESS     */
*/*              OF THE CTGPL IS PUT INTO THE CCA (CCACPL).          */
*/*                                                                  */
*/*   CONTROL BLOCK STRUCTURE = THE CTGPL IS POINTED TO BY           */
*/*                             REGISTER 1.                          */
*/*                                                                  */
*/*   INCLUDED MACROS = NONE                                         */
*/*                                                                  */
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */
*/*                                                                  */
*/*   STATUS = VS/2 RELEASE 4   (CHANGE FLAG @Z40WSXX)       @Z40WSSG*/
*/*                                                                  */
*/*   DATE OF LAST CHANGE = 16 AUG 77                        @ZA20773*/
*/*                                                                  */
*/********************************************************************/
*   DECLARE                                                        1400
*     1 CTGPL BASED(CTGPLPTR)       /* DECLARE CTGPL LEVEL ONE       */
*        BDY(WORD),                 /* WORD BOUNDARY                 */
*       5 CTGOPTN1 BIT(8),          /* FIRST OPTION INDICATOR        */
*         10 CTGBYPSS BIT(1),       /* BYPASS                        */
*         10 CTGMAST  BIT(1),       /* VERIFY MASTER PASSWORD        */
*         10 CTGCI    BIT(1),       /* VERIFY CONTROL INTERVAL       */
*         10 CTGUPD   BIT(1),       /* VERIFY UPDATE                 */
*         10 CTGREAD  BIT(1),       /* VERIFY READ                   */
*         10 CTGNAME  BIT(1),       /* 1 = 44-BYTE NAME OR VOL SER,  */
*                                   /* 0 = ENTRY ID NUMBER           */
*         10 CTGCNAME BIT(1),       /* 1 = 44-BYTE NAME,             */
*                                   /* 0 = ACB ADDRESS               */
*         10 CTGGENLD BIT(1),       /* GENERIC LOCATE REQUEST  Y02020*/
*       5 CTGOPTN2 BIT(8),          /* SECOND OPTION INDICATOR       */
*         10 CTGEXT   BIT(1),       /* EXTEND       (UPDATE)         */
*            15 CTGNSVS BIT(1),     /* CATLG CLEANUP REQUEST @ZA00605*/
*         10 CTGERASE BIT(1),       /* ERASE        (DELETE)         */
*            15 CTGSMF   BIT(1),    /* WRITE SMF    (LSPACE)         */
*               20 CTGREL   BIT(1), /* RELEASE      (UPDATE)         */
*                  25 CTGGTALL BIT(1),/* CONCAT SEARCH  FOR    Y02020*/
*                                   /* (LISTCAT)               Y02020*/
*         10 CTGPURG  BIT(1),       /* PURGE        (DELETE)         */
*           15 CTGVMNT BIT(1),      /* VOLUME MOUNT CALLER           */
*              20 CTGRCATN BIT(1),  /* RTN CATLG NAME(GLOC)    Y02020*/
*                 25 CTGSWAP BIT(1),/* SWAPSPACE (DEFINE)    @Z40WSSG*/
*         10 CTGGTNXT BIT(1),       /* GET NEXT     (LIST CATALOG)   */
*         10 CTGDISC BIT(1),        /* DISCONNECT   (DELETE)         */
*         10 CTGOVRID BIT(1),       /* ERASE OVERRIDE (DELETE)       */
*         10 CTGSCR   BIT(1),       /* SCRATCH SPACE (DELETE)        */
*         10 *        BIT(1),       /* RESERVED                      */
*       5 CTGOPTN3 BIT(8),          /* THIRD OPTION INDICATOR        */
*         10 CTGFUNC  BIT(3),       /* CATALOG FUNCTION              */
*         10 CTGSUPLT BIT(1),       /* SUPER LOCATE                  */
*         10 CTGGDGL  BIT(1),       /* GDG LOCATE REQUEST      Y02020*/
*                                   /* WITH BASE LEVEL GIVEN   Y02020*/
*                                   /* (CTGWAGB IN CTGWA)      Y02020*/
*         10 CTGSRH   BIT(1),       /* 0 = SEARCH MASTER CATLG Y02020*/
*                                   /*     ONLY                Y02020*/
*                                   /* 1 = SEARCH OS CATALOG FIRST   */
*         10 CTGNUM   BIT(1),       /* 0 = SEARCH BOTH CATALOGS,     */
*                                   /* 1 = SEARCH ONE CATALOG        */
*         10 CTGAM0   BIT(1),       /* VSAM REQ VERSUS NONVSAM       */
*       5 CTGOPTN4 BIT(8),          /* GDG FLAGS                     */
*         10 CTGLBASE BIT(1),       /* LOCATE GDG BASE ONLY Y02020   */
*         10 CTGDOCAT BIT(1),       /* DO NOT OPEN NEEDED CATALOG    */
*         10 CTGNPROF BIT(1),       /* NO (RAC) PROFILE SHOULD BE  1400
*                                      DEFINED OR DELETED    @Z40RSRC*/
*         10 CTGCOIN  BIT(1),       /* CONTROLLER INTERCEPT REQUESTED
*                                                            @ZA20773*/
*         10 CTGBYPMT BIT(1),       /* BYPASS SECURITY PROMPTING   1400
*                                       TO SYSTEM OPERATOR   @ZA07531*/
*         10 CTGTIOT  BIT(1),       /* CALLER OWNS SYSZTIOT EXCLUSIVE
*                                                            @ZA20773*/
*         10 *        BIT(2),       /* RESERVED              @ZA20773*/
*       5 CTGENT   PTR(31),         /* USER ENTRY ADDR OR PTR TO VOLUME
*                                        SERIAL NUMBER (LSPACE)      */
*         10 CTGFVT   PTR(31),      /* FVT ADDRESS (DEFINE, ALTER)   */
*       5 CTGCAT   PTR(31),         /* CATALOG POINTER               */
*         10 CTGCVOL PTR(31),       /* CVOL PTR (SUPER LOCATE)       */
*       5 CTGWKA  PTR(31),          /* WORKAREA ADDR                 */
*       5 CTGDSORG CHAR(2),         /* DATA SET ORG - SUPERLOCATE    */
*         10 CTGOPTNS BIT(5),       /* CMS OPTIONS                   */
*         10 *        BIT(11),      /* RESERVED                      */
*       5 CTGTYPE  CHAR(1),         /* ENTRY TYPE - LISTCAT, DELETE  */
*       5 CTGNOFLD PTR(8),          /* NUMBER OF FIELD POINTERS      */
*       5 CTGDDNM PTR(31),          /* DD NAME ADDR                  */
*         10 CTGNEWNM PTR(31),      /* NEWNAME ADDRESS - ALTER       */
*            15 CTGFDBK  PTR(16),   /* SUPER LOCATE FEEDBACK         */
*            15 CTGFBFLG BIT(16),   /* SUPER LOCATE FLAGS            */
*               20 CTGPAR   BIT(1), /* PARALLEL MOUNT -SUPERLOCATE   */
*               20 CTGKEEP  BIT(1), /* FORCED KEEP - SUPERLOCATE     */
*               20 CTGGDGB  BIT(1), /* GDG BASE LOCATE         Y02020*/
*               20 CTGNGDSN BIT(1), /* GDG NAME GENERATED      Y02020*/
*               20 *        BIT(12), /* RESERVED               Y02020*/
*       5 CTGJSCB  PTR(31),         /* JSCB ADDR                     */
*         10 CTGPSWD  PTR(31),      /* PASSWORD ADDR                 */
*       5 CTGFIELD(*) PTR(31) ;        /* FIELD POINTERS             */
*/********************************************************************/
*/*     CONSTANTS USED TO SET AND/OR TEST FIELDS DECLARED ABOVE      */
*/********************************************************************/
*   DECLARE                         /* CATALOG FUNCTION - CTGFUNC    */
*     CTGLOC   BIT(3) CONSTANT('001'B), /* LOCATE                    */
*     CTGLSP   BIT(3) CONSTANT('010'B), /* LSPACE                    */
*     CTGUPDAT BIT(3) CONSTANT('011'B), /* UPDATE                    */
*     CTGCMS   BIT(3) CONSTANT('100'B); /* CMS FUNCTION              */
*   DECLARE                         /* CMS OPTIONS - CTGOPTNS        */
*     CTGDEFIN BIT(5) CONSTANT('00001'B), /* DEFINE                  */
*     CTGALTER BIT(5) CONSTANT('00010'B), /* ALTER                   */
*     CTGDELET BIT(5) CONSTANT('00011'B), /* DELETE                  */
*     CTGLTCAT BIT(5) CONSTANT('00100'B), /* LIST CATALOG            */
*     CTGCNVTV BIT(5) CONSTANT('00110'B); /* CONVERTV        @Y30LSPS*/
*   DECLARE                           /* RECORD ENTRY TYPE - CTGTYPE */
*     CTGTDATA CHAR(1) CONSTANT('D'), /* DATA                        */
*     CTGTINDX CHAR(1) CONSTANT('I'), /* INDEX                       */
*     CTGTALIN CHAR(1) CONSTANT('A'), /* ALIEN                       */
*     CTGTUCAT CHAR(1) CONSTANT('U'), /* USER CATALOG                */
*     CTGTVOL  CHAR(1) CONSTANT('V'), /* VOLUME                      */
*     CTGTCL   CHAR(1) CONSTANT('C'), /* CLUSTER                     */
*     CTGTAIX  CHAR(1) CONSTANT('G'), /* ALTERNATE INDEX     @Y30SSPJ*/
*     CTGTPATH CHAR(1) CONSTANT('R'), /* PATH                @Y30SSPJ*/
*     CTGTFREE CHAR(1) CONSTANT('F'), /* FREE                @Y30SSPJ*/
*     CTGTPTH  CHAR(1) CONSTANT('R'), /* PATH                @Y30SSSB*/
*     CTGTUPG  CHAR(1) CONSTANT('Y'), /* UPGRADE             @Y30SSSB*/
*     CTGTGBS  CHAR(1) CONSTANT('B'), /* GDG BASE              Y02020*/
*     CTGTANM  CHAR(1) CONSTANT('X'), /* ALIAS NAME            Y02020*/
*     CTGTPGSP CHAR(1) CONSTANT('P'), /* PAGE SPACE            Y02020*/
*     CTGTMCAT CHAR(1) CONSTANT('M'); /* MASTER CATALOG              */
*/********************************************************************/
*/*                 PROBLEM  DETERMINATION  FIELDS                   */
*/********************************************************************/
*   DECLARE                                                        1404
*     1 * DEF(CTGDDNM),             /* PROBLEM DETERMINATION @Y30SSJG*/
*       2 CTGPROB CHAR(4),          /* PROBLEM DETERMINATION @Y30SSJG*/
*         3 CTGMODID CHAR(2),       /* MODULE IDENTIFICATION @Y30SSJG*/
*         3 CTGREASN CHAR(2),       /* REASON CODE           @Y30SSJG*/
*           4 CTGREAS1 CHAR(1),     /* HIGH ORDER BYTE ZERO  @Y30SSJG*/
*           4 CTGREAS2 CHAR(1);     /* REASON CODE LOW BYTE  @Y30SSJG*/
*                                                                  1404
*        /* DYNAMIC STORAGE FOR CATALOG PARAMETER LIST       @YL026UK*/
*        DCL CATLIST CHAR (LENGTH (CTGPL));                /*@YL026UK*/
*                                                                  1405
*        /* WORKAREA WHERE CATALOG RETURNS INFORMATION       @YL026UK*/
*        DCL 1 WORKAREA BDY (WORD) BASED (POOLADDR),               1406
*              2 WORKNUM FIXED (32) UNSIGNED, /* NUMBER MATCHING */
*                                                          /*@OZ04524*/
*                3 WORKLEN FIXED (16) UNSIGNED, /* SET WORKAREA LEN */
*                                                          /*@OZ04524*/
*                3 WORKRET FIXED (16) UNSIGNED, /* LENGTH RETURNED */
*                                                          /*@OZ04524*/
*              2 WORKENT (8) CHAR (45),/* ENTRIES            @YL026UK*/
*                3 ENTTYPE CHAR (1),   /* ENTRY TYPE         @YL026UK*/
*                3 DSNAME CHAR (44);   /* DATA SET NAME      @YL026UK*/
*                                                                  1406
*        /* ADDRESS OF DSNAME BEING PROCESSED                @YL026UK*/
*        DCL COMPPTR PTR (31);                             /*@YL026UK*/
*                                                                  1407
*        /* DATA SET NAME BEING PROCESSED                    @YL026UK*/
*        DCL COMPNAME CHAR (44) BASED (COMPPTR);           /*@YL026UK*/
*                                                                  1408
*        /* ADDRESS OF TRAILING QUALIFIERS TO COMPARE        @YL026UK*/
*        DCL CTRLPTR PTR (31);                             /*@YL026UK*/
*                                                                  1409
*        /* TRAILER QUALIFIERS IN DSNAME TO COMPARE          @YL026UK*/
*        DCL DSCMPTRL CHAR (44) BASED (CTRLPTR);           /*@YL026UK*/
*                                                                  1410
*        /* ENTRY TYPE IDENTIFYING A CATALOG                 @YL026UK*/
*        DCL CATTYPE CHAR (1) CONSTANT ('0');              /*@YL026UK*/
*                                                                  1411
*        /* RETURN CODE FROM GENERIC LOCATE                  @YL026UK*/
*        DCL CATRC FIXED (15);                             /*@YL026UK*/
*                                                                  1412
*        /* MAXIMUM NUMBER OF ENTRIES IN WORKAREA            @OZ18318*/
*        DCL MAXNO FIXED (31) CONSTANT (1456);             /*@OZ18318*/
*                                                                  1413
*        /* INITIAL NUMBER OF ENTRIES IN WORKAREA            @YL026UK*/
*        DCL INITNO FIXED (31) CONSTANT (182);             /*@OZ26403*/
*                                                                  1414
*        /* NUMBER OF ENTRIES IN WORKAREA                    @YL026UK*/
*        DCL WNOENT FIXED(31);                             /*@YL026UK*/
*                                                                  1415
*        /* AMOUNT OF STORAGE REQUESTED                      @YL026UK*/
*        DCL POOLSIZE FIXED (31);                          /*@YL026UK*/
*                                                                  1416
*        /* ADDRESS OF UGPOOL AREA                           @YL026UK*/
*        DCL POOLADDR PTR (31);                            /*@YL026UK*/
*                                                                  1417
*        /* WORKAREA WHERE POOL ADDRESS RETURNED TO USER     @YL026UK*/
*        DCL RETPOOL PTR (31) BASED (CIRWKP);              /*@YL026UK*/
*                                                                  1418
*        /* NAME WORKAREA REQUIRED BY CATALOG                @YL026UK*/
*        DCL 1 NAMEAREA BDY (WORD),                                1419
*              2 NAMELEN FIXED (8),    /* LENGTH OF QUAL     @YL026UK*/
*              2 LOCNAME CHAR (44);    /* LOCATE QUALIFIER   @YL026UK*/
*                                                                  1419
*        /* HEADER QUALIFIER SUPPLIED IN CIRAGL              @YL026UK*/
*        DCL HEADER CHAR (44) BASED (CIRHDR);              /*@YL026UK*/
*                                                                  1420
*        /* TRAILER QUALIFIER SUPPLIED BY CIRAGL             @YL026UK*/
*        DCL TRAILER CHAR (44) BASED (CIRTLR);             /*@YL026UK*/
*                                                                  1421
*        /* STID NUMBER FOR NO STORAGE AVAILABLE             @YL026UK*/
*        DCL NOCRSTID FIXED (8) CONSTANT (26);             /*@YL026UK*/
*                                                                  1422
*        /* STID NUMBER FOR ERROR FROM CATALOG               @YL026UK*/
*        DCL ECATSTID FIXED (8) CONSTANT (7);              /*@YL026UK*/
*                                                                  1423
*        /* STID FOR ENTRY XX NOT FOUND                      @ZA01484*/
*        DCL NOTFSTID FIXED(8) CONSTANT(13);               /*@ZA01484*/
*                                                                  1424
*        /* RETURN CODE FROM CATALOG WHEN WORKAREA IS        @YL026UK*/
*        /* TOO SMALL AND REQUIRED LENGTH COULD NOT BE       @YL026UK*/
*        /* DETERMINED.                                      @YL026UK*/
*        DCL LARGSIZE FIXED (15) CONSTANT (44);            /*@YL026UK*/
*                                                                  1425
*        /* RETURN CODE FROM CATALOG IF WORKAREA IS T00 SMALL@YL026UK*/
*        /* AND REQUIRED LENGTH IS RETURNED IN THE WORKAREA. @YL026UK*/
*        DCL KNOWSIZE FIXED (15) CONSTANT (40);            /*@YL026UK*/
*                                                                  1426
*        /* RETURN CODE THAT IS RETURNED TO CALLER           @YL026UK*/
*        DCL UCIRRC FIXED (15);                            /*@YL026UK*/
*                                                                  1427
*        /* INDICATOR FOR UGPOOL AND UCATLG LOOP             @YL026UK*/
*        DCL ACTION FIXED (15);                            /*@YL026UK*/
*                                                                  1428
*        /* STOP LOOP PROCESSING                             @YL026UK*/
*        DCL STOP FIXED (15) CONSTANT (0);                 /*@YL026UK*/
*                                                                  1429
*        /* PROCESS LOOP AGAIN                               @YL026UK*/
*        DCL AGAIN FIXED (15) CONSTANT (4);                /*@YL026UK*/
*                                                                  1430
*        /* ERROR DETECTED IN LOOP                           @YL026UK*/
*        DCL ERROR FIXED (15) CONSTANT (8);                /*@YL026UK*/
*                                                                  1431
*        /* STATUS OF ENTRY BEING CHECKED                    @YL026UK*/
*        DCL MATCH FIXED (15);                             /*@YL026UK*/
*                                                                  1432
*        /* ENTRY DOES NOT MATCH                             @YL026UK*/
*        DCL NOTEQUAL FIXED (15) CONSTANT (0);             /*@YL026UK*/
*                                                                  1433
*        /* ENTRY MATCHES USER SPECIFICATIONS                @YL026UK*/
*        DCL EQUAL FIXED (15) CONSTANT (4);                /*@YL026UK*/
*                                                                  1434
*        /* ALL ENTRIES ARE EQUAL                            @YL026UK*/
*        DCL ALLEQUAL FIXED (15) CONSTANT (8);             /*@YL026UK*/
*                                                                  1435
*        /* STATUS INDICATOR WHEN SEARCHING FOR QUALIFIER    @YL026UK*/
*        /* SEPARATOR.                                       @YL026UK*/
*        DCL SEPER FIXED (15);                             /*@YL026UK*/
*                                                                  1436
*        /* SEPARATOR NOT FOUND                              @YL026UK*/
*        DCL NOTFOUND FIXED (15) CONSTANT (0);             /*@YL026UK*/
*                                                                  1437
*        /* SEPARATOR FOUND                                  @YL026UK*/
*        DCL FOUND FIXED (15) CONSTANT (4);                /*@YL026UK*/
*                                                                  1438
*        /* FIRST CHARACTER OFFSET TO QUAL AFTER HEADER      @YL026UK*/
*        DCL NEXTQUAL FIXED (15);                          /*@YL026UK*/
*                                                                  1439
*        /* TOTAL LENGTH OF DATA SET NAME                    @YL026UK*/
*        DCL TOTALLEN FIXED (15) CONSTANT (44);            /*@YL026UK*/
*                                                                  1440
*        /* COUNTER TO CHECK EACH RETURNED ENTRY             @YL026UK*/
*        DCL CKENT FIXED (15);                             /*@YL026UK*/
*                                                                  1441
*        /* COUNTER USED TO CHECK BYTES IN DSNAME ENTRY      @YL026UK*/
*        DCL BYTECTR FIXED (15);                           /*@YL026UK*/
*                                                                  1442
*        /* OFFSET TO TRAILING QUALIFIER IN DATA SET NAME    @YL026UK*/
*        DCL TRLQUAL FIXED (15);                           /*@YL026UK*/
*                                                                  1443
*        /* BYTE OFFSET OF BYTE PRECEDING TRAILER QUAL       @YL026UK*/
*        DCL TOTRAIL FIXED (15);                           /*@YL026UK*/
*                                                                  1444
*        /* NEXT BYTE AFTER THE LAST BYTE OF TRAILER         @YL026UK*/
*        DCL LASTBYTE FIXED (15);                          /*@YL026UK*/
*                                                                  1445
*        /* LENGTH OF QUALIFIER SPECIFIED BY CIRAGL          @YL026UK*/
*        DCL TRLLEN FIXED (15);                            /*@YL026UK*/
*                                                                  1446
*        /* TOTAL NUMBER OF ENTRIES RETURNED BY CATALOG      @YL026UK*/
*        DCL CATRETNO FIXED (15);                          /*@YL026UK*/
*                                                                  1447
*        /* RETURN CODE IF NO ENTRIES IN LIST,  SAME         @YL026UH*/
*        /* CODE CATALOG MANAGEMENT RETURNS IF NO ENTRY      @YL026UH*/
*        /* IS FOUND.                                        @YL026UH*/
*        DCL NODSENT FIXED (15) CONSTANT (8);              /*@YL026UH*/
*                                                                  1448
*        /* CATALOG RETURN CODE = 8, NO ENTRY FOUND          @Y30SSMK*/
*        DCL CATRC8 FIXED(15) CONSTANT(8);                 /*@Y30SSMK*/
*                                                                  1449
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* CHECK FOR CONDITION WHERE BOTH THE ONE QUAL      @YL026UK*/
*        /* FUNCTION AND THE ALL QUAL FUNCTION IS REQUESTED  @YL026UK*/
*        /* OR WHERE NEITHER IS REQUESTED--UABORT IF EITHER  @YL026UK*/
*        /* CONDITION IS DECTECTED.                          @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1450
*        IF (CIRTYP1Q = ON & CIRTYPAQ = ON)                       1450
*           (CIRTYP1Q = OFF & CIRTYPAQ = OFF)                      1450
*          THEN                                                    1450
*                                                                  1450
         L     @15,PARMPTR2                                        1450
         TM    CIRTYP1Q(@15),B'11000000'                           1450
         BO    @RT01450                                            1450
         TM    CIRTYP1Q(@15),B'11000000'                           1450
         BNZ   @RF01450                                            1450
@RT01450 DS    0H                                                  1451
*            DO;                                                   1451
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  1452
*              REG15 = ARGERR;                                     1453
         LA    REG15,40                                            1453
*              REG14 = GDTABT;                                     1454
         L     REG14,GDTABT(,GDTPR)                                1454
*              REG13 = GDTABH;                                     1455
         L     REG13,GDTABH(,GDTPR)                                1455
*              GEN(BR    REG14);                                   1456
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 1457
*            END;                               /*@YL026UK*/       1458
*                                                                  1458
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* INITIALIZE RETURN CODE.                          @YL026UK*/
*        /* SET ADDRESSABILITY AND INITIALIZE MESSAGE AREA.  @YL026UK*/
*        /* SET ADDRESSABILITY TO CATALOG PARAMETER LIST.    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1459
*        UCIRRC = 0;                                       /*@YL026UK*/
@RF01450 SLR   @15,@15                                             1459
         STH   @15,UCIRRC                                          1459
*        DDSTRU = ADDR (MSGAREA);                          /*@YL026UK*/
         LA    @14,MSGAREA                                         1460
         ST    @14,DDSTRU                                          1460
*        DARGLIST = ''B;                                   /*@YL026UK*/
*                                                                  1461
         XC    DARGLIST(20,@14),DARGLIST(@14)                      1461
*        CTGPLPTR = ADDR (CATLIST);                        /*@YL026UK*/
*                                                                  1462
         LA    @14,CATLIST                                         1462
         ST    @14,CTGPLPTR                                        1462
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* INITIALIZE CTGPL FLAGS AND SET GENERIC NAME      @YL026UK*/
*        /* TO BE LOCATED.                                   @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1463
*        CATLIST = ''B;                                    /*@YL026UK*/
         XC    CATLIST(28),CATLIST                                 1463
*        CTGNAME = ON;                                     /*@YL026UK*/
         OI    CTGNAME(@14),B'00000100'                            1464
*        CTGSUPLT = ON;                                    /*@YL026UK*/
         OI    CTGSUPLT(@14),B'00010000'                           1465
*        CTGGENLD = ON;                                    /*@YL026UK*/
         OI    CTGGENLD(@14),B'00000001'                           1466
*        CTGAM0 = ON;                                      /*@YL026UK*/
         OI    CTGAM0(@14),B'00000001'                             1467
*        CTGRCATN = ON;                                    /*@YL026UK*/
*                                                                  1468
         OI    CTGRCATN(@14),B'00100000'                           1468
*        NAMELEN = CIRHLN;                                 /*@YL026UK*/
         L     @07,PARMPTR2                                        1469
         LH    @06,CIRHLN(,@07)                                    1469
         STC   @06,NAMELEN                                         1469
*        LOCNAME = ' ';                                    /*@YL026UK*/
         MVI   LOCNAME+1,C' '                                      1470
         MVC   LOCNAME+2(42),LOCNAME+1                             1470
         MVI   LOCNAME,C' '                                        1470
*        LOCNAME (1:NAMELEN) = HEADER (1:NAMELEN);         /*@YL026UK*/
         BCTR  @06,0                                               1471
         L     @01,CIRHDR(,@07)                                    1471
         EX    @06,@SM02482                                        1471
*        CTGENT = ADDR (NAMEAREA);                         /*@YL026UK*/
*                                                                  1472
         LA    @06,NAMEAREA                                        1472
         ST    @06,CTGENT(,@14)                                    1472
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* SET ADDRESS OF PASSWORD IN CTGPL. ADDRESS WILL   @YL026UK*/
*        /* BE ZERO IF NO PASSWORD SUPPLIED                  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1473
*        CTGPSWD = CIRPWD;                                 /*@YL026UK*/
*                                                                  1473
         L     @06,CIRPWD(,@07)                                    1473
         ST    @06,CTGPSWD(,@14)                                   1473
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* IF CATALOG IS SUPPLIED, SET CATALOG FLAG AND     @YL026UK*/
*        /* SET CATALOG NAME IN CTGPL                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1474
*        IF CIRCAT ^= NULLPTR                                      1474
*          THEN                                                    1474
         L     @07,CIRCAT(,@07)                                    1474
         CR    @07,@15                                             1474
         BE    @RF01474                                            1474
*            DO;                                           /*@YL026UK*/
*              CTGCNAME = ON;                              /*@YL026UK*/
         OI    CTGCNAME(@14),B'00000010'                           1476
*              CTGCAT = CIRCAT;                            /*@YL026UK*/
         ST    @07,CTGCAT(,@14)                                    1477
*            END;                                          /*@YL026UK*/
*                                                                  1478
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* A LOOP IS EXECUTED TO OBTAIN A WORKAREA,         @YL026UK*/
*        /* THE LOOP INDICATOR IS SET TO EXECUTE LOOP AND    @YL026UK*/
*        /* THE INITIAL NUMBER OF ENTRIES IN THE WORKAREA    @YL026UK*/
*        /* IS SET.                                          @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1479
*        ACTION = AGAIN;                                   /*@YL026UK*/
@RF01474 MVC   ACTION(2),@CH00038                                  1479
*        WNOENT = INITNO;                                  /*@YL026UK*/
*                                                                  1480
         MVC   WNOENT(4),@CF02316                                  1480
*        /*************************************************  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /* LOOP IS EXECUTED UNTIL LOCATE IS SUCCESSFUL OR   @YL026UK*/
*        /* UNITL AN ERROR IS DETECTED AND PROCESSING CANNOT @YL026UK*/
*        /* CONTINUE.                                        @YL026UK*/
*        /*                                                  @YL026UK*/
*        /*************************************************  @YL026UK*/
*                                                                  1481
*CTLLOOP:                                                          1481
*        DO WHILE ACTION = AGAIN;                          /*@YL026UK*/
*                                                                  1481
CTLLOOP  B     @DE01481                                            1481
@DL01481 DS    0H                                                  1482
*          /***********************************************  @YL026UK*/
*          /*                                                @YL026UK*/
*          /* CALCULATE POOLSIZE AND ISSUE UGPOOL MACRO.     @YL026UK*/
*          /*                                                @YL026UK*/
*          /***********************************************  @YL026UK*/
*                                                                  1482
*          POOLSIZE = (WNOENT * 45) + 4;                   /*@YL026UK*/
*                                                                  1482
         L     @15,WNOENT                                          1482
         MH    @15,@CH02303                                        1482
         AL    @15,@CF00038                                        1482
         ST    @15,POOLSIZE                                        1482
*          CALL IDCSAGP0 (GDTTBL,POOLSIZE,POOLADDR,CIRPID);/*@YL026UK*/
         ST    GDTPR,@AL00001                                      1483
         LA    @15,POOLSIZE                                        1483
         ST    @15,@AL00001+4                                      1483
         LA    @15,POOLADDR                                        1483
         ST    @15,@AL00001+8                                      1483
         L     @01,PARMPTR2                                        1483
         LA    @15,CIRPID(,@01)                                    1483
         ST    @15,@AL00001+12                                     1483
         MVI   @AL00001+12,X'80'                                   1483
         L     @15,GDTGPL(,GDTPR)                                  1483
         LA    @01,@AL00001                                        1483
         BALR  @14,@15                                             1483
*          RESPECIFY (RTNREG) RSTD;                        /*@YL026UK*/
*          RESPECIFY RTNREG RSTD;                                  1485
*          TESTRC = RTNREG;                                        1486
         STH   RTNREG,TESTRC                                       1486
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UK*/
*          RESPECIFY (RTNREG) UNRSTD;                      /*@YL026UK*/
*                                                                  1488
*          /***********************************************  @YL026UK*/
*          /*                                                @YL026UK*/
*          /* IF THE UGPOOL REQUEST WAS SUCCESSFUL THE       @YL026UK*/
*          /* UCATLG MACRO WILL BE ISSUED.                   @YL026UK*/
*          /*                                                @YL026UK*/
*          /***********************************************  @YL026UK*/
*                                                                  1489
*          IF TESTRC = 0                                           1489
*            THEN                                                  1489
         LH    @15,TESTRC                                          1489
         LTR   @15,@15                                             1489
         BNZ   @RF01489                                            1489
*STOROK:       DO;                                         /*@YL026UK*/
*                                                                  1490
STOROK   DS    0H                                                  1491
*                /*****************************************  @YL026UK*/
*                /*                                          @YL026UK*/
*                /* SET ADDR OF WORKAREA IN CTGPL AND        @YL026UK*/
*                /* LENGTH OF WORKAREA IN THE WORKAREA.      @YL026UK*/
*                /*                                          @YL026UK*/
*                /*****************************************  @YL026UK*/
*                                                                  1491
*                CTGWKA = POOLADDR;                        /*@YL026UK*/
         L     @15,POOLADDR                                        1491
         L     @14,CTGPLPTR                                        1491
         ST    @15,CTGWKA(,@14)                                    1491
*                WORKLEN = POOLSIZE;                       /*@YL026UK*/
         L     @14,POOLSIZE                                        1492
         STH   @14,WORKLEN(,@15)                                   1492
*                WORKRET = 4;                              /*@YL026UH*/
*                                                                  1493
         MVC   WORKRET(2,@15),@CH00038                             1493
*                /*****************************************  @YL026UK*/
*                /*                                          @YL026UK*/
*                /* ISSUE GENERIC LOCATE AND SAVE RC         @YL026UK*/
*                /*                                          @YL026UK*/
*                /*****************************************  @YL026UK*/
*                                                                  1494
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@YL026UK*/
*                                                                  1494
         ST    GDTPR,@AL00001                                      1494
         LA    @15,CTGPLPTR                                        1494
         ST    @15,@AL00001+4                                      1494
         L     @15,GDTCAT(,GDTPR)                                  1494
         LA    @01,@AL00001                                        1494
         BALR  @14,@15                                             1494
*                RESPECIFY (RTNREG) RSTD;                  /*@YL026UK*/
*                RESPECIFY RTNREG RSTD;                            1496
*                TESTRC = RTNREG;                                  1497
         STH   RTNREG,TESTRC                                       1497
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UK*/
*                RESPECIFY (RTNREG) UNRSTD;                /*@YL026UK*/
*                                                                  1499
*                CATRC = TESTRC;                           /*@YL026UK*/
*                                                                  1500
         LH    @15,TESTRC                                          1500
         STH   @15,CATRC                                           1500
*                /*****************************************  @YL026UK*/
*                /*                                          @YL026UK*/
*                /* IF THE LOCATE WAS SUCCESSFUL THE ACTION  @YL026UK*/
*                /* INDICATOR IS SET TO STOP LOOP.           @YL026UK*/
*                /*                                          @YL026UK*/
*                /*****************************************  @YL026UK*/
*                                                                  1501
*                IF CATRC = 0                                      1501
*                  THEN                                            1501
         SLR   @14,@14                                             1501
         CR    @15,@14                                             1501
         BNE   @RF01501                                            1501
*                    ACTION = STOP;                        /*@YL026UK*/
*                                                                  1502
         STH   @14,ACTION                                          1502
*                  /***************************************  @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /* CATALOG ROUTINE DETECTED AN ERROR.     @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /***************************************  @YL026UK*/
*                                                                  1503
*                  ELSE                                            1503
*CATERR:             DO;                                   /*@YL026UK*/
*                                                                  1503
         B     @RC01501                                            1503
@RF01501 DS    0H                                                  1503
CATERR   DS    0H                                                  1504
*                      /***********************************  @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /* IF THE WORKAREA WAS NOT LARGE      @YL026UK*/
*                      /* ENOUGH A LARGER WORKAREA WILL      @YL026UK*/
*                      /* BE OBTAINED AND CATLG WILL BE      @YL026UK*/
*                      /* ISSUED AGAIN.                      @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /***********************************  @YL026UK*/
*                                                                  1504
*                      IF (CATRC = LARGSIZE  CATRC = KNOWSIZE)    1504
*                        & WNOENT < MAXNO                  /*@OZ18318*/
*                        THEN                                      1504
         LH    @15,CATRC                                           1504
         C     @15,@CF01652                                        1504
         BE    @GL00025                                            1504
         C     @15,@CF01269                                        1504
         BNE   @RF01504                                            1504
@GL00025 L     @15,WNOENT                                          1504
         C     @15,@CF02314                                        1504
         BNL   @RF01504                                            1504
*SIZEERR:                  DO;                             /*@YL026UK*/
*                                                                  1505
SIZEERR  DS    0H                                                  1506
*                            /*****************************  @YL026UK*/
*                            /*                              @YL026UK*/
*                            /* IF THE SIZE OF THE REQUIRED  @YL026UK*/
*                            /* WORKAREA IS RETURNED, SET    @YL026UK*/
*                            /* WNOENT TO THE NUMBER OF      @YL026UK*/
*                            /* ENTRIES IN THIS KNOWN        @YL026UK*/
*                            /* WORKAREA                     @YL026UK*/
*                            /*                              @YL026UK*/
*                            /* IF THE REQUIRED SIZE IS NOT  @YL026UK*/
*                            /* RETURNED, DOUBLE PREVIOUS    @YL026UK*/
*                            /* NUMBER OF ENTRIES IN         @YL026UK*/
*                            /* WORKAREA                     @YL026UK*/
*                            /*                              @YL026UK*/
*                            /*****************************  @YL026UK*/
*                                                                  1506
*                            IF CATRC = KNOWSIZE                   1506
*                              THEN                                1506
         CLC   CATRC(2),@CH01269                                   1506
         BNE   @RF01506                                            1506
*                                WNOENT = (WORKRET - 4) / 45;      1507
         L     @01,POOLADDR                                        1507
         LH    @00,WORKRET(,@01)                                   1507
         N     @00,@CF02485                                        1507
         SL    @00,@CF00038                                        1507
         SRDA  @00,32                                              1507
         D     @00,@CF02303                                        1507
         ST    @01,WNOENT                                          1507
*                              ELSE                                1508
*                                WNOENT = WNOENT * 2;      /*@YL026UK*/
*                                                                  1508
         B     @RC01506                                            1508
@RF01506 L     @15,WNOENT                                          1508
         ALR   @15,@15                                             1508
         ST    @15,WNOENT                                          1508
*                            /****************************   @YL026UH*/
*                            /*                              @YL026UH*/
*                            /* FREE PREVIOUS WORKAREA       @YL026UH*/
*                            /*                              @YL026UH*/
*                            /****************************   @YL026UH*/
*                                                                  1509
*                            CALL IDCSAFP0 (GDTTBL,CIRPID);/*@YL026UH*/
*                                                                  1509
@RC01506 ST    GDTPR,@AL00001                                      1509
         L     @01,PARMPTR2                                        1509
         LA    @15,CIRPID(,@01)                                    1509
         ST    @15,@AL00001+4                                      1509
         MVI   @AL00001+4,X'80'                                    1509
         L     @15,GDTFPL(,GDTPR)                                  1509
         LA    @01,@AL00001                                        1509
         BALR  @14,@15                                             1509
*                          END SIZEERR;                    /*#YL026UK*/
*                                                                  1510
*                        /*********************************  #YL026UK*/
*                        /*                                  #YL026UK*/
*                        /* CATALOG ERROR SUCH THAT          #YL026UK*/
*                        /* PROCESSING ENDS.  SET ERROR DATA #YL026UK*/
*                        /*                                  #YL026UK*/
*                        /*********************************  #YL026UK*/
*                                                                  1511
*                        ELSE                                      1511
*CATTERM:                  DO;                             /*#YL026UK*/
         B     @RC01504                                            1511
@RF01504 DS    0H                                                  1511
CATTERM  DS    0H                                                  1512
*                            ACTION = ERROR;               /*#YL026UK*/
         LA    @15,8                                               1512
         STH   @15,ACTION                                          1512
*                            UCIRRC = 4;                   /*#YL026UK*/
*                                                                  1513
         MVC   UCIRRC(2),@CH00038                                  1513
*                            /****************************************/
*                            /*                              @Y30SSMK*/
*                            /* AN ERROR WAS ENCOUNTERED DURING A    */
*                            /* VSAM LOCATE, INITIALIZE THE ERROR    */
*                            /* CONVERSION TABLE AND CALL    @Y30SSMK*/
*                            /* UERROR.                      @Y30SSMK*/
*                            /*                              @Y30SSMK*/
*                            /****************************************/
*                                                                  1514
*                            ERCNVADR = ADDR(ERRORTAB);    /*@Y30SSMK*/
         LA    @14,ERRORTAB                                        1514
         ST    @14,ERCNVADR                                        1514
*                            ERCNVTAB = ''B;               /*@Y30SSMK*/
         XC    ERCNVTAB(32,@14),ERCNVTAB(@14)                      1515
*                            ERCATLG = ON;                 /*@Y30SSMK*/
         OI    ERCATLG(@14),B'10000000'                            1516
*                            ERCATLC = ON;                 /*@Y30SSMK*/
         OI    ERCATLC(@14),B'10000000'                            1517
*                            ERCATRC = CATRC;              /*@Y30SSMK*/
         LH    @07,CATRC                                           1518
         ST    @07,ERCATRC(,@14)                                   1518
*                            ERCPLPT = CTGPLPTR;           /*@Y30SSMK*/
         L     @06,CTGPLPTR                                        1519
         ST    @06,ERCPLPT(,@14)                                   1519
*                            IF CATRC = CATRC8                     1520
*                              THEN                                1520
         CR    @07,@15                                             1520
         BNE   @RF01520                                            1520
*                                ERDSNM = ADDR(LOCNAME);   /*@Y30SSMK*/
*                                                                  1521
         LA    @15,LOCNAME                                         1521
         ST    @15,ERDSNM(,@14)                                    1521
*                            CALL IDCTPER0 (GDTTBL,ERCNVADR);/*    1522
*                                                            @Y30SSMK*/
*                                                                  1522
@RF01520 ST    GDTPR,@AL00001                                      1522
         LA    @15,ERCNVADR                                        1522
         ST    @15,@AL00001+4                                      1522
         MVI   @AL00001+4,X'80'                                    1522
         L     @15,GDTERR(,GDTPR)                                  1522
         LA    @01,@AL00001                                        1522
         BALR  @14,@15                                             1522
*                            RESPECIFY RTNREG RSTD;                1523
*                            TESTRC = RTNREG;                      1524
         STH   RTNREG,TESTRC                                       1524
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSMK*/
*                            UCIRRC = MAX(UCIRRC,TESTRC);  /*@Y30SSMK*/
         LH    @15,TESTRC                                          1526
         LH    @14,UCIRRC                                          1526
         CR    @14,@15                                             1526
         BNL   *+6
         LR    @14,@15                                             1526
         STH   @14,UCIRRC                                          1526
*                          END CATTERM;                    /*#YL026UK*/
*                                                                  1527
*                    END CATERR;                           /*#YL026UK*/
*                                                                  1528
*              END STOROK;                                 /*#YL026UK*/
*                                                                  1529
*            /*******************************************    #YL026UK*/
*            /*                                              #YL026UK*/
*            /* NO STORAGE AVAILABLE.                        #YL026UK*/
*            /* SET MESSAGE DATA AND SET LOOP ACTION         #YL026UK*/
*            /* INDICATOR TO ERROR.                          #YL026UK*/
*            /*                                              #YL026UK*/
*            /*******************************************    #YL026UK*/
*                                                                  1530
*            ELSE                                                  1530
*STORERR:      DO;                                         /*#YL026UK*/
         B     @RC01489                                            1530
@RF01489 DS    0H                                                  1530
STORERR  DS    0H                                                  1531
*                UCIRRC = 4;                               /*#YL026UK*/
         MVC   UCIRRC(2),@CH00038                                  1531
*                DARGSMOD = IOMOD;                         /*#YL026UK*/
         L     @15,DDSTRU                                          1532
         MVC   DARGSMOD(3,@15),@CC01346                            1532
*                DARGSENT = NOCRSTID;                      /*#YL026UK*/
         MVI   DARGSENT(@15),X'1A'                                 1533
*                ACTION = ERROR;                           /*#YL026UK*/
*                                                                  1534
         MVC   ACTION(2),@CH00175                                  1534
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSMK*/
*                                                                  1535
         ST    GDTPR,@AL00001                                      1535
         LA    @15,@CF00111                                        1535
         ST    @15,@AL00001+4                                      1535
         LA    @15,DDSTRU                                          1535
         ST    @15,@AL00001+8                                      1535
         MVI   @AL00001+8,X'80'                                    1535
         L     @15,GDTPRT(,GDTPR)                                  1535
         LA    @01,@AL00001                                        1535
         BALR  @14,@15                                             1535
*              END STORERR;                                /*#YL026UK*/
*                                                                  1536
*        END CTLLOOP;                                      /*#YL026UK*/
*                                                                  1537
@RC01489 DS    0H                                                  1537
@DE01481 CLC   ACTION(2),@CH00038                                  1537
         BE    @DL01481                                            1537
*        /*************************************************  #YL026UK*/
*        /*                                                  #YL026UK*/
*        /* IF THE RETURN CODE IS RCOK THE DATA SET NAME     #YL026UK*/
*        /* DATA HAS BEEN PLACED IN THE WORKAREA.            #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*************************************************  #YL026UK*/
*                                                                  1538
*        IF UCIRRC = 0                                             1538
*          THEN                                                    1538
         LH    @15,UCIRRC                                          1538
         LTR   @15,@15                                             1538
         BNZ   @RF01538                                            1538
*WORKBLD:    DO;                                           /*#YL026UK*/
*                                                                  1539
WORKBLD  DS    0H                                                  1540
*              /*******************************************  #YL026UK*/
*              /*                                            #YL026UK*/
*              /* RETURN WORKAREA ADDRESS TO CALLER.         #YL026UK*/
*              /* CALCULATE NUMBER OF ENTRIES IN THE         #YL026UK*/
*              /* WORKAREA.                                  #YL026UK*/
*              /* SET NUMBER OF MATCHING ENTRIES TO ZERO.    #YL026UK*/
*              /*                                            #YL026UK*/
*              /*******************************************  #YL026UK*/
*                                                                  1540
*              RETPOOL = POOLADDR;                         /*#YL026UK*/
         L     @15,POOLADDR                                        1540
         L     @01,PARMPTR2                                        1540
         L     @01,CIRWKP(,@01)                                    1540
         ST    @15,RETPOOL(,@01)                                   1540
*              CATRETNO = (WORKRET - 4) / 45;              /*#YL026UK*/
         LH    @00,WORKRET(,@15)                                   1541
         N     @00,@CF02485                                        1541
         SL    @00,@CF00038                                        1541
         SRDA  @00,32                                              1541
         D     @00,@CF02303                                        1541
         STH   @01,CATRETNO                                        1541
*              WORKNUM = 0;                                /*#YL026UK*/
*                                                                  1542
         SLR   @14,@14                                             1542
         ST    @14,WORKNUM(,@15)                                   1542
*              /*******************************************  #YL026UK*/
*              /*                                            #YL026UK*/
*              /* CHECK ALL THE ENTRIES RETURNED IN WORKAREA #YL026UK*/
*              /*                                            #YL026UK*/
*              /*******************************************  #YL026UK*/
*                                                                  1543
*CKALLENT:     DO CKENT = 1 TO CATRETNO;                   /*#YL026UK*/
*                                                                  1543
CKALLENT LA    @15,1                                               1543
         B     @DE01543                                            1543
@DL01543 DS    0H                                                  1544
*                /*****************************************  #YL026UK*/
*                /*                                          #YL026UK*/
*                /* DETERMINE IF DSNAME HAS SEPARATOR AFTER  #YL026UK*/
*                /* THE HEADER QUALIFIER                     #YL026UK*/
*                /*                                          #YL026UK*/
*                /*****************************************  #YL026UK*/
*                                                                  1544
*                NEXTQUAL = CIRHLN + 1;                    /*#YL026UK*/
         L     @01,PARMPTR2                                        1544
         LH    @01,CIRHLN(,@01)                                    1544
         LA    @01,1(,@01)                                         1544
         STH   @01,NEXTQUAL                                        1544
*                SEPER = NOTFOUND;                         /*#YL026UK*/
         SLR   @15,@15                                             1545
         STH   @15,SEPER                                           1545
*                MATCH = NOTEQUAL;                         /*#YL026UK*/
*                                                                  1546
         STH   @15,MATCH                                           1546
*FINDSEP:        DO BYTECTR = NEXTQUAL TO TOTALLEN;        /*#YL026UK*/
*                                                                  1547
FINDSEP  LH    @15,NEXTQUAL                                        1547
         B     @DE01547                                            1547
@DL01547 DS    0H                                                  1548
*                  IF DSNAME (CKENT,BYTECTR) = '.'                 1548
*                    THEN                                          1548
         LH    @14,CKENT                                           1548
         MH    @14,@CH02303                                        1548
         ALR   @14,@15                                             1548
         L     @01,POOLADDR                                        1548
         ALR   @01,@14                                             1548
         AL    @01,@CF02486                                        1548
         CLI   DSNAME-5(@01),C'.'                                  1548
         BNE   @RF01548                                            1548
*                      DO;                                 /*#YL026UK*/
*                        TOTRAIL = BYTECTR - 1;            /*#YL026UK*/
         LR    @14,@15                                             1550
         BCTR  @14,0                                               1550
         STH   @14,TOTRAIL                                         1550
*                        TRLQUAL = BYTECTR;                /*#YL026UK*/
         STH   @15,TRLQUAL                                         1551
*                        SEPER = FOUND;                    /*#YL026UK*/
         MVC   SEPER(2),@CH00038                                   1552
*                        BYTECTR = TOTALLEN;               /*#YL026UK*/
         MVC   BYTECTR(2),@CH01652                                 1553
*                      END;                                /*#YL026UK*/
*                                                                  1554
*                END FINDSEP;                              /*#YL026UK*/
*                                                                  1555
@RF01548 LA    @15,1                                               1555
         AH    @15,BYTECTR                                         1555
@DE01547 STH   @15,BYTECTR                                         1555
         C     @15,@CF01652                                        1555
         BNH   @DL01547                                            1555
*                /*****************************************  #YL026UK*/
*                /*                                          #YL026UK*/
*                /* CHECK FOR MATCHING ENTRY IF NO TRAILER   #YL026UK*/
*                /* QUALIFIERS ARE SPECIFIED BY THE USER.    #YL026UK*/
*                /*                                          #YL026UK*/
*                /* IF ENTRY IS A CATALOG THIS ENTRY IS      #YL026UK*/
*                /* ALWAYS RETURNED TO THE USER.             #YL026UK*/
*                /*                                          #YL026UK*/
*                /*****************************************  #YL026UK*/
*                                                                  1556
*                IF CIRTLN = NULLPTR  ENTTYPE (CKENT) = CATTYPE   1556
*                  THEN                                            1556
         L     @01,PARMPTR2                                        1556
         LH    @15,CIRTLN(,@01)                                    1556
         LTR   @15,@15                                             1556
         BZ    @RT01556                                            1556
         LH    @15,CKENT                                           1556
         MH    @15,@CH02303                                        1556
         L     @01,POOLADDR                                        1556
         ALR   @01,@15                                             1556
         AL    @01,@CF02486                                        1556
         CLI   ENTTYPE-4(@01),C'0'                                 1556
         BNE   @RF01556                                            1556
@RT01556 DS    0H                                                  1557
*NOTRAIL:            DO;                                   /*#YL026UK*/
*                                                                  1557
NOTRAIL  DS    0H                                                  1558
*                      /***********************************  #YL026UK*/
*                      /*                                    #YL026UK*/
*                      /* IF CATALOG TYPE, SET MATCH.        #YL026UK*/
*                      /* THE OTHER CHECKS ARE STILL MADE    #YL026UK*/
*                      /* BECAUSE ALL ENTRIES MAY BE         #YL026UK*/
*                      /* RETURNED.                          #YL026UK*/
*                      /*                                    #YL026UK*/
*                      /***********************************  #YL026UK*/
*                                                                  1558
*                      IF ENTTYPE (CKENT) = CATTYPE                1558
*                        THEN                                      1558
         LH    @15,CKENT                                           1558
         MH    @15,@CH02303                                        1558
         L     @01,POOLADDR                                        1558
         ALR   @01,@15                                             1558
         AL    @01,@CF02486                                        1558
         CLI   ENTTYPE-4(@01),C'0'                                 1558
         BNE   @RF01558                                            1558
*                          MATCH = EQUAL;                  /*@YL026UK*/
*                                                                  1559
         MVC   MATCH(2),@CH00038                                   1559
*                        /***********************************@YL026UK*/
*                        /*                                  @YL026UK*/
*                        /* ALL ENTRIES MATCH IF ALL QUAL HAS@YL026UK*/
*                        /* BEEN SPECIFIED.                  @YL026UK*/
*                        /* THE ENTRY BEING CHECKED MATCHES  @YL026UK*/
*                        /* IF ONE QUAL IS SPECIFIED AND DATA@YL026UK*/
*                        /* SET NAME HAS NO MORE SEPARATORS  @YL026UK*/
*                        /*                                  @YL026UK*/
*                        /***********************************@YL026UK*/
*                                                                  1560
*                        ELSE                                      1560
*                          DO;                             /*@YL026UK*/
         B     @RC01558                                            1560
@RF01558 DS    0H                                                  1561
*                            IF CIRTYPAQ = ON                      1561
*                              THEN                                1561
         L     @01,PARMPTR2                                        1561
         TM    CIRTYPAQ(@01),B'01000000'                           1561
         BNO   @RF01561                                            1561
*                                MATCH = ALLEQUAL;         /*@YL026UK*/
         MVC   MATCH(2),@CH00175                                   1562
*                              ELSE                                1563
*                                DO;                       /*@YL026UK*/
         B     @RC01561                                            1563
@RF01561 DS    0H                                                  1564
*                                  IF SEPER = NOTFOUND             1564
*                                    THEN                          1564
         LH    @15,SEPER                                           1564
         LTR   @15,@15                                             1564
         BNZ   @RF01564                                            1564
*                                      MATCH = EQUAL;      /*@YL026UK*/
         MVC   MATCH(2),@CH00038                                   1565
*                                END;                      /*@YL026UK*/
*                          END;                            /*@YL026UK*/
*                                                                  1567
*                    END NOTRAIL;                          /*@YL026UK*/
*                                                                  1568
*                  /***************************************  @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /* USER SPECIFIED A TRAILING QUALIFIER    @YL026UK*/
*                  /*                                        @YL026UK*/
*                  /***************************************  @YL026UK*/
*                                                                  1569
*                  ELSE                                            1569
*CKTRAIL:            DO;                                   /*@YL026UK*/
*                                                                  1569
         B     @RC01556                                            1569
@RF01556 DS    0H                                                  1569
CKTRAIL  DS    0H                                                  1570
*                      TRLLEN = CIRTLN;                    /*@YL026UK*/
         L     @01,PARMPTR2                                        1570
         LH    @15,CIRTLN(,@01)                                    1570
         STH   @15,TRLLEN                                          1570
*                      COMPPTR = ADDR (DSNAME (CKENT));    /*@YL026UK*/
*                                                                  1571
         LH    @14,CKENT                                           1571
         MH    @14,@CH02303                                        1571
         L     @01,POOLADDR                                        1571
         AL    @01,@CF02487                                        1571
         LA    @14,DSNAME-5(@14,@01)                               1571
         ST    @14,COMPPTR                                         1571
*                      /***********************************  @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /* IF DATA SET NAME HAS A SEPARATOR   @YL026UK*/
*                      /* AND IF THE NUMBER OF BYTES         @YL026UK*/
*                      /* FOLLOWING (AND INCLUDING) THE      #YL026UK*/
*                      /* SEPARATOR IS GREATER THAN OR EQUAL #YL026UK*/
*                      /* TO THE NUMBER OF BYTES IN THE      #YL026UK*/
*                      /* TRAILOR SUPPLIED BY THE USER,      #YL026UK*/
*                      /* CHECK FOR A MATCH.                 #YL026UK*/
*                      /*                                    @YL026UK*/
*                      /***********************************  @YL026UK*/
*                                                                  1572
*                      IF SEPER = FOUND &                          1572
*                       TOTRAIL + TRLLEN <= TOTALLEN               1572
*                        THEN                                      1572
         CLC   SEPER(2),@CH00038                                   1572
         BNE   @RF01572                                            1572
         AH    @15,TOTRAIL                                         1572
         C     @15,@CF01652                                        1572
         BH    @RF01572                                            1572
*COMPTRL:                  DO;                             /*@YL026UK*/
*                                                                  1573
COMPTRL  DS    0H                                                  1574
*                            CTRLPTR = COMPPTR + TOTRAIL;  /*@YL026UK*/
*                                                                  1574
         LH    @15,TOTRAIL                                         1574
         AL    @15,COMPPTR                                         1574
         ST    @15,CTRLPTR                                         1574
*                            /****************************************/
*                            /*                              @YL026UK*/
*                            /* CHECK REMAINING BYTES IN     @YL026UK*/
*                            /* DATA SET NAME AGAINST        @YL026UK*/
*                            /* TRAILING QUALIFIERS (UP TO   @YL026UK*/
*                            /* TRAILING QUALIFIER LENGTH)   @YL026UK*/
*                            /* FOR A MATCH                  @YL026UK*/
*                            /*                              @YL026UK*/
*                            /****************************************/
*                                                                  1575
*                            IF DSCMPTRL (1:TRLLEN) =              1575
*                             TRAILER (1:TRLLEN)                   1575
*                              THEN                                1575
         L     @01,PARMPTR2                                        1575
         L     @01,CIRTLR(,@01)                                    1575
         LH    @14,TRLLEN                                          1575
         BCTR  @14,0                                               1575
         EX    @14,@SC02488                                        1575
         BNE   @RF01575                                            1575
*MATTRL:                         DO;                       /*@YL026UK*/
*                                                                  1576
MATTRL   DS    0H                                                  1577
*                                  /***********************  @YL026UK*/
*                                  /*                        @YL026UK*/
*                                  /* ENTRY MATCHES IF ALL   @YL026UK*/
*                                  /* QUAL SPECIFIED AND     @YL026UK*/
*                                  /* LASTBYTE IS 45, OR     @YL026UK*/
*                                  /* THE CHARACTER AT       @YL026UK*/
*                                  /* LASTBYTE IS A PERIOD   @YL026UK*/
*                                  /* OR A BLANK.            @YL026UK*/
*                                  /* ENTRY MATCHES IF ONE   @YL026UK*/
*                                  /* QUAL SPECIFIED AND THE @YL026UK*/
*                                  /* END OF THE DSN HAS     @YL026UK*/
*                                  /* BEEN REACHED.          @YL026UK*/
*                                  /*                        @YL026UK*/
*                                  /***********************  @YL026UK*/
*                                                                  1577
*                                  LASTBYTE = TRLQUAL +            1577
*                                              TRLLEN;     /*@YL026UK*/
*                                                                  1577
         LH    @15,TRLQUAL                                         1577
         AH    @15,TRLLEN                                          1577
         STH   @15,LASTBYTE                                        1577
*                                  IF CIRTYPAQ = ON & (COMPNAME    1578
*                                  (LASTBYTE) = '40'X  COMPNAME   1578
*                                  (LASTBYTE) = '.'  LASTBYTE = 45)
*                                    THEN                          1578
         L     @01,PARMPTR2                                        1578
         TM    CIRTYPAQ(@01),B'01000000'                           1578
         BNO   @RF01578                                            1578
         L     @14,COMPPTR                                         1578
         ALR   @15,@14                                             1578
         BCTR  @15,0                                               1578
         CLI   COMPNAME(@15),X'40'                                 1578
         BE    @RT01578                                            1578
         LH    @15,LASTBYTE                                        1578
         ALR   @14,@15                                             1578
         BCTR  @14,0                                               1578
         CLI   COMPNAME(@14),C'.'                                  1578
         BE    @RT01578                                            1578
         C     @15,@CF02303                                        1578
         BNE   @RF01578                                            1578
@RT01578 DS    0H                                                  1579
*                                      MATCH = EQUAL;      /*@YL026UK*/
         MVC   MATCH(2),@CH00038                                   1579
*                                    ELSE                          1580
*                                      DO;                 /*@YL026UK*/
         B     @RC01578                                            1580
@RF01578 DS    0H                                                  1581
*                                        IF LASTBYTE > TOTALLEN   1581
*                                         COMPNAME (LASTBYTE) = '40'X
*                                          THEN                    1581
         LH    @15,LASTBYTE                                        1581
         C     @15,@CF01652                                        1581
         BH    @RT01581                                            1581
         L     @01,COMPPTR                                         1581
         ALR   @01,@15                                             1581
         BCTR  @01,0                                               1581
         CLI   COMPNAME(@01),X'40'                                 1581
         BNE   @RF01581                                            1581
@RT01581 DS    0H                                                  1582
*                                            MATCH = EQUAL;/*@YL026UK*/
         MVC   MATCH(2),@CH00038                                   1582
*                                      END;                /*@YL026UK*/
*                                                                  1583
@RF01581 DS    0H                                                  1584
*                                END MATTRL;               /*@YL026UK*/
*                                                                  1584
@RC01578 DS    0H                                                  1585
*                          END COMPTRL;                    /*@YL026UK*/
*                                                                  1585
@RF01575 DS    0H                                                  1586
*                    END CKTRAIL;                          /*@YL026UK*/
*                                                                  1586
@RF01572 DS    0H                                                  1587
*                /*****************************************  @YL026UK*/
*                /*                                          @YL026UK*/
*                /* IF MATCH IS ALLEQUAL, ALL ENTRIES        @YL026UK*/
*                /* MATCH AND ARE IN ORDER IN THE WORKAREA.  @YL026UK*/
*                /* THE TOTAL NUMBER OF ENTRIES IS SET IN    @YL026UK*/
*                /* THE WORKAREA AND THE CHECK ENTRY LOOP IS @YL026UK*/
*                /* ENDED.                                   @YL026UK*/
*                /*                                          @YL026UK*/
*                /*****************************************  @YL026UK*/
*                                                                  1587
*                IF MATCH = ALLEQUAL                               1587
*                  THEN                                            1587
@RC01556 CLC   MATCH(2),@CH00175                                   1587
         BNE   @RF01587                                            1587
*                    DO;                                   /*@YL026UK*/
*                      WORKNUM = CATRETNO;                 /*@YL026UK*/
         LH    @15,CATRETNO                                        1589
         L     @14,POOLADDR                                        1589
         ST    @15,WORKNUM(,@14)                                   1589
*                      CKENT = CATRETNO;                   /*@YL026UK*/
         STH   @15,CKENT                                           1590
*                    END;                                  /*@YL026UK*/
*                                                                  1591
*                  ELSE                                            1592
*                    DO;                                   /*@YL026UK*/
*                                                                  1592
         B     @RC01587                                            1592
@RF01587 DS    0H                                                  1593
*                      /***********************************  @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /* IF MATCH IS EQUAL, THE NUMBER OF   @YL026UK*/
*                      /* MATCHING ENTRIES IS UPDATED AND    @YL026UK*/
*                      /* THE ENTRY IS MOVED TO THE NEXT     @YL026UK*/
*                      /* SLOT AVAILABLE IN THE WORKAREA     @YL026UK*/
*                      /*                                    @YL026UK*/
*                      /***********************************  @YL026UK*/
*                                                                  1593
*                      IF MATCH = EQUAL                            1593
*                        THEN                                      1593
         CLC   MATCH(2),@CH00038                                   1593
         BNE   @RF01593                                            1593
*                          DO;                             /*@YL026UK*/
*                            WORKNUM = WORKNUM + 1;        /*@YL026UK*/
         L     @15,POOLADDR                                        1595
         LA    @14,1                                               1595
         AL    @14,WORKNUM(,@15)                                   1595
         ST    @14,WORKNUM(,@15)                                   1595
*                            IF WORKNUM ^= CKENT                   1596
*                              THEN                                1596
         LH    @07,CKENT                                           1596
         CLR   @14,@07                                             1596
         BE    @RF01596                                            1596
*                                WORKENT (WORKNUM) =               1597
*                                  WORKENT (CKENT);        /*@YL026UK*/
         LA    @06,45                                              1597
         LR    @01,@14                                             1597
         MR    @00,@06                                             1597
         ALR   @01,@15                                             1597
         AL    @01,@CF02486                                        1597
         MR    @06,@06                                             1597
         ALR   @15,@07                                             1597
         AL    @15,@CF02486                                        1597
         MVC   @TS00001(45),WORKENT-4(@15)                         1597
         MVC   WORKENT-4(45,@01),@TS00001                          1597
*                          END;                            /*@YL026UK*/
@RF01596 DS    0H                                                  1599
*                    END;                                  /*@YL026UK*/
*                                                                  1599
@RF01593 DS    0H                                                  1600
*              END CKALLENT;                               /*@YL026UK*/
*                                                                  1600
@RC01587 LA    @15,1                                               1600
         AH    @15,CKENT                                           1600
@DE01543 STH   @15,CKENT                                           1600
         CH    @15,CATRETNO                                        1600
         BNH   @DL01543                                            1600
*              /******************************************   @YL026UH*/
*              /*                                            @YL026UH*/
*              /* IF NO ENTRIES ARE PRESENT IN THE LIST THAT @YL026UH*/
*              /* WILL BE RETURNED TO THE CALLER, SET THE    @YL026UH*/
*              /* CATALOG RETURN CODE TO 8, THE AND PRINT    @YL026UH*/
*              /* MESSAGE AS WHEN THE CATALOG CANNOT FIND    @YL026UH*/
*              /* AN ENTRY.                                  @YL026UH*/
*              /*                                            @YL026UH*/
*              /******************************************   @YL026UH*/
*                                                                  1601
*              CATRC = NODSENT;                            /*@YL026UH*/
*                                                                  1601
         MVC   CATRC(2),@CH00175                                   1601
*              DO CKENT = 1 TO WORKNUM WHILE CATRC = NODSENT;      1602
         LA    @15,1                                               1602
         B     @DE01602                                            1602
@DL01602 CLC   CATRC(2),@CH00175                                   1602
         BNE   @DC01602                                            1602
*                IF ENTTYPE (CKENT) ^= CATTYPE                     1603
*                  THEN                                            1603
         MH    @15,@CH02303                                        1603
         L     @01,POOLADDR                                        1603
         ALR   @01,@15                                             1603
         AL    @01,@CF02486                                        1603
         CLI   ENTTYPE-4(@01),C'0'                                 1603
         BE    @RF01603                                            1603
*                    CATRC = 0;                            /*@YL026UH*/
         SLR   @15,@15                                             1604
         STH   @15,CATRC                                           1604
*              END;                                        /*@YL026UH*/
*                                                                  1605
@RF01603 LA    @15,1                                               1605
         AH    @15,CKENT                                           1605
@DE01602 STH   @15,CKENT                                           1605
         L     @14,POOLADDR                                        1605
         CL    @15,WORKNUM(,@14)                                   1605
         BNH   @DL01602                                            1605
@DC01602 DS    0H                                                  1606
*              IF CATRC = NODSENT                                  1606
*                THEN                                              1606
         LH    @15,CATRC                                           1606
         C     @15,@CF00175                                        1606
         BNE   @RF01606                                            1606
*                  DO;                                     /*@YL026UH*/
*                                                                  1607
*                    UCIRRC = 4;                           /*@YL026UH*/
*                                                                  1608
         MVC   UCIRRC(2),@CH00038                                  1608
*                    /************************************************/
*                    /*                                      @Y30SSMK*/
*                    /* INVOKE UERROR TO PRINT THE ERROR MESSAGE     */
*                    /* AS WHEN THE CATALOG CANNOT FIND AN   @Y30SSMK*/
*                    /* ENTRY.                               @Y30SSMK*/
*                    /*                                      @Y30SSMK*/
*                    /************************************************/
*                                                                  1609
*                    ERCNVADR = ADDR(ERRORTAB);            /*@Y30SSMK*/
         LA    @14,ERRORTAB                                        1609
         ST    @14,ERCNVADR                                        1609
*                    ERCNVTAB = ''B;                       /*@Y30SSMK*/
         XC    ERCNVTAB(32,@14),ERCNVTAB(@14)                      1610
*                    ERCATLG = ON;                         /*@Y30SSMK*/
         OI    ERCATLG(@14),B'10000000'                            1611
*                    ERCATLC = ON;                         /*@Y30SSMK*/
         OI    ERCATLC(@14),B'10000000'                            1612
*                    ERCATRC = CATRC;                      /*@Y30SSMK*/
         ST    @15,ERCATRC(,@14)                                   1613
*                    ERCPLPT = CTGPLPTR;                   /*@Y30SSMK*/
         L     @15,CTGPLPTR                                        1614
         ST    @15,ERCPLPT(,@14)                                   1614
*                    ERDSNM = ADDR(LOCNAME);               /*@Y30SSMK*/
*                                                                  1615
         LA    @15,LOCNAME                                         1615
         ST    @15,ERDSNM(,@14)                                    1615
*                    CALL IDCTPER0 (GDTTBL,ERCNVADR);      /*@Y30SSMK*/
*                                                                  1616
         ST    GDTPR,@AL00001                                      1616
         LA    @15,ERCNVADR                                        1616
         ST    @15,@AL00001+4                                      1616
         MVI   @AL00001+4,X'80'                                    1616
         L     @15,GDTERR(,GDTPR)                                  1616
         LA    @01,@AL00001                                        1616
         BALR  @14,@15                                             1616
*                    RESPECIFY RTNREG RSTD;                        1617
*                    TESTRC = RTNREG;                              1618
         STH   RTNREG,TESTRC                                       1618
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSMK*/
*                    UCIRRC = MAX(UCIRRC,TESTRC);          /*@Y30SSMK*/
*                                                                  1620
         LH    @15,TESTRC                                          1620
         LH    @14,UCIRRC                                          1620
         CR    @14,@15                                             1620
         BNL   *+6
         LR    @14,@15                                             1620
         STH   @14,UCIRRC                                          1620
*                  END;                                    /*@YL026UH*/
*                                                                  1621
*            END WORKBLD;                                  /*#YL026UK*/
*                                                                  1622
@RF01606 DS    0H                                                  1623
*        IF GDTDBG = NULLPTR                                       1623
*          THEN;                                                   1623
@RF01538 L     @15,GDTDBG(,GDTPR)                                  1623
         LTR   @15,@15                                             1623
         BZ    @RT01623                                            1623
*          ELSE                                                    1625
*            CALL IDCDB010 (GDTTBL,'ZZCR');                        1625
         ST    GDTPR,@AL00001                                      1625
         LA    @15,@CC02178                                        1625
         ST    @15,@AL00001+4                                      1625
         MVI   @AL00001+4,X'80'                                    1625
         L     @15,GDTDBG(,GDTPR)                                  1625
         LA    @01,@AL00001                                        1625
         BALR  @14,@15                                             1625
*                                                          /*#YL026UK*/
*                                                                  1626
*        CALL IDCSAEP0(GDTTBL,MODID,UCIRRC);                       1626
@RT01623 ST    GDTPR,@AL00001                                      1626
         LA    @15,MODID                                           1626
         ST    @15,@AL00001+4                                      1626
         LA    @15,UCIRRC                                          1626
         ST    @15,@AL00001+8                                      1626
         MVI   @AL00001+8,X'80'                                    1626
         L     @15,GDTEPL(,GDTPR)                                  1626
         LA    @01,@AL00001                                        1626
         BALR  @14,@15                                             1626
*       /*#YL026UK*/                                               1627
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* ULINK ENTRY POINT                                #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  1627
*AMSSALK:  ENTRY(GDTTBLX,LKNAMEX,LINKARGX);                /*#YL026UK*/
*                                                                  1627
@EC01627 DS    0H                                                  1628
*AMSSALK1:                                                         1628
*                                                                  1628
*        DCL LKNAME CHAR(8) BASED;     /* ENTRY POINT NAME   #YL026UK*/
AMSSALK1 DS    0H                                                  1629
*                                      /* FOR ULINK          #YL026UK*/
*                                                                  1629
*        RESPECIFY LKNAME BASED(PARMPTR2);                 /*#YL026UK*/
*                                      /* BASE ENTRY POINT   #YL026UK*/
*                                      /* NAME               #YL026UK*/
*                                                                  1630
*        DCL LINKARG CHAR(*) BASED;    /* ARGUMENT AREA      #YL026UK*/
*                                                                  1630
*        RESPECIFY LINKARG BASED(PARMPTR3);                /*#YL026UK*/
*                                      /* BASE ARGUMENT AREA #YL026UK*/
*        DCL LKENTPT PTR(31);          /*ENTRY POINT LINKED MODULE   */
*                                                          /*@Z40GSBF*/
*                                                                  1633
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1633
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/
*        GDTPR = ADDR1;                                    /*#YL026UK*/
         L     GDTPR,ADDR1(,REG1PTR)                               1634
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/
         L     @00,ADDR2+4(,REG1PTR)                               1635
         ST    @00,PARMPTR2                                        1635
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/
         L     @00,ADDR3+8(,REG1PTR)                               1636
         ST    @00,PARMPTR3                                        1636
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/
*                                                                  1637
*                                                                  1637
*                                                                  1638
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1638
*        GEN;                                                      1638
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              1639
         LA    @15,1                                               1639
         STC   @15,LISTLN                                          1639
@DL01639 L     @14,LISTSCAN                                        1639
         TM    LISTTEST(@14),B'10000000'                           1639
         BNZ   @DC01639                                            1639
*          LISTSCAN = LISTSCAN + 4;                                1640
         AL    @14,@CF00038                                        1640
         ST    @14,LISTSCAN                                        1640
*        END;                                                      1641
*                                                                  1641
         AL    @15,@CF00215                                        1641
         STC   @15,LISTLN                                          1641
         C     @15,@CF01724                                        1641
         BNH   @DL01639                                            1641
@DC01639 DS    0H                                                  1642
*        OLDERID2 = NEWERID2;                                      1642
         L     @15,GDTTR2(,GDTPR)                                  1642
         MVC   @TS00001(95),NEWERID2(@15)                          1642
         MVC   OLDERID2(95,@15),@TS00001                           1642
*        NEWID2 = 'SALK';                                  /*#YL026UK*/
*                                                                  1643
         MVC   NEWID2(4,@15),@CC02399                              1643
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CALL FINDNAME RTN TO GET ENTRY POINT OF MODULE   @Z40GSBF*/
*        /* LOAD MODULE IF NECESSARY AND TEMPORARILY         @Z40GSBF*/
*        /* STORE THE ADDRESS OF THE ENTRY POINT TO BE       #YL026UK*/
*        /* BRANCHED TO (CONTAINED IN REGISTER 0 AFTER       #YL026UK*/
*        /* THE LOAD) INTO REGISTER 2                        #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1644
*        TEMPEPN = LKNAME;                                 /*#YL026UK*/
         L     @01,PARMPTR2                                        1644
         MVC   TEMPEPN(8),LKNAME(@01)                              1644
*        RESPECIFY (REG0,REG2) RSTD;                       /*#YL026UK*/
*        CALL FINDNAME(TEMPEPN,LKENTPT);                   /*@Z40GSBF*/
         LA    @03,TEMPEPN                                         1646
         ST    @03,@AL00001                                        1646
         LA    @03,LKENTPT                                         1646
         ST    @03,@AL00001+4                                      1646
         LA    @01,@AL00001                                        1646
         BAL   @14,FINDNAME                                        1646
*        REG2 = LKENTPT;                                   /*@Z40GSBF*/
         L     REG2,LKENTPT                                        1647
*        RESPECIFY (REG0) UNRSTD;                          /*#YL026UK*/
*                                                                  1648
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK THE VALUE OF LISTLN TO DETERMINE IF        #YL026UK*/
*        /* AN ARGUMENT IS TO BE PASSED TO THE CALLED        #YL026UK*/
*        /* ROUTINE.  IF LISTLN IS GREATER THAN TWO          #YL026UK*/
*        /* (INDICATING AN ARGUMENT), THEN REGISTER 3 IS     #YL026UK*/
*        /* SET TO THE ADDR OF LINKARG (THE ADDRESS OF THE   #YL026UK*/
*        /* ARGUMENT TO BE PASSED).  IF LISTLN IS NOT        #YL026UK*/
*        /* GREATER THAN TWO (INDICATING NO ARGUMENT), THEN  #YL026UK*/
*        /* REGISTER 3 IS SET TO ZERO.                       #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1649
*        RESPECIFY (REG3) RSTD;                            /*#YL026UK*/
*        IF LISTLN > 2                                             1650
*          THEN                                                    1650
         CLI   LISTLN,2                                            1650
         BNH   @RF01650                                            1650
*            REG3 = ADDR(LINKARG);                         /*#YL026UK*/
         L     REG3,PARMPTR3                                       1651
*          ELSE                                                    1652
*            REG3 = 0;                                     /*#YL026UK*/
*                                                                  1652
         B     @RC01650                                            1652
@RF01650 SLR   REG3,REG3                                           1652
*        /********************************************************** */
*        /*                                                  #YL026UK*/
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 7,  #YL026UK*/
*        /* AND CHECK WHETHER OR NOT THIS MODULE'S AUTOMATIC #YL026UK*/
*        /* STORAGE AREA IS TO BE FREED--NOTE DEPENDENCY     #YL026UK*/
*        /* ON SA01 INITIALIZING TABLE AUTOTBL WITH SA02     #YL026UK*/
*        /* AS THE SECOND ENTRY                              #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1653
*        RESPECIFY (REG7,REG13) RSTD;                      /*#YL026UK*/
@RC01650 DS    0H                                                  1654
*        GEN(L     REG7,4(REG13));                         /*#YL026UK*/
         L     REG7,4(REG13)
*        STATUS(2) = STATUS(2) - 1;                        /*#YL026UK*/
*                                                                  1655
         L     @06,GDTSAH(,GDTPR)                                  1655
         L     @06,AUTOPTR(,@06)                                   1655
         ICM   @15,12,STATUS+12(@06)                               1655
         SRA   @15,16                                              1655
         BCTR  @15,0                                               1655
         STCM  @15,3,STATUS+12(@06)                                1655
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CHECK IF THIS MODULE'S AUTOMATIC STORAGE STATUS  #YL026UK*/
*        /* IS GREATER THAN ZERO.                            #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1656
*        IF STATUS(2) > 0                                          1656
*          THEN                                                    1656
*                                                                  1656
         LTR   @15,@15                                             1656
         BNP   @RF01656                                            1656
*            /********************************************************/
*            /*                                              #YL026UK*/
*            /* FREE THIS MODULE'S AUTOMATIC STORAGE AREA    #YL026UK*/
*            /*                                              #YL026UK*/
*            /********************************************************/
*                                                                  1657
*            DO;                                           /*#YL026UK*/
*              RESPECIFY (REG0,REG1,REG11) RSTD;           /*#YL026UK*/
*              TEMPPTR = REG11 - 8;                        /*#YL026UK*/
         LR    @06,REG11                                           1659
         SL    @06,@CF00175                                        1659
         ST    @06,TEMPPTR                                         1659
*              RESPECIFY (REG11) UNRSTD;                   /*#YL026UK*/
*              REG0 = AUTOSIZE;                            /*#YL026UK*/
         ICM   REG0,15,AUTOSIZE(@06)                               1661
*              REG1 = TEMPPTR;                             /*#YL026UK*/
         LR    REG1,@06                                            1662
*LFREM11:      GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*#YL026UK*/
LFREM11  FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;               /*#YL026UK*/
*            END;                                          /*#YL026UK*/
*                                                                  1665
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* RESTORE OLD SAVEAREA POINTER, LOAD THE ADDRESS   #YL026UK*/
*        /* OF THE ENTRY POINT TO BE BRANCHED TO INTO REGISTER       */
*        /* 15, LOAD THE ADDRESS OF THE ARGUMENT TO          #YL026UK*/
*        /* BE PASSED INTO REGISTER 1, AND RESTORE REGISTERS #YL026UK*/
*        /* EXCLUDING REGISTERS 1 AND 15.                    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1666
*        REG13 = REG7;                                     /*#YL026UK*/
@RF01656 LR    REG13,REG7                                          1666
*        RESPECIFY (REG7) UNRSTD;                          /*#YL026UK*/
*        RESPECIFY (REG1,REG15) RSTD;                      /*#YL026UK*/
*        REG15 = REG2;                                     /*#YL026UK*/
         LR    REG15,REG2                                          1669
*        REG1 = REG3;                                      /*#YL026UK*/
         LR    REG1,REG3                                           1670
*        RESPECIFY (REG2,REG3) UNRSTD;                     /*#YL026UK*/
*        GEN(L     REG14,12(REG13));                       /*#YL026UK*/
         L     REG14,12(REG13)
*        GEN(L     REG0,20(REG13));                        /*#YL026UK*/
         L     REG0,20(REG13)
*        GEN(LM    REG2,REG12,28(REG13));                  /*#YL026UK*/
         LM    REG2,REG12,28(REG13)
*        RESPECIFY (REG13) UNRSTD;                         /*#YL026UK*/
*                                                                  1675
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* EXECUTE A BRANCH ON REGISTER 15                  #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1676
*        GEN(BR    REG15);                                 /*#YL026UK*/
         BR    REG15
*        RESPECIFY (REG1,REG15) UNRSTD;                    /*#YL026UK*/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /*  PROCEDURE NAME - COREINIT                       #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*  FUNCTION - THIS PROCEDURE INITIALIZES CORE,  THE ADDRESS*/
*        /*             OF THE CORE AND THE VALUE IT IS TO BE        */
*        /*             INITIALIZED TO ARE PROVIDED BY THE CALLER    */
*        /*                                                  #YL026UK*/
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF A SIZE */
*        /*          ARGUMENT, THE ADDRESS OF A VARIABLE CONTAINING  */
*        /*          THE ADDRESS OF THE CORE TO BE INITIALIZED, AND  */
*        /*          THE ADDRESS OF AN ARGUMENT INDICATING THE VALUE */
*        /*          TO WHICH THE CORE IS TO BE INITIALIZED. #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*  OUTPUT - THE INITIALIZED CORE                   #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* CORE INITIALIZATION REQUEST INNER PROCEDURE      #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1678
*COREINIT: PROCEDURE(ZSIZE,ZPTR,INITC);                    /*#YL026UK*/
*                                                                  1678
         B     @PB00002                                            1678
COREINIT STM   @14,@12,@SA00002                                    1678
         MVC   @PC00002(12),0(@01)                                 1678
*        DCL ZSIZE FIXED(31);          /* SIZE OF AREA TO INITIALIZE */
*                                                                  1679
*        DCL ZPTR PTR(31);             /* ADDRESS OF AREA TO #YL026UK*/
*                                      /* INITIALIZE         #YL026UK*/
*                                                                  1681
*        DCL ALLINIT CHAR(256);        /* AREA TO INITIALIZE FROM    */
*                                                                  1681
*        DCL INITCHAR CHAR(*) BASED(ZPTR);                 /*#YL026UK*/
*                                      /* AREA TO BE INITIALIZED     */
*                                                                  1683
*        DCL INITC CHAR(1);            /* INITIALIZATION CHARACTER   */
*                                      /* PASSED             #YL026UK*/
*                                                                  1684
*        DCL CHARIN CHAR(1);           /* INITIALIZATION CHARACTER   */
*                                                                  1684
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* INITIALIZE 256 BYTE AREA ALLINIT TO VALUE OF REQUEST     */
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1685
*        CHARIN = INITC;                                   /*#YL026UK*/
         L     @15,@PC00002+8                                      1685
         MVC   CHARIN(1),INITC(@15)                                1685
*        GEN(MVC   ALLINIT(1),CHARIN);                     /*#YL026UK*/
         MVC   ALLINIT(1),CHARIN
*        GEN(MVC   ALLINIT+1(255),ALLINIT);                /*#YL026UK*/
         MVC   ALLINIT+1(255),ALLINIT
*        DOCNTRL = ON;                                     /*#YL026UK*/
         OI    DOCNTRL,B'10000000'                                 1688
*INITDO: DO WHILE (DOCNTRL = ON);                          /*#YL026UK*/
*                                                                  1689
INITDO   B     @DE01689                                            1689
@DL01689 DS    0H                                                  1690
*          /**********************************************************/
*          /*                                                #YL026UK*/
*          /* CHECK FOR MORE THAN 256 BYTES TO INITIALIZE    #YL026UK*/
*          /*                                                #YL026UK*/
*          /**********************************************************/
*                                                                  1690
*          IF ZSIZE > 256                                          1690
*            THEN                                                  1690
         LA    @15,256                                             1690
         L     @14,@PC00002                                        1690
         L     @07,ZSIZE(,@14)                                     1690
         CR    @07,@15                                             1690
         BNH   @RF01690                                            1690
*              DO;                                         /*#YL026UK*/
*                                                                  1691
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* INITIALIZE 256 BYTES AND UPDATE SIZE AND POINTER */
*                /* VARIABLES FOR NEXT ITERATION             #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1692
*                INITCHAR(1:256) = ALLINIT(1:256);         /*#YL026UK*/
         L     @06,@PC00002+4                                      1692
         L     @05,ZPTR(,@06)                                      1692
         MVC   INITCHAR(256,@05),ALLINIT                           1692
*                ZSIZE = ZSIZE - 256;                      /*#YL026UK*/
         SLR   @07,@15                                             1693
         ST    @07,ZSIZE(,@14)                                     1693
*                ZPTR = ZPTR + 256;                        /*#YL026UK*/
         ALR   @05,@15                                             1694
         ST    @05,ZPTR(,@06)                                      1694
*              END;                                        /*#YL026UK*/
*            ELSE                                                  1696
*              DO;                                         /*#YL026UK*/
*                                                                  1696
         B     @RC01690                                            1696
@RF01690 DS    0H                                                  1697
*                /****************************************************/
*                /*                                          #YL026UK*/
*                /* INITIALIZE ZSIZE BYTES AND SET DOCNTRL TO FALL   */
*                /* OUT OF LOOP                              #YL026UK*/
*                /*                                          #YL026UK*/
*                /****************************************************/
*                                                                  1697
*                INITCHAR(1:ZSIZE) = ALLINIT(1:ZSIZE);     /*#YL026UK*/
         L     @15,@PC00002+4                                      1697
         L     @01,ZPTR(,@15)                                      1697
         L     @15,@PC00002                                        1697
         L     @15,ZSIZE(,@15)                                     1697
         BCTR  @15,0                                               1697
         EX    @15,@SM02490                                        1697
*                DOCNTRL = OFF;                            /*#YL026UK*/
         NI    DOCNTRL,B'01111111'                                 1698
*              END;                                        /*#YL026UK*/
*        END INITDO;                                       /*#YL026UK*/
@RC01690 DS    0H                                                  1700
@DE01689 TM    DOCNTRL,B'10000000'                                 1700
         BO    @DL01689                                            1700
*        END COREINIT;                                     /*#YL026UK*/
@EL00002 DS    0H                                                  1701
@EF00002 DS    0H                                                  1701
@ER00002 LM    @14,@12,@SA00002                                    1701
         BR    @14                                                 1701
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /*  PROCEDURE NAME - NOSUPP                         #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*  FUNCTION - THIS PROCEDURE PRINTS OUT AN ERROR   #YL026UK*/
*        /*             MESSAGE 'FUNCTION NOT SUPPORTED IN   #YL026UK*/
*        /*             THIS ENVIRONMENT'.                   #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*  INPUT - NONE                                    #YL026UK*/
*        /*                                                  #YL026UK*/
*        /*  OUTPUT - PRINTED MESSAGE                        #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* FUNCTION NOT SUPPORTED IN THIS ENVIRONMENT       #YL026UK*/
*        /* INNER PROCEDURE                                  #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1702
*NOSUPP: PROCEDURE;                                        /*#YL026UK*/
*                                                                  1702
NOSUPP   STM   @14,@12,@SA00003                                    1702
*        /* STID NUMBER FOR FUNCTION NOT SUPPORTED IN THIS   #YL026UK*/
*        /* ENVIRONMENT                                      #YL026UK*/
*        DCL NOSUSTID FIXED(8) CONSTANT(8);                /*#YL026UK*/
*                                                                  1703
*        /***********************************************************/
*        /*                                                  #YL026UK*/
*        /* SET ADDRESSABILITY AND INITIALIZE MESSAGE AREA   #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1704
*        DDSTRU = ADDR(MSGAREA);                           /*#YL026UK*/
         LA    @15,MSGAREA                                         1704
         ST    @15,DDSTRU                                          1704
*        DARGLIST = '0'B;                                  /*#YL026UK*/
*                                                                  1705
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  1705
         MVI   DARGLIST(@15),B'00000000'                           1705
*        /************************************************************/
*        /*                                                  #YL026UK*/
*        /* SET MESSAGE DATA, PRINT MESSAGE, AND RETURN      #YL026UK*/
*        /* TO NOSUPP CALLER                                 #YL026UK*/
*        /*                                                  #YL026UK*/
*        /************************************************************/
*                                                                  1706
*        DARGSMOD = UNIVMOD;                               /*#YL026UK*/
         MVC   DARGSMOD(3,@15),@CC01344                            1706
*        DARGSENT = NOSUSTID;                              /*#YL026UK*/
         MVI   DARGSENT(@15),X'08'                                 1707
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*#YL026UK*/
         ST    GDTPR,@AL00001                                      1708
         LA    @15,@CF00111                                        1708
         ST    @15,@AL00001+4                                      1708
         LA    @15,DDSTRU                                          1708
         ST    @15,@AL00001+8                                      1708
         MVI   @AL00001+8,X'80'                                    1708
         L     @15,GDTPRT(,GDTPR)                                  1708
         LA    @01,@AL00001                                        1708
         BALR  @14,@15                                             1708
*        RETURN;                                           /*#YL026UK*/
@EL00003 DS    0H                                                  1709
@EF00003 DS    0H                                                  1709
@ER00003 LM    @14,@12,@SA00003                                    1709
         BR    @14                                                 1709
*        END NOSUPP;                                       /*#YL026UK*/
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /*  PROCEDURE NAME - FINDNAME                       @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /*  FUNCTION - THIS PROCEDURE WILL SEARCH THE LOAD  @Z40GSBF*/
*        /*             LIST BLOCKS TO SEE IF MODULE HAS     @Z40GSBF*/
*        /*             BEEN LOADED AND STILL IN CORE.IF IT  @Z40GSBF*/
*        /*             IS RETURN WITH ENTRY POINT.IF NOT    @Z40GSBF*/
*        /*             LOAD THE CALLED MODULE,PUT NAME IN   @Z40GSBF*/
*        /*             IN LOAD BLOCK,THEN UP USE COUNTER    @Z40GSBF*/
*        /*             ONE AND RETURN WITH ENTRY POINT.     @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /*  INPUT - MODULE NAME                             @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /*  OUTPUT - ENTRY POINT OF MODULE                  @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*        /***************************************************@Z40GSBF*/
*        /***************************************************@Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /*   FINDNAME THIS WILL LOAD MODULE IF NOT          @Z40GSBF*/
*        /*   IN CORE  -  THEN RETURN ENTRY POINT            @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /***************************************************@Z40GSBF*/
*        /***************************************************@Z40GSBF*/
*                                                                  1711
*FINDNAME:   PROC(CLNAMX,ENTPT);                           /*@Z40GSBF*/
FINDNAME STM   @14,@12,@SA00004                                    1711
         MVC   @PC00004(8),0(@01)                                  1711
*        DCL CLNAMX    CHAR(8);        /* NAME OF MODULE     @Z40GSBF*/
*        DCL ENTPT     PTR(31);        /* ENTRY POINT        @Z40GSBF*/
*        DCL P         PTR(31);        /* POINTER TO CURRENT LLBLK   */
*                                                          /*@Z40GSBF*/
*        DCL CONTROL   BIT(1);         /* DO LOOP CONTROL    @Z40GSBF*/
*        DCL NAMEFND   BIT(1);         /* NAME FOUND SW      @Z40GSBF*/
*        DCL INDX      FIXED(15);      /* LOAD LIST INDEX    @Z40GSBF*/
*        DCL SLTOUSE  PTR(31);         /* SLOT TO USE PTR    @Z014804*/
*        DCL LOADNAME CHAR(8);         /* NAME OF MODULE     @Z014804*/
*                                                          /*@Z40GSBF*/
*        INDX = 0;                                         /*@Z40GSBF*/
         SLR   @15,@15                                             1720
         STH   @15,INDX                                            1720
*        NUMCMD  = 0;                                      /*@OZ28569*/
         STH   @15,NUMCMD                                          1721
*        CONTROL = OFF;                                    /*@Z40GSBF*/
         NI    CONTROL,B'01111111'                                 1722
*        NAMEFND = OFF;                                    /*@Z40GSBF*/
         NI    NAMEFND,B'01111111'                                 1723
*                                                          /*@Z40GSBF*/
*        /************************************************************/
*        /*                                                  @Z40GSBF*/
*        /* SEARCH LLBLKS FOR MATCH OF MODULE NAME           @Z40GSBF*/
*        /*                                                  @Z40GSBF*/
*        /************************************************************/
*                                                          /*@Z40GSBF*/
*FNDO:   DO WHILE CONTROL = OFF;                           /*@Z40GSBF*/
FNDO     B     @DE01724                                            1724
@DL01724 DS    0H                                                  1725
*          IF INDX = 0                                     /*@Z40GSBF*/
*            THEN                                          /*@Z40GSBF*/
         LH    @15,INDX                                            1725
         LTR   @15,@15                                             1725
         BNZ   @RF01725                                            1725
*                                                          /*@Z40GSBF*/
*              /******************************************************/
*              /*                                            @Z40GSBF*/
*              /*   FIRST TIME USE PTR IN SAHIST             @Z40GSBF*/
*              /*                                            @Z40GSBF*/
*              /******************************************************/
*                                                          /*@Z40GSBF*/
*              P= LLBLKPTR;                                /*@Z40GSBF*/
         L     @01,GDTSAH(,GDTPR)                                  1726
         L     @15,LLBLKPTR(,@01)                                  1726
         ST    @15,P                                               1726
*            ELSE;                                         /*@Z40GSBF*/
@RF01725 DS    0H                                                  1728
*                                                          /*@Z40GSBF*/
*          /**********************************************************/
*          /*                                                @Z40GSBF*/
*          /*    SEARCH FOR MODULE MATCH                     @Z40GSBF*/
*          /*                                                @Z40GSBF*/
*          /*********************************************************/
*                                                          /*@Z40GSBF*/
*          DO INDX = 1 TO LLSLTCNT WHILE CONTROL = OFF;    /*@Z40GSBF*/
*                                                                  1728
         LA    @15,1                                               1728
         STH   @15,INDX                                            1728
@DL01728 TM    CONTROL,B'10000000'                                 1728
         BNZ   @DC01728                                            1728
*            /********************************************************/
*            /*                                                      */
*            /*  COUNT THE NUMBER OF DIFFERENT COMMANDS THAT HAVE    */
*            /*  HAVE BEEN EXECUTED DURING THIS JOB STEP.            */
*            /*                                                      */
*            /********************************************************/
*                                                                  1729
*            IF LLNAME(INDX,1:5) = 'IDCCD'                 /*@OZ28569*/
*              THEN                                        /*@OZ25869*/
         SLA   @15,4                                               1729
         L     @01,P                                               1729
         ALR   @01,@15                                             1729
         AL    @01,@CF02460                                        1729
         CLC   LLNAME-8(5,@01),@CC02432                            1729
         BNE   @RF01729                                            1729
*                NUMCMD = NUMCMD + 1;                      /*@OZ25869*/
*                                                                  1730
         LH    @01,NUMCMD                                          1730
         LA    @01,1(,@01)                                         1730
         STH   @01,NUMCMD                                          1730
*            IF LLNOMOD(INDX) = 0                          /*@ZM43017*/
*                                                          /*@Z40GSBF*/
*            /********************************************************/
*            /*                                              @Z40GSBF*/
*            /*  NO MODULE IN THIS SLOT WHEN 0 IS FOUND      @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /********************************************************/
*                                                          /*@Z40GSBF*/
*              THEN;                                       /*@Z40GSBF*/
@RF01729 LH    @15,INDX                                            1731
         SLA   @15,4                                               1731
         L     @01,P                                               1731
         ALR   @01,@15                                             1731
         AL    @01,@CF02469                                        1731
         ICM   @00,15,LLNOMOD-12(@01)                              1731
         LTR   @00,@00                                             1731
         BZ    @RT01731                                            1731
*              ELSE                                        /*@Z40GSBF*/
*                DO;                                       /*@Z40GSBF*/
*                  IF CLNAMX = LLNAME(INDX)                /*@Z40GSBF*/
*                    THEN                                  /*@Z40GSBF*/
         L     @15,@PC00004                                        1734
         L     @14,P                                               1734
         LH    @07,INDX                                            1734
         SLA   @07,4                                               1734
         ST    @07,@TF00001                                        1734
         ALR   @07,@14                                             1734
         AL    @07,@CF02460                                        1734
         CLC   CLNAMX(8,@15),LLNAME-8(@07)                         1734
         BNE   @RF01734                                            1734
*                      DO;                                 /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                      /**********************************************/
*                      /*                                    @Z40GSBF*/
*                      /*   GOT A MATCH ON MODULE NAME       @Z40GSBF*/
*                      /*                                    @Z40GSBF*/
*                      /**********************************************/
*                                                          /*@Z40GSBF*/
*                        CONTROL = ON;                     /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 1736
*                        NAMEFND = ON;                     /*@Z40GSBF*/
         OI    NAMEFND,B'10000000'                                 1737
*                        ENTPT = LLADDR(INDX);             /*@Z40GSBF*/
         L     @15,@PC00004+4                                      1738
         LR    @01,@14                                             1738
         AL    @01,@TF00001                                        1738
         ICM   @00,15,LLADDR-16(@01)                               1738
         ST    @00,ENTPT(,@15)                                     1738
*                        LLUSECTR(INDX) = LLUSECTR(INDX)+1;/*@Z40GSBF*/
         LA    @15,1                                               1739
         L     @01,@TF00001                                        1739
         SLR   @00,@00                                             1739
         IC    @00,LLUSECTR-16(@01,@14)                            1739
         ALR   @15,@00                                             1739
         L     @01,@TF00001                                        1739
         STC   @15,LLUSECTR-16(@01,@14)                            1739
*                        END;                              /*@Z40GSBF*/
*                    ELSE;                                 /*@Z40GSBF*/
@RF01734 DS    0H                                                  1742
*                END;                                      /*@Z40GSBF*/
*          END;                                            /*@Z40GSBF*/
*                                                                  1743
@RT01731 LA    @15,1                                               1743
         AH    @15,INDX                                            1743
         STH   @15,INDX                                            1743
         C     @15,@CF00306                                        1743
         BNH   @DL01728                                            1743
@DC01728 DS    0H                                                  1744
*          /**********************************************************/
*          /*                                                @Z40GSBF*/
*          /*   USE CHAIN PTR IN LLBLK(S) IF 0 LAST LLBLK    @Z40GSBF*/
*          /*                                                @Z40GSBF*/
*          /**********************************************************/
*                                                          /*@Z40GSBF*/
*          IF LLNXTBLK = 0                                 /*@Z40GSBF*/
*            THEN                                          /*@Z40GSBF*/
         L     @01,P                                               1744
         L     @15,LLNXTBLK(,@01)                                  1744
         LTR   @15,@15                                             1744
         BNZ   @RF01744                                            1744
*              CONTROL = ON;                               /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 1745
*            ELSE                                          /*@Z40GSBF*/
*              P = LLNXTBLK;                               /*@Z40GSBF*/
         B     @RC01744                                            1746
@RF01744 L     @01,P                                               1746
         L     @15,LLNXTBLK(,@01)                                  1746
         ST    @15,P                                               1746
*        END FNDO;                                         /*@Z40GSBF*/
*                                                                  1747
@RC01744 DS    0H                                                  1747
@DE01724 TM    CONTROL,B'10000000'                                 1747
         BZ    @DL01724                                            1747
*        CONTROL = OFF;                                    /*@Z40GSBF*/
         NI    CONTROL,B'01111111'                                 1748
*          IF NAMEFND = ON                                 /*@Z40GSBF*/
*            THEN;                                         /*@Z40GSBF*/
         TM    NAMEFND,B'10000000'                                 1749
         BO    @RT01749                                            1749
*            ELSE                                          /*@Z40GSBF*/
*              DO;                                         /*@Z40GSBF*/
*              /*********************************************@Z40GSBF*/
*              /*                                            @Z40GSBF*/
*              /*     MODULE WAS NOT IN LLBLK PREPARE TO     @Z40GSBF*/
*              /*     RELEASE ANY MODULES NOT NEEDED THEN            */
*              /*     LOAD NEEDED MODULE AND                 @Z40GSBF*/
*              /*     FIND A AVAILABLE SLOT FOR THIS MODULE. @Z40GSBF*/
*              /******************************************************/
*                                                                  1752
*              IF NUMCMD > 2                               /*@OZ25869*/
*                THEN                                      /*@OZ25869*/
         LH    @15,NUMCMD                                          1752
         C     @15,@CF00149                                        1752
         BNH   @RF01752                                            1752
*                  CALL RELECORE;                          /*@OZ25869*/
*                                                                  1753
         BAL   @14,RELECORE                                        1753
*              P = LLBLKPTR;                               /*@Z40GSBF*/
@RF01752 L     @01,GDTSAH(,GDTPR)                                  1754
         L     @15,LLBLKPTR(,@01)                                  1754
         ST    @15,P                                               1754
*                DO WHILE LLFSTSLT = 0;                    /*@Z40GSBF*/
         B     @DE01755                                            1755
@DL01755 DS    0H                                                  1756
*                                                          /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                  IF LLNXTBLK = 0                         /*@Z40GSBF*/
*                    THEN                                  /*@Z40GSBF*/
         L     @15,P                                               1756
         L     @14,LLNXTBLK(,@15)                                  1756
         LTR   @14,@14                                             1756
         BNZ   @RF01756                                            1756
*                      DO;                                 /*@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                      /*************************************@Z40GSBF*/
*                      /*                                    @Z40GSBF*/
*                      /* NO SLOTS AVAIL.BUILD A NEW LLBLK   @Z40GSBF*/
*                      /*                                    @Z40GSBF*/
*                      /*************************************@Z40GSBF*/
*                                                          /*@Z40GSBF*/
*                        OLDERID2 = NEWERID2;                      1758
         L     @14,GDTTR2(,GDTPR)                                  1758
         MVC   @TS00001(95),NEWERID2(@14)                          1758
         MVC   OLDERID2(95,@14),@TS00001                           1758
*                        NEWID2 = 'SABB';                  /*@Z40GSBF*/
         MVC   NEWID2(4,@14),@CC02433                              1759
*                        CALL IDCSAGS0(GDTTBL,(LLSLTCNT*(LENGTH(LLSLOT)
*)                                                                 1760
*                        +(LENGTH(LLHDR)),LLNXTBLK,SETZERO);       1760
         ST    GDTPR,@AL00001                                      1760
         LA    @14,@CF02454                                        1760
         ST    @14,@AL00001+4                                      1760
         LA    @15,LLNXTBLK(,@15)                                  1760
         ST    @15,@AL00001+8                                      1760
         LA    @15,SETZERO                                         1760
         ST    @15,@AL00001+12                                     1760
         MVI   @AL00001+12,X'80'                                   1760
         L     @15,GDTGSP(,GDTPR)                                  1760
         LA    @01,@AL00001                                        1760
         BALR  @14,@15                                             1760
*                                                          /*@Z40GSBF*/
*                        TESTRC = RTNREG;                  /*@Z40GSBF*/
         STH   RTNREG,TESTRC                                       1761
*                          IF TESTRC ^= 0                  /*@Z40GSBF*/
*                            THEN                          /*@Z40GSBF*/
*                                                                  1762
         LH    @15,TESTRC                                          1762
         LTR   @15,@15                                             1762
         BZ    @RF01762                                            1762
*                              DO;                                 1763
*                                RESPECIFY(REG13,REG14,REG15) RSTD;
*                                REG15 = NOSPACE;                  1765
         LA    REG15,28                                            1765
*                                REG14 = GDTABT;                   1766
         L     REG14,GDTABT(,GDTPR)                                1766
*                                REG13 = GDTABH;                   1767
         L     REG13,GDTABH(,GDTPR)                                1767
*                                GEN(BR    REG14);                 1768
         BR    REG14
*                                RESPECIFY(REG13,REG14,REG15)UNRSTD;
*                              END;            /*@Z40GSBF*/        1770
*                            ELSE                          /*@Z40GSBF*/
*                              DO;                         /*@Z40GSBF*/
         B     @RC01762                                            1771
@RF01762 DS    0H                                                  1772
*                                                          /*@Z40GSBF*/
*                              /**************************************/
*                              /*                            @Z40GSBF*/
*                              /* FORMAT AND CHAIN NEW LLBLK @Z40GSBF*/
*                              /*                            @Z40GSBF*/
*                              /**************************************/
*                                                          /*@Z40GSBF*/
*                              P= LLNXTBLK;                /*@Z40GSBF*/
         L     @01,P                                               1772
         L     @15,LLNXTBLK(,@01)                                  1772
         ST    @15,P                                               1772
*                              LLFSTSLT = ADDR(LLNXTSLT(1));       1773
         LA    @14,LLNXTSLT(,@15)                                  1773
         ST    @14,LLFSTSLT(,@15)                                  1773
*                                                          /*@Z40GSBF*/
*                                DO INDX = 1 TO LLSLTCNT;  /*@Z40GSBF*/
         LA    @15,1                                               1774
         STH   @15,INDX                                            1774
@DL01774 DS    0H                                                  1775
*                                  LLNXTSLT(INDX) =                1775
*                                  ADDR(LLNXTSLT(INDX+1)); /*@Z40GSBF*/
         L     @14,P                                               1775
         LR    @07,@15                                             1775
         SLA   @07,4                                               1775
         LA    @06,LLNXTSLT(@07,@14)                               1775
         ALR   @14,@07                                             1775
         AL    @14,@CF02460                                        1775
         STCM  @06,15,LLNXTSLT-8(@14)                              1775
*                                END;                      /*@Z40GSBF*/
         AL    @15,@CF00215                                        1776
         STH   @15,INDX                                            1776
         C     @15,@CF00306                                        1776
         BNH   @DL01774                                            1776
*                              LLNXTSLT(LLSLTCNT) = 0;     /*@Z40GSBF*/
         L     @01,P                                               1777
         SLR   @00,@00                                             1777
         STCM  @00,15,LLNXTSLT+368(@01)                            1777
*                            END;                          /*@Z40GSBF*/
*                      END;                                /*@Z40GSBF*/
*                    ELSE                                  /*@Z40GSBF*/
*                      P = LLNXTBLK;                       /*@Z40GSBF*/
         B     @RC01756                                            1780
@RF01756 L     @01,P                                               1780
         L     @15,LLNXTBLK(,@01)                                  1780
         ST    @15,P                                               1780
*                END;                                      /*@Z40GSBF*/
@RC01756 DS    0H                                                  1781
@DE01755 L     @15,P                                               1781
         L     @14,LLFSTSLT(,@15)                                  1781
         LTR   @14,@14                                             1781
         BZ    @DL01755                                            1781
*                SLTOUSE = LLFSTSLT;                       /*@Z40GSBF*/
*                                                                  1782
         ST    @14,SLTOUSE                                         1782
*                /*******************************************@Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /*  CALCULATE THE INDX VALUE FOR SLOT       @Z40GSBF*/
*                /*  THAT WILL BE USED FOR THIS MODULE       @Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /*******************************************@Z40GSBF*/
*                                                                  1783
*                INDX = ((SLTOUSE -P -(LENGTH(LLHDR)))  /          1783
*                (LENGTH(LLSLOT))) +1;                     /*@Z40GSBF*/
*                                                                  1783
         SLR   @14,@15                                             1783
         SL    @14,@CF00175                                        1783
         SRDA  @14,32                                              1783
         D     @14,@CF00478                                        1783
         AL    @15,@CF00215                                        1783
         STH   @15,INDX                                            1783
*                LLFSTSLT = LLNXTSLT(INDX);                /*@Z40GSBF*/
         L     @14,P                                               1784
         SLA   @15,4                                               1784
         ALR   @15,@14                                             1784
         AL    @15,@CF02460                                        1784
         ICM   @07,15,LLNXTSLT-8(@15)                              1784
         ST    @07,LLFSTSLT(,@14)                                  1784
*                                                          /*@Z40GSBF*/
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*      LOAD THE MODULE                     @Z014804*/
*                /*                                          @Z40GSBF*/
*                /****************************************************/
*                                                          /*@Z40GSBF*/
*                RESPECIFY (REG0,REG1) RSTD;               /*@Z014804*/
*                LOADNAME = CLNAMX;                        /*@Z014804*/
         L     @15,@PC00004                                        1786
         MVC   LOADNAME(8),CLNAMX(@15)                             1786
*LLDA1:          GEN(LOAD  EPLOC=LOADNAME);                /*@Z014804*/
LLDA1    LOAD  EPLOC=LOADNAME
*                LLNAME(INDX) = CLNAMX;                    /*@Z014804*/
         L     @15,P                                               1788
         LH    @14,INDX                                            1788
         SLA   @14,4                                               1788
         ST    @14,@TF00001                                        1788
         ALR   @14,@15                                             1788
         AL    @14,@CF02460                                        1788
         L     @07,@PC00004                                        1788
         MVC   LLNAME-8(8,@14),CLNAMX(@07)                         1788
*                LLMODSZ(INDX) = REG1;                     /*@Z014804*/
         LR    @14,@15                                             1789
         AL    @14,@TF00001                                        1789
         STCM  REG1,7,LLMODSZ-16(@14)                              1789
*                                                          /*@Z014804*/
*                /*******************************************@Z014804*/
*                /*                                          @Z014804*/
*                /*     PUT MODULE ENTRY POINT               @Z014804*/
*                /*     IN AMS LOAD LIST BLOCK               @Z014804*/
*                /*                                          @Z014804*/
*                /*******************************************@Z014804*/
*                                                          /*@Z014804*/
*                ENTPT = REG0;                             /*@Z014804*/
         L     @14,@PC00004+4                                      1790
         ST    REG0,ENTPT(,@14)                                    1790
*                LLADDR(INDX) = ENTPT;                     /*@Z014804*/
         L     @14,@PC00004+4                                      1791
         L     @14,ENTPT(,@14)                                     1791
         LR    @07,@15                                             1791
         AL    @07,@TF00001                                        1791
         STCM  @14,15,LLADDR-16(@07)                               1791
*                                                          /*@Z014804*/
*                /*******************************************@Z014804*/
*                /*                                          @Z014804*/
*                /*  UP USE CTR.FOR MODULE                   @Z014804*/
*                /*                                          @Z014804*/
*                /*******************************************@Z014804*/
*                                                          /*@Z014804*/
*                LLUSECTR(INDX) = LLUSECTR(INDX)+1;        /*@Z014804*/
         LA    @14,1                                               1792
         L     @07,@TF00001                                        1792
         SLR   @06,@06                                             1792
         IC    @06,LLUSECTR-16(@07,@15)                            1792
         ALR   @14,@06                                             1792
         L     @07,@TF00001                                        1792
         STC   @14,LLUSECTR-16(@07,@15)                            1792
*                RESPECIFY (REG0,REG1) UNRSTD;             /*@Z014804*/
*            END;                                          /*@Z40GSBF*/
*        RETURN;                                           /*@Z40GSBF*/
@EL00004 DS    0H                                                  1795
@EF00004 DS    0H                                                  1795
@ER00004 LM    @14,@12,@SA00004                                    1795
         BR    @14                                                 1795
*        END FINDNAME;                                     /*@Z40GSBF*/
         B     @EL00004                                            1796
*                                                          /*@Z40GSBF*/
*                                                                  1797
*            /********************************************************/
*            /********************************************************/
*            /*                                              @Z40GSBF*/
*            /*  PROCEDURE NAME - RELECORE                   @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /*  FUNCTION                                    @Z40GSBF*/
*            /*      THIS RTN WILL SEARCH AMS LOAD LIST,     @Z40GSBF*/
*            /*      FREE MODULES NOT IN USE(USE CTR WILL BE @Z40GSBF*/
*            /*      ZERO) THIS SHOULD FREE SOME CORE        @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /*  INPUT - NONE                                @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /*  OUTPUT - NONE                               @Z40GSBF*/
*            /*                                              @Z40GSBF*/
*            /********************************************************/
*            /********************************************************/
*                                                                  1797
*RELECORE: PROC;                                           /*@Z40GSBF*/
*                                                                  1797
RELECORE STM   @14,@12,@SA00005                                    1797
*            OLDERID2 = NEWERID2;                                  1798
         L     @15,GDTTR2(,GDTPR)                                  1798
         MVC   @TS00001(95),NEWERID2(@15)                          1798
         MVC   OLDERID2(95,@15),@TS00001                           1798
*            NEWID2 = 'SAD3';                              /*@Z40GSBF*/
         MVC   NEWID2(4,@15),@CC02439                              1799
*            IX = 0;                                       /*@Z40GSBF*/
         SLR   @15,@15                                             1800
         ST    @15,IX                                              1800
*            CONTROL = OFF;                                /*@Z40GSBF*/
*                                                                  1801
         NI    CONTROL,B'01111111'                                 1801
*RELDO:        DO WHILE CONTROL = OFF;                     /*@Z40GSBF*/
RELDO    B     @DE01802                                            1802
@DL01802 DS    0H                                                  1803
*                IF IX = 0                                 /*@Z40GSBF*/
*                  THEN                                    /*@Z40GSBF*/
         L     @15,IX                                              1803
         LTR   @15,@15                                             1803
         BNZ   @RF01803                                            1803
*                                                          /*@Z40GSBF*/
*                      /**********************************************/
*                      /*                                    @Z40GSBF*/
*                      /*   FIRST TIME USE POINTER IN        @Z40GSBF*/
*                      /*   SYSTEM HIST AREA TO LOAD         @Z40GSBF*/
*                      /*   LIST BLOCK                       @Z40GSBF*/
*                      /*                                    @Z40GSBF*/
*                      /**********************************************/
*                                                                  1804
*                      P = LLBLKPTR;                       /*@Z40GSBF*/
         L     @01,GDTSAH(,GDTPR)                                  1804
         L     @15,LLBLKPTR(,@01)                                  1804
         ST    @15,P                                               1804
*                  ELSE;                                   /*@Z40GSBF*/
*                                                                  1805
@RF01803 DS    0H                                                  1806
*                /****************************************************/
*                /*                                          @Z40GSBF*/
*                /*   SEARCH EACH LOAD LIST                  @Z40GSBF*/
*                /*   BLOCK.WHEN MODULE NAME IS              @Z40GSBF*/
*                /*   IN SLOT AND USE CTR IS ZERO            @Z40GSBF*/
*                /*   THEN DELETE MODULE FROM CORE           @Z40GSBF*/
*                /*                                          @Z40GSBF*/
*                /*   IF MODULE TO BE DELETED IS ONE OF THE          */
*                /*   ACCESS METHOD SERVICES MODULES WHICH WILL      */
*                /*   BE IN CONSTANT USE THEN DON'T DELETE IT.       */
*                /*                                                  */
*                /****************************************************/
*                                                          /*@Z40GSBF*/
*                  DO IX = 1 TO LLSLTCNT;                  /*@Z40GSBF*/
         LA    @15,1                                               1806
         ST    @15,IX                                              1806
@DL01806 DS    0H                                                  1807
*                   IF LLNOMOD(IX) =0                     /*@OZ25869*/
*                   LLUSECTR(IX) ^= 0                     /*@OZ25869*/
*                   LLNAME(IX) = 'IDCRI01 '               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCRILT '               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCTSUV0'               /*@OZ25869*/
*                   LLNAME(IX) = 'IKJFF18 '               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCDB01 '               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCTSRI0'               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCTSTP0'               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCTSEX0'               /*@OZ25869*/
*                   LLNAME(IX) = 'IDCRIKT '                /*@OZ25869*/
*                      THEN;                               /*@Z40GSBF*/
         SLR   @14,@14                                             1807
         L     @07,P                                               1807
         SLA   @15,4                                               1807
         ST    @15,@TF00001                                        1807
         ALR   @15,@07                                             1807
         AL    @15,@CF02469                                        1807
         ICM   @06,15,LLNOMOD-12(@15)                              1807
         CR    @14,@06                                             1807
         BE    @RT01807                                            1807
         L     @06,@TF00001                                        1807
         SLR   @15,@15                                             1807
         IC    @15,LLUSECTR-16(@06,@07)                            1807
         CR    @14,@15                                             1807
         BNE   @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02442                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02443                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02444                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02445                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02446                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02447                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02448                            1807
         BE    @RT01807                                            1807
         LR    @06,@07                                             1807
         AL    @06,@TF00001                                        1807
         AL    @06,@CF02460                                        1807
         CLC   LLNAME-8(8,@06),@CC02449                            1807
         BE    @RT01807                                            1807
         AL    @07,@TF00001                                        1807
         AL    @07,@CF02460                                        1807
         CLC   LLNAME-8(8,@07),@CC02450                            1807
         BE    @RT01807                                            1807
*                      ELSE                                /*@Z40GSBF*/
*                        DO;                               /*@Z40GSBF*/
*                          RFY REG0 RSTD;                  /*@Z40GSBF*/
*                          REG0 =  ADDR(LLNAME(IX));       /*@Z40GSBF*/
         L     @15,IX                                              1811
         SLA   @15,4                                               1811
         L     @01,P                                               1811
         AL    @01,@CF02460                                        1811
         LA    REG0,LLNAME-8(@15,@01)                              1811
*LDEL2:                    GEN(DELETE  EPLOC=(REG0));      /*@Z40GSBF*/
LDEL2    DELETE  EPLOC=(REG0)
*                          RFY REG0 UNRSTD;                /*@Z40GSBF*/
*                          LLNOMOD(IX) = 0;                /*@Z40GSBF*/
         L     @15,P                                               1814
         L     @14,IX                                              1814
         SLA   @14,4                                               1814
         SLR   @07,@07                                             1814
         ST    @14,@TF00001                                        1814
         ALR   @14,@15                                             1814
         AL    @14,@CF02469                                        1814
         STCM  @07,15,LLNOMOD-12(@14)                              1814
*                          LLNXTSLT(IX) = LLFSTSLT;        /*@Z40GSBF*/
         L     @14,LLFSTSLT(,@15)                                  1815
         LR    @01,@15                                             1815
         AL    @01,@TF00001                                        1815
         AL    @01,@CF02460                                        1815
         STCM  @14,15,LLNXTSLT-8(@01)                              1815
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));  /*@Z40GSBF*/
         L     @14,@TF00001                                        1816
         AL    @14,@CF02460                                        1816
         LA    @14,LLNXTSLT-8(@14,@15)                             1816
         ST    @14,LLFSTSLT(,@15)                                  1816
*                        END;                              /*@Z40GSBF*/
*                  END;                                    /*@Z40GSBF*/
@RT01807 LA    @15,1                                               1818
         AL    @15,IX                                              1818
         ST    @15,IX                                              1818
         C     @15,@CF00306                                        1818
         BNH   @DL01806                                            1818
*                IF LLNXTBLK = 0                           /*@Z40GSBF*/
*                  THEN                                    /*@Z40GSBF*/
         L     @01,P                                               1819
         L     @15,LLNXTBLK(,@01)                                  1819
         LTR   @15,@15                                             1819
         BNZ   @RF01819                                            1819
*                    CONTROL = ON;                         /*@Z40GSBF*/
         OI    CONTROL,B'10000000'                                 1820
*                  ELSE                                    /*@Z40GSBF*/
*                    P = LLNXTBLK;                         /*@Z40GSBF*/
         B     @RC01819                                            1821
@RF01819 L     @01,P                                               1821
         L     @15,LLNXTBLK(,@01)                                  1821
         ST    @15,P                                               1821
*              END RELDO;                                  /*@Z40GSBF*/
*                                                                  1822
@RC01819 DS    0H                                                  1822
@DE01802 TM    CONTROL,B'10000000'                                 1822
         BZ    @DL01802                                            1822
*            IF GDTDBG = NULLPTR                                   1823
*              THEN;                                               1823
         L     @15,GDTDBG(,GDTPR)                                  1823
         LTR   @15,@15                                             1823
         BZ    @RT01823                                            1823
*              ELSE                                                1825
*                CALL IDCDB010(GDTTBL,'SAD4');                     1825
         ST    GDTPR,@AL00001                                      1825
         LA    @15,@CC02453                                        1825
         ST    @15,@AL00001+4                                      1825
         MVI   @AL00001+4,X'80'                                    1825
         L     @15,GDTDBG(,GDTPR)                                  1825
         LA    @01,@AL00001                                        1825
         BALR  @14,@15                                             1825
*                                                          /*@Z40GSBF*/
*            RETURN;                                       /*@Z40GSBF*/
@EL00005 DS    0H                                                  1826
@EF00005 DS    0H                                                  1826
@ER00005 LM    @14,@12,@SA00005                                    1826
         BR    @14                                                 1826
*        END RELECORE;                                     /*@Z40GSBF*/
         B     @EL00005                                            1827
@PB00005 DS    0H                                                  1828
*                                                          /*@Z40GSBF*/
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* GENERATED DATA                                   @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*        /************************************************************/
*                                                                  1828
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* LIST FORM OF GETMAIN MACRO--MOVED INTO A DYNAMIC AREA FOR*/
*        /* USE                                              @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1828
*        GENERATE DATA;                                    /*@YL026UK*/
*                                                                  1828
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* LIST FORM OF THE GETMAIN MACRO, SPECIFYING PAGE  @Y30LSMK*/
*        /* BOUNDARY--MOVED INTO A DYNAMIC AREA FOR USE      @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  1829
*        GENERATE DATA;                                    /*@Y30LSMK*/
*                                                                  1829
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* FULL REGION (SNAP) DUMP DCB - THIS IS COPIED INTO A      */
*        /* DYNAMIC AREA FOR USE                             @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1830
*        GENERATE DATA;                                    /*@YL026UK*/
*                                                                  1830
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* LIST FORM OF OPEN MACRO--MOVED INTO A DYNAMIC AREA FOR   */
*        /* USE WITH SNAP                                    @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1831
*        GENERATE DATA;                                    /*@YL026UK*/
*                                                                  1831
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* LIST FORM OF SNAP MACRO--MOVED INTO A DYNAMIC AREA FOR   */
*        /* USE                                              @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1832
*        GENERATE DATA;                                    /*@YL026UK*/
*                                                                  1832
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* LIST FORM OF THE TSO PUTGET MACRO--MOVED INTO    @YL026UK*/
*        /* A DYNAMIC AREA FOR USE WHERE:                    @YL026UK*/
*        /* TERMPUT EDIT - TPUT EDIT REQUEST                 @YL026UK*/
*        /* TERMPUT WAIT - CONTROL NOT RETURNED UNTIL        @YL026UK*/
*        /*                OUTPUT LINE IS IN BUFFER          @YL026UK*/
*        /* TERMPUT HOLD - PROCESSING CAN'T CONTINUE UNTIL   @YL026UK*/
*        /*                OUTPUT LINE PUT TO TERMINAL       @YL026UK*/
*        /* TERMPUT BREAKIN - OUTPUT HAS PRECEDENCE OVER     @YL026UK*/
*        /*                   INPUT                          @YL026UK*/
*        /* TERMGET EDIT - TGET EDIT REQUEST                 @YL026UK*/
*        /* TERMGET WAIT - CONTROL RETURNED ONLY AFTER INPUT @YL026UK*/
*        /*                MESSAGE RECIEVED                  @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1833
*        GENERATE DATA;                                    /*@YL026UK*/
*                                                                  1833
*        /************************************************************/
*        /*                                                  @YL026UK*/
*        /* DECLARATION ALLOWING MODULE IDCSA01 ACCESS TO THIS       */
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE            @YL026UK*/
*        /*                                                  @YL026UK*/
*        /************************************************************/
*                                                                  1834
*        GENERATE DATA;                                    /*@YL026UK*/
*        RESPECIFY (GDTPR) UNRSTD;                         /*@YL026UK*/
* END IDCSA02                                                      1836
*                                                                  1836
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (AMSDF09 )                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*;                                                                 1836
@EL00001 L     @13,4(,@13)                                         1836
@EF00001 L     @00,@SIZDATD                                        1836
         LR    @01,@11                                             1836
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1836
         BR    @14                                                 1836
@DATA    DS    0H
@CH00033 DC    H'10'
@SM02462 MVC   PGLINE(0),UPMSG(@01)
@SM02464 MVC   UNDSN(0,@01),DSNFLD
@SM02467 MVC   S99TUPAR(0,@15),UNTVAL-4(@04)
@SM02470 MVC   S99TUPRM(0,@14),VOLVAL-4(@06)
@SM02472 MVC   S99TUPAR(0,@15),VOLVAL-4(@07)
@SM02475 MVC   ALLDDN(0,@15),S99TUPAR(@14)
@SM02477 MVC   S99TUPAR(0,@15),UNTVAL(@14)
@SM02482 MVC   LOCNAME(0),HEADER(@01)
@SC02488 CLC   DSCMPTRL(0,@15),TRAILER(@01)
@SM02490 MVC   INITCHAR(0,@01),ALLINIT
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    36F
@SA00004 DS    15F
@PC00004 DS    2F
@SA00005 DS    15F
@SA00002 DS    15F
@PC00002 DS    3F
@SA00003 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
IDCSA02  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00215 DC    F'1'
@CH00215 EQU   @CF00215+2
@CF00149 DC    F'2'
@CH00149 EQU   @CF00149+2
@CF00158 DC    F'3'
@CF00038 DC    F'4'
@CH00038 EQU   @CF00038+2
@CF00175 DC    F'8'
@CH00175 EQU   @CF00175+2
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CF00478 DC    F'16'
@CF00306 DC    F'24'
@CF01269 DC    F'40'
@CH01269 EQU   @CF01269+2
@CF01652 DC    F'44'
@CH01652 EQU   @CF01652+2
@CF02303 DC    F'45'
@CH02303 EQU   @CF02303+2
@CF01916 DC    F'72'
@CF02316 DC    F'182'
@CF01724 DC    F'255'
@CF02454 DC    F'392'
@CF02314 DC    F'1456'
@CF02486 DC    F'-41'
@CF02487 DC    F'-40'
@CF02460 DC    F'-8'
@CF02466 DC    F'-6'
@CF02469 DC    F'-4'
@CF02485 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTPTR  DS    A
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
PARMPTR2 DS    A
PARMPTR3 DS    A
PARMPTR4 DS    A
PARMPTR5 DS    A
TEMPPTR  DS    A
INITPTR  DS    A
INITSIZE DS    F
IX       DS    F
P        DS    A
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
S99TUFP  DS    A
CLENTPT  DS    A
SPIDPTR  DS    A
PGCNTPTR DS    A
SADCBACB DS    AL4
         ORG   SADCBACB
BLOCKFLG DS    BL1
         ORG   SADCBACB+4
CPECB    DS    F
UPTPTR   DS    A
ECBLOCK  DS    F
DDLISTPT DS    A
DDLISTSZ DS    F
TEXTVOLP DS    A
TEXTVOLS DS    F
CTGPLPTR DS    A
POOLADDR DS    A
COMPPTR  DS    A
CTRLPTR  DS    A
WNOENT   DS    F
POOLSIZE DS    F
LKENTPT  DS    A
SLTOUSE  DS    A
DELPARM  DS    F
ERCNVPTR DS    A
SETRC    DS    H
TESTRC   DS    H
NUMCMD   DS    H
I        DS    H
J        DS    H
CATRC    DS    H
UCIRRC   DS    H
ACTION   DS    H
MATCH    DS    H
SEPER    DS    H
NEXTQUAL DS    H
CKENT    DS    H
BYTECTR  DS    H
TRLQUAL  DS    H
TOTRAIL  DS    H
LASTBYTE DS    H
TRLLEN   DS    H
CATRETNO DS    H
INDX     DS    H
LISTLN   DS    FL1
UNTCOUNT DS    FL1
         ORG   UNTCOUNT
UNITCNT  DS    CL1
         ORG   UNTCOUNT+1
VOLCOUNT DS    FL1
         ORG   VOLCOUNT
VOLUMCNT DS    CL1
         ORG   VOLCOUNT+1
@TS00001 DS    CL95
DOCNTRL  DS    BL1
         DS    CL7
TEMPEPN  DS    CL8
GETLIST  DS    CL10
         ORG   GETLIST
GETSZ    DS    FL4
GETPT    DS    AL4
GETFLG   DS    CL2
         ORG   GETFLG
@NM00038 DS    CL1
GETSP    DS    FL1
         ORG   GETLIST+10
         DS    CL2
MSGAREA  DS    CL20
S99RB    DS    CL20
         ORG   S99RB
S99RBLN  DS    CL1
S99VERB  DS    CL1
S99FLAG1 DS    CL2
         ORG   S99FLAG1
S99FLG11 DS    CL1
         ORG   S99FLG11
S99ONCNV DS    BL1
S99NOCNV EQU   S99FLG11+0
S99NOMNT EQU   S99FLG11+0
S99JBSYS EQU   S99FLG11+0
         ORG   S99FLAG1+1
S99FLG12 DS    CL1
         ORG   S99RB+4
S99RSC   DS    CL4
         ORG   S99RSC
S99ERROR DS    CL2
S99INFO  DS    CL2
         ORG   S99RB+8
S99TXTPP DS    AL4
S99RSV01 DS    FL4
S99FLAG2 DS    CL4
         ORG   S99FLAG2
S99FLG21 DS    CL1
         ORG   S99FLG21
S99WTVOL DS    BL1
S99WTDSN EQU   S99FLG21+0
S99NORES EQU   S99FLG21+0
S99WTUNT EQU   S99FLG21+0
S99OFFLN EQU   S99FLG21+0
S99TIONQ EQU   S99FLG21+0
S99CATLG EQU   S99FLG21+0
S99MOUNT EQU   S99FLG21+0
         ORG   S99FLAG2+1
S99FLG22 DS    CL1
         ORG   S99FLG22
S99UDEVT DS    BL1
S99PCINT EQU   S99FLG22+0
         ORG   S99FLAG2+2
S99FLG23 DS    CL1
S99FLG24 DS    CL1
         ORG   S99RB+20
TEXTDSN  DS    CL50
         DS    CL2
ERRORTAB DS    CL32
TEXTDDN  DS    CL14
TEXTPWD  DS    CL14
TEXTSTS  DS    CL7
         DS    CL1
TEXTDSP  DS    CL7
         DS    CL1
TEXTORG  DS    CL8
TEXTPERM DS    CL8
TUPL     DS    CL32
         ORG   TUPL
TUDSN    DS    AL4
TUDDN    DS    AL4
TUPWD    DS    AL4
TUSTS    DS    AL4
TUDSP    DS    AL4
TUORG    DS    AL4
TUULP    DS    AL4
TUVLP    DS    AL4
         ORG   TUPL+32
CONTROL  DS    BL1
NAMEFND  DS    BL1
         DS    CL2
OPENLIST DS    CL4
         ORG   OPENLIST
OPENOPT  DS    CL1
OPENADDR DS    AL3
         ORG   OPENLIST+4
SNAPLIST DS    CL20
         ORG   SNAPLIST
SNAPIDEN DS    FL1
SNAPOPT  DS    CL7
SNAPPTR  DS    AL4
SNAPTCB  DS    AL4
SNAPLST  DS    AL4
         ORG   SNAPLIST+20
DUMPDCB  DS    CL90
         DS    CL2
PGLB     DS    CL76
         ORG   PGLB
PGLNG    DS    FL2
PGOFF    DS    FL2
PGLINE   DS    CL72
         ORG   PGLB+76
PUTGETPB DS    CL16
         ORG   PUTGETPB
PGFLG1   DS    CL4
PGOLD    DS    AL4
PGFLG2   DS    CL4
PGINBUF  DS    AL4
         ORG   PUTGETPB+16
TSOIOPL  DS    CL16
         ORG   TSOIOPL
TSOUPT   DS    AL4
TSOECT   DS    AL4
TSOECB   DS    AL4
TSOPGPB  DS    AL4
         ORG   TSOIOPL+16
TSOOLD   DS    CL8
         ORG   TSOOLD
TSOSEGNO DS    FL4
TSOSEGAD DS    AL4
         ORG   TSOOLD+8
DSNBUF   DS    CL46
         ORG   DSNBUF
DSNLEN   DS    FL2
DSNFLD   DS    CL44
         ORG   DSNBUF+46
         DS    CL2
TSODFPB  DS    CL20
         ORG   TSODFPB
TSOENTRY DS    CL1
TSOBUF   DS    AL3
TSOCONT  DS    CL1
TSOPROT  DS    AL3
TSOLOC   DS    FL1
TSODEQ   DS    AL3
TSOCAT   DS    AL4
TSOPSD   DS    AL4
         ORG   TSODFPB+20
TSODFPL  DS    CL16
         ORG   TSODFPL
TSOUSE   DS    AL4
TSOENV   DS    AL4
TSOEVE   DS    AL4
TSODEF   DS    AL4
         ORG   TSODFPL+16
DSRERR   DS    CL4
         ORG   DSRERR
DSRRC    DS    FL2
DSRLC    DS    FL2
         ORG   DSRERR+4
TEXTUNT  DS    CL14
TEXTVOL  DS    CL12
TEXTPER  DS    CL4
TEXTPRI  DS    CL4
TEXTUCNT DS    CL7
         DS    CL1
TEXTVCNT DS    CL7
CATLIST  DS    CL28
         DS    CL3
NAMEAREA DS    CL45
         ORG   NAMEAREA
NAMELEN  DS    FL1
LOCNAME  DS    CL44
         ORG   NAMEAREA+45
ALLINIT  DS    CL256
CHARIN   DS    CL1
LOADNAME DS    CL8
DEMSGT   DS    CL44
IDCSA02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01831 DC    V(IDCSA05)
         DS    0D
@CC02078 DC    C'        '
@CC02442 DC    C'IDCRI01 '
@CC02443 DC    C'IDCRILT '
@CC02444 DC    C'IDCTSUV0'
@CC02445 DC    C'IKJFF18 '
@CC02446 DC    C'IDCDB01 '
@CC02447 DC    C'IDCTSRI0'
@CC02448 DC    C'IDCTSTP0'
@CC02449 DC    C'IDCTSEX0'
@CC02450 DC    C'IDCRIKT '
@CC02432 DC    C'IDCCD'
@CC00167 DC    C'ZERO'
@CC00169 DC    C'BLNK'
@CC00171 DC    C'NSET'
@CC01667 DC    C'SACL'
@CC01686 DC    C'SALD'
@CC01698 DC    C'SADE'
@CC01725 DC    C'SAGS'
@CC01745 DC    C'SAFS'
@CC01776 DC    C'SAGP'
@CC01805 DC    C'SAFP'
@CC01832 DC    C'SATI'
@CC01844 DC    C'SACA'
@CC01845 DC    C'ZZCA'
@CC01879 DC    C'SASN'
@CC01938 DC    C'SAPT'
@CC01975 DC    C'SAID'
@CC02025 DC    C'SAQL'
@CC02079 DC    C'SAAL'
@CC02106 DC    C'ZZAL'
@CC02153 DC    C'SADL'
@CC02164 DC    C'ZZDL'
@CC02177 DC    C'SACR'
@CC02178 DC    C'ZZCR'
@CC02399 DC    C'SALK'
@CC02433 DC    C'SABB'
@CC02439 DC    C'SAD3'
@CC02453 DC    C'SAD4'
@CC00159 DC    C'ALL'
@CC01344 DC    C'UV0'
@CC01346 DC    C'IO0'
@CC01350 DC    C'RI1'
@CC01746 EQU   @CC02078
@CC01777 DC    C'PG'
@CB01413 DC    X'0001'
@CB01415 DC    X'0002'
@CB01419 DC    X'0004'
@CB01421 DC    X'0005'
@CB01425 DC    X'0007'
@CB01443 DC    X'0010'
@CB01445 DC    X'0011'
@CB01449 DC    X'0013'
@CB01453 DC    X'0015'
@CB01455 DC    X'0016'
@CB01571 DC    X'0050'
@CB01581 DC    X'0055'
@CB01585 DC    X'0057'
@CB02151 DC    X'0364'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
FIXAREA  DS    CL800
         ORG   FIXAREA
@NM00034 DC    800X'00'
         ORG   FIXAREA+800
MODID    DC    CL4'SA02'
SETB     DC    CL1' '
SET0     DC    X'00'
@DATD    DSECT
IDCSA02 CSECT
LIST1   GETMAIN EC,LV=8,A=LIST1,MF=L
@DATD    DSECT
IDCSA02 CSECT
LIST2   GETMAIN EC,LV=8,A=LIST2,BNDRY=PAGE,MF=L
@DATD    DSECT
IDCSA02 CSECT
SNAPDCB  DCB   DSORG=PS,RECFM=VBA,MACRF=(W),BLKSIZE=1632,LRECL=125,   XX
               DDNAME=AMSDUMP
@DATD    DSECT
IDCSA02 CSECT
LIST3    OPEN  (SNAPDCB,(OUTPUT)),MF=L
@DATD    DSECT
IDCSA02 CSECT
LIST4    SNAP  DCB=SNAPDCB,SDATA=(CB,Q),PDATA=(ALL),ID=(00),MF=L
@DATD    DSECT
IDCSA02 CSECT
LIST5    PUTGET TERMPUT=(EDIT,WAIT),                                  XX
               TERMGET=(EDIT,WAIT),MF=L                       @ZA00133
@DATD    DSECT
IDCSA02 CSECT
IDCSAS2 DC    A(@SIZDATD)
        ENTRY IDCSAS2
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSA02  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG7     EQU   @07
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
GPR01P   EQU   @01
GDTPR    EQU   @08
REG1PTR  EQU   @01
GPR00F   EQU   @00
GPR00P   EQU   @00
GPR01F   EQU   @01
GPR14F   EQU   @14
GPR14P   EQU   @14
GPR15F   EQU   @15
GPR15P   EQU   @15
REG10    EQU   @10
REG12    EQU   @12
REG6     EQU   @06
REG8     EQU   @08
REG9     EQU   @09
CVTPTR   EQU   16
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTSAH   EQU   GDTTBL+32
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUPT   EQU   GDTTBL+180
GDTPSB   EQU   GDTTBL+184
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSACA0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
LISTTEST EQU   0
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
CIRTYP1Q EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRHLN   EQU   CIRAGL+4
CIRTLN   EQU   CIRAGL+6
CIRHDR   EQU   CIRAGL+8
CIRTLR   EQU   CIRAGL+12
CIRWKP   EQU   CIRAGL+16
CIRCAT   EQU   CIRAGL+20
CIRPWD   EQU   CIRAGL+24
CIRPID   EQU   CIRAGL+28
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERDYNRC  EQU   ERCATRC
ERCPLPT  EQU   ERCNVTAB+20
ERDARBPT EQU   ERCPLPT
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
ADDR1    EQU   0
ADDR2    EQU   0
ADDR3    EQU   0
ADDR4    EQU   0
ADDR5    EQU   0
FREEID   EQU   0
LLBLK    EQU   0
LLHDR    EQU   LLBLK
LLFSTSLT EQU   LLHDR
LLNXTBLK EQU   LLHDR+4
LLSLOT   EQU   LLBLK+8
LLNAME   EQU   LLSLOT
LLNXTSLT EQU   LLNAME
LLNOMOD  EQU   LLNAME+4
LLADDR   EQU   LLSLOT+8
LLUSECTR EQU   LLSLOT+12
LLMODSZ  EQU   LLSLOT+13
SAHIST   EQU   0
GPFIRST  EQU   SAHIST
GPLAST   EQU   SAHIST+4
AUTOPTR  EQU   SAHIST+8
LLBLKPTR EQU   SAHIST+16
AUTOTBL  EQU   0
AUTOARAY EQU   AUTOTBL
STATUS   EQU   AUTOARAY+4
@NM00035 EQU   0
AUTOSIZE EQU   @NM00035
GSCNTRL  EQU   0
GSLEN    EQU   GSCNTRL
GSLENID  EQU   GSLEN
GSID     EQU   GSCNTRL+4
GSSUBPID EQU   GSID+3
GPCNTRL  EQU   0
GPFORWRD EQU   GPCNTRL
GPBACK   EQU   GPCNTRL+4
GPLEN    EQU   GPCNTRL+8
GPID     EQU   GPCNTRL+12
GPADRPG  EQU   GPCNTRL+16
GPLENPG  EQU   GPCNTRL+20
PRECNTRL EQU   0
PREFWD   EQU   PRECNTRL
PASCNTRL EQU   0
PASBACK  EQU   PASCNTRL+4
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUPLN EQU   S99TUPTR
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUKEY EQU   S99TUNIT
S99TUNUM EQU   S99TUNIT+2
S99TUENT EQU   S99TUNIT+4
S99TULNG EQU   S99TUENT
S99TUPAR EQU   S99TUENT+2
S99TUFLD EQU   0
S99TULEN EQU   S99TUFLD
S99TUPRM EQU   S99TUFLD+2
AGLDSN   EQU   0
AGLPWD   EQU   0
CLNAME   EQU   0
LDMOD    EQU   0
LDPOINT  EQU   0
DEMOD    EQU   0
GSSIZE   EQU   0
GSPOINT  EQU   0
GSINIT   EQU   0
GSSPID   EQU   0
FSPOINT  EQU   0
GPSIZE   EQU   0
GPPOINT  EQU   0
GPIDVAR  EQU   0
GPINIT   EQU   0
GPFCHAIN EQU   0
FPIDVAR  EQU   0
FPALL    EQU   0
TIDATE   EQU   0
TITIME   EQU   0
TIFORM   EQU   0
CPLPTR   EQU   0
SNAPID   EQU   0
PTTEXTP  EQU   0
PTTEXTL  EQU   0
PTREPLP  EQU   0
PTREPLL  EQU   0
UPMSG    EQU   0
INBUFLN  EQU   0
USERID   EQU   0
USERIDL  EQU   0
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTPREFX EQU   UPT+16
UPTPREFL EQU   UPT+23
DSNS     EQU   0
DSNP     EQU   0
CATNP    EQU   0
PWDP     EQU   0
UNDSN    EQU   0
AGLVOL   EQU   0
VOLCNT   EQU   AGLVOL
@NM00041 EQU   AGLVOL+2
VOLLEN   EQU   @NM00041
VOLVAL   EQU   @NM00041+2
AGLUNT   EQU   0
UNTCNT   EQU   AGLUNT
@NM00042 EQU   AGLUNT+2
UNTLEN   EQU   @NM00042
UNTVAL   EQU   @NM00042+2
TEXTCON  EQU   0
CONKEY   EQU   TEXTCON
CONNUM   EQU   TEXTCON+2
CONENT   EQU   TEXTCON+4
CONLN    EQU   CONENT
CONDDN   EQU   CONENT+2
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGGENLD EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGOPTN3 EQU   CTGPL+2
CTGSUPLT EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
WORKAREA EQU   0
WORKNUM  EQU   WORKAREA
WORKLEN  EQU   WORKNUM
WORKRET  EQU   WORKNUM+2
WORKENT  EQU   WORKAREA+4
ENTTYPE  EQU   WORKENT
DSNAME   EQU   WORKENT+1
COMPNAME EQU   0
DSCMPTRL EQU   0
RETPOOL  EQU   0
HEADER   EQU   0
TRAILER  EQU   0
LKNAME   EQU   0
LINKARG  EQU   0
INITCHAR EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
MTEXTVOL EQU   0
NEWERID1 EQU   5
GDTTBLX  EQU   0
CLNAMEX  EQU   0
LDMODX   EQU   0
LDPOINTX EQU   0
DEMODX   EQU   0
GSSIZEX  EQU   0
GSPOINTX EQU   0
GSINITX  EQU   0
GSSPIDX  EQU   0
FSPOINTX EQU   0
GPSIZEX  EQU   0
GPPOINTX EQU   0
GPIDVARX EQU   0
GPINITX  EQU   0
FPIDVARX EQU   0
FPALLX   EQU   0
TITIMEX  EQU   0
TIDATEX  EQU   0
TIFORMX  EQU   0
CPLPTRX  EQU   0
SNAPIDX  EQU   0
PTTEXTPX EQU   0
PTTEXTLX EQU   0
PTREPLPX EQU   0
PTREPLLX EQU   0
USERIDX  EQU   0
USERIDLX EQU   0
DSNPX    EQU   0
DSNSX    EQU   0
CATNPX   EQU   0
PWDPX    EQU   0
ALLAGLX  EQU   0
ALLAGLY  EQU   0
CIRAGLX  EQU   0
LKNAMEX  EQU   0
LINKARGX EQU   0
ZSIZE    EQU   0
ZPTR     EQU   0
INITC    EQU   0
CLNAMX   EQU   0
ENTPT    EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTEHDEF EQU   CVTS01+388
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
GETGEN   EQU   LIST1
GETGENPG EQU   LIST2
OPENGEN  EQU   LIST3
SNAPGEN  EQU   LIST4
DCBFORM  EQU   SNAPDCB
PGLIST   EQU   LIST5
@NM00047 EQU   CTGDDNM
CTGPROB  EQU   @NM00047
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CTGFIELD EQU   CTGPL+28
@NM00046 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGNOFLD EQU   CTGPL+19
CTGTYPE  EQU   CTGPL+18
@NM00045 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00044 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGFUNC  EQU   CTGOPTN3
@NM00043 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
@NM00040 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00039 EQU   UPT
S99TUPND EQU   S99TUP
PASFWD   EQU   PASCNTRL
@NM00037 EQU   GSID
@NM00036 EQU   GSLEN+1
AUTOID   EQU   @NM00035+4
PTR1     EQU   AUTOARAY+8
ASIZE    EQU   AUTOARAY+6
AREAID   EQU   AUTOARAY
SAHSTA   EQU   SAHIST+12
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00033 EQU   CVTFIX+248
@NM00032 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
@NM00024 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
@NM00009 EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00298 EQU   @RC00294
@RC00355 EQU   @RC00345
@RF00372 EQU   @RC00363
@RF00387 EQU   @RC00363
@RC00385 EQU   @RC00363
@RC00486 EQU   @RC00476
@RF00552 EQU   @RC00494
@RC00565 EQU   @RC00494
@RC00893 EQU   @RC00890
@RF01086 EQU   @RC01060
@RF01133 EQU   @RC01131
@RC01152 EQU   @RC01001
@RC01346 EQU   @RC01344
@RC01374 EQU   @RC01372
@RC01501 EQU   @RC01489
@RC01504 EQU   @RC01489
@RC01558 EQU   @RC01556
@RC01561 EQU   @RC01556
@RF01564 EQU   @RC01556
@RC01762 EQU   @RC01756
@RT01749 EQU   @EL00004
@PB00004 EQU   @PB00005
@RT01823 EQU   @EL00005
@RC01182 EQU   @RC01152
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCSA02,(C'PLS1646',0701,78171)

         TITLE '************** IDCRS06: IDCAMS RESETCAT ROUTINE ********
               *********'
IDCRS06  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IDCRS06   77.116'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         USING @DATD,@08  DATA BASE REGISTER
         L     @15,@SIZDATD  SIZE OF AUTOMATIC DATA
         LA    @15,0(0,@15)  CLEAR SUBPOOL
         STM   @09,@12,RS06RG09(REG6)  SAVE BASE REGISTERS
*        RETURN CODE(REG15);  /*REG 15 HAS LENGTH OF AUTO DATA*/   0293
         L     @14,12(,@13)                                        0293
         LM    @00,@12,20(@13)                                     0293
         BR    @14                                                 0293
*/********************************************************************/
*/*                                                                  */
*/*            RESETCAT LOCAL DECLARATIONS                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0294
*DCL MODID CHAR(4) INIT('RS06');       /*MODID FOR UEPIL             */
*                                                                  0294
*DCL                                                               0295
*   1 PATCH    CHAR(1024)              /*PATCH AREA                  */
*              LOCAL STATIC BDY(WORD), /* 5 PERCENT                  */
*     2 *      CHAR(12)                /*PATCHAREA                   */
*              INIT('PATCHAREA 1K'),   /*IDENTIFIER                  */
*     2 *      CHAR(1012)              /*FORMAT UNUSED AREA          */
*              INIT('0');              /*WITH ZEROS                  */
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - CRADMNT                                         */
*/*                                                                  */
*/* FUNCTION - REQUEST CRA VOLUME DEALLOCATION                       */
*/*                                                                  */
*/* INPUT -    ADDRESS OF DDNAME                                     */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* RETURN CODES -                                                   */
*/*            0 = SUCCESSFUL                                        */
*/*            4 = VOLUME DEALLOCATION FAILED                        */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0296
         DS    0F
NAME06CD DC    CL8'IDCRS6CD'
*IDCRS6CD: PROCEDURE                                               0297
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0297
*                                                                  0297
         B     @PB00002                                            0297
IDCRS6CD DS    0H                                                  0298
*      /*SAVE AND PRIME REGISTERS*/                                0298
*      GENERATE REFS(RS06RG08, REG6);                              0298
*                                                                  0298
         ENTRY IDCRS6CD  EXTERNAL ENTRY POINT
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME06CD+4 PROCNAME TO REGSAVE
*        RFY REG1 RESTRICTED;                                      0299
*                                                                  0299
*        CALL CRADMNT; /*REG1 HAS PARAM LIST ADDR*/                0300
*                                                                  0300
         BAL   @14,CRADMNT                                         0300
*        RFY REG1;                                                 0301
*                                                                  0301
*           /*RESTORE CALLER'S REGISTERS AND RETURN*/              0302
*           DO;                                                    0302
*             GENERATE;                                            0303
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*             RETURN CODE(REG15); /*RETURN*/                       0304
@EL00002 DS    0H                                                  0304
@EF00002 DS    0H                                                  0304
@ER00002 BR    @14                                                 0304
*           END;                                                   0305
*                                                                  0305
*           CALL EXIT;  /*TERMINATE*/                              0306
*           END IDCRS6CD; /*END OF PROCEDURE*/                     0307
@PB00002 DS    0H                                                  0308
*                                                                  0308
*      GENERATE;                                                   0308
         DS    0F
NAME0002 DC    CL8'CRADMNT'
*CRADMNT: PROCEDURE (CRADDDP)                                      0309
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0309
*                                                                  0309
         B     @PB00003                                            0309
CRADMNT  MVC   @PC00003(4),0(@01)                                  0309
*      GENERATE REFS(RS06RG08, REG6);                              0310
*                                                                  0310
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0002  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  ARGUMENT OF INVOCATION AND DDNAME                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0311
*         DCL CRADDDP PTR(31);         /*ADDRESS OF DDNAME           */
*                                                                  0311
*         DCL CRADUDN CHAR(8) BASED(CRADDDP); /*DDNAME               */
*                                                                  0312
*         RFY ALLAGL BASED(RSALLAGP);                              0313
*                                                                  0313
*         OLDERID2 = NEWERID2;                                     0314
         L     @07,GDTTR2(,REG5)                                   0314
         MVC   @TS00001(95),NEWERID2(@07)                          0314
         MVC   OLDERID2(95,@07),@TS00001                           0314
*         NEWID2 = 'RSCD';                                         0315
*                                                                  0315
         MVC   NEWID2(4,@07),@CC03488                              0315
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD THE ALLAGL FOR THE UDEALLOC REQUEST              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0316
*         RSALLAGP = ADDR(RSALLAGL);                               0316
         L     @07,RSIOTBL(,REG6)                                  0316
         LA    @07,RSALLAGL(,@07)                                  0316
         ST    @07,RSALLAGP(,REG6)                                 0316
*         ALLAGL = ''B;                                            0317
         XC    ALLAGL(31,@07),ALLAGL(@07)                          0317
*         ALLDDN = CRADUDN;                                        0318
*                                                                  0318
         L     @04,@PC00003                                        0318
         L     @04,CRADDDP(,@04)                                   0318
         MVC   ALLDDN(8,@07),CRADUDN(@04)                          0318
*         /***********************************************************/
*         /*                                                         */
*         /*  ISSUE UDEALLOC REQUEST                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0319
*         CALL IDCSADL0 (GDTTBL,ALLAGL);                           0319
*                                                                  0319
         ST    REG5,@AL00001                                       0319
         ST    @07,@AL00001+4                                      0319
         MVI   @AL00001+4,X'80'                                    0319
         L     @15,GDTDLC(,REG5)                                   0319
         LA    @01,@AL00001                                        0319
         BALR  @14,@15                                             0319
*         RESPECIFY RTNREG RSTD;                                   0320
*         TESTRC = RTNREG;                                         0321
         STH   RTNREG,TESTRC(,REG6)                                0321
*         RESPECIFY RTNREG UNRSTD;                                 0322
*                                                                  0322
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UDEALLOC FAILED, SET RETURN CODE OF 4, OTHERWISE  */
*         /*    SET RETURN CODE OF 0.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0323
*         IF TESTRC ^= 0                                           0323
*           THEN                                                   0323
         LH    @07,TESTRC(,REG6)                                   0323
         LTR   @07,@07                                             0323
         BZ    @RF00323                                            0323
*             RSSUBRC = RCUERR1;                                   0324
         MVC   RSSUBRC(4,REG6),@CF00038                            0324
*           ELSE                                                   0325
*             RSSUBRC = 0;                                         0325
*                                                                  0325
         B     @RC00323                                            0325
@RF00323 SLR   @07,@07                                             0325
         ST    @07,RSSUBRC(,REG6)                                  0325
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0326
*         IF GDTDBG = NULLPTR                                      0326
*           THEN;                                                  0326
@RC00323 L     @07,GDTDBG(,REG5)                                   0326
         LTR   @07,@07                                             0326
         BZ    @RT00326                                            0326
*           ELSE                                                   0328
*             CALL IDCDB010 (GDTTBL,'RSC6');                       0328
*                                                                  0328
         ST    REG5,@AL00001                                       0328
         LA    @07,@CC03490                                        0328
         ST    @07,@AL00001+4                                      0328
         MVI   @AL00001+4,X'80'                                    0328
         L     @15,GDTDBG(,REG5)                                   0328
         LA    @01,@AL00001                                        0328
         BALR  @14,@15                                             0328
*         /*RESTORE CALLER'S REGISTERS AND RETURN*/                0329
*         DO;                                                      0329
@RT00326 DS    0H                                                  0330
*           GENERATE;                                              0330
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*           RETURN CODE(RSSUBRC); /*RETURN*/                       0331
         L     @15,RSSUBRC(,REG6)                                  0331
@EL00003 DS    0H                                                  0331
@EF00003 DS    0H                                                  0331
@ER00003 BR    @14                                                 0331
*         END;                                                     0332
*                                                                  0332
* CALL EXIT;  /*TERMINATE*/                                        0333
* END CRADMNT; /*END OF PROCEDURE*/                                0334
@PB00003 DS    0H                                                  0335
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - CRAMNT                                          */
*/*                                                                  */
*/* FUNCTION - REQUEST CRA VOLUME ALLOCATION                         */
*/*                                                                  */
*/* INPUT -    ADDRESS OF VOLUME LIST                                */
*/*            ADDRESS OF UNIT NAME LIST                             */
*/*            ADDRESS OF DDNAME AREA                                */
*/*                                                                  */
*/* OUTPUT -   DDNAME                                                */
*/*                                                                  */
*/* RETURN CODES -                                                   */
*/*            0 = SUCCESSFUL                                        */
*/*            4 = VOLUME ALLOCATION FAILED                          */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0335
         DS    0F
NAME06CM DC    CL8'IDCRS6CM'
*IDCRS6CM: PROCEDURE                                               0336
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0336
*                                                                  0336
         B     @PB00004                                            0336
IDCRS6CM DS    0H                                                  0337
*      /*SAVE AND PRIME REGISTERS*/                                0337
*      GENERATE REFS(RS06RG08, REG6);                              0337
*                                                                  0337
         ENTRY IDCRS6CM  EXTERNAL ENTRY POINT
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME06CM+4 PROCNAME TO REGSAVE
*        RFY REG1 RESTRICTED;                                      0338
*                                                                  0338
*        CALL CRAMNT; /*REG1 HAS PARAM LIST ADDR*/                 0339
*                                                                  0339
         BAL   @14,CRAMNT                                          0339
*        RFY REG1;                                                 0340
*                                                                  0340
*          /*RESTORE CALLER'S REGISTERS AND RETURN*/               0341
*          DO;                                                     0341
*            GENERATE;                                             0342
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*            RETURN CODE(REG15); /*RETURN*/                        0343
@EL00004 DS    0H                                                  0343
@EF00004 DS    0H                                                  0343
@ER00004 BR    @14                                                 0343
*          END;                                                    0344
*                                                                  0344
*          CALL EXIT;  /*TERMINATE*/                               0345
*          END IDCRS6CM; /*END OF PROCEDURE*/                      0346
@PB00004 DS    0H                                                  0347
*                                                                  0347
*      GENERATE;                                                   0347
         DS    0F
NAME0007 DC    CL8'CRAMNT'
*CRAMNT: PROCEDURE (CRAMVLP,CRAMULP,CRAMDDP)                       0348
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0348
*                                                                  0348
         B     @PB00005                                            0348
CRAMNT   MVC   @PC00005(12),0(@01)                                 0348
*      GENERATE REFS(RS06RG08, REG6);                              0349
*                                                                  0349
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0007  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  ARGUMENTS OF INVOCATION AND DDNAME AREA                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0350
*         DCL CRAMVLP PTR(31);         /*ADDRESS OF VOLUME LIST      */
*         DCL CRAMULP PTR(31);         /*ADDRESS OF UNIT NAME LIST   */
*         DCL CRAMDDP PTR(31);         /*ADDRESS OF DDNAME AREA      */
*                                                                  0352
*         DCL CRAMUDN CHAR(8) BASED(CRAMDDP); /*DDNAME AREA          */
*                                                                  0353
*         /***********************************************************/
*         /*                                                         */
*         /* VOLUME LIST AND UNIT LIST                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0354
*         DCL 1 CRAMVL BASED(CRAMVLP), /*VOLUME LIST                 */
*               2 CRAMVLLN FIXED(8),   /* LENGTH OF VOLSER           */
*               2 CRAMVLSR CHAR(6);    /* VOLSER                     */
*         DCL 1 CRAMUL BASED(CRAMULP), /*UNIT NAME LIST              */
*               2 CRAMULLN FIXED(8),   /* LENGTH OF UNIT NAME        */
*               2 CRAMULNM CHAR(8);    /* UNIT NAME                  */
*                                                                  0355
*         RFY ALLAGL BASED(RSALLAGP);                              0356
*                                                                  0356
*         OLDERID2 = NEWERID2;                                     0357
         L     @07,GDTTR2(,REG5)                                   0357
         MVC   @TS00001(95),NEWERID2(@07)                          0357
         MVC   OLDERID2(95,@07),@TS00001                           0357
*         NEWID2 = 'RSCM';                                         0358
*                                                                  0358
         MVC   NEWID2(4,@07),@CC03513                              0358
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD THE ALLAGL FOR THE UALLOC REQUEST                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0359
*         RSALLAGP = ADDR(RSALLAGL);                               0359
         L     @07,RSIOTBL(,REG6)                                  0359
         LA    @04,RSALLAGL(,@07)                                  0359
         ST    @04,RSALLAGP(,REG6)                                 0359
*         ALLAGL = ''B;                                            0360
*                                                                  0360
         XC    ALLAGL(31,@04),ALLAGL(@04)                          0360
*         /***********************************************************/
*         /*                                                         */
*         /*    INDICATE VOLUME MOUNT REQUEST.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0361
*         ALLOPTVL = ON;                                           0361
*                                                                  0361
         OI    ALLOPTVL(@04),B'10000000'                           0361
*         /***********************************************************/
*         /*                                                         */
*         /*    CONSTRUCT VOLUME LIST FOR UALLOC                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0362
*         ALLVLP = ADDR(ALLVL);                                    0362
         LA    @15,ALLVL(,@07)                                     0362
         ST    @15,ALLVLP(,@04)                                    0362
*         ALLVLC = 1;                                              0363
         LA    @15,1                                               0363
         STH   @15,ALLVLC(,@07)                                    0363
*         ALLVLLN = CRAMVLLN;                                      0364
         L     @14,@PC00005                                        0364
         L     @14,CRAMVLP(,@14)                                   0364
         SLR   @03,@03                                             0364
         IC    @03,CRAMVLLN(,@14)                                  0364
         STH   @03,ALLVLLN(,@07)                                   0364
*         ALLVLSR = CRAMVLSR(1:CRAMVLLN);                          0365
*                                                                  0365
         MVI   ALLVLSR+1(@07),C' '                                 0365
         MVC   ALLVLSR+2(4,@07),ALLVLSR+1(@07)                     0365
         BCTR  @03,0                                               0365
         EX    @03,@SM03971                                        0365
*         /***********************************************************/
*         /*                                                         */
*         /*    CONSTRUCT UNIT NAME LIST FOR UALLOC                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0366
*         ALLULP = ADDR(ALLUL);                                    0366
         LA    @14,ALLUL(,@07)                                     0366
         ST    @14,ALLULP(,@04)                                    0366
*         ALLULC = 1;                                              0367
*                                                                  0367
         STH   @15,ALLULC(,@07)                                    0367
*         /***********************************************************/
*         /*                                                         */
*         /*    IF NO UNIT NAME SUPPLIED, USE SYSALLDA               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0368
*         IF CRAMULLN = 0                                          0368
*           THEN                                                   0368
         L     @04,@PC00005+4                                      0368
         L     @04,CRAMULP(,@04)                                   0368
         CLI   CRAMULLN(@04),0                                     0368
         BNE   @RF00368                                            0368
*             DO;                                                  0369
*               ALLULLN = LENGTH(SYSALLDA);                        0370
         MVC   ALLULLN(2,@07),@CH00175                             0370
*               ALLULNM = SYSALLDA;                                0371
         MVC   ALLULNM(8,@07),@CC00774                             0371
*             END;                                                 0372
*           ELSE                                                   0373
*             DO;                                                  0373
         B     @RC00368                                            0373
@RF00368 DS    0H                                                  0374
*               ALLULLN = CRAMULLN;                                0374
         L     @07,RSIOTBL(,REG6)                                  0374
         L     @04,@PC00005+4                                      0374
         L     @04,CRAMULP(,@04)                                   0374
         SLR   @15,@15                                             0374
         IC    @15,CRAMULLN(,@04)                                  0374
         STH   @15,ALLULLN(,@07)                                   0374
*               ALLULNM = CRAMULNM;                                0375
         MVC   ALLULNM(8,@07),CRAMULNM(@04)                        0375
*             END;                                                 0376
*                                                                  0376
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UALLOC REQUEST                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0377
*         CALL IDCSAAL0 (GDTTBL,ALLAGL);                           0377
*                                                                  0377
@RC00368 ST    REG5,@AL00001                                       0377
         L     @07,RSALLAGP(,REG6)                                 0377
         ST    @07,@AL00001+4                                      0377
         MVI   @AL00001+4,X'80'                                    0377
         L     @15,GDTALC(,REG5)                                   0377
         LA    @01,@AL00001                                        0377
         BALR  @14,@15                                             0377
*         RESPECIFY RTNREG RSTD;                                   0378
*         TESTRC = RTNREG;                                         0379
         STH   RTNREG,TESTRC(,REG6)                                0379
*         RESPECIFY RTNREG UNRSTD;                                 0380
*                                                                  0380
*         /***********************************************************/
*         /*                                                         */
*         /* IF UALLOC FAILED, CALL CKERR TO PRINT MESSAGE AND       */
*         /*  SET RETURN CODE TO 4.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0381
*         IF TESTRC ^= 0                                           0381
*           THEN                                                   0381
         LH    @07,TESTRC(,REG6)                                   0381
         LTR   @07,@07                                             0381
         BZ    @RF00381                                            0381
*             DO;                                                  0382
*               RSSUBRC = RCUERR1;                                 0383
*                                                                  0383
*                                                                  0383
         MVC   RSSUBRC(4,REG6),@CF00038                            0383
*               DO;                                                0384
*               /*CALL CKERR*/                                     0385
*                 RSCKERR = RSCKERR && RSCKERR;                    0385
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0385
*                 RSCKERN = RSE086;                                0386
         MVC   RSCKERN(2,REG6),@CH01055                            0386
*                 RSCKTERM = 'RETU';                               0387
         MVC   RSCKTERM(4,REG6),@CC03514                           0387
*                 RSCKMVAR(1) = ADDR(ALLVLSR);                     0388
*                                                                  0388
         L     @07,RSIOTBL(,REG6)                                  0388
         LA    @07,ALLVLSR(,@07)                                   0388
         ST    @07,RSCKMVAR(,REG6)                                 0388
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        0389
         L     @15,@CV03452                                        0389
         BALR  @14,@15                                             0389
*               END;                                               0390
*                                                                  0390
*             END;                                                 0391
*                                                                  0391
*         /***********************************************************/
*         /*                                                         */
*         /*  UALLOC SUCCESSFUL. RETURN DDNAME AND A CODE OF 0       */
*         /*  SET VOLUME ALLOCATED AUDIT FLAG.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0392
*           ELSE                                                   0392
*             DO;                                                  0392
         B     @RC00381                                            0392
@RF00381 DS    0H                                                  0393
*               CRAMUDN = ALLDDN;                                  0393
         L     @07,@PC00005+8                                      0393
         L     @07,CRAMDDP(,@07)                                   0393
         L     @04,RSALLAGP(,REG6)                                 0393
         MVC   CRAMUDN(8,@07),ALLDDN(@04)                          0393
*               RSSUBRC = 0;                                       0394
         SLR   @07,@07                                             0394
         ST    @07,RSSUBRC(,REG6)                                  0394
*               RSALLC = ON;                                       0395
         OI    RSALLC(REG6),B'00001000'                            0395
*             END;                                                 0396
*                                                                  0396
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0397
*         IF GDTDBG = NULLPTR                                      0397
*           THEN;                                                  0397
@RC00381 L     @07,GDTDBG(,REG5)                                   0397
         LTR   @07,@07                                             0397
         BZ    @RT00397                                            0397
*           ELSE                                                   0399
*             CALL IDCDB010 (GDTTBL,'RSC5');                       0399
*                                                                  0399
         ST    REG5,@AL00001                                       0399
         LA    @07,@CC03515                                        0399
         ST    @07,@AL00001+4                                      0399
         MVI   @AL00001+4,X'80'                                    0399
         L     @15,GDTDBG(,REG5)                                   0399
         LA    @01,@AL00001                                        0399
         BALR  @14,@15                                             0399
*         /*RESTORE CALLER'S REGISTERS AND RETURN*/                0400
*         DO;                                                      0400
@RT00397 DS    0H                                                  0401
*           GENERATE;                                              0401
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*           RETURN CODE(RSSUBRC); /*RETURN*/                       0402
         L     @15,RSSUBRC(,REG6)                                  0402
@EL00005 DS    0H                                                  0402
@EF00005 DS    0H                                                  0402
@ER00005 BR    @14                                                 0402
*         END;                                                     0403
*                                                                  0403
*  CALL EXIT;  /*TERMINATE*/                                       0404
*  END CRAMNT; /*END OF PROCEDURE*/                                0405
@PB00005 DS    0H                                                  0406
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DSOPEN                                          */
*/*                                                                  */
*/* FUNCTION - OPEN THE WORKFILE, CATALOG OR A CRA                   */
*/*            VERIFY THE CATALOG OR A CRA                           */
*/*                                                                  */
*/* INPUT -    O FOR OPEN ONLY, V FOR VERIFY ONLY, B FOR BOTH        */
*/*            W FOR WF, C FOR CAT, R FOR CRA                        */
*/*            O FOR OUTPUT, U FOR UPDATE                            */
*/*            ADDRESS OF DDNAME OR DSNAME                           */
*/*            ADDRESS OF PASSWORD                                   */
*/*                                                                  */
*/* OUTPUT -   DDNAME IF DYNAMIC ALLOCATION DONE                     */
*/*                                                                  */
*/* RETURN CODES -                                                   */
*/*            0 = SUCCESSFUL                                        */
*/*            4 = OPEN FAILED                                       */
*/*            8 = VERIFY FAILED                                     */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0406
         DS    0F
NAME06DO DC    CL8'IDCRS6DO'
*IDCRS6DO: PROCEDURE                                               0407
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0407
*                                                                  0407
         B     @PB00006                                            0407
IDCRS6DO DS    0H                                                  0408
*      /*SAVE AND PRIME REGISTERS*/                                0408
*      GENERATE REFS(RS06RG08, REG6);                              0408
*                                                                  0408
         ENTRY IDCRS6DO  EXTERNAL ENTRY POINT
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME06DO+4 PROCNAME TO REGSAVE
*        RFY REG1 RESTRICTED;                                      0409
*                                                                  0409
*        CALL DSOPEN; /*REG1 HAS PARAM LIST ADDR*/                 0410
*                                                                  0410
         BAL   @14,DSOPEN                                          0410
*        RFY REG1;                                                 0411
*                                                                  0411
*          /*RESTORE CALLER'S REGISTERS AND RETURN*/               0412
*          DO;                                                     0412
*            GENERATE;                                             0413
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*            RETURN CODE(REG15); /*RETURN*/                        0414
@EL00006 DS    0H                                                  0414
@EF00006 DS    0H                                                  0414
@ER00006 BR    @14                                                 0414
*          END;                                                    0415
*                                                                  0415
*          CALL EXIT;  /*TERMINATE*/                               0416
*          END IDCRS6DO; /*END OF PROCEDURE*/                      0417
@PB00006 DS    0H                                                  0418
*                                                                  0418
*      GENERATE;                                                   0418
         DS    0F
NAME0014 DC    CL8'DSOPEN'
*DSOPEN: PROCEDURE (DSOTYP,DSODS,DSOOP,DSODDNP,DSODSNP,DSOPSWP)    0419
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0419
*                                                                  0419
         B     @PB00007                                            0419
DSOPEN   MVC   @PC00007(24),0(@01)                                 0419
*      GENERATE REFS(RS06RG08, REG6);                              0420
*                                                                  0420
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0014  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  ARGUMENTS OF INVOCATION AND DDNAME AREAS               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0421
*         DCL DSOTYP CHAR(1);          /* OPEN,VERIFY OR BOTH IND.   */
*         DCL DSODS CHAR(1);           /* WF,CAT OR CRA INDICATOR    */
*         DCL DSOOP CHAR(1);           /* OUTPUT OR UPDATE INDICATOR */
*         DCL DSODDNP PTR(31);         /* ADDRESS OF DDNAME          */
*         DCL DSODSNP PTR(31);         /* ADDRESS OF DSNAME          */
*         DCL DSOPSWP PTR(31);         /* ADDRESS OF PASSWORD        */
*                                                                  0426
*         DCL DSOUDDN CHAR(8) BASED(DSODDNP); /* USER'S DDNAME AREA  */
*         DCL DSORDDN CHAR(8) BASED(IOCDDN);  /* UOPEN'S DDNAME AREA */
*                                                                  0428
*         OLDERID2 = NEWERID2;                                     0429
         L     @07,GDTTR2(,REG5)                                   0429
         MVC   @TS00001(95),NEWERID2(@07)                          0429
         MVC   OLDERID2(95,@07),@TS00001                           0429
*         NEWID2 = 'DSDO';                                         0430
*                                                                  0430
         MVC   NEWID2(4,@07),@CC03538                              0430
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE RETURN CODE TO 0.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0431
*         RSSUBRC = 0;                                             0431
*                                                                  0431
         SLR   @07,@07                                             0431
         ST    @07,RSSUBRC(,REG6)                                  0431
*         /***********************************************************/
*         /*                                                         */
*         /*  IF OPEN ONLY OR OPEN AND VERIFY REQUESTED,             */
*         /*  ISSUE UOPEN                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*         IF DSOTYP ^= 'V'                                         0432
*           THEN                                                   0432
         L     @07,@PC00007                                        0432
         CLI   DSOTYP(@07),C'V'                                    0432
         BE    @RF00432                                            0432
*DSOOPEN:     DO;                                                  0433
*                                                                  0433
DSOOPEN  DS    0H                                                  0434
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD THE OPNAGL FOR THE UOPEN REQUEST                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0434
*               OPNPTR = ADDR(RSOPNAGL);                           0434
         L     @07,RSIOTBL(,REG6)                                  0434
         LA    @07,RSOPNAGL(,@07)                                  0434
         ST    @07,OPNPTR(,REG6)                                   0434
*               OPNAGL = ''B;                                      0435
*                                                                  0435
         XC    OPNAGL(48,@07),OPNAGL(@07)                          0435
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CATALOG OPNAGL FIELDS                            */
*         /*     KEYED, CNV, 2 STRINGS                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0436
*               IF DSODS = 'C'                                     0436
*                 THEN                                             0436
         L     @04,@PC00007+4                                      0436
         CLI   DSODS(@04),C'C'                                     0436
         BNE   @RF00436                                            0436
*                   DO;                                            0437
*                     OPNIOC = ADDR(RSCAIOCS);                     0438
         LA    @04,RSCAIOCS(,REG6)                                 0438
         ST    @04,OPNIOC(,@07)                                    0438
*                     OPNOPTKS = ON;                               0439
*                     OPNOPTBK = ON;                               0440
*                     OPNOPTDR = ON;                               0441
         OI    OPNOPTKS(@07),B'00011010'                           0441
*                     OPNSTRNO = 2;                                0442
         MVI   OPNSTRNO(@07),X'02'                                 0442
*                   END;                                           0443
*                                                                  0443
*         /***********************************************************/
*         /*                                                         */
*         /*    SET WORKFILE OPNAGL FIELDS                           */
*         /*     KEYED, CNV, 1 STRING FOR OUTPUT,                    */
*         /*     MULTIPLE STRINGS FOR UPDATE                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0444
*               IF DSODS = 'W'                                     0444
*                 THEN                                             0444
@RF00436 L     @07,@PC00007+4                                      0444
         CLI   DSODS(@07),C'W'                                     0444
         BNE   @RF00444                                            0444
*                   DO;                                            0445
*                     OPNIOC = ADDR(RSWFIOCS);                     0446
         L     @07,OPNPTR(,REG6)                                   0446
         LA    @04,RSWFIOCS(,REG6)                                 0446
         ST    @04,OPNIOC(,@07)                                    0446
*                     OPNOPTKS = ON;                               0447
         OI    OPNOPTKS(@07),B'00001000'                           0447
*                     IF DSOOP = 'U'                               0448
*                       THEN                                       0448
         L     @04,@PC00007+8                                      0448
         CLI   DSOOP(@04),C'U'                                     0448
         BNE   @RF00448                                            0448
*                         OPNSTRNO = 3 + 1;                        0449
         MVI   OPNSTRNO(@07),X'04'                                 0449
*                   END;                                           0450
*                                                                  0450
@RF00448 DS    0H                                                  0451
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CRA OPNAGL FIELDS                                */
*         /*     CNV, RECOVERY AREA, 1 STRING                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0451
*               IF DSODS = 'R'                                     0451
*                 THEN                                             0451
@RF00444 L     @07,@PC00007+4                                      0451
         CLI   DSODS(@07),C'R'                                     0451
         BNE   @RF00451                                            0451
*                   DO;                                            0452
*                     OPNIOC = ADDR(RSCRIOCS);                     0453
         L     @07,OPNPTR(,REG6)                                   0453
         LA    @04,RSCRIOCS(,REG6)                                 0453
         ST    @04,OPNIOC(,@07)                                    0453
*                     OPNOPTBK = ON;                               0454
         OI    OPNOPTBK(@07),B'00010000'                           0454
*                     OPNTYPRA = ON;                               0455
         OI    OPNTYPRA(@07),B'00001000'                           0455
*                   END;                                           0456
*                                                                  0456
*         /***********************************************************/
*         /*                                                         */
*         /*  SET COMMON OPNAGL FIELDS                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0457
*         /***********************************************************/
*         /*                                                         */
*         /*    SET OPNAGL DDNAME POINTER OR DSNAME POINTER          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0457
*               IF DSODSNP = 0                                     0457
*                 THEN                                             0457
@RF00451 L     @07,@PC00007+16                                     0457
         L     @07,DSODSNP(,@07)                                   0457
         LTR   @07,@07                                             0457
         BNZ   @RF00457                                            0457
*                   DO;                                            0458
*                     OPNDDN = DSODDNP;                            0459
         L     @07,OPNPTR(,REG6)                                   0459
         L     @04,@PC00007+12                                     0459
         L     @04,DSODDNP(,@04)                                   0459
         ST    @04,OPNDDN(,@07)                                    0459
*                     RSOPDYN = OFF;                               0460
         NI    RSOPDYN(REG6),B'01111111'                           0460
*                   END;                                           0461
*                 ELSE                                             0462
*                   DO;                                            0462
         B     @RC00457                                            0462
@RF00457 DS    0H                                                  0463
*                     OPNDSN = DSODSNP;                            0463
         L     @07,OPNPTR(,REG6)                                   0463
         L     @04,@PC00007+16                                     0463
         L     @04,DSODSNP(,@04)                                   0463
         ST    @04,OPNDSN(,@07)                                    0463
*                     RSOPDYN = ON;                                0464
         OI    RSOPDYN(REG6),B'10000000'                           0464
*                   END;                                           0465
*                                                                  0465
*         /***********************************************************/
*         /*                                                         */
*         /*    SET OPNAGL PASSWORD POINTER                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0466
*               OPNPWA = DSOPSWP;                                  0466
*                                                                  0466
@RC00457 L     @07,OPNPTR(,REG6)                                   0466
         L     @04,@PC00007+20                                     0466
         L     @04,DSOPSWP(,@04)                                   0466
         ST    @04,OPNPWA(,@07)                                    0466
*         /***********************************************************/
*         /*                                                         */
*         /*    SET OPNAGL OUTPUT OR UPDATE OPTION                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0467
*               IF DSOOP = 'O'                                     0467
*                 THEN                                             0467
         L     @04,@PC00007+8                                      0467
         CLI   DSOOP(@04),C'O'                                     0467
         BNE   @RF00467                                            0467
*                   OPNOPTOT = ON;                                 0468
         OI    OPNOPTOT(@07),B'01000000'                           0468
*                 ELSE                                             0469
*                   OPNOPTUP = ON;                                 0469
*                                                                  0469
         B     @RC00467                                            0469
@RF00467 L     @07,OPNPTR(,REG6)                                   0469
         OI    OPNOPTUP(@07),B'00100000'                           0469
*         /***********************************************************/
*         /*                                                         */
*         /*    SET OPNAGL VSAM OPTION                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0470
*               OPNDSOAM = ON;                                     0470
*                                                                  0470
@RC00467 L     @07,OPNPTR(,REG6)                                   0470
         OI    OPNDSOAM(@07),B'10000000'                           0470
*         /***********************************************************/
*         /*                                                         */
*         /*  OPEN THE DATA SET VIA UOPEN                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0471
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN A CATALOG RECOVERY AREA                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0471
*               IF DSODS = 'R'                                     0471
*                 THEN                                             0471
         L     @04,@PC00007+4                                      0471
         CLI   DSODS(@04),C'R'                                     0471
         BNE   @RF00471                                            0471
*                   DO;                                            0472
*                                                                  0472
*                     CALL IDCIOOP0 (GDTTBL,OPNAGL,0);             0473
*                                                                  0473
         ST    REG5,@AL00001                                       0473
         ST    @07,@AL00001+4                                      0473
         LA    @07,@CF00111                                        0473
         ST    @07,@AL00001+8                                      0473
         MVI   @AL00001+8,X'80'                                    0473
         L     @15,GDTOPN(,REG5)                                   0473
         LA    @01,@AL00001                                        0473
         BALR  @14,@15                                             0473
*                     RESPECIFY RTNREG RSTD;                       0474
*                     TESTRC = RTNREG;                             0475
         STH   RTNREG,TESTRC(,REG6)                                0475
*                     RESPECIFY RTNREG UNRSTD;                     0476
*                                                                  0476
*                   END;                                           0477
*                                                                  0477
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN THE WORKFILE OR CATALG                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0478
*               IF DSODS = 'W'  DSODS = 'C'                       0478
*                 THEN                                             0478
@RF00471 L     @07,@PC00007+4                                      0478
         CLI   DSODS(@07),C'W'                                     0478
         BE    @RT00478                                            0478
         CLI   DSODS(@07),C'C'                                     0478
         BNE   @RF00478                                            0478
@RT00478 DS    0H                                                  0479
*                   DO;                                            0479
*                                                                  0479
*                     CALL IDCIOOP0 (GDTTBL,OPNAGL);               0480
*                                                                  0480
         ST    REG5,@AL00001                                       0480
         L     @07,OPNPTR(,REG6)                                   0480
         ST    @07,@AL00001+4                                      0480
         MVI   @AL00001+4,X'80'                                    0480
         L     @15,GDTOPN(,REG5)                                   0480
         LA    @01,@AL00001                                        0480
         BALR  @14,@15                                             0480
*                     RESPECIFY RTNREG RSTD;                       0481
*                     TESTRC = RTNREG;                             0482
         STH   RTNREG,TESTRC(,REG6)                                0482
*                     RESPECIFY RTNREG UNRSTD;                     0483
*                                                                  0483
*                   END;                                           0484
*                                                                  0484
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, SET RETURN CODE OF 4                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0485
*               IF TESTRC ^= 0                                     0485
*                 THEN                                             0485
@RF00478 LH    @07,TESTRC(,REG6)                                   0485
         LTR   @07,@07                                             0485
         BZ    @RF00485                                            0485
*                   RSSUBRC = RCUERR1;                             0486
*                                                                  0486
         MVC   RSSUBRC(4,REG6),@CF00038                            0486
*         /***********************************************************/
*         /*                                                         */
*         /*  OPEN SUCCESSFUL                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0487
*                 ELSE                                             0487
*                   DO;                                            0487
*                                                                  0487
         B     @RC00485                                            0487
@RF00485 DS    0H                                                  0488
*         /***********************************************************/
*         /*                                                         */
*         /*  SET AUDIT FLAGS AND INITIALIZE CONTROL BLOCKS          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0488
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0488
*                     IF DSODS = 'W'                               0488
*                       THEN                                       0488
         L     @07,@PC00007+4                                      0488
         CLI   DSODS(@07),C'W'                                     0488
         BNE   @RF00488                                            0488
*                         DO;                                      0489
*                           RSWFOPN = ON;                          0490
*                                                                  0490
*                                                                  0490
         OI    RSWFOPN(REG6),B'01000000'                           0490
*                           DO;                                    0491
*                             RSRECREQ = ''B;                      0492
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0492
*                             RSRINIT = ON;     /* INITRCD */      0493
         OI    RSRINIT(REG6),B'00000100'                           0493
*                             RSRWF = ON;       /* WORKFILE */     0494
*                                                                  0494
         OI    RSRWF(REG6),B'10000000'                             0494
*                           CALL RECMGMT;                          0495
         BAL   @14,RECMGMT                                         0495
*                             RFY RTNREG RSTD;                     0496
*                             TESTRC = RTNREG;                     0497
         STH   RTNREG,TESTRC(,REG6)                                0497
*                             RFY RTNREG UNRSTD;                   0498
*                           END;                                   0499
*                                                                  0499
*                         END;                                     0500
*                                                                  0500
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0501
*                     IF DSODS = 'C'                               0501
*                       THEN                                       0501
@RF00488 L     @07,@PC00007+4                                      0501
         CLI   DSODS(@07),C'C'                                     0501
         BNE   @RF00501                                            0501
*                         DO;                                      0502
*                           RSCAOPN = ON;                          0503
*                                                                  0503
*                                                                  0503
         OI    RSCAOPN(REG6),B'00010000'                           0503
*                           DO;                                    0504
*                             RSRECREQ = ''B;                      0505
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0505
*                             RSRINIT = ON;     /* INITRCD */      0506
         OI    RSRINIT(REG6),B'00000100'                           0506
*                             RSRCAT = ON;      /* CATALOG */      0507
*                                                                  0507
         OI    RSRCAT(REG6),B'01000000'                            0507
*                           CALL RECMGMT;                          0508
         BAL   @14,RECMGMT                                         0508
*                             RFY RTNREG RSTD;                     0509
*                             TESTRC = RTNREG;                     0510
         STH   RTNREG,TESTRC(,REG6)                                0510
*                             RFY RTNREG UNRSTD;                   0511
*                           END;                                   0512
*                                                                  0512
*                         END;                                     0513
*                                                                  0513
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECOVERY AREA                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0514
*                     IF DSODS = 'R'                               0514
*                       THEN                                       0514
@RF00501 L     @07,@PC00007+4                                      0514
         CLI   DSODS(@07),C'R'                                     0514
         BNE   @RF00514                                            0514
*                         DO;                                      0515
*                           RSCROPN = ON;                          0516
*                                                                  0516
*                                                                  0516
         OI    RSCROPN(REG6),B'00100000'                           0516
*                           DO;                                    0517
*                             RSRECREQ = ''B;                      0518
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0518
*                             RSRINIT = ON;     /* INITRCD */      0519
         OI    RSRINIT(REG6),B'00000100'                           0519
*                             RSRCRA = ON;      /* CRA   */        0520
*                                                                  0520
         OI    RSRCRA(REG6),B'00100000'                            0520
*                           CALL RECMGMT;                          0521
         BAL   @14,RECMGMT                                         0521
*                             RFY RTNREG RSTD;                     0522
*                             TESTRC = RTNREG;                     0523
         STH   RTNREG,TESTRC(,REG6)                                0523
*                             RFY RTNREG UNRSTD;                   0524
*                           END;                                   0525
*                                                                  0525
*                         END;                                     0526
*                                                                  0526
*         /***********************************************************/
*         /*                                                         */
*         /*  RETURN DYNAMIC ALLOCATION DDNAME                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0527
*                     IF RSOPDYN = ON                              0527
*                       THEN                                       0527
@RF00514 TM    RSOPDYN(REG6),B'10000000'                           0527
         BNO   @RF00527                                            0527
*                         DSOUDDN = DSORDDN;                       0528
*                                                                  0528
         L     @07,@PC00007+12                                     0528
         L     @07,DSODDNP(,@07)                                   0528
         L     @04,IOCSPTR(,REG6)                                  0528
         L     @04,IOCEXT(,@04)                                    0528
         L     @04,IOCDDN(,@04)                                    0528
         MVC   DSOUDDN(8,@07),DSORDDN(@04)                         0528
*                   END;                                           0529
*                                                                  0529
@RF00527 DS    0H                                                  0530
*             END DSOOPEN;                                         0530
*                                                                  0530
*                                                                  0530
@RC00485 DS    0H                                                  0531
*         /***********************************************************/
*         /*                                                         */
*         /*  IF VERIFY ONLY OR OPEN AND VERIFY SPECIFIED,           */
*         /*  VERIFY THE CATALOG OR A CRA VIA UVERIFY                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0531
*         IF DSOTYP ^= 'O' & (DSODS = 'C'  DSODS = 'R') &         0531
*            RSSUBRC = 0                                           0531
*           THEN                                                   0531
@RF00432 L     @07,@PC00007                                        0531
         CLI   DSOTYP(@07),C'O'                                    0531
         BE    @RF00531                                            0531
         L     @07,@PC00007+4                                      0531
         CLI   DSODS(@07),C'C'                                     0531
         BE    @GL00002                                            0531
         CLI   DSODS(@07),C'R'                                     0531
         BNE   @RF00531                                            0531
@GL00002 L     @07,RSSUBRC(,REG6)                                  0531
         LTR   @07,@07                                             0531
         BNZ   @RF00531                                            0531
*DSOVRFY:     DO;                                                  0532
DSOVRFY  DS    0H                                                  0533
*               IF DSODS = 'C'                                     0533
*                 THEN                                             0533
         L     @07,@PC00007+4                                      0533
         CLI   DSODS(@07),C'C'                                     0533
         BNE   @RF00533                                            0533
*                   IOCSPTR = RSCAIOCS;                            0534
         L     @07,RSCAIOCS(,REG6)                                 0534
         ST    @07,IOCSPTR(,REG6)                                  0534
*                 ELSE                                             0535
*                   IOCSPTR = RSCRIOCS;                            0535
*                                                                  0535
         B     @RC00533                                            0535
@RF00533 L     @07,RSCRIOCS(,REG6)                                 0535
         ST    @07,IOCSPTR(,REG6)                                  0535
*               CALL IDCIOVY0 (GDTTBL,IOCSPTR);                    0536
*                                                                  0536
@RC00533 ST    REG5,@AL00001                                       0536
         LA    @07,IOCSPTR(,REG6)                                  0536
         ST    @07,@AL00001+4                                      0536
         MVI   @AL00001+4,X'80'                                    0536
         L     @15,GDTVFY(,REG5)                                   0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*               RESPECIFY RTNREG RSTD;                             0537
*               TESTRC = RTNREG;                                   0538
         STH   RTNREG,TESTRC(,REG6)                                0538
*               RESPECIFY RTNREG UNRSTD;                           0539
*                                                                  0539
*         /***********************************************************/
*         /*                                                         */
*         /*    IF VERIFY FAILED, SET RETURN CODE OF 8               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0540
*               IF TESTRC ^= 0                                     0540
*                 THEN                                             0540
         LH    @07,TESTRC(,REG6)                                   0540
         LTR   @07,@07                                             0540
         BZ    @RF00540                                            0540
*                   DO;                                            0541
*                     RSSUBRC = RCUERR2;                           0542
         MVC   RSSUBRC(4,REG6),@CF00175                            0542
*                     IOCMSGOP = ON;                               0543
         L     @07,IOCSPTR(,REG6)                                  0543
         OI    IOCMSGOP(@07),B'00100000'                           0543
*                   END;                                           0544
*                                                                  0544
*             END DSOVRFY;                                         0545
*                                                                  0545
@RF00540 DS    0H                                                  0546
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0546
*         IF GDTDBG = NULLPTR                                      0546
*           THEN;                                                  0546
@RF00531 L     @07,GDTDBG(,REG5)                                   0546
         LTR   @07,@07                                             0546
         BZ    @RT00546                                            0546
*           ELSE                                                   0548
*             CALL IDCDB010 (GDTTBL,'RSD1');                       0548
*                                                                  0548
         ST    REG5,@AL00001                                       0548
         LA    @07,@CC03545                                        0548
         ST    @07,@AL00001+4                                      0548
         MVI   @AL00001+4,X'80'                                    0548
         L     @15,GDTDBG(,REG5)                                   0548
         LA    @01,@AL00001                                        0548
         BALR  @14,@15                                             0548
*         /*RESTORE CALLER'S REGISTERS AND RETURN*/                0549
*         DO;                                                      0549
@RT00546 DS    0H                                                  0550
*           GENERATE;                                              0550
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*           RETURN CODE(RSSUBRC); /*RETURN*/                       0551
         L     @15,RSSUBRC(,REG6)                                  0551
@EL00007 DS    0H                                                  0551
@EF00007 DS    0H                                                  0551
@ER00007 BR    @14                                                 0551
*         END;                                                     0552
*                                                                  0552
*  CALL EXIT;  /*TERMINATE*/                                       0553
*  END DSOPEN; /*END OF PROCEDURE*/                                0554
@PB00007 DS    0H                                                  0555
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - RECMGMT                                         */
*/*                                                                  */
*/* FUNCTION - PERFORMS ALL THE I/O FOR RESETCAT ON                  */
*/*            THE WORKFILE, CATALOG AND CRA'S                       */
*/*                                                                  */
*/* INPUT    - THE RSRECREQ PARAMETER LIST CONTAINS THE              */
*/*            PROCESSING OPTIONS                                    */
*/*            THE RECMGMT ROUTINE COMMUNICATES WITH ITS             */
*/*            CALLERS VIA A GRABS /CURRENT RAB STRUCTURE.           */
*/*            THE FOLLOWING FIELDS ARE EXTRACTED:                   */
*/*            GRABAFLS = ERROR ACTION DIRECTION FLAGS               */
*/*            RABBUF  = RECORD TO BE WRITTEN                        */
*/*            RABPROC = WORKFILE PROCESSING AREA TO BE WRITTEN      */
*/*            RABRCDA = CIN,RRN OR ADDRESS OF KEY OF RECORD         */
*/*            RABRRN  = CIN OR RRN ARG INDICATOR                    */
*/*                                                                  */
*/* OUTPUT   - THE FOLLOWING INFORMATION MAY BE SET                  */
*/*            RABFLG1 = ERROR ACTION RESULT FLAGS                   */
*/*            RABBUF  = RECORD READ                                 */
*/*            RABPROC = WORKFILE PROCESSING AREA READ               */
*/*            RABRCDA = CIN,RRN OR ADDRESS OF KEY OF RECORD         */
*/*            RABRRN  = CIN OR RRN ARG INDICATOR                    */
*/*                                                                  */
*/* RETURN CODES -                                                   */
*/*            0 = SUCCESSFUL COMPLETION OF OPERATION                */
*/*           16 = EOF ENCOUNTERED                                   */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO TERMINATION ROUTINE                             */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0555
         DS    0F
NAME0025 DC    CL8'RECMGMT'
*RECMGMT: PROCEDURE                                                0556
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0556
*                                                                  0556
         B     @PB00008                                            0556
RECMGMT  DS    0H                                                  0557
*      GENERATE REFS(RS06RG08, REG6);                              0557
*                                                                  0557
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY RECMGMT  ENTRY POINT
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0025  PROCNAME TO REGSAVE
*        /************************************************************/
*        /*                                                          */
*        /* INPUT/OUTPUT VARIABLE MAPPING                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0558
*        DCL RECRCD CHAR(*) DEF(RABBUF);   /* USER RECORD         */
*        DCL RECFFLG CHAR(LENGTH(RSWFLD))                          0559
*             DEF(RABPROC);            /*WF PROCESSING FIELD         */
*        DCL RECKEYA CHAR(DSNLGT)                                  0560
*             DEF(RABRCDA);            /*USER KEY ARG                */
*        DCL RECIORCD CHAR(*) BASED(IOCDAD);  /* I/O ADAPTER RECORD  */
*        DCL RECIOKEY CHAR(DSNLGT)                                 0562
*             BASED(IOCKYA);           /*I/O ADAPTER KEY ARG         */
*        DCL RECHL FIXED(8) DEF(RABBUF); /* LKR-HKR INDICATOR        */
*        DCL RECIODSN CHAR(44) BASED(IOCDSN);                      0564
*                                    /*DATA SET NAME                */
*                                                                  0565
*        /************************************************************/
*        /*                                                          */
*        /* CI RANGE TABLE MAPPING VARIABLES                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0565
*        DCL RECISTRT FIXED(31) BASED(ADDR(RSXCIBEG(RSRIXNO)));    0565
*                                       /* STARTING CI               */
*        DCL RECICNT FIXED(31) BASED(ADDR(RSXCILN(RSRIXNO)));      0566
*                                       /* COUNT OF CIS              */
*        DCL RECIXLTE FIXED(31) BASED(ADDR(RSXCIREL(RSRIXNO)));    0567
*                                       /* TRANSLATE FACTOR          */
*                                                                  0568
*     DCL    1 IFGRPL   BASED ,             /* LEVEL ONE DECLARE    */
*             2 RPLCOMN,                    /* RPL COMMON SECTION  0568
*                                                             X03004*/
*              3 RPLIDWD     CHAR(4),       /* ID WORD OF RPL       */
*                4 RPLID     BIT(8),        /* IDENT & HEADER TYPE  */
*                4 RPLSTYP   PTR(8),        /* SUBTYPE              */
*                4 RPLREQ    PTR(8),        /* REQUEST TYPE         */
*                4 RPLLEN    PTR(8),        /* LENGTH OF THIS BLOCK */
*                  5 RPLLEN2 PTR(8),        /* LENGTH OF THIS BLOCK
*                                                             X03004*/
*              3 RPLPLHPT    PTR(31),       /* PTR TO PLACEHOLDER   */
*              3 RPLECB      PTR(31),       /* EXTERNAL ECB PTR OR 0568
*                                              INTERNAL ECB         */
*                  5 RPLWAIT BIT(1),        /* EVENT WAITED ON      */
*                  5 RPLPOST BIT(1),        /* EVENT COMPLETE       */
*              3 RPLFDBWD    PTR(31),       /* FEEDBACK WORD@X04SVHS*/
*                4 RPLSTAT   BIT(8),        /* CURRENT RPL STATUS   */
*                4 RPLFDBK   PTR(24),       /* FEEDBACK AREA        */
*                  5 RPLRTNCD  PTR(8),      /* RPL RETURN CODE      */
*                    6 RPLERREG PTR(8),     /* SAME AS RPLRTNCD    0568
*                                              RECEIVED      X3004BS*/
*                  5 RPLCNDCD   BIT(16) BDY(BYTE), /*RPL CONDITION 0568
*                                                            X3004BS*/
*                    6 RPLCMPON PTR(8),     /* COMPONENT ISSUING   0568
*                                              CODE(VSAM)           */
*                      7 RPLFDB2  PTR(8),   /* REASON CODE(VTAM)   0568
*                                                             X03004*/
*                        8 RPLERLK  BIT(1), /* ERROR LOCK SET X03004*/
*                        8 RPLRVID  BIT(1), /* RVI RECEIVED   X03004*/
*                        8 RPLATND  BIT(1), /* ATTENTION RECEIVED  0568
*                                                             X03004*/
*                        8 RPLDVUNS BIT(1), /* DEVICE UNUSEABLE    0568
*                                                             X03004*/
*                        8 RPLIOERR BIT(1), /* I/O ERROR - 0=INPUT/
*                                              1=OUTPUT       X03004*/
*                        8 RPLDLGFL BIT(1), /* DIALOG INITIATION   0568
*                                              FAILED         X03004*/
*                        8 RPLCUERR BIT(1), /* CONTROL UNIT FAILURE
*                                                             X03004*/
*                        8 RPLSTSAV BIT(1), /* SENSE BYTES PRESENT 0568
*                                                             X03004*/
*                    6 RPLERRCD PTR(8),     /* ERROR CODE(VSAM)     */
*                      7 RPLFDB3  PTR(8),   /* DATA FLAGS(VTAM)    0568
*                                                            X03004 */
*                        8 RPLUINPT  BIT(1),/* UNSOLICITED INPUT   0568
*                                                             X03004*/
*                        8 RPLSV32   BIT(1),/* RESERVED       X03004*/
*                        8 RPLREOB   BIT(1),/* END OF BLOCK   X03004*/
*                        8 RPLREOM   BIT(1),/* END OF MESSAGE X03004*/
*                        8 RPLREOT   BIT(1),/* END OF TRANSMISSION 0568
*                                                             X03004*/
*                        8 RPLLGFRC  BIT(1),/* LOGOFF RECEIVEDX03004*/
*                        8 RPLRLG    BIT(1),/* LEADING GRAPHICS    0568
*                                              RECEIVED       X03004*/
*                        8 RPLRDSOH  BIT(1),/* START-OF-HEADER (SOH)
*                                              RECEIVED       X03004*/
*              3 RPLKEYLE    FIXED(15),     /* KEY LENGTH (PROC=GEN)*/
*                4 RPLKEYL   FIXED(15),     /* SAME AS RPLKEYLE     */
*              3 RPLSTRID    FIXED(15),     /* STRING IDENTIFIER    */
*              3 RPLCCHAR    PTR(31),       /* CONTROL CHAR POINTER */
*              3 RPLDACB     PTR(31),       /* DATA ACB POINTER     */
*              3 RPLTCBPT    PTR(31),       /* TCB POINTER          */
*              3 RPLAREA     PTR(31),       /* DATA AREA POINTER    */
*              3 RPLARG      PTR(31),       /* SEARCH ARGUMENT PTR  */
*                4 RPLSAF    PTR(16),       /* SOURCE ADDRESS      0568
*                                              FIELD          X03004*/
*                4 RPLDAF    PTR(16),       /* DESTINATION ADDRESS 0568
*                                              FIELD          X03004*/
*              3 RPLOPTCD    BIT(32),       /* OPTION CODES         */
*                4 RPLOPT1   BIT(8),        /* OPTION BYTE 1        */
*                  5 RPLLOC  BIT(1),        /* LOCATE MODE          */
*                                           /* MOVE MODE IF OFF     */
*                  5 RPLDIR  BIT(1),        /* DIRECT SEARCH ACCESS */
*                  5 RPLSEQ  BIT(1),        /* SEQUENTIAL ACCESS    */
*                  5 RPLSKP  BIT(1),        /* SKIP SEQ ACCESS      */
*                  5 RPLASY  BIT(1),        /* ASYNCHRONOUS REQUEST */
*                                           /* SYNCH IF OFF         */
*                  5 RPLKGE  BIT(1),        /* SEARCH KEY GT/EQ     */
*                                           /* SEARCH KEY EQ IF OFF */
*                  5 RPLGEN  BIT(1),        /* GENERIC KEY REQUEST  */
*                                           /* FULL KEY IF OFF      */
*                  5 RPLECBSW BIT(1),       /* EXTERNAL ECB         */
*                    6 RPLECBIN BIT(1),     /* SAME AS RPLECBSW    0568
*                                                             X03004*/
*                4 RPLOPT2   BIT(8),        /* OPTION BYTE 2        */
*                  5 RPLKEY  BIT(1),        /* KEYED ACCESS         */
*                  5 RPLADR  BIT(1),        /* ACCESS BY LOCATION   */
*                    6 RPLADD BIT(1),       /* SAME AS RPLADR       */
*                  5 RPLCNV  BIT(1),        /* CINV ACCESS (BY RBA) */
*                  5 RPLBWD  BIT(1),        /* FWD=0/BWD=1  @X04SVHS*/
*                  5 RPLLRD  BIT(1),        /* ARD=0/LRD=1  @X04SVHS*/
*                  5 RPLWAITX BIT(1),       /* SYNCH  PROCESSING   0568
*                                               WAIT EXIT   @ZA07549*/
*                  5 RPLUPD  BIT(1),        /* UPDATE IF ON         */
*                  5 RPLNSP  BIT(1),        /* NOTE STRING POSITION */
*                4 RPLOPT3   BIT(8),        /* OPTION BYTE 3        */
*                  5 RPLEODS BIT(1),        /* END OF USER SYSOUT   */
*                  5 RPLSFORM BIT(1),       /* SPECIAL FORM ON     0568
*                                              REMOTE PRINTER       */
*                  5 RPLBLK  BIT(1),        /* BLOCK=1,UNBLOCKED=0  */
*                                           /* FIXED BLOCK PROCESSING
*                                                            X04SVHS*/
*                  5 RPLVFY  BIT(1),        /* UCS/FCB VERIFY=1     */
*                  5 RPLFLD  BIT(1),        /* UCS FOLD=1           */
*                  5 RPLFMT  BIT(2),        /* FORMAT TYPE          */
*                                           /* 00=UCS LOAD          */
*                                           /* 01=FCB LOAD          */
*                                           /* 10-11 RESERVED       */
*                  5 RPLALIGN BIT(1),       /* 0=DO NOT ALIGN FCB  0568
*                                              BUFFER LOADS         */
*                                           /* 1=ALIGN BUFFER AND  0568
*                                              NOTIFY OPERATOR      */
*                4 RPLOPT4   BIT(8),        /* OPTION BYTE 4        */
*              3 RPLNXTRP    PTR(31),       /* CHAIN TO NEXT RPL    */
*                4 RPLCHAIN  PTR(31),       /* SAME AS RPLNXTRP     */
*              3 RPLRLEN     PTR(31),       /* LENGTH OF RECORD     */
*              3 RPLBUFL     PTR(31),       /* USER BUFFER SIZE     */
*              3 RPLOPTC2    BIT(32),       /* VTAM OPTIONS   X03004*/
*                4 RPLOPT5   BIT(8),        /* OPTION BYTE 5  X03004*/
*                  5 RPLDLGIN BIT(1),       /* 1 = CS / 0 = CA     0568
*                                                             X03004*/
*                  5 RPLSSNIN BIT(1),       /* 1 = CD / 0 = ED     0568
*                                                             X03004*/
*                  5 RPLPSOPT BIT(1),       /* 1 = PASS/0 = RELEASE
*                                                             X03004*/
*                  5 RPLWRTYP BIT(3),       /* WRITE TYPE     X03004*/
*                    6 RPLNERAS BIT(1),     /* WRITE NO ERASE X03004*/
*                    6 RPLEAU   BIT(1),     /* WRITE EAU      X03004*/
*                    6 RPLERACE BIT(1),     /* WRITE WITH ERASE    0568
*                                                             X03004*/
*                  5 RPLNODE  BIT(1),       /* 1=ANY/0=SPEC   X03004*/
*                  5 RPLWROPT BIT(1),       /* 1=CONV/0=NCONV X03004*/
*                4 RPLOPT6   BIT(8),        /* OPTION BYTE 6  X03004*/
*                  5 RPLUNTYP BIT(3),       /* UNIT TYPE      X03004*/
*                    6 RPLEOB   BIT(1),     /* WRITE = BLK    X03004*/
*                    6 RPLEOM   BIT(1),     /* WRITE = LBM    X03004*/
*                    6 RPLEOT   BIT(1),     /* WRITE = LBT    X03004*/
*                  5 RPLCOND  BIT(1),       /* CONDITIONAL    X03004*/
*                  5 RPLNCOND BIT(1),       /* UNCONDITIONAL  X03004*/
*                  5 RPLLOCK  BIT(1),       /* LOCK           X03004*/
*                  5 RPLRSV67 BIT(1),       /* RESERVED       X03004*/
*                  5 RPLRSV68 BIT(1),       /* RESERVED       X03004*/
*                4 RPLOPT7   BIT(8),        /* OPTION BYTE 7  X03004*/
*                  5 RPLCNOPT BIT(3),       /* CONNECTION OPTION   0568
*                                                             X03004*/
*                    6 RPLCNALL BIT(1),     /* CONALL         X03004*/
*                    6 RPLCNANY BIT(1),     /* CONANY         X03004*/
*                    6 RPLCNIMM BIT(1),     /* RESERVED FOR CONIMM 0568
*                                                             X03004*/
*                  5 RPLQOPT  BIT(1),       /* 1 = Q / 0 = NQ X03004*/
*                  5 RPLTPOST BIT(1),       /* RPL ALREADY UNDER PSS
*                                                           @XM08790*/
*                  5 RPLRLSOP BIT(1),       /* 1 = RELQ / 0 = NRELQ
*                                                             X03004*/
*                  5 RPLRSV77 BIT(1),       /* RESERVED       X03004*/
*                  5 RPLRSV78 BIT(1),       /* RESERVED       X03004*/
*                4 RPLOPT8   BIT(8),        /* OPTION BYTE 8  X03004*/
*                  5 RPLODACQ BIT(1),       /* ACQUIRE        X03004*/
*                  5 RPLODACP BIT(1),       /* ACCEPT         X03004*/
*                  5 RPLODPRM BIT(1),       /* PREEMPT        X03004*/
*                  5 RPLPEND  BIT(1),       /* PEND           X03004*/
*                  5 RPLSESS  BIT(1),       /* SESSION        X03004*/
*                  5 RPLACTV  BIT(1),       /* ACTIVE         X03004*/
*                  5 RPLUNCON BIT(1),       /* UNCONDL        X03004*/
*                  5 RPLRSV88 BIT(1),       /* RESERVED       X03004*/
*              3 RPLRBAR     CHAR(8)        /* RBA RETURN LOCATION  */
*                            BDY (WORD),                           0568
*                4 RPLAIXPC PTR(16),        /* AIX POINTER COUNT   0568
*                                                           @X04SVHS*/
*                4 RPLAIXID  BIT(8),        /* AIX POINTER TYPE    0568
*                                                           @X04SVHS*/
*                  5 RPLAXPKP BIT(1),       /* RBA=0/PRIME=1 @XM07761*/
*                  5 *        BIT(7),       /* RESERVED     @X04SVHS*/
*                4 *         BIT(8),        /* RESERVED     @X04SVHS*/
*                4 RPLDDDD PTR(32),         /* RELATIVE BYTE ADDRESS*/
*              3 RPLEXTDS    BIT(8),        /* EXIT DEFINITIONS    0568
*                                                             X03004*/
*                4 RPLEXTD1    BIT(8),      /* SAME AS RPLEXTDS    0568
*                                                             X03004*/
*                  5 RPLEXSCH  BIT(1),      /* EXIT SCHEDULED X03004*/
*                  5 RPLNEXIT  BIT(1),      /* NO EXIT SPECIFIED   0568
*                                                             X03004*/
*                  5 RPLEXIT   BIT(1),      /* ASYNCH EXIT   @XM01127*/
*                  5 *         BIT(2),      /* RESERVED      @XM01127*/
*                  5 RPLNIB    BIT(1),      /* ARG HAS NIB POINTER 0568
*                                              IF ON          X03004*/
*                  5 RPLBRANC  BIT(1),      /* BRANCH ENTRY TO MACRO
*                                              IF ON          X03004*/
*              3 RPLACTIV    BIT(8),        /* ACTIVE INDICATOR    0568
*                                              FF=ACTIVE/00=INACTIVE*/
*              3 RPLEMLEN    PTR(16),       /* ERROR MESSAGE AREA  0568
*                                              LENGTH               */
*              3 RPLERMSA    PTR(31);       /* PTR TO ERR MSG AREA  */
*     DCL      RPLGET   PTR(8) CONSTANT(0); /* GET REQUEST   @X04SVHS*/
*     DCL      RPLPUT   PTR(8) CONSTANT(1); /* PUT REQUEST   @X04SVHS*/
*     DCL      RPLCHECK PTR(8) CONSTANT(2); /* CHECK REQUEST @X04SVHS*/
*     DCL      RPLPOINT PTR(8) CONSTANT(3); /* POINT REQUEST @X04SVHS*/
*     DCL      RPLENDRE PTR(8) CONSTANT(4); /* ENDREQ REQUEST@X04SVHS*/
*     DCL      RPLERASE PTR(8) CONSTANT(5); /* ERASE REQUEST @X04SVHS*/
*     DCL      RPLVERIF PTR(8) CONSTANT(6); /* VERIFY REQUEST@X04SVHS*/
*     DCL      RPLPFMTD PTR(8) CONSTANT(8); /* DATA PREFORMAT@X04SVHS*/
*     DCL      RPLPFMTI PTR(8) CONSTANT(9); /* INDEX PREFORMAT     0577
*                                                            @X04SVHS*/
*     DCL      RPLFRCIO PTR(8) CONSTANT(10); /* FORCE I/O REQUEST  0578
*                                                            @X04SVHS*/
*     DCL      RPLGETIX PTR(8) CONSTANT(11); /* GETIX REQUEST@X04SVHS*/
*     DCL      RPLPUTIX PTR(8) CONSTANT(12); /* PUTIX REQUEST@X04SVHS*/
*     DCL      RPLSRCHB PTR(8) CONSTANT(13); /* SRCHBFR REQUEST    0581
*                                                            @X04SVHS*/
*     DCL      RPLMRKB  PTR(8) CONSTANT(14); /* MRKBFR REQUEST     0582
*                                                            @X04SVHS*/
*     DCL      RPLWRTB  PTR(8) CONSTANT(15); /* WRTBFR REQUEST     0583
*                                                            @X04SVHS*/
*                                                                  0583
*RFY IFGRPL BASED(IOCRPL);                                         0584
*/********************************************************************/
*/*                                                                  */
*/*   MACRO NAME = IDARMRCD                                          */
*/*                                                                  */
*/*   DESCRIPTIVE NAME = VSAM RECORD MANAGEMENT RETURN CODES         */
*/*                                                                  */
*/*   FUNCTION = DECLARES POSSIBLE VALUES FOR IFGRPL FIELDS,         */
*/*              RPLERREG, RPLCMPON, AND RPLERRCD.                   */
*/*                                                                  */
*/*   INCLUDED MACROS = NONE                                         */
*/*                                                                  */
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */
*/*                                                                  */
*/*   STATUS = VS/1 RELEASE 4  (CHANGE FLAG @X04SVXX)                */
*/*                                                                  */
*/*   DATE OF LAST CHANGE = 9 AUG 74                                 */
*/*                                                                  */
*/********************************************************************/
*  /*                                                                */
*  /*    THE FOLLOWING CODE MAY BE SET WHEN (REGISTER 15 = 0).       */
*  DCL   RPLDVOL   PTR(8)    CONSTANT(4);  /* EOV CALLED             */
*  DCL   RPLMOKEY  PTR(8)    CONSTANT(8);  /* DUPLICATE KEY FOLLOWS
*                                                            @X04SVLC*/
*  DCL   RPLWTBFR  PTR(8)    CONSTANT(12); /* WRITE BUFFER IS SUGGESTED
*                                                            @X04SVMR*/
*  /*                                                                */
*  /*    THE FOLLOWING CODES MAY BE SET WHEN (REGISTER 15 = 8).      */
*  /*                    LOGICAL ERROR CODES                         */
*  DCL   RPLEODER  PTR(8)    CONSTANT(4);  /* END OF DATA DETECTED   */
*  DCL   RPLDUP    PTR(8)    CONSTANT(8);  /* DUPLICATE RECORD       */
*                                   /* OR DUP RCD FOR AIX WITH UNIQUE
*                                      KEY OPTION            @X04SVLC*/
*  DCL   RPLSEQCK  PTR(8)    CONSTANT(12); /* KEY SEQUENCE ERROR     */
*  DCL   RPLNOREC  PTR(8)    CONSTANT(16); /* NO RECORD FOUND        */
*  DCL   RPLEXCL   PTR(8)    CONSTANT(20); /* CONTROL INTERVAL       */
*                                          /* EXCLUSIVE USE CONFLICT */
*  DCL   RPLNOMNT  PTR(8)    CONSTANT(24); /* RECORD ON NONMOUNTABLE */
*                                          /* VOLUME                 */
*  DCL   RPLNOEXT  PTR(8)    CONSTANT(28); /* NOT ABLE TO EXTEND     */
*                                          /* DATA SET               */
*  DCL   RPLINRBA  PTR(8)    CONSTANT(32); /* INVALID RBA            */
*  DCL   RPLNOKR   PTR(8)    CONSTANT(36); /* NO KEY RANGE DEFINED   */
*                                          /* FOR PUT RECORD         */
*  DCL   RPLNOVRT  PTR(8)    CONSTANT(40); /* VIRTUAL STORAGE NOT    */
*                                          /* AVAILABLE              */
*  DCL   RPLINBUF  PTR(8)    CONSTANT(44); /* RECORD AREA TOO SMALL  */
*  DCL   RPLNOPLH  PTR(8)    CONSTANT(64); /* PLACEHOLDER NOT AVAIL. */
*  DCL   RPLINACC  PTR(8)    CONSTANT(68); /* ACCESS TYPE NOT ALLOWED*/
*                                          /* BY MACRF OR PASSWORD   */
*  DCL   RPLINKEY  PTR(8)    CONSTANT(72); /* KEYED REQUEST FOR ESDS
*                                   GETIX/PUTIX TO ESDS/RRDS @X04SVMR*/
*  DCL   RPLINADR  PTR(8)    CONSTANT(76);/* ADR OR CI INSERT FOR A
*                                      KSDS                  @X04SVLC*/
*  DCL   RPLERSER  PTR(8)    CONSTANT(80); /* INVALID ERASE REQUEST  */
*                                   /* ERASE VIA PATH FOR ESDS     0604
*                                                            @X04SVLC*/
*  DCL   RPLINLOC  PTR(8)    CONSTANT(84); /* INV. LOCATE MODE REQ.  */
*  DCL   RPLNOPTR  PTR(8)    CONSTANT(88); /* NO POSITION PTR AVAIL. */
*                                   /* OR NO POSITIONING FOR SEQ PUT
*                                      INSERT FOR RRDS. OR ILLEGAL 0606
*                                      SWITCH BETWEEN FWD AND BWD  0606
*                                      PROCESSING            @X04SVLC*/
*  DCL   RPLINUPD  PTR(8)    CONSTANT(92); /* UPD/ERASE--NO GET UPD  */
*                                   /* OR PUTIX WITHOUT PRECEDING  0607
*                                       GETIX                @X04SVLC*/
*  DCL   RPLKEYCH  PTR(8)    CONSTANT(96); /* KEY CHANGE ATTEMPTED   */
*  DCL   RPLDLCER  PTR(8)    CONSTANT(100);/* RECORD LENGTH CHANGE   */
*                                          /* ON ADDRESSED UPDATE  0609
*                                                            @X04SVLC*/
*  DCL   RPLINVP   PTR(8)    CONSTANT(104);/* INVALID RPL OPTIONS    */
*                                   /* KEY, ADR OR CNV NOT SPECIFIED
*                                      SKP WITHOUT KEYED ACCESS    0610
*                                                            @X04SVLC*/
*                                   /* SKP WITH OPTCD=BWD    @X04SVLC*/
*                                   /* CNV WITH OPTCD=BWD    @X04SVLC*/
*                                   /* LRD WITH OPTCD=FWD    @X04SVLC*/
*                                   /* WRTBFR, MRKBFR, OR SCHBFR   0610
*                                      WITH TRANSID>31 OR WITHOUT  0610
*                                      DB/DC OPTION          @X04SVLC*/
*  DCL   RPLINLEN  PTR(8)    CONSTANT(108);/* RECORD LENGTH TOO LARGE*/
*                                          /* OR TOO SMALL           */
*                                   /* OR RECLEN NOT EQUAL TO RECORD
*                                      (SLOT) SIZE SPEC FOR RRDS   0611
*                                                            @X04SVLC*/
*  DCL   RPLKEYLC  PTR(8)    CONSTANT(112);/* GENERIC KEY LENGTH TOO */
*                                          /* LARGE OR 0             */
*  DCL   RPLINLRQ  PTR(8)    CONSTANT(116);/* INVALID REQUEST TYPE   */
*                                          /* OR OPTION DURING LOAD  */
*                                   /* OR REQUEST OTHER THAN PUT INSERT
*                                       FOR RRDS LOADING     @X04SVLC*/
*  DCL   RPLINTCB  PTR(8)    CONSTANT(120);/* CURRENT JOB STEP TCB IS
*                                        NOT CORRECT ONE     @X04SVMR*/
*  DCL   RPLSRLOC  PTR(8)    CONSTANT(132);/* ATTEMPT TO READ SPANNED
*                                        RCD IN LOCATE MODE  @X04SVLC*/
*  DCL   RPLARSRK  PTR(8)    CONSTANT(136);/* ADDR RETRIEVAL SPANNED
*                                      RCD OF KSDS ATTEMPTED @X04SVLC*/
*  DCL   RPLSRISG  PTR(8)    CONSTANT(140);/* INCONSISTANT SPANNED RCD
*                                                            @X04SVLC*/
*  DCL   RPLNBRCD  PTR(8)    CONSTANT(144);/* PTR IN AIX WITH NO BASE
*                                       RECORD               @X04SVLC*/
*  DCL   RPLNXPTR  PTR(8)    CONSTANT(148);/* MAX NBR OF AIX RCD PTRS
*                                       EXCEEDED             @X04SVLC*/
*  DCL   RPLNOBFR  PTR(8)    CONSTANT(152); /* NO BUFFERS    @X04SVMR*/
*  DCL   RPLIRRNO  PTR(8)    CONSTANT(192);/* INVALID RELATIVE RCD 0620
*                                       NUMBER               @X04SVLC*/
*  DCL   RPLRRADR  PTR(8)    CONSTANT(196);/* ADDRESSED REQ FOR RRDS
*                                                            @X04SVLC*/
*  DCL   RPLPAACI  PTR(8)    CONSTANT(200);/* ADDR OR CNV ACCESS THRU
*                                       PATH ATTEMPTED       @X04SVLC*/
*  DCL   RPLPUTBK  PTR(8)    CONSTANT(204);/* PUT INSERT NOT ALLOWED
*                                       IN BACKWARD MODE     @X04SVLC*/
*  DCL   RPLINVEQ  PTR(8)    CONSTANT(208);/* INVALID ENDREQ ISSUED
*                                       (301 PREVENTED)      @OZ02513*/
*  /*                                                                */
*  /*    THE FOLLOWING CODE VALUES ARE NOT ASSIGNED                  */
*  /*               48,52,56,60                                      */
*  /*                                                                */
*  /*    THE FOLLOWING CODES MAY BE SET WHEN (REGISTER 15 = 12)      */
*  /*                    PHYSICAL ERROR CODES                        */
*  DCL   RPLRDERD  PTR(8)    CONSTANT(4);  /* DATA  READ ERROR       */
*  DCL   RPLRDERI  PTR(8)    CONSTANT(8);  /* INDEX READ ERROR       */
*  DCL   RPLRDERS  PTR(8)    CONSTANT(12); /* SEQUENCE SET READ ERROR*/
*  DCL   RPLWTERD  PTR(8)    CONSTANT(16); /* DATA WRITE ERROR       */
*  DCL   RPLWTERI  PTR(8)    CONSTANT(20); /* INDEX WRITE ERROR      */
*  DCL   RPLWTERS  PTR(8)    CONSTANT(24); /* SEQUENCE SET WRITE ERR.*/
*/*      THE FOLLOWING CODES ARE SET IN RPLCMPON WHENEVER          0631
*        RPLERREG IS NON-ZERO                                @X04SVLC*/
*  DCL RPLBASER PTR(8) CONSTANT(0);/* ERROR ACCESSING BASE DS-     0631
*                                     UPGRADE IS OK          @X04SVLC*/
*  DCL RPLBASUM PTR(8) CONSTANT(1);/* ERROR ACCESSING BASE-UPGRADE 0632
*                                     MAY BE BAD             @X04SVLC*/
*  DCL RPLAIXER PTR(8) CONSTANT(2);/* ERROR ACCESSING AIX OVER     0633
*                                     BASE-UPGRADE IS OK     @X04SVLC*/
*  DCL RPLAIXUM PTR(8) CONSTANT(3);/* ERROR ACCESSING AIX- UPGRADE 0634
*                                     MAY BE BAD             @X04SVLC*/
*  DCL RPLUPGER PTR(8) CONSTANT(4);/* ERROR DURING AIX UPGRADE-    0635
*                                     UPGRADE IS OK          @X04SVLC*/
*  DCL RPLUPGUM PTR(8) CONSTANT(5);/* ERROR DURING UPGRADE - UPGRADE
*                                     MAY BE BAD             @X04SVLC*/
*        OLDERID2 = NEWERID2;                                      0637
         L     @07,GDTTR2(,REG5)                                   0637
         MVC   @TS00001(95),NEWERID2(@07)                          0637
         MVC   OLDERID2(95,@07),@TS00001                           0637
*        NEWID2 = 'RSRC';                                          0638
*                                                                  0638
         MVC   NEWID2(4,@07),@CC03782                              0638
*        RFY GRAB BASED(RSRGRBPT);                                 0639
*        RFY RESVOL BASED(RSENTPT);                                0640
*        /************************************************************/
*        /*                                                          */
*        /*  FOR ENDRCD REQUEST, FORCE A PHYSICAL WRITE OF THE LAST  */
*        /*  RECORD PUT SEQUENTIALLY TO THE WORKFILE BY ISSUING      */
*        /*  ENDREQ AGAINST THE SEQUENTIAL RPL.                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0641
*        IF RSREND = ON                                            0641
*          THEN                                                    0641
         TM    RSREND(REG6),B'00000010'                            0641
         BNO   @RF00641                                            0641
*RECEND:     DO;                                                   0642
*                                                                  0642
RECEND   DS    0H                                                  0643
*        /************************************************************/
*        /*                                                          */
*        /*    SET WORKFILE IOCS, RMB AND RPL ADDRESSES.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0643
*              IOCSPTR = RSWFIOCS;                                 0643
         L     @07,RSWFIOCS(,REG6)                                 0643
         ST    @07,IOCSPTR(,REG6)                                  0643
*              RSRMBP = ADDR(WFSRMB);                              0644
         L     @04,RSIOTBL(,REG6)                                  0644
         LA    @04,WFSRMB(,@04)                                    0644
         ST    @04,RSRMBP(,REG6)                                   0644
*              IOCRPL = RMBRPL;                                    0645
*                                                                  0645
         L     @01,IOCEXT(,@07)                                    0645
         L     @04,RMBRPL(,@04)                                    0645
         ST    @04,IOCRPL(,@01)                                    0645
*        /************************************************************/
*        /*                                                          */
*        /*    ISSUE UPUT FOR ENDREQ.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0646
*              IOCMACEN = ON;                                      0646
*                                                                  0646
         OI    IOCMACEN(@07),B'00001000'                           0646
*              CALL IDCIOPT0 (GDTTBL,IOCSPTR);                     0647
*                                                                  0647
         ST    REG5,@AL00001                                       0647
         LA    @07,IOCSPTR(,REG6)                                  0647
         ST    @07,@AL00001+4                                      0647
         MVI   @AL00001+4,X'80'                                    0647
         L     @15,GDTPUT(,REG5)                                   0647
         LA    @01,@AL00001                                        0647
         BALR  @14,@15                                             0647
*              RSRRC = 0;                                          0648
         SLR   @07,@07                                             0648
         ST    @07,RSRRC(,REG6)                                    0648
*            END RECEND;                                           0649
*        /************************************************************/
*        /*                                                          */
*        /* CHKRCD -                                                 */
*        /*  WHEN THE CHKRCD MACRO IS ACTIVATED, THIS CODE WILL      */
*        /*  ISSUE A UABORT 16 IF A WORKFILE DIRECT RMB IS STILL     */
*        /*  HELD FOR UPDATE                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0650
*        IF RSRCHK = ON                                            0650
*          THEN                                                    0650
@RF00641 TM    RSRCHK(REG6),B'00000001'                            0650
         BNO   @RF00650                                            0650
*            DO;                                                   0651
*CHKLP1:       DO RSRI = 1 TO RSRWFRN - 1;                         0652
CHKLP1   LA    @07,1                                               0652
         B     @DE00652                                            0652
@DL00652 DS    0H                                                  0653
*              RSRMBP = ADDR(WFDRMB(RSRI));                        0653
         SLR   @07,@07                                             0653
         IC    @07,RSRI(,REG6)                                     0653
         MH    @07,@CH00032                                        0653
         L     @04,RSIOTBL(,REG6)                                  0653
         LA    @07,WFDRMB-12(@07,@04)                              0653
         ST    @07,RSRMBP(,REG6)                                   0653
*              IF RMBGETU = ON                                     0654
*                THEN                                              0654
*                                                                  0654
         TM    RMBGETU(@07),B'00000100'                            0654
         BNO   @RF00654                                            0654
*                  DO;                                             0655
*                    RESPECIFY(REG13,REG14,REG15) RSTD;            0656
*                    REG15 = 16;                                   0657
         LA    REG15,16                                            0657
*                    REG14 = GDTABT;                               0658
         L     REG14,GDTABT(,REG5)                                 0658
*                    REG13 = GDTABH;                               0659
         L     REG13,GDTABH(,REG5)                                 0659
*                    GEN(BR    REG14);                             0660
         BR    REG14
*                    RESPECIFY(REG13,REG14,REG15)UNRSTD;           0661
*                  END;                                            0662
*                ELSE;                                             0663
@RF00654 DS    0H                                                  0664
*              END CHKLP1;                                         0664
         LA    @07,1                                               0664
         SLR   @04,@04                                             0664
         IC    @04,RSRI(,REG6)                                     0664
         ALR   @07,@04                                             0664
@DE00652 STC   @07,RSRI(,REG6)                                     0664
         LH    @04,RSRWFRN(,REG6)                                  0664
         BCTR  @04,0                                               0664
         CR    @07,@04                                             0664
         BNH   @DL00652                                            0664
*                /*RESTORE CALLER'S REGISTERS AND RETURN*/         0665
*                DO;                                               0665
*                  GENERATE;                                       0666
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*                  RETURN; /*RETURN*/                              0667
@EL00008 DS    0H                                                  0667
@EF00008 DS    0H                                                  0667
@ER00008 BR    @14                                                 0667
*                END;                                              0668
*            END;                                                  0669
*        /************************************************************/
*        /*                                                          */
*        /* SET THE ADDRESS OF THE IOCSTR AND THE ADDRESS OF         */
*        /* THE GRABS CONTROL BLOCK FOR THE SPECIFIED DATA SET       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0670
*        IF RSRCRA = ON                                            0670
*          THEN                                                    0670
@RF00650 TM    RSRCRA(REG6),B'00100000'                            0670
         BNO   @RF00670                                            0670
*            DO;                                                   0671
*              IOCSPTR = RSCRIOCS;                                 0672
         L     @07,RSCRIOCS(,REG6)                                 0672
         ST    @07,IOCSPTR(,REG6)                                  0672
*              RSRGRBPT = ADDR(GRABSCR);                           0673
         L     @07,RSIOTBL(,REG6)                                  0673
         LA    @07,GRABSCR(,@07)                                   0673
         ST    @07,RSRGRBPT(,REG6)                                 0673
*            END;                                                  0674
*                                                                  0674
*        IF RSRCAT = ON                                            0675
*          THEN                                                    0675
@RF00670 TM    RSRCAT(REG6),B'01000000'                            0675
         BNO   @RF00675                                            0675
*            DO;                                                   0676
*              IOCSPTR = RSCAIOCS;                                 0677
         L     @07,RSCAIOCS(,REG6)                                 0677
         ST    @07,IOCSPTR(,REG6)                                  0677
*              RSRGRBPT = ADDR(GRABSCA);                           0678
         L     @07,RSIOTBL(,REG6)                                  0678
         LA    @07,GRABSCA(,@07)                                   0678
         ST    @07,RSRGRBPT(,REG6)                                 0678
*            END;                                                  0679
*                                                                  0679
*        IF RSRWF = ON                                             0680
*          THEN                                                    0680
@RF00675 TM    RSRWF(REG6),B'10000000'                             0680
         BNO   @RF00680                                            0680
*            DO;                                                   0681
*              IOCSPTR = RSWFIOCS;                                 0682
         L     @07,RSWFIOCS(,REG6)                                 0682
         ST    @07,IOCSPTR(,REG6)                                  0682
*              RSRGRBPT = ADDR(GRABSWF);                           0683
         L     @07,RSIOTBL(,REG6)                                  0683
         ST    @07,RSRGRBPT(,REG6)                                 0683
*            END;                                                  0684
*                                                                  0684
*        /************************************************************/
*        /*                                                          */
*        /*   INITRCD OR TERMRCD                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0685
*        IF RSRINIT = ON  RSRTERM = ON                            0685
*          THEN                                                    0685
*                                                                  0685
@RF00680 TM    RSRINIT(REG6),B'00000110'                           0685
         BZ    @RF00685                                            0685
*            CALL RECMIT;           /* INITRCD OR TERMRCD        */
*                                                                  0686
         BAL   @14,RECMIT                                          0686
*        /************************************************************/
*        /*                                                          */
*        /*   THE FOLLOWING OPERATIONS MAY BE RETRIED IF AN ERROR    */
*        /*   OCCURRS.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0687
*        RSROKSW = OFF;                                            0687
@RF00685 DS    0H                                                  0688
*        RSRXTRY = OFF;                                            0688
*                                                                  0688
         NI    RSROKSW(REG6),B'00111111'                           0688
*RECLP1: DO WHILE (RSROKSW = OFF & RSRINIT = OFF & RSRTERM = OFF   0689
*                  & RSREND = OFF);                                0689
*                                                                  0689
RECLP1   B     @DE00689                                            0689
@DL00689 DS    0H                                                  0690
*          RSRRC = 0;                                              0690
*                                                                  0690
         SLR   @07,@07                                             0690
         ST    @07,RSRRC(,REG6)                                    0690
*        /************************************************************/
*        /*                                                          */
*        /*   GETRCD,ADDRCD OR POSRCD                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0691
*          IF RSRGET = ON  RSRADD = ON  RSRPOS = ON              0691
*            THEN                                                  0691
*                                                                  0691
         TM    RSRGET(REG6),B'11010000'                            0691
         BZ    @RF00691                                            0691
*                CALL RECMGAP;      /* GETRCD,ADDRCD OR POSRCD   */
*                                                                  0692
         BAL   @14,RECMGAP                                         0692
*        /************************************************************/
*        /*                                                          */
*        /*   UPDRCD,DELRCD OR FREERCD                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0693
*          IF RSRUPDT = ON  RSRDEL = ON  RSRFREE = ON            0693
*            THEN                                                  0693
*                                                                  0693
@RF00691 TM    RSRUPDT(REG6),B'00101001'                           0693
         BZ    @RF00693                                            0693
*                CALL RECMUD;         /* UPDRCD,DELRCD OR FREERCD*/
*                                                                  0694
         BAL   @14,RECMUD                                          0694
*        /************************************************************/
*        /*                                                          */
*        /* IF AN I/O ERROR, XLATE ERROR OR EOF = NRF ERROR          */
*        /* WAS ENCOUNTERED, CALL THE APPROPRIATE ERROR ROUTINE      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0695
*          IF RSRRC = RCIOERR  RSRRC = RCXLERR                   0695
*             (RSRRC = RCEOF & GRABSNRN = ON)                      0695
*            THEN                                                  0695
@RF00693 L     @07,RSRRC(,REG6)                                    0695
         C     @07,@CF00038                                        0695
         BE    @RT00695                                            0695
         C     @07,@CF00175                                        0695
         BE    @RT00695                                            0695
         C     @07,@CF00471                                        0695
         BNE   @RF00695                                            0695
         L     @07,RSRGRBPT(,REG6)                                 0695
         TM    GRABSNRN(@07),B'00000010'                           0695
         BNO   @RF00695                                            0695
@RT00695 DS    0H                                                  0696
*              DO;                                                 0696
*        /************************************************************/
*        /*                                                          */
*        /*   CALL ERROR ROUTINE                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0697
*                CALL RECERR;                                      0697
*                                                                  0697
         BAL   @14,RECERR                                          0697
*        /************************************************************/
*        /*                                                          */
*        /*   RETRY OR IGNORE AS DIRECTED                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0698
*                IF RSRRC ^= 0                                     0698
*                  THEN                                            0698
         L     @07,RSRRC(,REG6)                                    0698
         LTR   @07,@07                                             0698
         BZ    @RF00698                                            0698
*                    RSROKSW = ON;                                 0699
         OI    RSROKSW(REG6),B'10000000'                           0699
*              END;                                                0700
*            ELSE                                                  0701
*              RSROKSW = ON;                                       0701
*                                                                  0701
         B     @RC00695                                            0701
@RF00695 OI    RSROKSW(REG6),B'10000000'                           0701
*        END RECLP1;                                               0702
*                                                                  0702
@RC00695 DS    0H                                                  0702
@DE00689 TM    RSROKSW(REG6),B'10000000'                           0702
         BNZ   @DC00689                                            0702
         TM    RSRINIT(REG6),B'00000110'                           0702
         BNZ   @DC00689                                            0702
         TM    RSREND(REG6),B'00000010'                            0702
         BZ    @DL00689                                            0702
@DC00689 DS    0H                                                  0703
*        RSREND = OFF;                                             0703
*                                                                  0703
         NI    RSREND(REG6),B'11111101'                            0703
*        IF RSRRC ^= RCEOF                                         0704
*          THEN                                                    0704
         CLC   RSRRC(4,REG6),@CF00471                              0704
         BE    @RF00704                                            0704
*            RSRRC = 0;                                            0705
*                                                                  0705
         SLR   @07,@07                                             0705
         ST    @07,RSRRC(,REG6)                                    0705
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESSING COMPLETED. RETURN.                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0706
*        IF GDTDBG = NULLPTR                                       0706
*          THEN;                                                   0706
@RF00704 L     @07,GDTDBG(,REG5)                                   0706
         LTR   @07,@07                                             0706
         BZ    @RT00706                                            0706
*          ELSE                                                    0708
*            CALL IDCDB010 (GDTTBL,'RSR2');                        0708
*                                                                  0708
         ST    REG5,@AL00001                                       0708
         LA    @07,@CC03795                                        0708
         ST    @07,@AL00001+4                                      0708
         MVI   @AL00001+4,X'80'                                    0708
         L     @15,GDTDBG(,REG5)                                   0708
         LA    @01,@AL00001                                        0708
         BALR  @14,@15                                             0708
*        /*RESTORE CALLER'S REGISTERS AND RETURN*/                 0709
*        DO;                                                       0709
@RT00706 DS    0H                                                  0710
*          GENERATE;                                               0710
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*          RETURN CODE(RSRRC); /*RETURN*/                          0711
         L     @15,RSRRC(,REG6)                                    0711
         BR    @14                                                 0711
*        END;                                                      0712
*      GENERATE;                                                   0713
         B     NAME0033+8  BR AROUND NAME
         DS    0F
NAME0033 DC    CL8'RECMIT'
*RECMIT: PROCEDURE                                                 0714
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0714
*                                                                  0714
         B     @PB00009                                            0714
RECMIT   DS    0H                                                  0715
*      GENERATE REFS(RS06RG08, REG6);                              0715
*                                                                  0715
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0033  PROCNAME TO REGSAVE
*/********************************************************************/
*/* INITIALIZE RMB'S AFTER UOPEN                                     */
*/* CLEANUP RMB'S BEFORE UCLOSE                                      */
*/* FOR DATA SETS OPENED FOR UPDATE,                                 */
*/* SET THE DATA ADDRESS IN THE IOCSTR TO POINT TO                   */
*/* THE BUFFER OBTAINED BY UOPEN                                     */
*/* FOR DATA SETS OPENED FOR OUTPUT,                                 */
*/* SET THE DATA ADDRESS IN THE IOCSTR TO POINT TO                   */
*/* RECMGMT'S WORKAREA BUFFER                                        */
*/********************************************************************/
*                                                                  0716
*        /************************************************************/
*        /*                                                          */
*        /* SET IOCSTR DATA ADDRESS                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0716
*        IF RSRINIT = ON                                           0716
*          THEN                                                    0716
         TM    RSRINIT(REG6),B'00000100'                           0716
         BNO   @RF00716                                            0716
*            IF OPNOPTOT = ON                                      0717
*              THEN                                                0717
         L     @07,OPNPTR(,REG6)                                   0717
         TM    OPNOPTOT(@07),B'01000000'                           0717
         BNO   @RF00717                                            0717
*                IOCDAD = ADDR(RECPTRCD);                          0718
         L     @07,IOCSPTR(,REG6)                                  0718
         L     @04,RSIOTBL(,REG6)                                  0718
         LA    @04,RECPTRCD(,@04)                                  0718
         ST    @04,IOCDAD(,@07)                                    0718
*              ELSE                                                0719
*                IOCDAD = IOCWKA;                                  0719
*                                                                  0719
         B     @RC00717                                            0719
@RF00717 L     @07,IOCSPTR(,REG6)                                  0719
         L     @04,IOCEXT(,@07)                                    0719
         L     @04,IOCWKA(,@04)                                    0719
         ST    @04,IOCDAD(,@07)                                    0719
*        /************************************************************/
*        /*                                                          */
*        /* SET THE RSRMBP TO THE FIRST RMB FOR THE DATASET AND      */
*        /* SET THE NUMBER OF STRINGS                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0720
*                                                                  0720
*        /************************************************************/
*        /*                                                          */
*        /*   FOR CATALOG RECOVERY AREA, THERE IS ONLY 1 RMB         */
*        /*   SET RSRMBP TO IT                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0720
*        IF RSRCRA = ON                                            0720
*          THEN                                                    0720
@RC00717 DS    0H                                                  0720
@RF00716 TM    RSRCRA(REG6),B'00100000'                            0720
         BNO   @RF00720                                            0720
*            DO;                                                   0721
*              RSRMBP = ADDR(CRARMB);                              0722
         L     @07,RSIOTBL(,REG6)                                  0722
         LA    @07,CRARMB(,@07)                                    0722
         ST    @07,RSRMBP(,REG6)                                   0722
*              IF RSRINIT = ON                                     0723
*                THEN                                              0723
         TM    RSRINIT(REG6),B'00000100'                           0723
         BNO   @RF00723                                            0723
*                  RSRCRARN = 1;                                   0724
         MVC   RSRCRARN(2,REG6),@CH00212                           0724
*              RSRRCPY = RSRCRARN;                                 0725
@RF00723 LH    @07,RSRCRARN(,REG6)                                 0725
         STH   @07,RSRRCPY(,REG6)                                  0725
*            END;                                                  0726
*                                                                  0726
*        /************************************************************/
*        /*                                                          */
*        /*   FOR CATALOG, THERE ARE TWO RMBS - ONE FOR THE          */
*        /*   LOW KEY RANGE AND ONE FOR THE HIGH KEY RANGE           */
*        /*   SET RSRMBP TO THE LOW KEY RANGE RMB                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0727
*        IF RSRCAT = ON                                            0727
*          THEN                                                    0727
@RF00720 TM    RSRCAT(REG6),B'01000000'                            0727
         BNO   @RF00727                                            0727
*            DO;                                                   0728
*              RSRMBP = ADDR(CATLRMB);                             0729
         L     @07,RSIOTBL(,REG6)                                  0729
         LA    @07,CATLRMB(,@07)                                   0729
         ST    @07,RSRMBP(,REG6)                                   0729
*              IF RSRINIT = ON                                     0730
*                THEN                                              0730
         TM    RSRINIT(REG6),B'00000100'                           0730
         BNO   @RF00730                                            0730
*                  RSRCATRN = OPNSTRNO;                            0731
         L     @07,OPNPTR(,REG6)                                   0731
         SLR   @04,@04                                             0731
         IC    @04,OPNSTRNO(,@07)                                  0731
         STH   @04,RSRCATRN(,REG6)                                 0731
*              RSRRCPY = RSRCATRN;                                 0732
@RF00730 LH    @07,RSRCATRN(,REG6)                                 0732
         STH   @07,RSRRCPY(,REG6)                                  0732
*            END;                                                  0733
*                                                                  0733
*        /************************************************************/
*        /*                                                          */
*        /*   FOR THE WORKFILE, THERE IS ONE SEQ RMB AND             */
*        /*   MULTIPLE DIRECT RMBS. SET THE RSRMBP TO THE            */
*        /*   SEQ RMB                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0734
*        IF RSRWF = ON                                             0734
*          THEN                                                    0734
@RF00727 TM    RSRWF(REG6),B'10000000'                             0734
         BNO   @RF00734                                            0734
*            DO;                                                   0735
*              RSRMBP = ADDR(WFSRMB);                              0736
         L     @07,RSIOTBL(,REG6)                                  0736
         LA    @07,WFSRMB(,@07)                                    0736
         ST    @07,RSRMBP(,REG6)                                   0736
*              IF RSRINIT = ON                                     0737
*                THEN                                              0737
         TM    RSRINIT(REG6),B'00000100'                           0737
         BNO   @RF00737                                            0737
*                  DO;                                             0738
*                    RSRLU = 0;                                    0739
         MVI   RSRLU(REG6),X'00'                                   0739
*                    IF OPNSTRNO > 1                               0740
*                      THEN                                        0740
         L     @07,OPNPTR(,REG6)                                   0740
         CLI   OPNSTRNO(@07),1                                     0740
         BNH   @RF00740                                            0740
*                        RSRWFRN = OPNSTRNO;                       0741
         SLR   @04,@04                                             0741
         IC    @04,OPNSTRNO(,@07)                                  0741
         STH   @04,RSRWFRN(,REG6)                                  0741
*                      ELSE                                        0742
*                        RSRWFRN = 1;                              0742
         B     @RC00740                                            0742
@RF00740 MVC   RSRWFRN(2,REG6),@CH00212                            0742
*                  END;                                            0743
@RC00740 DS    0H                                                  0744
*              RSRRCPY = RSRWFRN;                                  0744
@RF00737 LH    @07,RSRWFRN(,REG6)                                  0744
         STH   @07,RSRRCPY(,REG6)                                  0744
*            END;                                                  0745
*                                                                  0745
*        /************************************************************/
*        /*                                                          */
*        /* INITRCD REQUEST, SET LOGICAL ERROR MESSAGE               */
*        /* SUPPRESSION FLAG                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0746
*        IF RSRINIT = ON                                           0746
*          THEN                                                    0746
@RF00734 TM    RSRINIT(REG6),B'00000100'                           0746
         BNO   @RF00746                                            0746
*            DO;                                                   0747
*                                                                  0747
*              IOCMSGSM = ON;                                      0748
*                                                                  0748
         L     @07,IOCSPTR(,REG6)                                  0748
         OI    IOCMSGSM(@07),B'00000010'                           0748
*        /************************************************************/
*        /*                                                          */
*        /*  INITRCD REQUEST, COMPUTE THE LENGTH OF EACH RPL         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0749
*              RSRRPL = IOCRPL;                                    0749
         L     @07,IOCEXT(,@07)                                    0749
         L     @04,IOCRPL(,@07)                                    0749
         ST    @04,RSRRPL(,REG6)                                   0749
*              RSRRLN = IOCLRP/RSRRCPY;                            0750
         LH    @00,IOCLRP(,@07)                                    0750
         SRDA  @00,32                                              0750
         LH    @07,RSRRCPY(,REG6)                                  0750
         DR    @00,@07                                             0750
         STH   @01,RSRRLN(,REG6)                                   0750
*            END;                                                  0751
*                                                                  0751
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS EACH RMB FOR THE REQUESTED DATA SET.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0752
*RECLP3: DO RSRX = 1 TO RSRRCPY;                                   0752
*                                                                  0752
@RF00746 DS    0H                                                  0752
RECLP3   LA    @07,1                                               0752
         B     @DE00752                                            0752
@DL00752 DS    0H                                                  0753
*        /************************************************************/
*        /*                                                          */
*        /*    FOR TERMRCD REQUEST, ISSUE ENDREQ FOR ALL WORKFILE    */
*        /*    WORKFILE DIRECT RMBS WHICH WERE USED FOR GET UPDATE   */
*        /*    SET RMB GET UPDATE FLAG OFF.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0753
*          IF RSRTERM = ON & RSRWF = ON & RMBDIR = ON & RMBGETU = ON
*            THEN                                                  0753
         TM    RSRTERM(REG6),B'00000010'                           0753
         BNO   @RF00753                                            0753
         TM    RSRWF(REG6),B'10000000'                             0753
         BNO   @RF00753                                            0753
         L     @07,RSRMBP(,REG6)                                   0753
         TM    RMBDIR(@07),B'01000100'                             0753
         BNO   @RF00753                                            0753
*              DO;                                                 0754
*                RMBGETU = OFF;                                    0755
         NI    RMBGETU(@07),B'11111011'                            0755
*                IOCRPL = RMBRPL;                                  0756
         L     @04,IOCSPTR(,REG6)                                  0756
         L     @01,IOCEXT(,@04)                                    0756
         L     @07,RMBRPL(,@07)                                    0756
         ST    @07,IOCRPL(,@01)                                    0756
*                IOCMACEN = ON;                                    0757
*                                                                  0757
         OI    IOCMACEN(@04),B'00001000'                           0757
*                CALL IDCIOPT0 (GDTTBL,IOCSPTR);                   0758
*                                                                  0758
         ST    REG5,@AL00001                                       0758
         LA    @07,IOCSPTR(,REG6)                                  0758
         ST    @07,@AL00001+4                                      0758
         MVI   @AL00001+4,X'80'                                    0758
         L     @15,GDTPUT(,REG5)                                   0758
         LA    @01,@AL00001                                        0758
         BALR  @14,@15                                             0758
*              END;                                                0759
*                                                                  0759
*        /************************************************************/
*        /*                                                          */
*        /*    FOR INITRCD, PLACE AN RPL ADDRESS IN THE RMB AND      */
*        /*    SET THE RMB FLAGS TO CORRESPOND TO THE RPL FLAGS      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0760
*          IF RSRINIT = ON                                         0760
*            THEN                                                  0760
@RF00753 TM    RSRINIT(REG6),B'00000100'                           0760
         BNO   @RF00760                                            0760
*              DO;                                                 0761
*                                                                  0761
*                RMBRPL = RSRRPL;                                  0762
         L     @07,RSRMBP(,REG6)                                   0762
         L     @04,RSRRPL(,REG6)                                   0762
         ST    @04,RMBRPL(,@07)                                    0762
*                RMBFLAGS = ''B;                                   0763
         XC    RMBFLAGS(4,@07),RMBFLAGS(@07)                       0763
*                IF IOCMACUP = ON                                  0764
*                  THEN                                            0764
         L     @04,IOCSPTR(,REG6)                                  0764
         TM    IOCMACUP(@04),B'00100000'                           0764
         BNO   @RF00764                                            0764
*                    RMBUPD = ON;                                  0765
*                                                                  0765
         OI    RMBUPD(@07),B'00100000'                             0765
*                IF IOCMACBK = OFF                                 0766
*                  THEN                                            0766
@RF00764 L     @07,IOCSPTR(,REG6)                                  0766
         TM    IOCMACBK(@07),B'00001000'                           0766
         BNZ   @RF00766                                            0766
*                    RMBKEY = ON;                                  0767
*                                                                  0767
         L     @07,RSRMBP(,REG6)                                   0767
         OI    RMBKEY(@07),B'00010000'                             0767
*                IF IOCMACDR = ON                                  0768
*                  THEN                                            0768
@RF00766 L     @07,IOCSPTR(,REG6)                                  0768
         TM    IOCMACDR(@07),B'00000100'                           0768
         BNO   @RF00768                                            0768
*                    RMBDIR = ON;                                  0769
         L     @07,RSRMBP(,REG6)                                   0769
         OI    RMBDIR(@07),B'01000000'                             0769
*                  ELSE                                            0770
*                    IF IOCMACSK = OFF                             0770
*                      THEN                                        0770
         B     @RC00768                                            0770
@RF00768 L     @07,IOCSPTR(,REG6)                                  0770
         TM    IOCMACSK(@07),B'10000000'                           0770
         BNZ   @RF00770                                            0770
*                        RMBSEQ = ON;                              0771
*                                                                  0771
         L     @07,RSRMBP(,REG6)                                   0771
         OI    RMBSEQ(@07),B'10000000'                             0771
*              END;                                                0772
*                                                                  0772
@RF00770 DS    0H                                                  0772
@RC00768 DS    0H                                                  0773
*        /************************************************************/
*        /*                                                          */
*        /*    SET UP TO PROCESS THE NEXT RPL AND RMB.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0773
*          IF RSRX < RSRRCPY                                       0773
*            THEN                                                  0773
@RF00760 SLR   @07,@07                                             0773
         IC    @07,RSRX(,REG6)                                     0773
         CH    @07,RSRRCPY(,REG6)                                  0773
         BNL   @RF00773                                            0773
*              DO;                                                 0774
*                IF RSRINIT = ON                                   0775
*                  THEN                                            0775
         TM    RSRINIT(REG6),B'00000100'                           0775
         BNO   @RF00775                                            0775
*                    RSRRPL = RSRRPL + RSRRLN;                     0776
         LH    @07,RSRRLN(,REG6)                                   0776
         AL    @07,RSRRPL(,REG6)                                   0776
         ST    @07,RSRRPL(,REG6)                                   0776
*                IF RSRWF = ON                                     0777
*                  THEN                                            0777
@RF00775 TM    RSRWF(REG6),B'10000000'                             0777
         BNO   @RF00777                                            0777
*                    RSRMBP = ADDR(WFDRMB(RSRX));                  0778
         SLR   @07,@07                                             0778
         IC    @07,RSRX(,REG6)                                     0778
         MH    @07,@CH00032                                        0778
         L     @04,RSIOTBL(,REG6)                                  0778
         LA    @07,WFDRMB-12(@07,@04)                              0778
         ST    @07,RSRMBP(,REG6)                                   0778
*                  ELSE                                            0779
*                    RSRMBP = ADDR(CATHRMB);                       0779
         B     @RC00777                                            0779
@RF00777 L     @07,RSIOTBL(,REG6)                                  0779
         LA    @07,CATHRMB(,@07)                                   0779
         ST    @07,RSRMBP(,REG6)                                   0779
*              END;                                                0780
*                                                                  0780
@RC00777 DS    0H                                                  0781
*        END RECLP3;                                               0781
*                                                                  0781
@RF00773 LA    @07,1                                               0781
         SLR   @04,@04                                             0781
         IC    @04,RSRX(,REG6)                                     0781
         ALR   @07,@04                                             0781
@DE00752 STC   @07,RSRX(,REG6)                                     0781
         CH    @07,RSRRCPY(,REG6)                                  0781
         BNH   @DL00752                                            0781
*        /************************************************************/
*        /*                                                          */
*        /* FOR TERMRCD REQUEST, SET THE ADDRESS OF THE RPL FROM     */
*        /* THE FIRST RMB BACK INTO IOCRPL SO UCLOSE CAN FREE        */
*        /* THE RPL CORE.                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0782
*        IF RSRTERM = ON & RSRWF = ON                              0782
*          THEN                                                    0782
         TM    RSRTERM(REG6),B'00000010'                           0782
         BNO   @RF00782                                            0782
         TM    RSRWF(REG6),B'10000000'                             0782
         BNO   @RF00782                                            0782
*            DO;                                                   0783
*              RSRMBP = ADDR(WFSRMB);                              0784
         L     @07,RSIOTBL(,REG6)                                  0784
         LA    @07,WFSRMB(,@07)                                    0784
         ST    @07,RSRMBP(,REG6)                                   0784
*              IOCRPL = RMBRPL;                                    0785
         L     @04,IOCSPTR(,REG6)                                  0785
         L     @04,IOCEXT(,@04)                                    0785
         L     @07,RMBRPL(,@07)                                    0785
         ST    @07,IOCRPL(,@04)                                    0785
*            END;                                                  0786
*                                                                  0786
*        IF RSRTERM = ON & RSRCAT = ON                             0787
*          THEN                                                    0787
@RF00782 TM    RSRTERM(REG6),B'00000010'                           0787
         BNO   @RF00787                                            0787
         TM    RSRCAT(REG6),B'01000000'                            0787
         BNO   @RF00787                                            0787
*            DO;                                                   0788
*              RSRMBP = ADDR(CATLRMB);                             0789
         L     @07,RSIOTBL(,REG6)                                  0789
         LA    @07,CATLRMB(,@07)                                   0789
         ST    @07,RSRMBP(,REG6)                                   0789
*              IOCRPL = RMBRPL;                                    0790
         L     @04,IOCSPTR(,REG6)                                  0790
         L     @04,IOCEXT(,@04)                                    0790
         L     @07,RMBRPL(,@07)                                    0790
         ST    @07,IOCRPL(,@04)                                    0790
*            END;                                                  0791
*                                                                  0791
*        /************************************************************/
*        /*                                                          */
*        /* CLEAR THE ARGUMENT FIELD                                 */
*        /* AND FLAGS IN EACH RAB FOR THE DATA SET                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0792
*                                                                  0792
*RECLP5: DO RSIDX3 = 1 TO GRABSN;                                  0792
@RF00787 DS    0H                                                  0792
RECLP5   LA    @07,1                                               0792
         B     @DE00792                                            0792
@DL00792 DS    0H                                                  0793
*          GRABCURR = RABARRAY(RSIDX3);                            0793
         L     @07,RSRGRBPT(,REG6)                                 0793
         LH    @04,RSIDX3(,REG6)                                   0793
         SLA   @04,2                                               0793
         L     @04,RABARRAY-4(@04,@07)                             0793
         ST    @04,GRABCURR(,@07)                                  0793
*          RABFLGS = ''B;                                          0794
         XC    RABFLGS(4,@04),RABFLGS(@04)                         0794
*          RABRCDA = 0;                                            0795
         SLR   @07,@07                                             0795
         ST    @07,RABRCDA(,@04)                                   0795
*        END RECLP5;                                               0796
*                                                                  0796
         LA    @07,1                                               0796
         AH    @07,RSIDX3(,REG6)                                   0796
@DE00792 STH   @07,RSIDX3(,REG6)                                   0796
         L     @04,RSRGRBPT(,REG6)                                 0796
         SLR   @15,@15                                             0796
         IC    @15,GRABSN(,@04)                                    0796
         CR    @07,@15                                             0796
         BNH   @DL00792                                            0796
*  CALL EXIT;  /*TERMINATE*/                                       0797
         BAL   @14,EXIT                                            0797
*  END RECMIT; /*END OF PROCEDURE*/                                0798
@EL00009 DS    0H                                                  0798
@EF00009 DS    0H                                                  0798
@ER00009 BR    @14                                                 0798
@PB00009 DS    0H                                                  0799
*      GENERATE;                                                   0799
         B     NAME0035+8  BR AROUND NAME
         DS    0F
NAME0035 DC    CL8'RECMGAP'
*RECMGAP: PROCEDURE                                                0800
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0800
*                                                                  0800
         B     @PB00010                                            0800
RECMGAP  DS    0H                                                  0801
*      GENERATE REFS(RS06RG08, REG6);                              0801
*                                                                  0801
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0035  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* GET, PUT INSERT OR POSITION                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0802
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE SKIP PROCESSING FLAG TO OFF. THIS FLAG      */
*         /*  IS USED TO CONTROL THE FLOW THROUGH VARIOUS            */
*         /*  DEPENDENT PARTS OF THE CODE. WHEN SET ON, IT           */
*         /*  WILL CAUSE THESE PARTS OF THE CODE TO BE BYPASSED.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0802
*         RSRSKPSW = OFF;                                          0802
*                                                                  0802
*                                                                  0802
         NI    RSRSKPSW(REG6),B'11101111'                          0802
*        /************************************************************/
*        /*                                                          */
*        /* CHOOSE AN RPL/RMB FOR THIS REQUEST                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0803
*        CALL RMBNUPIK;                                            0803
*                                                                  0803
         BAL   @14,RMBNUPIK                                        0803
*        /************************************************************/
*        /*                                                          */
*        /* FOR A POSITION REQUEST, OR A DIRECT REQUEST,             */
*        /* AN ARGUMENT MUST BE SET UP IN THE IOCSTR AND             */
*        /* FOR A GET UPDATE REQUEST, THE ARGUMENT MUST ALSO BE      */
*        /* SAVED IN THE RMB                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0804
*        IF RSRDIR = ON  RSRPOS = ON                              0804
*          THEN                                                    0804
*                                                                  0804
         TM    RSRDIR(REG6),B'00000100'                            0804
         BO    @RT00804                                            0804
         TM    RSRPOS(REG6),B'00010000'                            0804
         BNO   @RF00804                                            0804
@RT00804 DS    0H                                                  0805
*        /************************************************************/
*        /*                                                          */
*        /*   FOR THE WORKFILE, THE ARG IS SET IN IOCREL             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0805
*            IF RSRWF = ON                                         0805
*              THEN                                                0805
         TM    RSRWF(REG6),B'10000000'                             0805
         BNO   @RF00805                                            0805
*                DO;                                               0806
*                                                                  0806
*        /************************************************************/
*        /*                                                          */
*        /*   ARG IS AN RRN, NO TRANSLATION NECESSARY                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0807
*                  IF RABRRN = ON                                  0807
*                    THEN                                          0807
         L     @07,RSRGRBPT(,REG6)                                 0807
         L     @07,GRABCURR(,@07)                                  0807
         TM    RABRRN(@07),B'00010000'                             0807
         BNO   @RF00807                                            0807
*                      DO;                                         0808
*                        IOCREL = RABRCDA;                         0809
*                                                                  0809
         L     @04,IOCSPTR(,REG6)                                  0809
         L     @07,RABRCDA(,@07)                                   0809
         ST    @07,IOCREL(,@04)                                    0809
*        /************************************************************/
*        /*                                                          */
*        /*   IF REQUEST IS FOR GET UPDATE, SAVE THE ARGUMENT IN     */
*        /*   THE RMB.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0810
*                        IF RMBGETU = ON                           0810
*                          THEN                                    0810
         L     @04,RSRMBP(,REG6)                                   0810
         TM    RMBGETU(@04),B'00000100'                            0810
         BNO   @RF00810                                            0810
*                            RMBARG = IOCREL;                      0811
*                                                                  0811
         ST    @07,RMBARG(,@04)                                    0811
*                      END;                                        0812
*                                                                  0812
*        /************************************************************/
*        /*                                                          */
*        /*   ARG IS A CATCI, TRANSLATION IS NECESSARY               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0813
*                    ELSE                                          0813
*                      DO;                                         0813
*                                                                  0813
         B     @RC00807                                            0813
@RF00807 DS    0H                                                  0814
*                        CALL RECIXL(IOCREL);                      0814
*                                                                  0814
         L     @07,IOCSPTR(,REG6)                                  0814
         LA    @07,IOCREL(,@07)                                    0814
         ST    @07,@AL00001                                        0814
         LA    @01,@AL00001                                        0814
         BAL   @14,RECIXL                                          0814
*        /************************************************************/
*        /*                                                          */
*        /*   TRANSLATION FAILED. SET SKIP PROCESSING FLAG ON        */
*        /*   THIS WILL CAUSE U-MACRO PROCESSING TO BE BYPASSED      */
*        /*   UNTIL THE ERROR IS CORRECTED. CLEAR RMB AND RAB GET    */
*        /*   UPDATE FLAGS.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0815
*                        IF RSRRC = RCXLERR                        0815
*                          THEN                                    0815
         CLC   RSRRC(4,REG6),@CF00175                              0815
         BNE   @RF00815                                            0815
*                            DO;                                   0816
*                              RSRSKPSW = ON;                      0817
         OI    RSRSKPSW(REG6),B'00010000'                          0817
*                              RMBGETU = OFF;                      0818
         L     @07,RSRMBP(,REG6)                                   0818
         NI    RMBGETU(@07),B'11111011'                            0818
*                              RABUPD = OFF;                       0819
         L     @07,RSRGRBPT(,REG6)                                 0819
         L     @07,GRABCURR(,@07)                                  0819
         NI    RABUPD(@07),B'10111111'                             0819
*                            END;                                  0820
*                                                                  0820
*        /************************************************************/
*        /*                                                          */
*        /*   TRANSLATION SUCCESSFUL.                                */
*        /*   IF REQUEST IS FOR GET UPDATE, SAVE THE ARGUMENT IN     */
*        /*   THE RMB.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0821
*                          ELSE                                    0821
*                            IF RMBGETU = ON                       0821
*                              THEN                                0821
         B     @RC00815                                            0821
@RF00815 L     @07,RSRMBP(,REG6)                                   0821
         TM    RMBGETU(@07),B'00000100'                            0821
         BNO   @RF00821                                            0821
*                                RMBARG = IOCREL;                  0822
         L     @04,IOCSPTR(,REG6)                                  0822
         L     @04,IOCREL(,@04)                                    0822
         ST    @04,RMBARG(,@07)                                    0822
*                      END;                                        0823
*                                                                  0823
*                  END;                                            0824
*        /************************************************************/
*        /*                                                          */
*        /*    FOR THE CATALOG OR CRA, THE ARGUMENT IS SET           */
*        /*    IN IOCRBA OR IOCKYA.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0825
*              ELSE                                                0825
*                                                                  0825
*        /************************************************************/
*        /*                                                          */
*        /*   FOR A CNV REQUEST, THE ARG IS SET IN IOCRBA            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0825
*                IF RSRKEY = OFF                                   0825
*                  THEN                                            0825
         B     @RC00805                                            0825
@RF00805 TM    RSRKEY(REG6),B'00010000'                            0825
         BNZ   @RF00825                                            0825
*                    DO;                                           0826
*                      IOCRBA = RABRCDA*CILEN;                     0827
         L     @07,IOCSPTR(,REG6)                                  0827
         L     @04,RSRGRBPT(,REG6)                                 0827
         L     @04,GRABCURR(,@04)                                  0827
         L     @04,RABRCDA(,@04)                                   0827
         LR    @15,@04                                             0827
         SLA   @15,9                                               0827
         ST    @15,IOCRBA(,@07)                                    0827
*                      IF RMBGETU = ON                             0828
*                        THEN                                      0828
         L     @07,RSRMBP(,REG6)                                   0828
         TM    RMBGETU(@07),B'00000100'                            0828
         BNO   @RF00828                                            0828
*                          RMBARG = RABRCDA;                       0829
         ST    @04,RMBARG(,@07)                                    0829
*                    END;                                          0830
*                                                                  0830
*        /************************************************************/
*        /*                                                          */
*        /*   FOR A KEYED GET OR POINT, THE ADDRESS OF THE ARG       */
*        /*   IS SET IN IOCKYA. THE ARGUMENT IS NOT REQUIRED         */
*        /*   FOR A KEYED PUT.                                       */
*        /*                                                          */
*        /************************************************************/
*                  ELSE                                            0831
*                                                                  0831
*                    IF RSRGET = ON  RSRPOS = ON                  0831
*                      THEN                                        0831
         B     @RC00825                                            0831
@RF00825 TM    RSRGET(REG6),B'10010000'                            0831
         BZ    @RF00831                                            0831
*                        DO;                                       0832
*                          IOCKYA = RABRCDA;                       0833
         L     @07,IOCSPTR(,REG6)                                  0833
         L     @04,RSRGRBPT(,REG6)                                 0833
         L     @04,GRABCURR(,@04)                                  0833
         L     @15,RABRCDA(,@04)                                   0833
         ST    @15,IOCKYA(,@07)                                    0833
*                          IF RMBGETU = ON                         0834
*                            THEN                                  0834
         L     @07,RSRMBP(,REG6)                                   0834
         TM    RMBGETU(@07),B'00000100'                            0834
         BNO   @RF00834                                            0834
*                              RMBKEYA = RECKEYA;                  0835
         MVC   RMBKEYA(44,@07),RECKEYA(@04)                        0835
*                        END;                                      0836
@RF00834 DS    0H                                                  0837
*        /************************************************************/
*        /*                                                          */
*        /* FOR A PUT INSERT REQUEST, THE RECORD WILL BE MOVED       */
*        /* TO A WORKAREA AND A UPUT WILL BE ISSUED                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0837
*        IF RSRADD = ON & RSRSKPSW = OFF                           0837
*          THEN                                                    0837
@RF00831 DS    0H                                                  0837
@RC00825 DS    0H                                                  0837
@RC00805 DS    0H                                                  0837
@RF00804 TM    RSRADD(REG6),B'01000000'                            0837
         BNO   @RF00837                                            0837
         TM    RSRSKPSW(REG6),B'00010000'                          0837
         BNZ   @RF00837                                            0837
*RECADD:     DO;                                                   0838
*                                                                  0838
RECADD   DS    0H                                                  0839
*        /************************************************************/
*        /*                                                          */
*        /*   SET RAB IN USE AND RAB UPDATE FLAGS OFF                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0839
*              RABINUSE = OFF;                                     0839
*              RABUPD = OFF;                                       0840
*                                                                  0840
         L     @07,RSRGRBPT(,REG6)                                 0840
         L     @07,GRABCURR(,@07)                                  0840
         NI    RABINUSE(@07),B'00111111'                           0840
*        /************************************************************/
*        /*                                                          */
*        /*   THE RECORD LENGTH MUST BE PLACED IN IOCDLN.            */
*        /*   LENGTH IS 505 FOR WORKFILE AND LKR OF CATALOG.         */
*        /*   LENGTH IS 47 FOR HKR OF CATALOG.                       */
*        /*   LENGTH IS 512 FOR CRA.                         @ZA18274*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0841
*              IF RSRWF = ON                                       0841
*                THEN                                              0841
         TM    RSRWF(REG6),B'10000000'                             0841
         BNO   @RF00841                                            0841
*                  IOCDLN = CELEN;                                 0842
         L     @07,IOCSPTR(,REG6)                                  0842
         MVC   IOCDLN(4,@07),@CF00738                              0842
*              IF RSRCAT = ON                                      0843
*                THEN                                      /*@ZA18274*/
@RF00841 TM    RSRCAT(REG6),B'01000000'                            0843
         BNO   @RF00843                                            0843
*                  IF RECHL < RECHLC                               0844
*                    THEN                                          0844
         L     @07,RSRGRBPT(,REG6)                                 0844
         L     @07,GRABCURR(,@07)                                  0844
         CLI   RECHL(@07),64                                       0844
         BNL   @RF00844                                            0844
*                      IOCDLN = CELEN;                             0845
         L     @07,IOCSPTR(,REG6)                                  0845
         MVC   IOCDLN(4,@07),@CF00738                              0845
*                    ELSE                                          0846
*                      IOCDLN = TNLEN;                             0846
         B     @RC00844                                            0846
@RF00844 L     @07,IOCSPTR(,REG6)                                  0846
         MVC   IOCDLN(4,@07),@CF00747                              0846
*              IF RSRCRA = ON                                      0847
*                THEN                                              0847
@RC00844 DS    0H                                                  0847
@RF00843 TM    RSRCRA(REG6),B'00100000'                            0847
         BNO   @RF00847                                            0847
*                  IOCDLN = CILEN;                         /*@ZA18274*/
*                                                                  0848
         L     @07,IOCSPTR(,REG6)                                  0848
         MVC   IOCDLN(4,@07),@CF00740                              0848
*        /************************************************************/
*        /*                                                          */
*        /*   MOVE THE USERS RECORD TO THE WORKAREA                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0849
*              IF IOCDLN < 257                                     0849
*                THEN                                              0849
@RF00847 L     @07,IOCSPTR(,REG6)                                  0849
         L     @04,IOCDLN(,@07)                                    0849
         C     @04,@CF03810                                        0849
         BNL   @RF00849                                            0849
*                  RECIORCD(1:IOCDLN) = RECRCD(1:IOCDLN);          0850
         L     @07,IOCDAD(,@07)                                    0850
         BCTR  @04,0                                               0850
         L     @01,RSRGRBPT(,REG6)                                 0850
         L     @01,GRABCURR(,@01)                                  0850
         EX    @04,@SM03984                                        0850
*                ELSE                                              0851
*                  DO;                                             0851
         B     @RC00849                                            0851
@RF00849 DS    0H                                                  0852
*                    RECIORCD(1:256) = RECRCD(1:256);              0852
         L     @07,IOCSPTR(,REG6)                                  0852
         L     @04,IOCDAD(,@07)                                    0852
         L     @01,RSRGRBPT(,REG6)                                 0852
         L     @15,GRABCURR(,@01)                                  0852
         MVC   RECIORCD(256,@04),RECRCD(@15)                       0852
*                    RECIORCD(257:IOCDLN) = RECRCD(257:IOCDLN);    0853
         L     @07,IOCDLN(,@07)                                    0853
         SL    @07,@CF03810                                        0853
         EX    @07,@SM03986                                        0853
*                  END;                                            0854
*                                                                  0854
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WORKFILE, MOVE THE USERS WORKFILE PROC AREA        */
*        /*   INTO THE WORKAREA                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0855
*              IF RSRWF = ON                                       0855
*                THEN                                              0855
@RC00849 TM    RSRWF(REG6),B'10000000'                             0855
         BNO   @RF00855                                            0855
*                  RECIORCD(34:43) = RECFFLG;                      0856
*                                                                  0856
         L     @07,IOCSPTR(,REG6)                                  0856
         L     @07,IOCDAD(,@07)                                    0856
         L     @04,RSRGRBPT(,REG6)                                 0856
         L     @04,GRABCURR(,@04)                                  0856
         MVC   RECIORCD+33(10,@07),RECFFLG(@04)                    0856
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE UPUT                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0857
*              CALL IDCIOPT0 (GDTTBL,IOCSPTR);                     0857
*                                                                  0857
@RF00855 ST    REG5,@AL00001                                       0857
         LA    @07,IOCSPTR(,REG6)                                  0857
         ST    @07,@AL00001+4                                      0857
         MVI   @AL00001+4,X'80'                                    0857
         L     @15,GDTPUT(,REG5)                                   0857
         LA    @01,@AL00001                                        0857
         BALR  @14,@15                                             0857
*              RESPECIFY RTNREG RSTD;                              0858
*              TESTRC = RTNREG;                                    0859
         STH   RTNREG,TESTRC(,REG6)                                0859
*              RESPECIFY RTNREG UNRSTD;                            0860
*                                                                  0860
*              RSRRC = TESTRC;                                     0861
*                                                                  0861
         LH    @07,TESTRC(,REG6)                                   0861
         ST    @07,RSRRC(,REG6)                                    0861
*            END RECADD;                                           0862
*        /************************************************************/
*        /*                                                          */
*        /* FOR A POSITION REQUEST, ISSUE UPOSIT                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0863
*        IF RSRPOS = ON & RSRSKPSW = OFF                           0863
*          THEN                                                    0863
@RF00837 TM    RSRPOS(REG6),B'00010000'                            0863
         BNO   @RF00863                                            0863
         TM    RSRSKPSW(REG6),B'00010000'                          0863
         BNZ   @RF00863                                            0863
*RECPOS:     DO;                                                   0864
*                                                                  0864
RECPOS   DS    0H                                                  0865
*        /************************************************************/
*        /*                                                          */
*        /*    FOR A KEYED REQUEST AGAINST THE CATALOG OR CRA,       */
*        /*    SET KEYLENGTH TO 44.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0865
*              IF RSRKEY = ON & RSRWF = OFF                        0865
*                THEN                                              0865
         TM    RSRKEY(REG6),B'00010000'                            0865
         BNO   @RF00865                                            0865
         TM    RSRWF(REG6),B'10000000'                             0865
         BNZ   @RF00865                                            0865
*                  IOCPTL = LENGTH(RSWFDSN);                       0866
*                                                                  0866
         L     @07,IOCSPTR(,REG6)                                  0866
         MVC   IOCPTL(2,@07),@CH00595                              0866
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE UPOSIT                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0867
*              CALL IDCIOPO0 (GDTTBL,IOCSPTR);                     0867
*                                                                  0867
@RF00865 ST    REG5,@AL00001                                       0867
         LA    @07,IOCSPTR(,REG6)                                  0867
         ST    @07,@AL00001+4                                      0867
         MVI   @AL00001+4,X'80'                                    0867
         L     @15,GDTPOS(,REG5)                                   0867
         LA    @01,@AL00001                                        0867
         BALR  @14,@15                                             0867
*              RESPECIFY RTNREG RSTD;                              0868
*              TESTRC = RTNREG;                                    0869
         STH   RTNREG,TESTRC(,REG6)                                0869
*              RESPECIFY RTNREG UNRSTD;                            0870
*                                                                  0870
*        /************************************************************/
*        /*                                                          */
*        /* IF POSITION WAS SUCCESSFUL, SET RSRRC TO 0               */
*        /* IF EOF ENCOUNTERED, SET RSRRC TO 16, OTHERWISE           */
*        /* SET RSRRC TO 4                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0871
*              IF TESTRC = 0                                       0871
*                THEN                                              0871
         SLR   @07,@07                                             0871
         LH    @04,TESTRC(,REG6)                                   0871
         CR    @04,@07                                             0871
         BNE   @RF00871                                            0871
*                  RSRRC = 0;                                      0872
         ST    @07,RSRRC(,REG6)                                    0872
*                ELSE                                              0873
*                  IF (RPLERREG = RCLOGERR & RPLERRCD = RPLEODER)  0873
*                    THEN                                          0873
         B     @RC00871                                            0873
@RF00871 L     @07,IOCSPTR(,REG6)                                  0873
         L     @07,IOCEXT(,@07)                                    0873
         L     @07,IOCRPL(,@07)                                    0873
         CLI   RPLERREG(@07),8                                     0873
         BNE   @RF00873                                            0873
         CLI   RPLERRCD(@07),4                                     0873
         BNE   @RF00873                                            0873
*                      RSRRC = RCEOF;                              0874
         MVC   RSRRC(4,REG6),@CF00471                              0874
*                    ELSE                                          0875
*                      RSRRC = RCIOERR;                            0875
*                                                                  0875
         B     @RC00873                                            0875
@RF00873 MVC   RSRRC(4,REG6),@CF00038                              0875
*            END RECPOS;                                           0876
@RC00873 DS    0H                                                  0876
@RC00871 DS    0H                                                  0877
*        /************************************************************/
*        /*                                                          */
*        /* FOR A GET REQUEST, ISSUE UGET AND RETURN RECORD          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0877
*        IF RSRGET = ON & RSRSKPSW = OFF                           0877
*          THEN                                                    0877
@RF00863 TM    RSRGET(REG6),B'10000000'                            0877
         BNO   @RF00877                                            0877
         TM    RSRSKPSW(REG6),B'00010000'                          0877
         BNZ   @RF00877                                            0877
*RECGET:     DO;                                                   0878
*                                                                  0878
RECGET   DS    0H                                                  0879
*              CALL IDCIOGT0 (GDTTBL,IOCSPTR);                     0879
*                                                                  0879
         ST    REG5,@AL00001                                       0879
         LA    @07,IOCSPTR(,REG6)                                  0879
         ST    @07,@AL00001+4                                      0879
         MVI   @AL00001+4,X'80'                                    0879
         L     @15,GDTGET(,REG5)                                   0879
         LA    @01,@AL00001                                        0879
         BALR  @14,@15                                             0879
*              RESPECIFY RTNREG RSTD;                              0880
*              TESTRC = RTNREG;                                    0881
         STH   RTNREG,TESTRC(,REG6)                                0881
*              RESPECIFY RTNREG UNRSTD;                            0882
*                                                                  0882
*              RSRRC = TESTRC;                                     0883
*                                                                  0883
         LH    @07,TESTRC(,REG6)                                   0883
         ST    @07,RSRRC(,REG6)                                    0883
*        /************************************************************/
*        /*                                                          */
*        /*   IF GET FAILED, CLEAR RAB AND RMB GET UPDATE FLAGS.     */
*        /*   IF EOF ENCOUNTERED, SET FOR REPROCESSING.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0884
*              IF RSRRC ^= 0                                       0884
*                THEN                                              0884
         LTR   @07,@07                                             0884
         BZ    @RF00884                                            0884
*                  DO;                                             0885
*                    RMBGETU = OFF;                                0886
         L     @04,RSRMBP(,REG6)                                   0886
         NI    RMBGETU(@04),B'11111011'                            0886
*                    RABUPD = OFF;                                 0887
         L     @04,RSRGRBPT(,REG6)                                 0887
         L     @04,GRABCURR(,@04)                                  0887
         NI    RABUPD(@04),B'10111111'                             0887
*                    IF RSRRC = RCEOF                              0888
*                      THEN                                        0888
         C     @07,@CF00471                                        0888
         BNE   @RF00888                                            0888
*                        IOCMACPA = ON;                            0889
         L     @07,IOCSPTR(,REG6)                                  0889
         OI    IOCMACPA(@07),B'00000100'                           0889
*                  END;                                            0890
*                                                                  0890
*        /************************************************************/
*        /*                                                          */
*        /*   GET SUCCESSFUL.                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0891
*                ELSE                                              0891
*RECGETOK:         DO;                                             0891
*                                                                  0891
         B     @RC00884                                            0891
@RF00884 DS    0H                                                  0891
RECGETOK DS    0H                                                  0892
*        /************************************************************/
*        /*                                                          */
*        /*   SET RAB IN USE FLAG ON                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0892
*                    RABINUSE = ON;                                0892
*                                                                  0892
         L     @07,RSRGRBPT(,REG6)                                 0892
         L     @07,GRABCURR(,@07)                                  0892
         OI    RABINUSE(@07),B'10000000'                           0892
*        /************************************************************/
*        /*                                                          */
*        /*   MOVE INPUT RECORD TO USERS BUFFER                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0893
*                    IF IOCDLN < 257                               0893
*                      THEN                                        0893
         L     @04,IOCSPTR(,REG6)                                  0893
         L     @15,IOCDLN(,@04)                                    0893
         C     @15,@CF03810                                        0893
         BNL   @RF00893                                            0893
*                        RECRCD(1:IOCDLN) = RECIORCD(1:IOCDLN);    0894
         BCTR  @15,0                                               0894
         L     @04,IOCDAD(,@04)                                    0894
         EX    @15,@SM03988                                        0894
*                      ELSE                                        0895
*                        DO;                                       0895
         B     @RC00893                                            0895
@RF00893 DS    0H                                                  0896
*                          RECRCD(1:256) = RECIORCD(1:256);        0896
         L     @07,RSRGRBPT(,REG6)                                 0896
         L     @07,GRABCURR(,@07)                                  0896
         L     @04,IOCSPTR(,REG6)                                  0896
         L     @15,IOCDAD(,@04)                                    0896
         MVC   RECRCD(256,@07),RECIORCD(@15)                       0896
*                          RECRCD(257:IOCDLN) = RECIORCD(257:IOCDLN);
         L     @04,IOCDLN(,@04)                                    0897
         SL    @04,@CF03810                                        0897
         EX    @04,@SM03990                                        0897
*                        END;                                      0898
*                                                                  0898
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WORKFILE, MOVE PROCESSING AREA TO USERS AREA       */
*        /*   AND CLEAR PROCESSING AREA IN RECORD BUFFER             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0899
*                    IF RSRWF = ON                                 0899
*                      THEN                                        0899
@RC00893 TM    RSRWF(REG6),B'10000000'                             0899
         BNO   @RF00899                                            0899
*                        DO;                                       0900
*                          RECFFLG = RECIORCD(34:43);              0901
         L     @07,RSRGRBPT(,REG6)                                 0901
         L     @07,GRABCURR(,@07)                                  0901
         L     @04,IOCSPTR(,REG6)                                  0901
         L     @04,IOCDAD(,@04)                                    0901
         MVC   RECFFLG(10,@07),RECIORCD+33(@04)                    0901
*                          RECRCD(34:43) = ''B;                    0902
         XC    RECRCD+33(10,@07),RECRCD+33(@07)                    0902
*                        END;                                      0903
*                                                                  0903
*        /************************************************************/
*        /*                                                          */
*        /*   FOR SEQUENTIAL REQUEST, RETURN ARGUMENT.               */
*        /*   IF GET UPD REQUEST, SAVE ARGUMENT IN RMB.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0904
*                    IF RSRDIR = OFF                               0904
*                      THEN                                        0904
*                                                                  0904
@RF00899 TM    RSRDIR(REG6),B'00000100'                            0904
         BNZ   @RF00904                                            0904
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WORKFILE, ARG IS IN IOCREL                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0905
*                        IF RSRWF = ON                             0905
*                          THEN                                    0905
         TM    RSRWF(REG6),B'10000000'                             0905
         BNO   @RF00905                                            0905
*                            DO;                                   0906
*                              RABRCDA = IOCREL;                   0907
         L     @07,RSRGRBPT(,REG6)                                 0907
         L     @07,GRABCURR(,@07)                                  0907
         L     @04,IOCSPTR(,REG6)                                  0907
         L     @04,IOCREL(,@04)                                    0907
         ST    @04,RABRCDA(,@07)                                   0907
*                              IF RMBGETU = ON                     0908
*                                THEN                              0908
         L     @07,RSRMBP(,REG6)                                   0908
         TM    RMBGETU(@07),B'00000100'                            0908
         BNO   @RF00908                                            0908
*                                  RMBARG = IOCREL;                0909
         ST    @04,RMBARG(,@07)                                    0909
*                              RABRRN = ON;                        0910
@RF00908 L     @07,RSRGRBPT(,REG6)                                 0910
         L     @07,GRABCURR(,@07)                                  0910
         OI    RABRRN(@07),B'00010000'                             0910
*                            END;                                  0911
*                                                                  0911
*        /************************************************************/
*        /*                                                          */
*        /*    FOR CATALOG OR CRA CNV REQUEST, ARGUMENT IS IN        */
*        /*    IOCRBA. ARGUMENT IS NOT RETURNED FOR KEYED REQUEST.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0912
*                          ELSE                                    0912
*                                                                  0912
*        /************************************************************/
*        /*                                                          */
*        /*   FOR CNV, ARG IS IN IOCRBA                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0912
*                            IF RSRKEY = OFF                       0912
*                              THEN                                0912
         B     @RC00905                                            0912
@RF00905 TM    RSRKEY(REG6),B'00010000'                            0912
         BNZ   @RF00912                                            0912
*                                DO;                               0913
*                                  RABRCDA = IOCRBA/CILEN;         0914
         L     @07,RSRGRBPT(,REG6)                                 0914
         L     @07,GRABCURR(,@07)                                  0914
         L     @04,IOCSPTR(,REG6)                                  0914
         L     @00,IOCRBA(,@04)                                    0914
         SRDA  @00,32                                              0914
         D     @00,@CF00740                                        0914
         ST    @01,RABRCDA(,@07)                                   0914
*                                  IF RMBGETU = ON                 0915
*                                    THEN                          0915
         L     @07,RSRMBP(,REG6)                                   0915
         TM    RMBGETU(@07),B'00000100'                            0915
         BNO   @RF00915                                            0915
*                                      RMBARG = RABRCDA;           0916
         ST    @01,RMBARG(,@07)                                    0916
*                               END;                               0917
*                                                                  0917
@RF00915 DS    0H                                                  0918
*                  END RECGETOK;                                   0918
*                                                                  0918
@RF00912 DS    0H                                                  0918
@RC00905 DS    0H                                                  0918
@RF00904 DS    0H                                                  0919
*             END RECGET;                                          0919
*                                                                  0919
@RC00884 DS    0H                                                  0920
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESSING COMPLETED. SET SKIP PROCESSING FLAG OFF      */
*        /*  AND RETURN.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0920
*        RSRSKPSW = OFF;                                           0920
*                                                                  0920
@RF00877 NI    RSRSKPSW(REG6),B'11101111'                          0920
*      GENERATE;                                                   0921
         B     NAME0038+8  BR AROUND NAME
         DS    0F
NAME0038 DC    CL8'RMBNUPIK'
*RMBNUPIK: PROCEDURE                                               0922
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0922
*                                                                  0922
         B     @PB00011                                            0922
RMBNUPIK DS    0H                                                  0923
*      GENERATE REFS(RS06RG08, REG6);                              0923
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0038  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* DETERMINE WHICH RMB TO USE FOR THIS REQUEST                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0924
*        /************************************************************/
*        /*                                                          */
*        /* FOR CRA, THERE IS ONLY ONE RMB. SET RSRMBP TO IT.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0924
*        IF RSRCRA = ON                                            0924
*          THEN                                                    0924
         TM    RSRCRA(REG6),B'00100000'                            0924
         BNO   @RF00924                                            0924
*            RSRMBP = ADDR(CRARMB);                                0925
*                                                                  0925
         L     @07,RSIOTBL(,REG6)                                  0925
         LA    @07,CRARMB(,@07)                                    0925
         ST    @07,RSRMBP(,REG6)                                   0925
*        /************************************************************/
*        /*                                                          */
*        /* FOR CATALOG, IF THE REQUEST IS FOR KEYED PROCESSING,     */
*        /* USE THE HIGH KEY RANGE RMB. IF THE REQUEST IS FOR        */
*        /* CNV PROCESSING, USE THE LOW KEY RANGE RMB                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0926
*        IF RSRCAT = ON                                            0926
*          THEN                                                    0926
*                                                                  0926
@RF00924 TM    RSRCAT(REG6),B'01000000'                            0926
         BNO   @RF00926                                            0926
*        /************************************************************/
*        /*                                                          */
*        /*    KEYED REQUEST.                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0927
*            IF RSRKEY = ON                                        0927
*              THEN                                                0927
         TM    RSRKEY(REG6),B'00010000'                            0927
         BNO   @RF00927                                            0927
*                DO;                                               0928
*                  RSRMBP = ADDR(CATHRMB);                         0929
*                                                                  0929
         L     @07,RSIOTBL(,REG6)                                  0929
         LA    @07,CATHRMB(,@07)                                   0929
         ST    @07,RSRMBP(,REG6)                                   0929
*        /************************************************************/
*        /*                                                          */
*        /*   THE HIGH KEY RANGE RPL MUST BE SET FOR                 */
*        /*   SEARCH KEY EQUAL PROCESSING                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0930
*                  IF RMBKEQ = OFF                                 0930
*                    THEN                                          0930
         TM    RMBKEQ(@07),B'00001000'                             0930
         BNZ   @RF00930                                            0930
*                      DO;                                         0931
*                        IOCCHPKE = ON;                            0932
         L     @04,IOCSPTR(,REG6)                                  0932
         OI    IOCCHPKE(@04),B'10000000'                           0932
*                        RMBKEQ = ON;                              0933
         OI    RMBKEQ(@07),B'00001000'                             0933
*                      END;                                        0934
*                END;                                              0935
*                                                                  0935
*        /************************************************************/
*        /*                                                          */
*        /*    CONTROL INTERVAL REQUEST.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0936
*              ELSE                                                0936
*                RSRMBP = ADDR(CATLRMB);                           0936
*                                                                  0936
         B     @RC00927                                            0936
@RF00927 L     @07,RSIOTBL(,REG6)                                  0936
         LA    @07,CATLRMB(,@07)                                   0936
         ST    @07,RSRMBP(,REG6)                                   0936
*        /************************************************************/
*        /*                                                          */
*        /* FOR WORKFILE, IF THE REQUEST IS FOR SEQ PROCESSING,      */
*        /* USE THE SEQ RMB                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0937
*                                                                  0937
*        IF RSRWF = ON & RSRDIR = OFF                              0937
*          THEN                                                    0937
@RC00927 DS    0H                                                  0937
@RF00926 TM    RSRWF(REG6),B'10000000'                             0937
         BNO   @RF00937                                            0937
         TM    RSRDIR(REG6),B'00000100'                            0937
         BNZ   @RF00937                                            0937
*            RSRMBP = ADDR(WFSRMB);                                0938
*                                                                  0938
         L     @07,RSIOTBL(,REG6)                                  0938
         LA    @07,WFSRMB(,@07)                                    0938
         ST    @07,RSRMBP(,REG6)                                   0938
*        /************************************************************/
*        /*                                                          */
*        /*  FOR WORKFILE DIRECT REQUEST, AVOID USING AN RMB WHICH   */
*        /*  IS BEING HELD AS A RESULT OF A GET UPDATE OPERATION.    */
*        /*  IF AN RMB IS FOUND WHICH WAS NOT USED FOR GET UPDATE,   */
*        /*  USE IT FOR THIS REQUEST. IF ALL RMBS WERE USED FOR      */
*        /*  GET UPDATE, USE THE LAST RMB USED FOR GET UPDATE AGAIN. */
*        /*  SET THE RMB CHOSEN AS THE LAST USED. IF THIS REQUEST    */
*        /*  IS FOR GET UPDATE, SET THE RMB CHOSEN AS LAST USED FOR  */
*        /*  GET UPDATE.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0939
*        IF RSRWF = ON & RSRDIR = ON                               0939
*          THEN                                                    0939
@RF00937 TM    RSRWF(REG6),B'10000100'                             0939
         BNO   @RF00939                                            0939
*            DO;                                                   0940
*                                                                  0940
*              RSRU = 0;                                           0941
*                                                                  0941
         MVI   RSRU(REG6),X'00'                                    0941
*        /************************************************************/
*        /*                                                          */
*        /*    IF LAST USED RMB WAS NOT USED FOR GET UPDATE,         */
*        /*    THEN USE IT FOR THIS REQUEST.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0942
*              IF RSRLU ^= 0                                       0942
*                THEN                                              0942
         CLI   RSRLU(REG6),0                                       0942
         BE    @RF00942                                            0942
*                  DO;                                             0943
*                    RSRMBP = ADDR(WFDRMB(RSRLU));                 0944
         SLR   @07,@07                                             0944
         IC    @07,RSRLU(,REG6)                                    0944
         LR    @04,@07                                             0944
         MH    @04,@CH00032                                        0944
         L     @01,RSIOTBL(,REG6)                                  0944
         LA    @04,WFDRMB-12(@04,@01)                              0944
         ST    @04,RSRMBP(,REG6)                                   0944
*                    IF RMBGETU = OFF                              0945
*                      THEN                                        0945
         TM    RMBGETU(@04),B'00000100'                            0945
         BNZ   @RF00945                                            0945
*                        RSRU = RSRLU;                             0946
         STC   @07,RSRU(,REG6)                                     0946
*                  END;                                            0947
*                                                                  0947
@RF00945 DS    0H                                                  0948
*        /************************************************************/
*        /*                                                          */
*        /*    CANNOT USE LAST USED RMB. CHECK ALL RMBS. USE THE     */
*        /*    FIRST ONE FOUND WHICH WAS NOT USED FOR GET UPDATE.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0948
*RECLP7:       DO RSRI = 1 TO RSRWFRN - 1 WHILE(RSRU = 0);         0948
*                                                                  0948
@RF00942 DS    0H                                                  0948
RECLP7   LA    @07,1                                               0948
         B     @DE00948                                            0948
@DL00948 CLI   RSRU(REG6),0                                        0948
         BNE   @DC00948                                            0948
*                IF RSRI ^= RSRLU                                  0949
*                  THEN                                            0949
         CLC   RSRI(1,REG6),RSRLU(REG6)                            0949
         BE    @RF00949                                            0949
*                    DO;                                           0950
*                      RSRMBP = ADDR(WFDRMB(RSRI));                0951
         SLR   @07,@07                                             0951
         IC    @07,RSRI(,REG6)                                     0951
         LR    @04,@07                                             0951
         MH    @04,@CH00032                                        0951
         L     @01,RSIOTBL(,REG6)                                  0951
         LA    @04,WFDRMB-12(@04,@01)                              0951
         ST    @04,RSRMBP(,REG6)                                   0951
*                      IF RMBGETU = OFF                            0952
*                        THEN                                      0952
         TM    RMBGETU(@04),B'00000100'                            0952
         BNZ   @RF00952                                            0952
*                          RSRU = RSRI;                            0953
         STC   @07,RSRU(,REG6)                                     0953
*                    END;                                          0954
*                                                                  0954
@RF00952 DS    0H                                                  0955
*              END RECLP7;                                         0955
*                                                                  0955
@RF00949 LA    @07,1                                               0955
         SLR   @04,@04                                             0955
         IC    @04,RSRI(,REG6)                                     0955
         ALR   @07,@04                                             0955
@DE00948 STC   @07,RSRI(,REG6)                                     0955
         LH    @04,RSRWFRN(,REG6)                                  0955
         BCTR  @04,0                                               0955
         CR    @07,@04                                             0955
         BNH   @DL00948                                            0955
@DC00948 DS    0H                                                  0956
*        /************************************************************/
*        /*                                                          */
*        /*    ALL RMBS WERE USED FOR GET UPDATE. USE THE LAST       */
*        /*    RMB USED FOR GET UPDATE AGAIN.                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0956
*              IF RSRU = 0                                         0956
*                THEN                                              0956
         CLI   RSRU(REG6),0                                        0956
         BNE   @RF00956                                            0956
*                  DO;                                             0957
*                    RSRU = RSRLG;                                 0958
         SLR   @07,@07                                             0958
         IC    @07,RSRLG(,REG6)                                    0958
         STC   @07,RSRU(,REG6)                                     0958
*                    RSRMBP = ADDR(WFDRMB(RSRU));                  0959
         MH    @07,@CH00032                                        0959
         L     @04,RSIOTBL(,REG6)                                  0959
         LA    @07,WFDRMB-12(@07,@04)                              0959
         ST    @07,RSRMBP(,REG6)                                   0959
*                  END;                                            0960
*                                                                  0960
*        /************************************************************/
*        /*                                                          */
*        /*   SET LAST USED INDEX FOR THIS RMB                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0961
*              RSRLU = RSRU;                                       0961
*                                                                  0961
@RF00956 IC    @07,RSRU(,REG6)                                     0961
         STC   @07,RSRLU(,REG6)                                    0961
*            END;                                                  0962
*                                                                  0962
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS A GET UPD REQUEST, SET THE RAB AND RMB        */
*        /* GET UPDATE FLAGS. IF THIS IS A DIR WORKFILE              */
*        /* REQUEST, SET LAST GET UPD INDEX FOR THIS RMB             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0963
*        IF RSRGET = ON & RSRUPD = ON                              0963
*          THEN                                                    0963
@RF00939 TM    RSRGET(REG6),B'10000000'                            0963
         BNO   @RF00963                                            0963
         TM    RSRUPD(REG6),B'00001000'                            0963
         BNO   @RF00963                                            0963
*            DO;                                                   0964
*              RMBGETU = ON;                                       0965
         L     @07,RSRMBP(,REG6)                                   0965
         OI    RMBGETU(@07),B'00000100'                            0965
*              RABUPD = ON;                                        0966
         L     @07,RSRGRBPT(,REG6)                                 0966
         L     @07,GRABCURR(,@07)                                  0966
         OI    RABUPD(@07),B'01000000'                             0966
*              IF RSRWF = ON & RSRDIR = ON                         0967
*                THEN                                              0967
         TM    RSRWF(REG6),B'10000100'                             0967
         BNO   @RF00967                                            0967
*                  RSRLG = RSRU;                                   0968
         IC    @07,RSRU(,REG6)                                     0968
         STC   @07,RSRLG(,REG6)                                    0968
*            END;                                                  0969
*                                                                  0969
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS NOT A GET UPDATE REQUEST, SET THE GET UPDATE  */
*        /* FLAGS OFF IN THE RAB AND RMB.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0970
*          ELSE                                                    0970
*            DO;                                                   0970
         B     @RC00963                                            0970
@RF00963 DS    0H                                                  0971
*              RMBGETU = OFF;                                      0971
         L     @07,RSRMBP(,REG6)                                   0971
         NI    RMBGETU(@07),B'11111011'                            0971
*              RABUPD = OFF;                                       0972
         L     @07,RSRGRBPT(,REG6)                                 0972
         L     @07,GRABCURR(,@07)                                  0972
         NI    RABUPD(@07),B'10111111'                             0972
*            END;                                                  0973
*                                                                  0973
*        /************************************************************/
*        /*                                                          */
*        /* SET ADDRESS OF RPL FROM RMB                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0974
*        IOCRPL = RMBRPL;                                          0974
*                                                                  0974
@RC00963 L     @07,IOCSPTR(,REG6)                                  0974
         L     @07,IOCEXT(,@07)                                    0974
         L     @04,RSRMBP(,REG6)                                   0974
         L     @04,RMBRPL(,@04)                                    0974
         ST    @04,IOCRPL(,@07)                                    0974
*        /************************************************************/
*        /*                                                          */
*        /* IF REQUEST IS NOT POSITION,                              */
*        /* MATCH THE REQUEST OPTIONS AGAINST THE CURRENT            */
*        /* OPTIONS IN THE RPL AND IOCSTR. CHANGE THE                */
*        /* RPL AND IOCSTR TO REFLECT THE REQUEST OPTIONS.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0975
*        IF RSRPOS = OFF                                           0975
*          THEN                                                    0975
         TM    RSRPOS(REG6),B'00010000'                            0975
         BNZ   @RF00975                                            0975
*RECOPTS:    DO;                                                   0976
*                                                                  0976
RECOPTS  DS    0H                                                  0977
*        /************************************************************/
*        /*                                                          */
*        /*  KEYED REQUEST.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0977
*              IF RSRKEY = ON                                      0977
*                THEN                                              0977
*                                                                  0977
         TM    RSRKEY(REG6),B'00010000'                            0977
         BNO   @RF00977                                            0977
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR KEYED. SET IOCSTR FOR KEYED.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0978
*                  IF RMBKEY = ON                                  0978
*                    THEN                                          0978
         L     @07,RSRMBP(,REG6)                                   0978
         TM    RMBKEY(@07),B'00010000'                             0978
         BNO   @RF00978                                            0978
*                      IOCMACBK = OFF;                             0979
*                                                                  0979
         L     @07,IOCSPTR(,REG6)                                  0979
         NI    IOCMACBK(@07),B'11110111'                           0979
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR CONTROL INTERVAL. SET RMB FOR KEYED.   */
*        /*    SET IOCSTR CHANGE TO KEYED PROCESSING FLAG.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0980
*                    ELSE                                          0980
*                      DO;                                         0980
         B     @RC00978                                            0980
@RF00978 DS    0H                                                  0981
*                        IOCCHPKS = ON;                            0981
         L     @07,IOCSPTR(,REG6)                                  0981
         OI    IOCCHPKS(@07),B'00010000'                           0981
*                        RMBKEY = ON;                              0982
         L     @07,RSRMBP(,REG6)                                   0982
         OI    RMBKEY(@07),B'00010000'                             0982
*                      END;                                        0983
*                                                                  0983
*        /************************************************************/
*        /*                                                          */
*        /*    CONTROL INTERVAL REQUEST. SET IOCSTR FOR CONTROL      */
*        /*    INTERVAL.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0984
*                ELSE                                              0984
*                  IOCMACBK = ON;                                  0984
*                                                                  0984
         B     @RC00977                                            0984
@RF00977 L     @07,IOCSPTR(,REG6)                                  0984
         OI    IOCMACBK(@07),B'00001000'                           0984
*        /************************************************************/
*        /*                                                          */
*        /*  UPDATE REQUEST.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0985
*              IF RSRUPD = ON                                      0985
*                THEN                                              0985
*                                                                  0985
@RC00977 TM    RSRUPD(REG6),B'00001000'                            0985
         BNO   @RF00985                                            0985
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR NO UPDATE. SET RMB FOR UPDATE.         */
*        /*    SET IOCSTR CHANGE TO UPDATE PROCESSING FLAG.          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0986
*                  IF RMBUPD = OFF                                 0986
*                    THEN                                          0986
         L     @07,RSRMBP(,REG6)                                   0986
         TM    RMBUPD(@07),B'00100000'                             0986
         BNZ   @RF00986                                            0986
*                      DO;                                         0987
*                        IOCCHPUP = ON;                            0988
         L     @04,IOCSPTR(,REG6)                                  0988
         OI    IOCCHPUP(@04),B'00000010'                           0988
*                        RMBUPD = ON;                              0989
         OI    RMBUPD(@07),B'00100000'                             0989
*                      END;                                        0990
*                    ELSE;                                         0991
*                                                                  0991
@RF00986 DS    0H                                                  0992
*        /************************************************************/
*        /*                                                          */
*        /*  NO UPDATE REQUEST.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0992
*                ELSE                                              0992
*                                                                  0992
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR UPDATE. SET RMB FOR NO UPDATE.         */
*        /*    SET IOCSTR CHANGE TO NO UPDATE FLAG.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0992
*                  IF RMBUPD = ON                                  0992
*                    THEN                                          0992
         B     @RC00985                                            0992
@RF00985 L     @07,RSRMBP(,REG6)                                   0992
         TM    RMBUPD(@07),B'00100000'                             0992
         BNO   @RF00992                                            0992
*                      DO;                                         0993
*                        IOCCHPNU = ON;                            0994
         L     @04,IOCSPTR(,REG6)                                  0994
         OI    IOCCHPNU(@04),B'00000001'                           0994
*                        RMBUPD = OFF;                             0995
         NI    RMBUPD(@07),B'11011111'                             0995
*                      END;                                        0996
*                                                                  0996
*        /************************************************************/
*        /*                                                          */
*        /*  DIRECT REQUEST.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0997
*              IF RSRDIR = ON                                      0997
*                THEN                                              0997
*                                                                  0997
@RF00992 DS    0H                                                  0997
@RC00985 TM    RSRDIR(REG6),B'00000100'                            0997
         BNO   @RF00997                                            0997
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR DIRECT. SET IOCSTR FOR DIRECT.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0998
*                  IF RMBDIR = ON                                  0998
*                    THEN                                          0998
         L     @07,RSRMBP(,REG6)                                   0998
         TM    RMBDIR(@07),B'01000000'                             0998
         BNO   @RF00998                                            0998
*                      DO;                                         0999
*                        IOCMACSK = OFF;                           1000
         L     @07,IOCSPTR(,REG6)                                  1000
         NI    IOCMACSK(@07),B'01111111'                           1000
*                        IOCMACDR = ON;                            1001
         OI    IOCMACDR(@07),B'00000100'                           1001
*                      END;                                        1002
*                                                                  1002
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR SEQUENTIAL. SET RMB FOR DIRECT.        */
*        /*    SET IOCSTR CHANGE TO DIRECT PROCESSING FLAG.          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1003
*                    ELSE                                          1003
*                      DO;                                         1003
         B     @RC00998                                            1003
@RF00998 DS    0H                                                  1004
*                        IOCCHPDR = ON;                            1004
         L     @07,IOCSPTR(,REG6)                                  1004
         OI    IOCCHPDR(@07),B'01000000'                           1004
*                        RMBDIR = ON;                              1005
*                        RMBSEQ = OFF;                             1006
         L     @07,RSRMBP(,REG6)                                   1006
         OI    RMBDIR(@07),B'01000000'                             1006
         NI    RMBSEQ(@07),B'01111111'                             1006
*                      END;                                        1007
*                                                                  1007
*        /************************************************************/
*        /*                                                          */
*        /*  SEQUENTIAL REQUEST.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1008
*              IF RSRDIR = OFF                                     1008
*                THEN                                              1008
*                                                                  1008
@RC00998 DS    0H                                                  1008
@RF00997 TM    RSRDIR(REG6),B'00000100'                            1008
         BNZ   @RF01008                                            1008
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR SEQUENTIAL. SET IOCSTR FOR SEQUENTIAL. */
*        /*                                                          */
*        /************************************************************/
*                                                                  1009
*                  IF RMBSEQ = ON                                  1009
*                    THEN                                          1009
         L     @07,RSRMBP(,REG6)                                   1009
         TM    RMBSEQ(@07),B'10000000'                             1009
         BNO   @RF01009                                            1009
*                      DO;                                         1010
*                        IOCMACSK = OFF;                           1011
         L     @07,IOCSPTR(,REG6)                                  1011
         NI    IOCMACSK(@07),B'01111111'                           1011
*                        IOCMACDR = OFF;                           1012
         NI    IOCMACDR(@07),B'11111011'                           1012
*                      END;                                        1013
*                                                                  1013
*        /************************************************************/
*        /*                                                          */
*        /*    RMB IS SET FOR DIRECT. SET RMB FOR SEQUENTIAL.        */
*        /*    SET IOCSTR CHANGE TO SEQUENTIAL PROCESSING FLAG.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1014
*                    ELSE                                          1014
*                      DO;                                         1014
         B     @RC01009                                            1014
@RF01009 DS    0H                                                  1015
*                        IOCCHPSQ = ON;                            1015
         L     @07,IOCSPTR(,REG6)                                  1015
         OI    IOCCHPSQ(@07),B'10000000'                           1015
*                        RMBDIR = OFF;                             1016
*                        RMBSEQ = ON;                              1017
         L     @07,RSRMBP(,REG6)                                   1017
         OI    RMBSEQ(@07),B'10000000'                             1017
         NI    RMBDIR(@07),B'10111111'                             1017
*                      END;                                        1018
*                                                                  1018
*            END RECOPTS;                                          1019
*                                                                  1019
@RC01009 DS    0H                                                  1019
@RF01008 DS    0H                                                  1020
*  CALL EXIT;  /*TERMINATE*/                                       1020
@RF00975 BAL   @14,EXIT                                            1020
*  END RMBNUPIK; /*END OF PROCEDURE*/                              1021
*                                                                  1021
@EL00011 DS    0H                                                  1021
@EF00011 DS    0H                                                  1021
@ER00011 BR    @14                                                 1021
@PB00011 DS    0H                                                  1022
*  CALL EXIT;  /*TERMINATE*/                                       1022
         BAL   @14,EXIT                                            1022
*  END RECMGAP; /*END OF PROCEDURE*/                               1023
@EL00010 DS    0H                                                  1023
@EF00010 DS    0H                                                  1023
@ER00010 BR    @14                                                 1023
@PB00010 DS    0H                                                  1024
*      GENERATE;                                                   1024
         B     NAME0041+8  BR AROUND NAME
         DS    0F
NAME0041 DC    CL8'RECMUD'
*RECMUD: PROCEDURE                                                 1025
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1025
*                                                                  1025
         B     @PB00012                                            1025
RECMUD   DS    0H                                                  1026
*      GENERATE REFS(RS06RG08, REG6);                              1026
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0041  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* PUT UPDATE, ERASE OR FREE CBS PROCESSING                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1027
*        /************************************************************/
*        /*                                                          */
*        /* IF REQUEST IS TO UPDATE CI 0 FOR CATALOG OR A CRA,       */
*        /* CALL CKERR TO TERMINATE.                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1027
*        IF (RSRDEL = ON  RSRUPDT = ON) & RABRCDA = DATACI        1027
*          THEN                                                    1027
*                                                                  1027
*                                                                  1027
         TM    RSRDEL(REG6),B'00101000'                            1027
         BZ    @RF01027                                            1027
         L     @07,RSRGRBPT(,REG6)                                 1027
         L     @07,GRABCURR(,@07)                                  1027
         L     @07,RABRCDA(,@07)                                   1027
         LTR   @07,@07                                             1027
         BNZ   @RF01027                                            1027
*            DO;                                                   1028
*            /*CALL CKERR*/                                        1029
*              RSCKERR = RSCKERR && RSCKERR;                       1029
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1029
*              RSCKERN = RSE100;                                   1030
         MVC   RSCKERN(2,REG6),@CH00143                            1030
*              RSCKTERM = 'TERM';                                  1031
*                                                                  1031
         MVC   RSCKTERM(4,REG6),@CC03827                           1031
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1032
         L     @15,@CV03452                                        1032
         BALR  @14,@15                                             1032
*            END;                                                  1033
*                                                                  1033
*        /************************************************************/
*        /*                                                          */
*        /* SET RAB IN USE AND RAB UPDATE FLAGS OFF                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1034
*        RABINUSE = OFF;                                           1034
@RF01027 DS    0H                                                  1035
*        RABUPD = OFF;                                             1035
*                                                                  1035
         L     @07,RSRGRBPT(,REG6)                                 1035
         L     @07,GRABCURR(,@07)                                  1035
         NI    RABINUSE(@07),B'00111111'                           1035
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF THE SPECIFIED ARGUMENT WAS THE OBJECT       */
*        /* OF A GET UPDATE WHOSE RMB HAS NOT BEEN ALTERED           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1036
*        CALL RMBUPPIK;                                            1036
*                                                                  1036
         BAL   @14,RMBUPPIK                                        1036
*        RESPECIFY RTNREG RSTD;                                    1037
*        TESTRC = RTNREG;                                          1038
         STH   RTNREG,TESTRC(,REG6)                                1038
*        RESPECIFY RTNREG UNRSTD;                                  1039
*                                                                  1039
*        /************************************************************/
*        /*                                                          */
*        /*   FREERCD REQUESTED. IF ARGUMENT WAS FOUND, ISSUE        */
*        /*   UPUT - ENDREQ. SET SKIP PROCESSING FLAG TO             */
*        /*   CAUSE ALL REMAINING CODE IN THIS PROC TO BE BYPASSED   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1040
*        IF RSRFREE = ON                                           1040
*          THEN                                                    1040
         TM    RSRFREE(REG6),B'00000001'                           1040
         BNO   @RF01040                                            1040
*            DO;                                                   1041
*              IF TESTRC = 0                                       1042
*                THEN                                              1042
         LH    @07,TESTRC(,REG6)                                   1042
         LTR   @07,@07                                             1042
         BNZ   @RF01042                                            1042
*                  DO;                                             1043
*                    IOCMACEN = ON;                                1044
*                                                                  1044
         L     @07,IOCSPTR(,REG6)                                  1044
         OI    IOCMACEN(@07),B'00001000'                           1044
*                    CALL IDCIOPT0 (GDTTBL,IOCSPTR);               1045
*                                                                  1045
         ST    REG5,@AL00001                                       1045
         LA    @07,IOCSPTR(,REG6)                                  1045
         ST    @07,@AL00001+4                                      1045
         MVI   @AL00001+4,X'80'                                    1045
         L     @15,GDTPUT(,REG5)                                   1045
         LA    @01,@AL00001                                        1045
         BALR  @14,@15                                             1045
*                  END;                                            1046
*              RSRRC = 0;                                          1047
@RF01042 SLR   @07,@07                                             1047
         ST    @07,RSRRC(,REG6)                                    1047
*              RSRSKPSW = ON;                                      1048
         OI    RSRSKPSW(REG6),B'00010000'                          1048
*            END;                                                  1049
*                                                                  1049
*        /************************************************************/
*        /*                                                          */
*        /*   IF TRANSLATE FAILED, SET SKIP PROCESSING FLAG TO       */
*        /*   CAUSE ALL REMAINING CODE IN THIS PROC TO BE BYPASSED   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1050
*        IF TESTRC = RCXLERR                                       1050
*          THEN                                                    1050
@RF01040 CLC   TESTRC(2,REG6),@CH00175                             1050
         BNE   @RF01050                                            1050
*            RSRSKPSW = ON;                                        1051
*                                                                  1051
         OI    RSRSKPSW(REG6),B'00010000'                          1051
*        /************************************************************/
*        /*                                                          */
*        /*   IF THE ARGUMENT WAS NOT FOUND IN ANY OF THE RMBS,      */
*        /*   THEN A GET UPDATE MUST FIRST BE DONE FOR THE RECORD    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1052
*        IF TESTRC ^= 0 & RSRSKPSW = OFF                           1052
*          THEN                                                    1052
@RF01050 LH    @07,TESTRC(,REG6)                                   1052
         LTR   @07,@07                                             1052
         BZ    @RF01052                                            1052
         TM    RSRSKPSW(REG6),B'00010000'                          1052
         BNZ   @RF01052                                            1052
*RECUGET:    DO;                                                   1053
*                                                                  1053
RECUGET  DS    0H                                                  1054
*        /************************************************************/
*        /*                                                          */
*        /*   SAVE THE USERS RECORD                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1054
*              RECPTRCD(1:256) = RECRCD(1:256);                    1054
         L     @07,RSIOTBL(,REG6)                                  1054
         L     @04,RSRGRBPT(,REG6)                                 1054
         L     @04,GRABCURR(,@04)                                  1054
         MVC   RECPTRCD(256,@07),RECRCD(@04)                       1054
*              RECPTRCD(257:CELEN) = RECRCD(257:CELEN);            1055
*                                                                  1055
         MVC   RECPTRCD+256(249,@07),RECRCD+256(@04)               1055
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WORKFILE, SAVE THE USERS FLAG FIELD                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1056
*                                                                  1056
*              IF RSRWF = ON                                       1056
*                THEN                                              1056
         TM    RSRWF(REG6),B'10000000'                             1056
         BNO   @RF01056                                            1056
*                  RSRSVFLG = RECFFLG;                             1057
*                                                                  1057
         MVC   RSRSVFLG(10,REG6),RECFFLG(@04)                      1057
*        /************************************************************/
*        /*                                                          */
*        /*   ISSUE GET UPD REQUEST FOR THE RECORD WITH              */
*        /*   THE SPECIFIED ARGUMENT.                                */
*        /*   IF THE REQUEST IS FOR CNV, THE RDF,CIDF WILL BE        */
*        /*   RETRIEVED.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1058
*              RSRGET = ON;                                        1058
*                                                                  1058
@RF01056 OI    RSRGET(REG6),B'10000000'                            1058
*              CALL RECMGAP;                                       1059
*                                                                  1059
         BAL   @14,RECMGAP                                         1059
*              RSRGET = OFF;                                       1060
*                                                                  1060
         NI    RSRGET(REG6),B'01111111'                            1060
*        /************************************************************/
*        /*                                                          */
*        /*   RESTORE USER'S RECORD                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1061
*              RECRCD(1:256) = RECPTRCD(1:256);                    1061
         L     @07,RSRGRBPT(,REG6)                                 1061
         L     @07,GRABCURR(,@07)                                  1061
         L     @04,RSIOTBL(,REG6)                                  1061
         MVC   RECRCD(256,@07),RECPTRCD(@04)                       1061
*              RECRCD(257:CELEN) = RECPTRCD(257:CELEN);            1062
*                                                                  1062
         MVC   RECRCD+256(249,@07),RECPTRCD+256(@04)               1062
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WF, RESTORE USER'S PROCESSING AREA                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1063
*              IF RSRWF = ON                                       1063
*                THEN                                              1063
         TM    RSRWF(REG6),B'10000000'                             1063
         BNO   @RF01063                                            1063
*                  RECFFLG = RSRSVFLG;                             1064
*                                                                  1064
         MVC   RECFFLG(10,@07),RSRSVFLG(REG6)                      1064
*        /************************************************************/
*        /*                                                          */
*        /*   IF THE GET WAS SUCCESSFUL, CONTINUE WITH UPDRCD.       */
*        /*   IF A NO RECORD FOUND ERROR WAS ENCOUNTERED ON THE      */
*        /*   GETRCD, THEN IF THE SET NRF FLAG WAS SET, SET          */
*        /*   THE NRF FLAG IN THE RAB, AND IF THE ADD ON NRF FLAG    */
*        /*   WAS SET, THEN DO AN ADDRCD INSTEAD OF THE UPDRCD.      */
*        /*   SINCE THE GET WAS UNSUCCESSFUL, SET THE SKIP           */
*        /*   PROCESSING FLAG TO BYPASS REMAINING CODE IN THIS       */
*        /*   PROCEDURE.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1065
*              IF RSRRC ^= 0                                       1065
*                THEN                                              1065
@RF01063 L     @07,RSRRC(,REG6)                                    1065
         LTR   @07,@07                                             1065
         BZ    @RF01065                                            1065
*                  DO;                                             1066
*                                                                  1066
*        /************************************************************/
*        /*                                                          */
*        /*    PROCESS EXPECTED NO RECORD FOUND ERROR.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1067
*                    IF GRABSNRA = ON  GRABSNRN = ON              1067
*                      THEN                                        1067
         L     @04,RSRGRBPT(,REG6)                                 1067
         TM    GRABSNRA(@04),B'01000010'                           1067
         BZ    @RF01067                                            1067
*                        IF (RSRRC = RCIOERR & RPLERREG = RCLOGERR &
*                          RPLERRCD = RPLNOREC)                   1068
*                           (RSRRC = RCEOF & GRABSEFN = ON)        1068
*                          THEN                                    1068
         C     @07,@CF00038                                        1068
         BNE   @GL00022                                            1068
         L     @07,IOCSPTR(,REG6)                                  1068
         L     @07,IOCEXT(,@07)                                    1068
         L     @07,IOCRPL(,@07)                                    1068
         CLI   RPLERREG(@07),8                                     1068
         BNE   @GL00022                                            1068
         CLI   RPLERRCD(@07),16                                    1068
         BE    @RT01068                                            1068
@GL00022 CLC   RSRRC(4,REG6),@CF00471                              1068
         BNE   @RF01068                                            1068
         L     @07,RSRGRBPT(,REG6)                                 1068
         TM    GRABSEFN(@07),B'00100000'                           1068
         BNO   @RF01068                                            1068
@RT01068 DS    0H                                                  1069
*                            DO;                                   1069
*                                                                  1069
*        /************************************************************/
*        /*                                                          */
*        /*    ALLOW PROCESSING TO CONTINUE AGAINST THE DATA SET.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1070
*                              IOCMSGOP = ON;                      1070
*                                                                  1070
         L     @07,IOCSPTR(,REG6)                                  1070
         OI    IOCMSGOP(@07),B'00100000'                           1070
*        /************************************************************/
*        /*                                                          */
*        /*    SET RABNRF FLAG.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1071
*                              IF GRABSNRN = ON                    1071
*                                THEN                              1071
         L     @07,RSRGRBPT(,REG6)                                 1071
         TM    GRABSNRN(@07),B'00000010'                           1071
         BNO   @RF01071                                            1071
*                                  DO;                             1072
*                                    RABNRF = ON;                  1073
         L     @07,GRABCURR(,@07)                                  1073
         OI    RABNRF(@07),B'00000010'                             1073
*                                    RSRRC = 0;                    1074
         SLR   @07,@07                                             1074
         ST    @07,RSRRC(,REG6)                                    1074
*                                  END;                            1075
*                                                                  1075
*        /************************************************************/
*        /*                                                          */
*        /*    ISSUE INTERNAL ADDRCD INSTEAD OF UPDRCD.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1076
*                              IF GRABSNRA = ON                    1076
*                                THEN                              1076
@RF01071 L     @07,RSRGRBPT(,REG6)                                 1076
         TM    GRABSNRA(@07),B'01000000'                           1076
         BNO   @RF01076                                            1076
*                                  DO;                             1077
*                                    RSRADD = ON;                  1078
         OI    RSRADD(REG6),B'01000000'                            1078
*                                    RSRUPD = OFF;                 1079
*                                                                  1079
         NI    RSRUPD(REG6),B'11110111'                            1079
*                                    CALL RECMGAP;                 1080
*                                                                  1080
         BAL   @14,RECMGAP                                         1080
*                                    RSRUPD = ON;                  1081
         OI    RSRUPD(REG6),B'00001000'                            1081
*                                    RSRADD = OFF;                 1082
         NI    RSRADD(REG6),B'10111111'                            1082
*                                  END;                            1083
*                                                                  1083
*                            END;                                  1084
*                                                                  1084
@RF01076 DS    0H                                                  1085
*        /************************************************************/
*        /*                                                          */
*        /*    SET SKIP PROCESSING FLAG ON TO BYPASS UPUT.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1085
*                    RSRSKPSW = ON;                                1085
*                                                                  1085
@RF01068 DS    0H                                                  1085
@RF01067 OI    RSRSKPSW(REG6),B'00010000'                          1085
*                  END;                                            1086
*                                                                  1086
*        /************************************************************/
*        /*                                                          */
*        /* FIND THE RMB WHICH WAS USED FOR THE GET UPD              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1087
*              IF RSRSKPSW = OFF                                   1087
*                THEN                                              1087
*                                                                  1087
@RF01065 TM    RSRSKPSW(REG6),B'00010000'                          1087
         BNZ   @RF01087                                            1087
*                  CALL RMBUPPIK;                                  1088
*                                                                  1088
         BAL   @14,RMBUPPIK                                        1088
*            END RECUGET;                                          1089
*                                                                  1089
@RF01087 DS    0H                                                  1090
*        /************************************************************/
*        /*                                                          */
*        /* FOR DELETE REQUEST, SET THE ERASE BIT IN THE IOCSTR      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1090
*        IF RSRDEL = ON & RSRSKPSW = OFF                           1090
*          THEN                                                    1090
@RF01052 TM    RSRDEL(REG6),B'00001000'                            1090
         BNO   @RF01090                                            1090
         TM    RSRSKPSW(REG6),B'00010000'                          1090
         BNZ   @RF01090                                            1090
*            IOCMACER = ON;                                        1091
*                                                                  1091
         L     @07,IOCSPTR(,REG6)                                  1091
         OI    IOCMACER(@07),B'00000010'                           1091
*        /************************************************************/
*        /*                                                          */
*        /* FOR PUT UPDATE REQUEST, SET IOCDLN TO THE RECORD LENGTH, */
*        /* AND SET THE ARGUMENT FROM THE RMB                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1092
*        IF RSRUPDT = ON & RSRSKPSW = OFF                          1092
*          THEN                                                    1092
@RF01090 TM    RSRUPDT(REG6),B'00100000'                           1092
         BNO   @RF01092                                            1092
         TM    RSRSKPSW(REG6),B'00010000'                          1092
         BNZ   @RF01092                                            1092
*RECPLEN:    DO;                                                   1093
*                                                                  1093
RECPLEN  DS    0H                                                  1094
*        /************************************************************/
*        /*                                                          */
*        /*    WORKFILE. LENGTH OF RECORD IS 505. ARGUEMENT IS       */
*        /*    PLACED IN IOCREL.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1094
*              IF RSRWF = ON                                       1094
*                THEN                                              1094
         TM    RSRWF(REG6),B'10000000'                             1094
         BNO   @RF01094                                            1094
*                  DO;                                             1095
*                    IOCDLN = CELEN;                               1096
         L     @07,IOCSPTR(,REG6)                                  1096
         MVC   IOCDLN(4,@07),@CF00738                              1096
*                    IOCREL = RMBARG;                              1097
         L     @04,RSRMBP(,REG6)                                   1097
         L     @04,RMBARG(,@04)                                    1097
         ST    @04,IOCREL(,@07)                                    1097
*                  END;                                            1098
*                                                                  1098
*        /************************************************************/
*        /*                                                          */
*        /*    CATALOG OR CRA.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1099
*                ELSE                                              1099
*                                                                  1099
*        /************************************************************/
*        /*                                                          */
*        /*    KEYED REQUEST. LENGTH IS 47. ARGUEMENT IS PLACED      */
*        /*    IN IOCKYA.                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1099
*                  IF RSRKEY = ON                                  1099
*                    THEN                                          1099
         B     @RC01094                                            1099
@RF01094 TM    RSRKEY(REG6),B'00010000'                            1099
         BNO   @RF01099                                            1099
*                      DO;                                         1100
*                        IOCDLN = TNLEN;                           1101
         L     @07,IOCSPTR(,REG6)                                  1101
         MVC   IOCDLN(4,@07),@CF00747                              1101
*                        IOCKYA = ADDR(RMBKEYA);                   1102
         L     @04,RSRMBP(,REG6)                                   1102
         LA    @04,RMBKEYA(,@04)                                   1102
         ST    @04,IOCKYA(,@07)                                    1102
*                      END;                                        1103
*                                                                  1103
*        /************************************************************/
*        /*                                                          */
*        /*    CONTROL INTERVAL REQUEST. LENGTH IS 512. ARGUEMENT    */
*        /*    IS PLACED IN IOCRBA.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1104
*                    ELSE                                          1104
*                      DO;                                         1104
         B     @RC01099                                            1104
@RF01099 DS    0H                                                  1105
*                        IOCDLN = CILEN;                           1105
         L     @07,IOCSPTR(,REG6)                                  1105
         MVC   IOCDLN(4,@07),@CF00740                              1105
*                        IOCRBA = RMBARG*CILEN;                    1106
         L     @04,RSRMBP(,REG6)                                   1106
         L     @04,RMBARG(,@04)                                    1106
         SLA   @04,9                                               1106
         ST    @04,IOCRBA(,@07)                                    1106
*                      END;                                        1107
*                                                                  1107
*        /************************************************************/
*        /*                                                          */
*        /*   MOVE THE UPDATED RECORD TO THE WORKAREA                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1108
*              IF IOCDLN < 257                                     1108
*                THEN                                              1108
@RC01099 DS    0H                                                  1108
@RC01094 L     @07,IOCSPTR(,REG6)                                  1108
         L     @04,IOCDLN(,@07)                                    1108
         C     @04,@CF03810                                        1108
         BNL   @RF01108                                            1108
*                  RECIORCD(1:IOCDLN) = RECRCD(1:IOCDLN);          1109
         L     @07,IOCDAD(,@07)                                    1109
         BCTR  @04,0                                               1109
         L     @01,RSRGRBPT(,REG6)                                 1109
         L     @01,GRABCURR(,@01)                                  1109
         EX    @04,@SM03984                                        1109
*                ELSE                                              1110
*                  DO;                                             1110
         B     @RC01108                                            1110
@RF01108 DS    0H                                                  1111
*                    RECIORCD(1:256) = RECRCD(1:256);              1111
         L     @07,IOCSPTR(,REG6)                                  1111
         L     @04,IOCDAD(,@07)                                    1111
         L     @01,RSRGRBPT(,REG6)                                 1111
         L     @15,GRABCURR(,@01)                                  1111
         MVC   RECIORCD(256,@04),RECRCD(@15)                       1111
*                    RECIORCD(257:IOCDLN) = RECRCD(257:IOCDLN);    1112
         L     @07,IOCDLN(,@07)                                    1112
         SL    @07,@CF03810                                        1112
         EX    @07,@SM03986                                        1112
*                  END;                                            1113
*                                                                  1113
*        /************************************************************/
*        /*                                                          */
*        /*   FOR WF, MOVE THE UPDATED PROCESSING AREA TO            */
*        /*   THE WORKAREA                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1114
*              IF RSRWF = ON                                       1114
*                THEN                                              1114
@RC01108 TM    RSRWF(REG6),B'10000000'                             1114
         BNO   @RF01114                                            1114
*                  RECIORCD(34:43) = RECFFLG;                      1115
*                                                                  1115
         L     @07,IOCSPTR(,REG6)                                  1115
         L     @07,IOCDAD(,@07)                                    1115
         L     @04,RSRGRBPT(,REG6)                                 1115
         L     @04,GRABCURR(,@04)                                  1115
         MVC   RECIORCD+33(10,@07),RECFFLG(@04)                    1115
*            END RECPLEN;                                          1116
*                                                                  1116
@RF01114 DS    0H                                                  1117
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE UPUT                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1117
*        IF RSRSKPSW = OFF                                         1117
*          THEN                                                    1117
@RF01092 TM    RSRSKPSW(REG6),B'00010000'                          1117
         BNZ   @RF01117                                            1117
*            DO;                                                   1118
*                                                                  1118
*              CALL IDCIOPT0 (GDTTBL,IOCSPTR);                     1119
*                                                                  1119
         ST    REG5,@AL00001                                       1119
         LA    @07,IOCSPTR(,REG6)                                  1119
         ST    @07,@AL00001+4                                      1119
         MVI   @AL00001+4,X'80'                                    1119
         L     @15,GDTPUT(,REG5)                                   1119
         LA    @01,@AL00001                                        1119
         BALR  @14,@15                                             1119
*              RESPECIFY RTNREG RSTD;                              1120
*              TESTRC = RTNREG;                                    1121
         STH   RTNREG,TESTRC(,REG6)                                1121
*              RESPECIFY RTNREG UNRSTD;                            1122
*                                                                  1122
*              RSRRC = TESTRC;                                     1123
*                                                                  1123
         LH    @07,TESTRC(,REG6)                                   1123
         ST    @07,RSRRC(,REG6)                                    1123
*            END;                                                  1124
*                                                                  1124
*        /************************************************************/
*        /*                                                          */
*        /* PROCESSING COMPLETED. SET SKIP PROCESSING FLAG OFF       */
*        /* AND RETURN.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1125
*        RSRSKPSW = OFF;                                           1125
*                                                                  1125
@RF01117 NI    RSRSKPSW(REG6),B'11101111'                          1125
*  CALL EXIT;  /*TERMINATE*/                                       1126
         BAL   @14,EXIT                                            1126
*  END RECMUD; /*END OF PROCEDURE*/                                1127
@EL00012 DS    0H                                                  1127
@EF00012 DS    0H                                                  1127
@ER00012 BR    @14                                                 1127
@PB00012 DS    0H                                                  1128
*      GENERATE;                                                   1128
         B     NAME0049+8  BR AROUND NAME
         DS    0F
NAME0049 DC    CL8'RMBUPPIK'
*RMBUPPIK: PROCEDURE                                               1129
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1129
*                                                                  1129
         B     @PB00013                                            1129
RMBUPPIK DS    0H                                                  1130
*      GENERATE REFS(RS06RG08, REG6);                              1130
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0049  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* DETERMINE IF THE SPECIFIED ARGUMENT WAS PREVIOUSLY               */
*/* THE OBJECT OF A GET UPD                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1131
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE RETURN CODE TO 0.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1131
*        RSSUBRC = 0;                                              1131
*                                                                  1131
         SLR   @07,@07                                             1131
         ST    @07,RSSUBRC(,REG6)                                  1131
*        /************************************************************/
*        /*                                                          */
*        /*  FIND THE POSSIBLE RMBS FOR THE REQUEST AND CHECK EACH   */
*        /*  TO DETERMINE IF ONE WAS USED FOR A GET UPDATE FOR THE   */
*        /*  REQUESTED ARGUMENT. IF SO, USE THAT RMB FOR             */
*        /*  THIS REQUEST. IF NOT, SET RETURN CODE TO 4.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1132
*        /************************************************************/
*        /*                                                          */
*        /* FOR CRA, THERE IS ONLY ONE RMB, SO CHECK IT              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1132
*        IF RSRCRA = ON                                            1132
*          THEN                                                    1132
         TM    RSRCRA(REG6),B'00100000'                            1132
         BNO   @RF01132                                            1132
*            DO;                                                   1133
*              RSRMBP = ADDR(CRARMB);                              1134
         L     @07,RSIOTBL(,REG6)                                  1134
         LA    @07,CRARMB(,@07)                                    1134
         ST    @07,RSRMBP(,REG6)                                   1134
*              IF RMBGETU = OFF  RABRCDA ^= RMBARG                1135
*                THEN                                              1135
         TM    RMBGETU(@07),B'00000100'                            1135
         BZ    @RT01135                                            1135
         L     @04,RSRGRBPT(,REG6)                                 1135
         L     @04,GRABCURR(,@04)                                  1135
         CLC   RABRCDA(4,@04),RMBARG(@07)                          1135
         BE    @RF01135                                            1135
@RT01135 DS    0H                                                  1136
*                  RSSUBRC = RCNOGU;                               1136
         MVC   RSSUBRC(4,REG6),@CF00038                            1136
*            END;                                                  1137
*                                                                  1137
@RF01135 DS    0H                                                  1138
*        /************************************************************/
*        /*                                                          */
*        /* FOR CATALOG, IF IT IS A KEYED REQUEST, CHECK THE         */
*        /* HKR RMB, IF IT IS A CNV REQUEST, CHECK THE LKR RMB       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1138
*        IF RSRCAT = ON                                            1138
*          THEN                                                    1138
@RF01132 TM    RSRCAT(REG6),B'01000000'                            1138
         BNO   @RF01138                                            1138
*            IF RSRKEY = ON                                        1139
*              THEN                                                1139
         TM    RSRKEY(REG6),B'00010000'                            1139
         BNO   @RF01139                                            1139
*                DO;                                               1140
*                  RSRMBP = ADDR(CATHRMB);                         1141
         L     @07,RSIOTBL(,REG6)                                  1141
         LA    @07,CATHRMB(,@07)                                   1141
         ST    @07,RSRMBP(,REG6)                                   1141
*                  IF RMBGETU = OFF                                1142
*                    THEN                                          1142
         TM    RMBGETU(@07),B'00000100'                            1142
         BNZ   @RF01142                                            1142
*                      RSSUBRC = RCNOGU;                           1143
         MVC   RSSUBRC(4,REG6),@CF00038                            1143
*                    ELSE                                          1144
*                      IF RECKEYA ^= RMBKEYA                       1144
*                        THEN                                      1144
         B     @RC01142                                            1144
@RF01142 L     @07,RSRGRBPT(,REG6)                                 1144
         L     @07,GRABCURR(,@07)                                  1144
         L     @04,RSRMBP(,REG6)                                   1144
         CLC   RECKEYA(44,@07),RMBKEYA(@04)                        1144
         BE    @RF01144                                            1144
*                          RSSUBRC = RCNOGU;                       1145
         MVC   RSSUBRC(4,REG6),@CF00038                            1145
*                END;                                              1146
*              ELSE                                                1147
*                DO;                                               1147
         B     @RC01139                                            1147
@RF01139 DS    0H                                                  1148
*                  RSRMBP = ADDR(CATLRMB);                         1148
         L     @07,RSIOTBL(,REG6)                                  1148
         LA    @07,CATLRMB(,@07)                                   1148
         ST    @07,RSRMBP(,REG6)                                   1148
*                  IF RMBGETU = OFF  RABRCDA ^= RMBARG            1149
*                    THEN                                          1149
         TM    RMBGETU(@07),B'00000100'                            1149
         BZ    @RT01149                                            1149
         L     @04,RSRGRBPT(,REG6)                                 1149
         L     @04,GRABCURR(,@04)                                  1149
         CLC   RABRCDA(4,@04),RMBARG(@07)                          1149
         BE    @RF01149                                            1149
@RT01149 DS    0H                                                  1150
*                      RSSUBRC = RCNOGU;                           1150
         MVC   RSSUBRC(4,REG6),@CF00038                            1150
*                END;                                              1151
*                                                                  1151
@RF01149 DS    0H                                                  1152
*        /************************************************************/
*        /*                                                          */
*        /* FOR WORKFILE, THE ARGUMENT MAY BE A SLOT OR A CATCI.     */
*        /* DETERMINE THE SLOT NUMBER AND PLACE IN RSRSVARG.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1152
*        IF RSRWF = ON                                             1152
*          THEN                                                    1152
*                                                                  1152
@RC01139 DS    0H                                                  1152
@RF01138 TM    RSRWF(REG6),B'10000000'                             1152
         BNO   @RF01152                                            1152
*        /************************************************************/
*        /*                                                          */
*        /*   IF ARGUMENT IS RRN, NO TRANSLATION IS NEEDED           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1153
*            IF RABRRN = ON                                        1153
*              THEN                                                1153
         L     @07,RSRGRBPT(,REG6)                                 1153
         L     @07,GRABCURR(,@07)                                  1153
         TM    RABRRN(@07),B'00010000'                             1153
         BNO   @RF01153                                            1153
*                RSRSVARG = RABRCDA;                               1154
*                                                                  1154
         L     @07,RABRCDA(,@07)                                   1154
         ST    @07,RSRSVARG(,REG6)                                 1154
*        /************************************************************/
*        /*                                                          */
*        /*   IF ARGUMENT IS CATCI, TRANSLATE TO RRN                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1155
*              ELSE                                                1155
*                DO;                                               1155
*                                                                  1155
         B     @RC01153                                            1155
@RF01153 DS    0H                                                  1156
*                  CALL RECIXL(RSRSVARG);                          1156
*                                                                  1156
         LA    @07,RSRSVARG(,REG6)                                 1156
         ST    @07,@AL00001                                        1156
         LA    @01,@AL00001                                        1156
         BAL   @14,RECIXL                                          1156
*        /************************************************************/
*        /*                                                          */
*        /*   IF TRANSLATE FAILED, SET RETURN CODE TO 8.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1157
*                  IF RSRRC = RCXLERR                              1157
*                    THEN                                          1157
         LA    @07,8                                               1157
         C     @07,RSRRC(,REG6)                                    1157
         BNE   @RF01157                                            1157
*                      RSSUBRC = RCXLERR;                          1158
         ST    @07,RSSUBRC(,REG6)                                  1158
*                END;                                              1159
*                                                                  1159
@RF01157 DS    0H                                                  1160
*        /************************************************************/
*        /*                                                          */
*        /* FOR WORKFILE, IF IT IS A SEQ REQUEST, CHECK THE          */
*        /* SEQ RMB                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1160
*        IF RSRWF = ON & RSRDIR = OFF & RSSUBRC ^= RCXLERR         1160
*          THEN                                                    1160
@RC01153 DS    0H                                                  1160
@RF01152 TM    RSRWF(REG6),B'10000000'                             1160
         BNO   @RF01160                                            1160
         TM    RSRDIR(REG6),B'00000100'                            1160
         BNZ   @RF01160                                            1160
         CLC   RSSUBRC(4,REG6),@CF00175                            1160
         BE    @RF01160                                            1160
*            DO;                                                   1161
*              RSRMBP = ADDR(WFSRMB);                              1162
         L     @07,RSIOTBL(,REG6)                                  1162
         LA    @07,WFSRMB(,@07)                                    1162
         ST    @07,RSRMBP(,REG6)                                   1162
*              IF RMBGETU = OFF  RSRSVARG ^= RMBARG               1163
*                THEN                                              1163
         TM    RMBGETU(@07),B'00000100'                            1163
         BZ    @RT01163                                            1163
         CLC   RSRSVARG(4,REG6),RMBARG(@07)                        1163
         BE    @RF01163                                            1163
@RT01163 DS    0H                                                  1164
*                  RSSUBRC = RCNOGU;                               1164
         MVC   RSSUBRC(4,REG6),@CF00038                            1164
*            END;                                                  1165
*                                                                  1165
@RF01163 DS    0H                                                  1166
*        /************************************************************/
*        /*                                                          */
*        /* FOR WORKFILE, IF IT IS A DIR REQUEST, CHECK ALL          */
*        /* THE DIRECT RMBS                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1166
*        IF RSRWF = ON & RSRDIR = ON & RSSUBRC ^= RCXLERR          1166
*          THEN                                                    1166
@RF01160 TM    RSRWF(REG6),B'10000100'                             1166
         BNO   @RF01166                                            1166
         CLC   RSSUBRC(4,REG6),@CF00175                            1166
         BE    @RF01166                                            1166
*            DO;                                                   1167
*              RSRU = 0;                                           1168
*                                                                  1168
         MVI   RSRU(REG6),X'00'                                    1168
*RECLP9:       DO RSRI = 1 TO RSRWFRN - 1 WHILE(RSRU = 0);         1169
*                                                                  1169
RECLP9   LA    @07,1                                               1169
         B     @DE01169                                            1169
@DL01169 CLI   RSRU(REG6),0                                        1169
         BNE   @DC01169                                            1169
*                RSRMBP = ADDR(WFDRMB(RSRI));                      1170
         SLR   @07,@07                                             1170
         IC    @07,RSRI(,REG6)                                     1170
         MH    @07,@CH00032                                        1170
         L     @04,RSIOTBL(,REG6)                                  1170
         LA    @07,WFDRMB-12(@07,@04)                              1170
         ST    @07,RSRMBP(,REG6)                                   1170
*                IF RMBGETU = OFF  RSRSVARG ^= RMBARG             1171
*                  THEN;                                           1171
         TM    RMBGETU(@07),B'00000100'                            1171
         BZ    @RT01171                                            1171
         CLC   RSRSVARG(4,REG6),RMBARG(@07)                        1171
         BNE   @RT01171                                            1171
*                  ELSE                                            1173
*                    RSRU = RSRI;                                  1173
*                                                                  1173
         IC    @07,RSRI(,REG6)                                     1173
         STC   @07,RSRU(,REG6)                                     1173
*              END RECLP9;                                         1174
*                                                                  1174
@RT01171 LA    @07,1                                               1174
         SLR   @04,@04                                             1174
         IC    @04,RSRI(,REG6)                                     1174
         ALR   @07,@04                                             1174
@DE01169 STC   @07,RSRI(,REG6)                                     1174
         LH    @04,RSRWFRN(,REG6)                                  1174
         BCTR  @04,0                                               1174
         CR    @07,@04                                             1174
         BNH   @DL01169                                            1174
@DC01169 DS    0H                                                  1175
*              IF RSRU = 0                                         1175
*                THEN                                              1175
         CLI   RSRU(REG6),0                                        1175
         BNE   @RF01175                                            1175
*                  RSSUBRC = RCNOGU;                               1176
*                                                                  1176
         MVC   RSSUBRC(4,REG6),@CF00038                            1176
*              RSRLU = RSRU;                                       1177
*                                                                  1177
@RF01175 IC    @07,RSRU(,REG6)                                     1177
         STC   @07,RSRLU(,REG6)                                    1177
*            END;                                                  1178
*                                                                  1178
*        /************************************************************/
*        /*                                                          */
*        /*  FREERCD REQUEST. MAKE RMB AVAILABLE BY SETTING          */
*        /*  THE GET UPDATE FLAG OFF.                                */
*        /*  SET ADDRESS OF RPL FROM RMB.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1179
*        IF RSRFREE = ON & RSSUBRC = 0                             1179
*          THEN                                                    1179
@RF01166 TM    RSRFREE(REG6),B'00000001'                           1179
         BNO   @RF01179                                            1179
         L     @07,RSSUBRC(,REG6)                                  1179
         LTR   @07,@07                                             1179
         BNZ   @RF01179                                            1179
*            DO;                                                   1180
*              RMBGETU = OFF;                                      1181
         L     @07,RSRMBP(,REG6)                                   1181
         NI    RMBGETU(@07),B'11111011'                            1181
*              IOCRPL = RMBRPL;                                    1182
         L     @04,IOCSPTR(,REG6)                                  1182
         L     @04,IOCEXT(,@04)                                    1182
         L     @07,RMBRPL(,@07)                                    1182
         ST    @07,IOCRPL(,@04)                                    1182
*            END;                                                  1183
*                                                                  1183
*        /************************************************************/
*        /*                                                          */
*        /* PUT UPDATE OR ERASE REQUEST.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1184
*        IF RSRFREE = OFF & RSSUBRC = 0                            1184
*          THEN                                                    1184
@RF01179 TM    RSRFREE(REG6),B'00000001'                           1184
         BNZ   @RF01184                                            1184
         L     @07,RSSUBRC(,REG6)                                  1184
         LTR   @07,@07                                             1184
         BNZ   @RF01184                                            1184
*RECUPD:     DO;                                                   1185
RECUPD   DS    0H                                                  1186
*        /************************************************************/
*        /*                                                          */
*        /* SET ADDRESS OF RPL FROM RMB                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1186
*              IOCRPL = RMBRPL;                                    1186
*                                                                  1186
         L     @07,IOCSPTR(,REG6)                                  1186
         L     @04,IOCEXT(,@07)                                    1186
         L     @01,RSRMBP(,REG6)                                   1186
         L     @15,RMBRPL(,@01)                                    1186
         ST    @15,IOCRPL(,@04)                                    1186
*        /************************************************************/
*        /*                                                          */
*        /* MAKE SURE THAT THE IOCSTR FLAGS AGREE WITH THE           */
*        /* REQ OPTIONS                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1187
*                                                                  1187
*        /************************************************************/
*        /*                                                          */
*        /*   SET FOR KEYED OR CONTROL INTERVAL PROCESSING           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1187
*              IF RSRKEY = ON                                      1187
*                THEN                                              1187
         TM    RSRKEY(REG6),B'00010000'                            1187
         BNO   @RF01187                                            1187
*                  IOCMACBK = OFF;                                 1188
         NI    IOCMACBK(@07),B'11110111'                           1188
*                ELSE                                              1189
*                  IOCMACBK = ON;                                  1189
*                                                                  1189
         B     @RC01187                                            1189
@RF01187 L     @07,IOCSPTR(,REG6)                                  1189
         OI    IOCMACBK(@07),B'00001000'                           1189
*        /************************************************************/
*        /*                                                          */
*        /*   SET FOR DIRECT OR SEQUENTIAL PROCESSING.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1190
*              IF RSRDIR = ON                                      1190
*                THEN                                              1190
@RC01187 TM    RSRDIR(REG6),B'00000100'                            1190
         BNO   @RF01190                                            1190
*                  IOCMACDR = ON;                                  1191
         L     @07,IOCSPTR(,REG6)                                  1191
         OI    IOCMACDR(@07),B'00000100'                           1191
*                ELSE                                              1192
*                  IOCMACDR = OFF;                                 1192
*                                                                  1192
         B     @RC01190                                            1192
@RF01190 L     @07,IOCSPTR(,REG6)                                  1192
         NI    IOCMACDR(@07),B'11111011'                           1192
*        /************************************************************/
*        /*                                                          */
*        /*    MAKE THE RMB AVAILABLE BY SETTING THE GET UPDATE      */
*        /*    FLAG OFF.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1193
*              RMBGETU = OFF;                                      1193
*                                                                  1193
@RC01190 L     @07,RSRMBP(,REG6)                                   1193
         NI    RMBGETU(@07),B'11111011'                            1193
*           END RECUPD;                                            1194
*                                                                  1194
*        /************************************************************/
*        /*                                                          */
*        /* PROCESSING COMPLETED. RETURN.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1195
*        /*RESTORE CALLER'S REGISTERS AND RETURN*/                 1195
*        DO;                                                       1195
@RF01184 DS    0H                                                  1196
*          GENERATE;                                               1196
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*          RETURN CODE(RSSUBRC); /*RETURN*/                        1197
         L     @15,RSSUBRC(,REG6)                                  1197
@EL00013 DS    0H                                                  1197
@EF00013 DS    0H                                                  1197
@ER00013 BR    @14                                                 1197
*        END;                                                      1198
*                                                                  1198
*  CALL EXIT;  /*TERMINATE*/                                       1199
*  END RMBUPPIK; /*END OF PROCEDURE*/                              1200
@PB00013 DS    0H                                                  1201
*      GENERATE;                                                   1201
         B     NAME0053+8  BR AROUND NAME
         DS    0F
NAME0053 DC    CL8'RECIXL'
*RECIXL: PROCEDURE (RECXLCI)                                       1202
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1202
*                                                                  1202
         B     @PB00014                                            1202
RECIXL   MVC   @PC00014(4),0(@01)                                  1202
*      GENERATE REFS(RS06RG08, REG6);                              1203
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0053  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* TRANSLATE A CONTROL INTERVAL TO A RELATIVE                       */
*/* RECORD NUMBER.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1204
*        /************************************************************/
*        /*                                                          */
*        /* ARGUMENT OF INVOCATION                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1204
*        DCL RECXLCI FIXED(31);       /* CIN TO BE TRANSLATED        */
*                                                                  1204
*                                                                  1204
*        RSRXSW = OFF;                                             1205
         NI    RSRXSW(REG6),B'11011111'                            1205
*        RSRRC = 0;                                                1206
*                                                                  1206
         SLR   @07,@07                                             1206
         ST    @07,RSRRC(,REG6)                                    1206
*        /************************************************************/
*        /*                                                          */
*        /* FIND THE ENTRY IN THE CI RANGE TABLE IN WHICH            */
*        /* THE CI TO BE TRANSLATED IS INCLUDED                      */
*        /*                                                          */
*        /************************************************************/
*RECLP11:                                                          1207
*        DO RSRIXNO = 1 TO DIM(RSXCIENT) WHILE(RSRXSW = OFF);      1207
*                                                                  1207
RECLP11  LA    @07,1                                               1207
         STC   @07,RSRIXNO(,REG6)                                  1207
@DL01207 TM    RSRXSW(REG6),B'00100000'                            1207
         BNZ   @DC01207                                            1207
*          RSXCIEND = RECISTRT + RECICNT - 1;                      1208
         SLR   @07,@07                                             1208
         IC    @07,RSRIXNO(,REG6)                                  1208
         SLA   @07,4                                               1208
         L     @04,RSCIXLTA(,REG6)                                 1208
         LA    @01,0(@07,@04)                                      1208
         AL    @01,@CF03995                                        1208
         L     @15,RECISTRT(,@01)                                  1208
         LA    @14,0(@07,@04)                                      1208
         AL    @14,@CF03996                                        1208
         LR    @03,@15                                             1208
         AL    @03,RECICNT(,@14)                                   1208
         BCTR  @03,0                                               1208
         ST    @03,RSXCIEND(,REG6)                                 1208
*          IF RECISTRT <= RABRCDA & RABRCDA <= RSXCIEND            1209
*            THEN                                                  1209
         L     @01,RSRGRBPT(,REG6)                                 1209
         L     @01,GRABCURR(,@01)                                  1209
         L     @14,RABRCDA(,@01)                                   1209
         CR    @15,@14                                             1209
         BH    @RF01209                                            1209
         CR    @14,@03                                             1209
         BH    @RF01209                                            1209
*              DO;                                                 1210
*                                                                  1210
*        /************************************************************/
*        /*                                                          */
*        /*   THE CORRECT ENTRY HAS BEEN FOUND.                      */
*        /*   IF THE TRANSLATE FACTOR IS 0, SET                      */
*        /*   RSRRC = 8 INDICATING TRANSLATE ERROR.                  */
*        /*   IF THE TRANSLATION FACTOR IS NOT 0, ADD THE            */
*        /*   TRANSLATE FACTOR TO THE CI ARGUMENT.                   */
*        /*   SET THE ENTRY FOUND FLAG.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1211
*                RSRXSW = ON;                                      1211
         OI    RSRXSW(REG6),B'00100000'                            1211
*                IF RECIXLTE = 0                                   1212
*                  THEN                                            1212
         SLR   @15,@15                                             1212
         LA    @07,RSXCIREL-16(@07,@04)                            1212
         C     @15,RECIXLTE(,@07)                                  1212
         BNE   @RF01212                                            1212
*                    DO;                                           1213
*                      RSRRC = RCXLERR;                            1214
         MVC   RSRRC(4,REG6),@CF00175                              1214
*                      RECXLCI = 0;                                1215
         L     @07,@PC00014                                        1215
         ST    @15,RECXLCI(,@07)                                   1215
*                    END;                                          1216
*                  ELSE                                            1217
*                    RECXLCI = RABRCDA + RECIXLTE;                 1217
         B     @RC01212                                            1217
@RF01212 L     @07,@PC00014                                        1217
         L     @04,RSRGRBPT(,REG6)                                 1217
         L     @04,GRABCURR(,@04)                                  1217
         SLR   @15,@15                                             1217
         IC    @15,RSRIXNO(,REG6)                                  1217
         SLA   @15,4                                               1217
         L     @01,RSCIXLTA(,REG6)                                 1217
         LA    @15,RSXCIREL-16(@15,@01)                            1217
         L     @04,RABRCDA(,@04)                                   1217
         AL    @04,RECIXLTE(,@15)                                  1217
         ST    @04,RECXLCI(,@07)                                   1217
*              END;                                                1218
*                                                                  1218
@RC01212 DS    0H                                                  1219
*        END RECLP11;                                              1219
*                                                                  1219
@RF01209 LA    @07,1                                               1219
         SLR   @04,@04                                             1219
         IC    @04,RSRIXNO(,REG6)                                  1219
         ALR   @07,@04                                             1219
         STC   @07,RSRIXNO(,REG6)                                  1219
         C     @07,@CF01845                                        1219
         BNH   @DL01207                                            1219
@DC01207 DS    0H                                                  1220
*        /************************************************************/
*        /*                                                          */
*        /*   TABLE ENTRY FOR TRANSLATION WAS NOT FOUND.             */
*        /*   IF REQUEST WAS GETRCD AND SET NRF FLAG IS ON,          */
*        /*   THEN SET RABNRF AND INDICATE TRANSLATION ERROR.        */
*        /*   IF REQUEST IS FREERCD, INDICATE TRANSLATION ERROR.     */
*        /*   OTHERWISE CALL CKERR TO TERMINATE.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1220
*        IF RSRXSW = OFF                                           1220
*          THEN                                                    1220
         TM    RSRXSW(REG6),B'00100000'                            1220
         BNZ   @RF01220                                            1220
*            IF (RSRGET = ON & GRABSNRN = ON)  RSRFREE = ON       1221
*              THEN                                                1221
         TM    RSRGET(REG6),B'10000000'                            1221
         BNO   @GL00037                                            1221
         L     @07,RSRGRBPT(,REG6)                                 1221
         TM    GRABSNRN(@07),B'00000010'                           1221
         BO    @RT01221                                            1221
@GL00037 TM    RSRFREE(REG6),B'00000001'                           1221
         BNO   @RF01221                                            1221
@RT01221 DS    0H                                                  1222
*                DO;                                               1222
*                  RSRRC = RCXLERR;                                1223
         MVC   RSRRC(4,REG6),@CF00175                              1223
*                  IF RSRGET = ON                                  1224
*                    THEN                                          1224
         TM    RSRGET(REG6),B'10000000'                            1224
         BNO   @RF01224                                            1224
*                      RABNRF = ON;                                1225
         L     @07,RSRGRBPT(,REG6)                                 1225
         L     @07,GRABCURR(,@07)                                  1225
         OI    RABNRF(@07),B'00000010'                             1225
*                END;                                              1226
*              ELSE                                                1227
*                                                                  1227
*                                                                  1227
*                DO;                                               1227
         B     @RC01221                                            1227
@RF01221 DS    0H                                                  1228
*                /*CALL CKERR*/                                    1228
*                  RSCKERR = RSCKERR && RSCKERR;                   1228
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1228
*                  RSCKERN = RSE100;                               1229
         MVC   RSCKERN(2,REG6),@CH00143                            1229
*                  RSCKTERM = 'TERM';                              1230
*                                                                  1230
         MVC   RSCKTERM(4,REG6),@CC03827                           1230
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */
*                CALL CKERR;                                       1231
         L     @15,@CV03452                                        1231
         BALR  @14,@15                                             1231
*                END;                                              1232
*                                                                  1232
*                                                                  1232
*        /************************************************************/
*        /*                                                          */
*        /* PROCESSING COMPLETED. RETURN.                            */
*        /************************************************************/
*                                                                  1233
*  CALL EXIT;  /*TERMINATE*/                                       1233
@RC01221 DS    0H                                                  1233
@RF01220 BAL   @14,EXIT                                            1233
*  END RECIXL; /*END OF PROCEDURE*/                                1234
@EL00014 DS    0H                                                  1234
@EF00014 DS    0H                                                  1234
@ER00014 BR    @14                                                 1234
@PB00014 DS    0H                                                  1235
*      GENERATE;                                                   1235
         B     NAME0057+8  BR AROUND NAME
         DS    0F
NAME0057 DC    CL8'RECERR'
*RECERR: PROCEDURE                                                 1236
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1236
*                                                                  1236
         B     @PB00015                                            1236
RECERR   DS    0H                                                  1237
*      GENERATE REFS(RS06RG08, REG6);                              1237
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0057  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* HANDLES ALL VSAM I/O ERROR CONDITIONS                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1238
*        /************************************************************/
*        /*                                                          */
*        /* ALLOW PROCESSING TO CONTINUE.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1238
*        IOCMSGOP = ON;                                            1238
         L     @07,IOCSPTR(,REG6)                                  1238
         OI    IOCMSGOP(@07),B'00100000'                           1238
*        RSMSGRC = RPLERRCD;                                       1239
*                                                                  1239
         L     @07,IOCEXT(,@07)                                    1239
         L     @07,IOCRPL(,@07)                                    1239
         SLR   @04,@04                                             1239
         IC    @04,RPLERRCD(,@07)                                  1239
         STH   @04,RSMSGRC(,REG6)                                  1239
*        /************************************************************/
*        /*                                                          */
*        /* IF REQUEST WAS SEQUENTIAL FOR CATALOG OR CRA             */
*        /* BY CONTROL INTERVAL, MUST INCREMENT RABRCDA BY 1         */
*        /* SINCE ARGUEMENT IS NOT RETURNED ON ERROR.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1240
*        IF RSRDIR = OFF & RSRKEY = OFF & (RSRCAT = ON  RSRCRA = ON)
*          THEN                                                    1240
         TM    RSRDIR(REG6),B'00010100'                            1240
         BNZ   @RF01240                                            1240
         TM    RSRCAT(REG6),B'01100000'                            1240
         BZ    @RF01240                                            1240
*            RABRCDA = RABRCDA + 1;                                1241
*                                                                  1241
         L     @07,RSRGRBPT(,REG6)                                 1241
         L     @07,GRABCURR(,@07)                                  1241
         LA    @04,1                                               1241
         AL    @04,RABRCDA(,@07)                                   1241
         ST    @04,RABRCDA(,@07)                                   1241
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS PHYSICAL ERROR                                   */
*        /* FOR CATALOG OR CRA                                       */
*        /* SET SKIP PROCESSING FLAG TO BYPASS REMAINING CODE        */
*        /* IN THIS PROCEDURE.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1242
*        IF RPLERREG = RCPHYERR & (RSRCAT = ON  RSRCRA = ON)      1242
*          THEN                                                    1242
@RF01240 L     @07,IOCSPTR(,REG6)                                  1242
         L     @07,IOCEXT(,@07)                                    1242
         L     @07,IOCRPL(,@07)                                    1242
         CLI   RPLERREG(@07),12                                    1242
         BNE   @RF01242                                            1242
         TM    RSRCAT(REG6),B'01100000'                            1242
         BZ    @RF01242                                            1242
*            DO;                                                   1243
*                                                                  1243
*              CALL RECPHERR;                                      1244
*                                                                  1244
         BAL   @14,RECPHERR                                        1244
*              RSRSKPSW = ON;                                      1245
         OI    RSRSKPSW(REG6),B'00010000'                          1245
*            END;                                                  1246
*                                                                  1246
*        /************************************************************/
*        /*                                                          */
*        /* IF SET NRF ON NO RECORD FOUND FLAG IS SET, AND ERROR     */
*        /* IS NO RECORD FOUND, THEN SET RABNRF ON AND IGNORE ERROR  */
*        /* IF SET FOR ADD ON NO RECORD FOUND FLAG IS SET,           */
*        /* AND ERROR IS NO RECORD FOUND, THEN SET RABADD ON,        */
*        /* AND IGNORE ERROR.                                        */
*        /* IF FORMAT FLAG ON NRF IS SET, AND ERROR IS NRF, THEN     */
*        /* SET UP A DUMMY RECORD IN THE RETRIEVAL BUFFER AND IGNORE */
*        /* ERROR.                                                   */
*        /* ZERO THE WORKFILE PROCESSING FIELD.                      */
*        /* SET SKIP PROCESSING FLAG TO BYPASS REMAINING CODE        */
*        /* IN THIS PROCEDURE.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1247
*        IF (GRABSNRA = ON  GRABSNRN = ON                        1247
*          (GRABSNRF = ON & RSRGET = ON & (RSRCAT = ON  RSRCRA = ON)))
*          & RSRSKPSW = OFF                                        1247
*          THEN                                                    1247
@RF01242 L     @07,RSRGRBPT(,REG6)                                 1247
         TM    GRABSNRA(@07),B'01000010'                           1247
         BNZ   @GL00041                                            1247
         TM    GRABSNRF(@07),B'10000000'                           1247
         BNO   @RF01247                                            1247
         TM    RSRGET(REG6),B'10000000'                            1247
         BNO   @RF01247                                            1247
         TM    RSRCAT(REG6),B'01100000'                            1247
         BZ    @RF01247                                            1247
@GL00041 TM    RSRSKPSW(REG6),B'00010000'                          1247
         BNZ   @RF01247                                            1247
*            IF (RSRRC = RCIOERR & RPLERREG = RCLOGERR &           1248
*                RPLERRCD = RPLNOREC)                             1248
*               (RSRRC = RCEOF & GRABSEFN = ON)                   1248
*               (RSRRC = RCXLERR & RABNRF = ON)                    1248
*              THEN                                                1248
         CLC   RSRRC(4,REG6),@CF00038                              1248
         BNE   @GL00046                                            1248
         L     @07,IOCSPTR(,REG6)                                  1248
         L     @07,IOCEXT(,@07)                                    1248
         L     @07,IOCRPL(,@07)                                    1248
         CLI   RPLERREG(@07),8                                     1248
         BNE   @GL00046                                            1248
         CLI   RPLERRCD(@07),16                                    1248
         BE    @RT01248                                            1248
@GL00046 CLC   RSRRC(4,REG6),@CF00471                              1248
         BNE   @GL00045                                            1248
         L     @07,RSRGRBPT(,REG6)                                 1248
         TM    GRABSEFN(@07),B'00100000'                           1248
         BO    @RT01248                                            1248
@GL00045 CLC   RSRRC(4,REG6),@CF00175                              1248
         BNE   @RF01248                                            1248
         L     @07,RSRGRBPT(,REG6)                                 1248
         L     @07,GRABCURR(,@07)                                  1248
         TM    RABNRF(@07),B'00000010'                             1248
         BNO   @RF01248                                            1248
@RT01248 DS    0H                                                  1249
*RECENRF:        DO;                                               1249
RECENRF  DS    0H                                                  1250
*                  RABNRF = OFF;                                   1250
*                                                                  1250
         L     @07,RSRGRBPT(,REG6)                                 1250
         L     @04,GRABCURR(,@07)                                  1250
         NI    RABNRF(@04),B'11111101'                             1250
*        /************************************************************/
*        /*                                                          */
*        /*    SET RABNRF FLAG ON                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1251
*                  IF GRABSNRN = ON                                1251
*                    THEN                                          1251
         TM    GRABSNRN(@07),B'00000010'                           1251
         BNO   @RF01251                                            1251
*                      RABNRF = ON;                                1252
*                                                                  1252
         OI    RABNRF(@04),B'00000010'                             1252
*        /************************************************************/
*        /*                                                          */
*        /*    SET RABADD FLAG ON                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1253
*                  IF GRABSNRA = ON                                1253
*                    THEN                                          1253
@RF01251 L     @07,RSRGRBPT(,REG6)                                 1253
         TM    GRABSNRA(@07),B'01000000'                           1253
         BNO   @RF01253                                            1253
*                      RABADD = ON;                                1254
*                                                                  1254
*                                                                  1254
         L     @07,GRABCURR(,@07)                                  1254
         OI    RABADD(@07),B'00100000'                             1254
*        /************************************************************/
*        /*                                                          */
*        /*    FORMAT DUMMY RECORD IN RETRIEVAL BUFFER               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1255
*                  IF GRABSNRF = ON  & RSRGET = ON &               1255
*                     (RSRCAT = ON  RSRCRA = ON)                  1255
*                    THEN                                          1255
@RF01253 L     @07,RSRGRBPT(,REG6)                                 1255
         TM    GRABSNRF(@07),B'10000000'                           1255
         BNO   @RF01255                                            1255
         TM    RSRGET(REG6),B'10000000'                            1255
         BNO   @RF01255                                            1255
         TM    RSRCAT(REG6),B'01100000'                            1255
         BZ    @RF01255                                            1255
*                      DO;                                         1256
*                        RECRCD(1:256) = ''B;                      1257
         L     @07,GRABCURR(,@07)                                  1257
         XC    RECRCD(256,@07),RECRCD(@07)                         1257
*                        RECRCD(257:CELEN) = ''B;                  1258
         XC    RECRCD+256(249,@07),RECRCD+256(@07)                 1258
*                        RECRCD(506:CILEN) = RDFCIDF;              1259
*                                                                  1259
         MVC   RECRCD+505(7,@07),RDFCIDF                           1259
*        /************************************************************/
*        /*                                                          */
*        /*    SET RECORD CI TO RABRCDA.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1260
*                        RCDCINO = RABRCDA;                        1260
*                                                                  1260
         MVC   RCDCINO+8(3,@07),RABRCDA+1(@07)                     1260
*                      END;                                        1261
*                                                                  1261
*        /************************************************************/
*        /*                                                          */
*        /*    ZERO THE WORKFILE PROCESSING FIELD                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1262
*                  IF RSRWF = ON                                   1262
*                    THEN                                          1262
@RF01255 TM    RSRWF(REG6),B'10000000'                             1262
         BNO   @RF01262                                            1262
*                      RECFFLG = ''B;                              1263
*                                                                  1263
         L     @07,RSRGRBPT(,REG6)                                 1263
         L     @07,GRABCURR(,@07)                                  1263
         XC    RECFFLG(10,@07),RECFFLG(@07)                        1263
*        /************************************************************/
*        /*                                                          */
*        /*    SET RETURN CODE TO 4 AND SET SKIP PROCESSING FLAG.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1264
*                  RSRRC = RCIGNERR;                               1264
@RF01262 MVC   RSRRC(4,REG6),@CF00038                              1264
*                  RSRSKPSW = ON;                                  1265
*                                                                  1265
         OI    RSRSKPSW(REG6),B'00010000'                          1265
*                END RECENRF;                                      1266
*                                                                  1266
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS SPECIAL CRA ERRORS                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1267
*        IF RSRCRA = ON & RSRSKPSW = OFF                           1267
*          THEN                                                    1267
@RF01248 DS    0H                                                  1267
@RF01247 TM    RSRCRA(REG6),B'00100000'                            1267
         BNO   @RF01267                                            1267
         TM    RSRSKPSW(REG6),B'00010000'                          1267
         BNZ   @RF01267                                            1267
*            DO;                                                   1268
*                                                                  1268
*        /************************************************************/
*        /*                                                          */
*        /*   LOGICAL ERROR - PRINT MESSAGE - TERMINATE.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1269
*                                                                  1269
*              DO;                                                 1269
*              /*CALL CKERR*/                                      1270
*                RSCKERR = RSCKERR && RSCKERR;                     1270
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1270
*                RSCKERN = RSE083;                                 1271
         MVC   RSCKERN(2,REG6),@CH01049                            1271
*                RSCKTERM = 'RETU';                                1272
         MVC   RSCKTERM(4,REG6),@CC03514                           1272
*                RSCKMVAR(1) = ADDR(RECIODSN);                     1273
*                                                                  1273
         L     @07,IOCSPTR(,REG6)                                  1273
         L     @07,IOCDSN(,@07)                                    1273
         ST    @07,RSCKMVAR(,REG6)                                 1273
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         1274
         L     @15,@CV03452                                        1274
         BALR  @14,@15                                             1274
*              END;                                                1275
*                                                                  1275
*                                                                  1275
*              DO;                                                 1276
*              /*CALL CKERR*/                                      1277
*                RSCKERR = RSCKERR && RSCKERR;                     1277
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1277
*                RSCKERN = RSE085;                                 1278
         MVC   RSCKERN(2,REG6),@CH01053                            1278
*                RSCKTERM = 'TERM';                                1279
         MVC   RSCKTERM(4,REG6),@CC03827                           1279
*                RSCKMVAR(1) = ADDR(RSMSGRC);                      1280
*                                                                  1280
         LA    @07,RSMSGRC(,REG6)                                  1280
         ST    @07,RSCKMVAR(,REG6)                                 1280
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         1281
         L     @15,@CV03452                                        1281
         BALR  @14,@15                                             1281
*              END;                                                1282
*                                                                  1282
*            END;                                                  1283
*                                                                  1283
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS SPECIAL CATALOG ERRORS                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1284
*        IF RSRCAT = ON & RSRSKPSW = OFF                           1284
*          THEN                                                    1284
@RF01267 TM    RSRCAT(REG6),B'01000000'                            1284
         BNO   @RF01284                                            1284
         TM    RSRSKPSW(REG6),B'00010000'                          1284
         BNZ   @RF01284                                            1284
*            DO;                                                   1285
*                                                                  1285
*        /************************************************************/
*        /*                                                          */
*        /*   IF IGNORE DUP FLAG IS SET AND ERROR IS DUP             */
*        /*   ON ADDRCD, THEN SET RABDUP ON AND IGNORE ERROR.        */
*        /*   SET SKIP PROCESSING FLAG TO BYPASS REMAINING CODE      */
*        /*   IN THIS PROCEDURE.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1286
*              IF GRABSDUP = ON & RSRADD = ON & RPLERRCD = RPLDUP  1286
*                THEN                                              1286
         L     @07,RSRGRBPT(,REG6)                                 1286
         TM    GRABSDUP(@07),B'00000001'                           1286
         BNO   @RF01286                                            1286
         TM    RSRADD(REG6),B'01000000'                            1286
         BNO   @RF01286                                            1286
         L     @04,IOCSPTR(,REG6)                                  1286
         L     @04,IOCEXT(,@04)                                    1286
         L     @04,IOCRPL(,@04)                                    1286
         CLI   RPLERRCD(@04),8                                     1286
         BNE   @RF01286                                            1286
*                  DO;                                             1287
*                    RABDUP = ON;                                  1288
         L     @07,GRABCURR(,@07)                                  1288
         OI    RABDUP(@07),B'00000001'                             1288
*                    RSRRC = RCIGNERR;                             1289
         MVC   RSRRC(4,REG6),@CF00038                              1289
*                    RSRSKPSW = ON;                                1290
         OI    RSRSKPSW(REG6),B'00010000'                          1290
*                  END;                                            1291
*                                                                  1291
*        /************************************************************/
*        /*                                                          */
*        /*   LOGICAL ERROR - PRINT MESSAGE - TERMINATE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1292
*                ELSE                                              1292
*                  DO;                                             1292
*                                                                  1292
*                                                                  1292
         B     @RC01286                                            1292
@RF01286 DS    0H                                                  1293
*                    DO;                                           1293
*                    /*CALL CKERR*/                                1294
*                      RSCKERR = RSCKERR && RSCKERR;               1294
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1294
*                      RSCKERN = RSE083;                           1295
         MVC   RSCKERN(2,REG6),@CH01049                            1295
*                      RSCKTERM = 'RETU';                          1296
         MVC   RSCKTERM(4,REG6),@CC03514                           1296
*                      RSCKMVAR(1) = ADDR(RECIODSN);               1297
*                                                                  1297
         L     @07,IOCSPTR(,REG6)                                  1297
         L     @07,IOCDSN(,@07)                                    1297
         ST    @07,RSCKMVAR(,REG6)                                 1297
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */
*                    CALL CKERR;                                   1298
         L     @15,@CV03452                                        1298
         BALR  @14,@15                                             1298
*                    END;                                          1299
*                                                                  1299
*                                                                  1299
*                    DO;                                           1300
*                    /*CALL CKERR*/                                1301
*                      RSCKERR = RSCKERR && RSCKERR;               1301
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1301
*                      RSCKERN = RSE085;                           1302
         MVC   RSCKERN(2,REG6),@CH01053                            1302
*                      RSCKTERM = 'TERM';                          1303
         MVC   RSCKTERM(4,REG6),@CC03827                           1303
*                      RSCKMVAR(1) = ADDR(RSMSGRC);                1304
*                                                                  1304
         LA    @07,RSMSGRC(,REG6)                                  1304
         ST    @07,RSCKMVAR(,REG6)                                 1304
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */
*                    CALL CKERR;                                   1305
         L     @15,@CV03452                                        1305
         BALR  @14,@15                                             1305
*                    END;                                          1306
*                                                                  1306
*                  END;                                            1307
*                                                                  1307
*            END;                                                  1308
*                                                                  1308
@RC01286 DS    0H                                                  1309
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS SPECIAL WORKFILE ERRORS                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1309
*        IF RSRWF = ON & RSRSKPSW = OFF                            1309
*          THEN                                                    1309
@RF01284 TM    RSRWF(REG6),B'10000000'                             1309
         BNO   @RF01309                                            1309
         TM    RSRSKPSW(REG6),B'00010000'                          1309
         BNZ   @RF01309                                            1309
*RECEWF:     DO;                                                   1310
*                                                                  1310
RECEWF   DS    0H                                                  1311
*        /************************************************************/
*        /*                                                          */
*        /*   IF RETRY DONE ON THIS ERROR, ABORT                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1311
*              IF RSRRC = RCXLERR & RSRXTRY = ON                   1311
*                THEN                                              1311
*                                                                  1311
*                                                                  1311
         CLC   RSRRC(4,REG6),@CF00175                              1311
         BNE   @RF01311                                            1311
         TM    RSRXTRY(REG6),B'01000000'                           1311
         BNO   @RF01311                                            1311
*                  DO;                                             1312
*                  /*CALL CKERR*/                                  1313
*                    RSCKERR = RSCKERR && RSCKERR;                 1313
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1313
*                    RSCKERN = RSE100;                             1314
         MVC   RSCKERN(2,REG6),@CH00143                            1314
*                    RSCKTERM = 'TERM';                            1315
*                                                                  1315
         MVC   RSCKTERM(4,REG6),@CC03827                           1315
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */
*                  CALL CKERR;                                     1316
         L     @15,@CV03452                                        1316
         BALR  @14,@15                                             1316
*                  END;                                            1317
*                                                                  1317
*        /************************************************************/
*        /*                                                          */
*        /*   PHYSICAL ERROR - TERMINATE                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1318
*              IF RPLERREG = RCPHYERR                              1318
*                THEN                                              1318
*                                                                  1318
*                                                                  1318
@RF01311 L     @07,IOCSPTR(,REG6)                                  1318
         L     @07,IOCEXT(,@07)                                    1318
         L     @07,IOCRPL(,@07)                                    1318
         CLI   RPLERREG(@07),12                                    1318
         BNE   @RF01318                                            1318
*                  DO;                                             1319
*                  /*CALL CKERR*/                                  1320
*                    RSCKERR = RSCKERR && RSCKERR;                 1320
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1320
*                    RSCKERN = RSE011;                             1321
         MVC   RSCKERN(2,REG6),@CH00033                            1321
*                    RSCKTERM = 'TERM';                            1322
*                                                                  1322
         MVC   RSCKTERM(4,REG6),@CC03827                           1322
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */
*                  CALL CKERR;                                     1323
         L     @15,@CV03452                                        1323
         BALR  @14,@15                                             1323
*                  END;                                            1324
*                                                                  1324
*        /************************************************************/
*        /*                                                          */
*        /*   LOGICAL ERROR - PRINT MESSAGE - TERMINATE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1325
*              IF RSRRC = RCIOERR                                  1325
*                THEN                                              1325
@RF01318 CLC   RSRRC(4,REG6),@CF00038                              1325
         BNE   @RF01325                                            1325
*                  IF RPLERRCD = RPLIRRNO                          1326
*                    THEN                                          1326
*                                                                  1326
*                                                                  1326
         L     @07,IOCSPTR(,REG6)                                  1326
         L     @07,IOCEXT(,@07)                                    1326
         L     @07,IOCRPL(,@07)                                    1326
         CLI   RPLERRCD(@07),192                                   1326
         BNE   @RF01326                                            1326
*                      DO;                                         1327
*                      /*CALL CKERR*/                              1328
*                        RSCKERR = RSCKERR && RSCKERR;             1328
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1328
*                        RSCKERN = RSE081;                         1329
         MVC   RSCKERN(2,REG6),@CH01045                            1329
*                        RSCKTERM = 'TERM';                        1330
*                                                                  1330
         MVC   RSCKTERM(4,REG6),@CC03827                           1330
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR */
*                      CALL CKERR;                                 1331
         L     @15,@CV03452                                        1331
         BALR  @14,@15                                             1331
*                      END;                                        1332
*                                                                  1332
*                    ELSE                                          1333
*                      DO;                                         1333
*                                                                  1333
*                                                                  1333
         B     @RC01326                                            1333
@RF01326 DS    0H                                                  1334
*                        DO;                                       1334
*                        /*CALL CKERR*/                            1335
*                          RSCKERR = RSCKERR && RSCKERR;           1335
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1335
*                          RSCKERN = RSE083;                       1336
         MVC   RSCKERN(2,REG6),@CH01049                            1336
*                          RSCKTERM = 'RETU';                      1337
         MVC   RSCKTERM(4,REG6),@CC03514                           1337
*                          RSCKMVAR(1) = ADDR(RECIODSN);           1338
*                                                                  1338
         L     @07,IOCSPTR(,REG6)                                  1338
         L     @07,IOCDSN(,@07)                                    1338
         ST    @07,RSCKMVAR(,REG6)                                 1338
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1339
         L     @15,@CV03452                                        1339
         BALR  @14,@15                                             1339
*                        END;                                      1340
*                                                                  1340
*                                                                  1340
*                        DO;                                       1341
*                        /*CALL CKERR*/                            1342
*                          RSCKERR = RSCKERR && RSCKERR;           1342
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1342
*                          RSCKERN = RSE085;                       1343
         MVC   RSCKERN(2,REG6),@CH01053                            1343
*                          RSCKTERM = 'TERM';                      1344
         MVC   RSCKTERM(4,REG6),@CC03827                           1344
*                          RSCKMVAR(1) = ADDR(RSMSGRC);            1345
*                                                                  1345
         LA    @07,RSMSGRC(,REG6)                                  1345
         ST    @07,RSCKMVAR(,REG6)                                 1345
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR
*                                                                    */
*                        CALL CKERR;                               1346
         L     @15,@CV03452                                        1346
         BALR  @14,@15                                             1346
*                        END;                                      1347
*                                                                  1347
*                      END;                                        1348
*                                                                  1348
*        /************************************************************/
*        /*                                                          */
*        /*   TRANSLATION ERROR. IF EXTEND TABLE FLAG OFF, ABORT     */
*        /*   IF EXTEND TABLE FLAG ON, EXTEND THE TRANSLATE TABLE    */
*        /*   TO INCLUDE THE CATCIS OF THE ENTRY CONTAINING THE      */
*        /*   INVALID ARGUMENT.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1349
*              IF GRABSFXT = OFF                                   1349
*                THEN                                              1349
*                                                                  1349
*                                                                  1349
@RC01326 DS    0H                                                  1349
@RF01325 L     @07,RSRGRBPT(,REG6)                                 1349
         TM    GRABSFXT(@07),B'10000000'                           1349
         BNZ   @RF01349                                            1349
*                  DO;                                             1350
*                  /*CALL CKERR*/                                  1351
*                    RSCKERR = RSCKERR && RSCKERR;                 1351
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1351
*                    RSCKERN = RSE100;                             1352
         MVC   RSCKERN(2,REG6),@CH00143                            1352
*                    RSCKTERM = 'TERM';                            1353
*                                                                  1353
         MVC   RSCKTERM(4,REG6),@CC03827                           1353
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */
*                  CALL CKERR;                                     1354
         L     @15,@CV03452                                        1354
         BALR  @14,@15                                             1354
*                  END;                                            1355
*                                                                  1355
*              RSRXLFND = 0;                                       1356
@RF01349 SLR   @07,@07                                             1356
         ST    @07,RSRXLFND(,REG6)                                 1356
*RECLP13:                                                          1357
*              DO RSRIXNO = 1 TO DIM(RSXCIENT) WHILE(RSRXLFND = 0);
*                                                                  1357
RECLP13  LA    @07,1                                               1357
         STC   @07,RSRIXNO(,REG6)                                  1357
@DL01357 L     @07,RSRXLFND(,REG6)                                 1357
         LTR   @07,@07                                             1357
         BNZ   @DC01357                                            1357
*                RSXCIEND = RECISTRT + RECICNT - 1;                1358
*                                                                  1358
         SLR   @07,@07                                             1358
         IC    @07,RSRIXNO(,REG6)                                  1358
         LR    @04,@07                                             1358
         SLA   @04,4                                               1358
         L     @15,RSCIXLTA(,REG6)                                 1358
         LA    @01,0(@04,@15)                                      1358
         AL    @01,@CF03995                                        1358
         L     @14,RECISTRT(,@01)                                  1358
         AL    @15,@CF03996                                        1358
         LA    @04,RSXCILN-12(@04,@15)                             1358
         LR    @15,@14                                             1358
         AL    @15,RECICNT(,@04)                                   1358
         BCTR  @15,0                                               1358
         ST    @15,RSXCIEND(,REG6)                                 1358
*        /************************************************************/
*        /*                                                          */
*        /*   IF THE ARGUMENT IS IN THIS ENTRY, SAVE IT              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1359
*                IF RECISTRT <= RABRCDA & RABRCDA <= RSXCIEND      1359
*                  THEN                                            1359
         L     @04,RSRGRBPT(,REG6)                                 1359
         L     @04,GRABCURR(,@04)                                  1359
         L     @04,RABRCDA(,@04)                                   1359
         CR    @14,@04                                             1359
         BH    @RF01359                                            1359
         CR    @04,@15                                             1359
         BH    @RF01359                                            1359
*                    RSRXLFND = RSRIXNO;                           1360
*                                                                  1360
         ST    @07,RSRXLFND(,REG6)                                 1360
*              END RECLP13;                                        1361
*                                                                  1361
@RF01359 LA    @07,1                                               1361
         SLR   @04,@04                                             1361
         IC    @04,RSRIXNO(,REG6)                                  1361
         ALR   @07,@04                                             1361
         STC   @07,RSRIXNO(,REG6)                                  1361
         C     @07,@CF01845                                        1361
         BNH   @DL01357                                            1361
@DC01357 DS    0H                                                  1362
*        /************************************************************/
*        /*                                                          */
*        /*   IF THE ARGUMENT WAS NOT FOUND IN THE TABLE, ABORT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1362
*              IF RSRXLFND = 0                                     1362
*                THEN                                              1362
*                                                                  1362
*                                                                  1362
         L     @07,RSRXLFND(,REG6)                                 1362
         LTR   @07,@07                                             1362
         BNZ   @RF01362                                            1362
*                  DO;                                             1363
*                  /*CALL CKERR*/                                  1364
*                    RSCKERR = RSCKERR && RSCKERR;                 1364
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1364
*                    RSCKERN = RSE100;                             1365
         MVC   RSCKERN(2,REG6),@CH00143                            1365
*                    RSCKTERM = 'TERM';                            1366
*                                                                  1366
         MVC   RSCKTERM(4,REG6),@CC03827                           1366
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */
*                  CALL CKERR;                                     1367
         L     @15,@CV03452                                        1367
         BALR  @14,@15                                             1367
*                  END;                                            1368
*                                                                  1368
*        /************************************************************/
*        /*                                                          */
*        /*   COMPUTE THE TRANSLATE FACTOR AND PLACE IT IN           */
*        /*   THE EXTENDED TABLE ENTRY. INCREMENT THE NEXT           */
*        /*   RRN AVAILABLE FOR AN OVERFLOW RECORD BY THE COUNT      */
*        /*   IN THE EXTENDED ENTRY                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1369
*              RSRIXNO = RSRXLFND;                                 1369
@RF01362 L     @07,RSRXLFND(,REG6)                                 1369
         STC   @07,RSRIXNO(,REG6)                                  1369
*              RECIXLTE = RSWFNEXT - RECISTRT;                     1370
         SLA   @07,4                                               1370
         L     @04,RSCIXLTA(,REG6)                                 1370
         LA    @15,RSXCIREL-16(@07,@04)                            1370
         L     @14,RSWFNEXT(,REG6)                                 1370
         AL    @04,@CF03995                                        1370
         LA    @07,RSXCIBEG-8(@07,@04)                             1370
         LR    @04,@14                                             1370
         SL    @04,RECISTRT(,@07)                                  1370
         ST    @04,RECIXLTE(,@15)                                  1370
*              IF RECIXLTE = 0                                     1371
*                THEN                                              1371
         LTR   @04,@04                                             1371
         BNZ   @RF01371                                            1371
*                  DO;                                             1372
*                    RECIXLTE = 1;                                 1373
         LA    @07,1                                               1373
         ST    @07,RECIXLTE(,@15)                                  1373
*                    RSWFNEXT = RSWFNEXT + 1;                      1374
         ALR   @14,@07                                             1374
         ST    @14,RSWFNEXT(,REG6)                                 1374
*                  END;                                            1375
*              RSWFNEXT = RSWFNEXT + RECICNT;                      1376
*                                                                  1376
@RF01371 SLR   @07,@07                                             1376
         IC    @07,RSRIXNO(,REG6)                                  1376
         SLA   @07,4                                               1376
         L     @04,RSCIXLTA(,REG6)                                 1376
         AL    @04,@CF03996                                        1376
         LA    @07,RSXCILN-12(@07,@04)                             1376
         L     @04,RSWFNEXT(,REG6)                                 1376
         AL    @04,RECICNT(,@07)                                   1376
         ST    @04,RSWFNEXT(,REG6)                                 1376
*        /************************************************************/
*        /*                                                          */
*        /*   SET RETRY INDICATOR.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1377
*              RSRRC = 0;                                          1377
         SLR   @07,@07                                             1377
         ST    @07,RSRRC(,REG6)                                    1377
*              RSRXTRY = ON;                                       1378
*                                                                  1378
         OI    RSRXTRY(REG6),B'01000000'                           1378
*            END RECEWF;                                           1379
*                                                                  1379
*        /************************************************************/
*        /*                                                          */
*        /* PROCESSING COMPLETE. SET SKIP PROCESSING FLAG OFF        */
*        /* AND RETURN.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1380
*        RSRSKPSW = OFF;                                           1380
@RF01309 NI    RSRSKPSW(REG6),B'11101111'                          1380
*  CALL EXIT;  /*TERMINATE*/                                       1381
         BAL   @14,EXIT                                            1381
*  END RECERR; /*END OF PROCEDURE*/                                1382
*                                                                  1382
@EL00015 DS    0H                                                  1382
@EF00015 DS    0H                                                  1382
@ER00015 BR    @14                                                 1382
@PB00015 DS    0H                                                  1383
*      GENERATE;                                                   1383
         B     NAME0082+8  BR AROUND NAME
         DS    0F
NAME0082 DC    CL8'RECPHERR'
*RECPHERR: PROCEDURE                                               1384
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1384
*                                                                  1384
         B     @PB00016                                            1384
RECPHERR DS    0H                                                  1385
*      GENERATE REFS(RS06RG08, REG6);                              1385
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0082  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/* IF PHYSICAL I/O ERROR ON CAT OR CRA, AND IGNORE NOT SET          */
*/* OR GRABS TERMINATE FLAG SET, THEN CALL CKERR TO TERMINATE        */
*/* IF IGNORE SET AND GRABS TERMINATE FLAG NOT SET, THEN             */
*/* IF GRABS SET IGNORE FLAG ON, SET RABIOIGN FLAG, AND IF           */
*/* CAT REQUEST WAS GETRCD AND GRABS FORMAT FLAG ON, THEN            */
*/* FORMAT A DUMMY RECORD IN THE BUFFER. RETURN WITH                 */
*/* IGNORE OPTION.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1386
*        /************************************************************/
*        /*                                                          */
*        /* TERMINATE.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1386
*        IF GRABSIOT = ON  RSIGNR = OFF                           1386
*          THEN                                                    1386
*                                                                  1386
*                                                                  1386
         L     @07,RSRGRBPT(,REG6)                                 1386
         TM    GRABSIOT(@07),B'00000100'                           1386
         BO    @RT01386                                            1386
         TM    RSIGNR(REG6),B'00000001'                            1386
         BNZ   @RF01386                                            1386
@RT01386 DS    0H                                                  1387
*              DO;                                                 1387
*              /*CALL CKERR*/                                      1388
*                RSCKERR = RSCKERR && RSCKERR;                     1388
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1388
*                RSCKERN = RSE011;                                 1389
         MVC   RSCKERN(2,REG6),@CH00033                            1389
*                RSCKTERM = 'TERM';                                1390
*                                                                  1390
         MVC   RSCKTERM(4,REG6),@CC03827                           1390
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */
*              CALL CKERR;                                         1391
         L     @15,@CV03452                                        1391
         BALR  @14,@15                                             1391
*              END;                                                1392
*                                                                  1392
*        /************************************************************/
*        /*                                                          */
*        /* IGNORE ERROR                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1393
*        RSRRC = RCIGNERR;                                         1393
*                                                                  1393
@RF01386 MVC   RSRRC(4,REG6),@CF00038                              1393
*        /************************************************************/
*        /*                                                          */
*        /*   PRINT MESSAGE.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1394
*        RSMSGCI = RABRCDA;                                        1394
*                                                                  1394
         L     @07,RSRGRBPT(,REG6)                                 1394
         L     @07,GRABCURR(,@07)                                  1394
         MVC   RSMSGCI(3,REG6),RABRCDA+1(@07)                      1394
*        IF RSRCAT = ON                                            1395
*          THEN                                                    1395
*                                                                  1395
*                                                                  1395
         TM    RSRCAT(REG6),B'01000000'                            1395
         BNO   @RF01395                                            1395
*            DO;                                                   1396
*            /*CALL CKERR*/                                        1397
*              RSCKERR = RSCKERR && RSCKERR;                       1397
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1397
*              RSCKERN = RSE082;                                   1398
         MVC   RSCKERN(2,REG6),@CH01047                            1398
*              RSCKTERM = 'RETU';                                  1399
         MVC   RSCKTERM(4,REG6),@CC03514                           1399
*              RSCKMVAR(1) = ADDR(RSMSGCI);                        1400
*                                                                  1400
         LA    @07,RSMSGCI(,REG6)                                  1400
         ST    @07,RSCKMVAR(,REG6)                                 1400
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1401
         L     @15,@CV03452                                        1401
         BALR  @14,@15                                             1401
*            END;                                                  1402
*                                                                  1402
*          ELSE                                                    1403
*                                                                  1403
*                                                                  1403
*            DO;                                                   1403
         B     @RC01395                                            1403
@RF01395 DS    0H                                                  1404
*            /*CALL CKERR*/                                        1404
*              RSCKERR = RSCKERR && RSCKERR;                       1404
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1404
*              RSCKERN = RSE010;                                   1405
         MVC   RSCKERN(2,REG6),@CH00034                            1405
*              RSCKTERM = 'RETU';                                  1406
         MVC   RSCKTERM(4,REG6),@CC03514                           1406
*              RSCKMVAR(1) = ADDR(RSMSGCI);                        1407
         LA    @07,RSMSGCI(,REG6)                                  1407
         ST    @07,RSCKMVAR(,REG6)                                 1407
*              RSCKMVAR(2) = ADDR(RESVLSER);                       1408
*                                                                  1408
         L     @07,RSENTPT(,REG6)                                  1408
         LA    @07,RESVLSER(,@07)                                  1408
         ST    @07,RSCKMVAR+4(,REG6)                               1408
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */
*            CALL CKERR;                                           1409
         L     @15,@CV03452                                        1409
         BALR  @14,@15                                             1409
*            END;                                                  1410
*                                                                  1410
*        /************************************************************/
*        /*                                                          */
*        /*   SET RABIOIGN FLAG.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1411
*        IF GRABSIOI = ON                                          1411
*          THEN                                                    1411
@RC01395 L     @07,RSRGRBPT(,REG6)                                 1411
         TM    GRABSIOI(@07),B'00010000'                           1411
         BNO   @RF01411                                            1411
*            RABIOIGN = ON;                                        1412
*                                                                  1412
         L     @07,GRABCURR(,@07)                                  1412
         OI    RABIOIGN(@07),B'00000100'                           1412
*        /************************************************************/
*        /*                                                          */
*        /*   FORMAT DUMMY RECORD.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1413
*        IF GRABSIOF = ON & RSRGET = ON & RSRCAT = ON              1413
*          THEN                                                    1413
@RF01411 L     @07,RSRGRBPT(,REG6)                                 1413
         TM    GRABSIOF(@07),B'00001000'                           1413
         BNO   @RF01413                                            1413
         TM    RSRGET(REG6),B'10000000'                            1413
         BNO   @RF01413                                            1413
         TM    RSRCAT(REG6),B'01000000'                            1413
         BNO   @RF01413                                            1413
*            DO;                                                   1414
*              RECRCD(1:256) = ''B;                                1415
         L     @07,GRABCURR(,@07)                                  1415
         XC    RECRCD(256,@07),RECRCD(@07)                         1415
*              RECRCD(257:CELEN) = ''B;                            1416
         XC    RECRCD+256(249,@07),RECRCD+256(@07)                 1416
*              RECRCD(506:CILEN) = RDFCIDF;                        1417
*                                                                  1417
         MVC   RECRCD+505(7,@07),RDFCIDF                           1417
*        /************************************************************/
*        /*                                                          */
*        /*   SET RECORD CI TO RABRCDA                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1418
*              RCDCINO = RABRCDA;                                  1418
         MVC   RCDCINO+8(3,@07),RABRCDA+1(@07)                     1418
*            END;                                                  1419
*                                                                  1419
*  CALL EXIT;  /*TERMINATE*/                                       1420
@RF01413 BAL   @14,EXIT                                            1420
*  END RECPHERR; /*END OF PROCEDURE*/                              1421
*                                                                  1421
@EL00016 DS    0H                                                  1421
@EF00016 DS    0H                                                  1421
@ER00016 BR    @14                                                 1421
@PB00016 DS    0H                                                  1422
*        RFY GRAB BASED(RSGRABCU);                                 1422
*                                                                  1422
*  CALL EXIT;  /*TERMINATE*/                                       1423
         BAL   @14,EXIT                                            1423
*  END RECMGMT; /*END OF PROCEDURE*/                               1424
         B     @EL00008                                            1424
@PB00008 DS    0H                                                  1425
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DSCLOSE                                         */
*/*                                                                  */
*/* FUNCTION - CLOSE THE WORKFILE, CATALOG OR A CRA                  */
*/*                                                                  */
*/* INPUT -    W FOR WF, C FOR CAT, R FOR CRA                        */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* RETURN CODES -                                                   */
*/*            0 = SUCCESSFUL                                        */
*/*            4 = CLOSE FAILED                                      */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1425
         DS    0F
NAME06DC DC    CL8'IDCRS6DC'
*IDCRS6DC: PROCEDURE                                               1426
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1426
*                                                                  1426
         B     @PB00017                                            1426
IDCRS6DC DS    0H                                                  1427
*      /*SAVE AND PRIME REGISTERS*/                                1427
*      GENERATE REFS(RS06RG08, REG6);                              1427
*                                                                  1427
         ENTRY IDCRS6DC  EXTERNAL ENTRY POINT
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME06DC+4 PROCNAME TO REGSAVE
*        RFY REG1 RESTRICTED;                                      1428
*                                                                  1428
*        CALL DSCLOSE; /*REG1 HAS PARAM LIST ADDR*/                1429
*                                                                  1429
         BAL   @14,DSCLOSE                                         1429
*        RFY REG1;                                                 1430
*                                                                  1430
*           /*RESTORE CALLER'S REGISTERS AND RETURN*/              1431
*           DO;                                                    1431
*             GENERATE;                                            1432
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*             RETURN CODE(REG15); /*RETURN*/                       1433
@EL00017 DS    0H                                                  1433
@EF00017 DS    0H                                                  1433
@ER00017 BR    @14                                                 1433
*           END;                                                   1434
*                                                                  1434
*           CALL EXIT;  /*TERMINATE*/                              1435
*           END IDCRS6DC; /*END OF PROCEDURE*/                     1436
@PB00017 DS    0H                                                  1437
*                                                                  1437
*      GENERATE;                                                   1437
         DS    0F
NAME0091 DC    CL8'DSCLOSE'
*DSCLOSE: PROCEDURE (DSCDS)                                        1438
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1438
*                                                                  1438
         B     @PB00018                                            1438
DSCLOSE  MVC   @PC00018(4),0(@01)                                  1438
*      GENERATE REFS(RS06RG08, REG6);                              1439
*                                                                  1439
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0091  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  ARGUMENT OF INVOCATION                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1440
*         DCL DSCDS CHAR(1);           /* WF,CAT OR CRA INDICATOR    */
*                                                                  1440
*         OLDERID2 = NEWERID2;                                     1441
         L     @07,GDTTR2(,REG5)                                   1441
         MVC   @TS00001(95),NEWERID2(@07)                          1441
         MVC   OLDERID2(95,@07),@TS00001                           1441
*         NEWID2 = 'RSDC';                                         1442
*                                                                  1442
         MVC   NEWID2(4,@07),@CC03873                              1442
*         /***********************************************************/
*         /*                                                         */
*         /*  DETERMINE DATA SET REQUESTED AND RESET ITS CONTROL     */
*         /*  BLOCKS AND AUDIT FLAG. SET THE IOCSTR POINTER TO       */
*         /*  ITS IOCSTR FOR UCLOSE.                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1443
*                                                                  1443
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1443
*         IF DSCDS = 'W'                                           1443
*           THEN                                                   1443
         L     @07,@PC00018                                        1443
         CLI   DSCDS(@07),C'W'                                     1443
         BNE   @RF01443                                            1443
*             DO;                                                  1444
*                                                                  1444
*                                                                  1444
*               DO;                                                1445
*                 RSRECREQ = ''B;                                  1446
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     1446
*                 RSRTERM = ON;     /* TERMRCD */                  1447
         OI    RSRTERM(REG6),B'00000010'                           1447
*                 RSRWF = ON;       /* WORKFILE */                 1448
*                                                                  1448
         OI    RSRWF(REG6),B'10000000'                             1448
*               CALL RECMGMT;                                      1449
         BAL   @14,RECMGMT                                         1449
*                 RFY RTNREG RSTD;                                 1450
*                 TESTRC = RTNREG;                                 1451
         STH   RTNREG,TESTRC(,REG6)                                1451
*                 RFY RTNREG UNRSTD;                               1452
*               END;                                               1453
*                                                                  1453
*               RSWFOPN = OFF;                                     1454
         NI    RSWFOPN(REG6),B'10111111'                           1454
*               IOCSPTR = RSWFIOCS;                                1455
         L     @07,RSWFIOCS(,REG6)                                 1455
         ST    @07,IOCSPTR(,REG6)                                  1455
*             END;                                                 1456
*                                                                  1456
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1457
*         IF DSCDS = 'C'                                           1457
*           THEN                                                   1457
@RF01443 L     @07,@PC00018                                        1457
         CLI   DSCDS(@07),C'C'                                     1457
         BNE   @RF01457                                            1457
*             DO;                                                  1458
*                                                                  1458
*                                                                  1458
*               DO;                                                1459
*                 RSRECREQ = ''B;                                  1460
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     1460
*                 RSRTERM = ON;     /* TERMRCD */                  1461
         OI    RSRTERM(REG6),B'00000010'                           1461
*                 RSRCAT = ON;      /* CATALOG */                  1462
*                                                                  1462
         OI    RSRCAT(REG6),B'01000000'                            1462
*               CALL RECMGMT;                                      1463
         BAL   @14,RECMGMT                                         1463
*                 RFY RTNREG RSTD;                                 1464
*                 TESTRC = RTNREG;                                 1465
         STH   RTNREG,TESTRC(,REG6)                                1465
*                 RFY RTNREG UNRSTD;                               1466
*               END;                                               1467
*                                                                  1467
*               RSCAOPN = OFF;                                     1468
         NI    RSCAOPN(REG6),B'11101111'                           1468
*               IOCSPTR = RSCAIOCS;                                1469
         L     @07,RSCAIOCS(,REG6)                                 1469
         ST    @07,IOCSPTR(,REG6)                                  1469
*             END;                                                 1470
*                                                                  1470
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECOVERY AREA                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1471
*         IF DSCDS = 'R'                                           1471
*           THEN                                                   1471
@RF01457 L     @07,@PC00018                                        1471
         CLI   DSCDS(@07),C'R'                                     1471
         BNE   @RF01471                                            1471
*             DO;                                                  1472
*                                                                  1472
*                                                                  1472
*               DO;                                                1473
*                 RSRECREQ = ''B;                                  1474
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     1474
*                 RSRTERM = ON;     /* TERMRCD */                  1475
         OI    RSRTERM(REG6),B'00000010'                           1475
*                 RSRCRA = ON;      /* CRA   */                    1476
*                                                                  1476
         OI    RSRCRA(REG6),B'00100000'                            1476
*               CALL RECMGMT;                                      1477
         BAL   @14,RECMGMT                                         1477
*                 RFY RTNREG RSTD;                                 1478
*                 TESTRC = RTNREG;                                 1479
         STH   RTNREG,TESTRC(,REG6)                                1479
*                 RFY RTNREG UNRSTD;                               1480
*               END;                                               1481
*                                                                  1481
*               RSCROPN = OFF;                                     1482
         NI    RSCROPN(REG6),B'11011111'                           1482
*               IOCSPTR = RSCRIOCS;                                1483
         L     @07,RSCRIOCS(,REG6)                                 1483
         ST    @07,IOCSPTR(,REG6)                                  1483
*             END;                                                 1484
*                                                                  1484
*         /***********************************************************/
*         /*                                                         */
*         /*  CLOSE THE DATA SET VIA UCLOSE                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1485
*         CALL IDCIOCL0 (GDTTBL,IOCSPTR);                          1485
*                                                                  1485
@RF01471 ST    REG5,@AL00001                                       1485
         LA    @07,IOCSPTR(,REG6)                                  1485
         ST    @07,@AL00001+4                                      1485
         MVI   @AL00001+4,X'80'                                    1485
         L     @15,GDTCLS(,REG5)                                   1485
         LA    @01,@AL00001                                        1485
         BALR  @14,@15                                             1485
*         RESPECIFY RTNREG RSTD;                                   1486
*         TESTRC = RTNREG;                                         1487
         STH   RTNREG,TESTRC(,REG6)                                1487
*         RESPECIFY RTNREG UNRSTD;                                 1488
*                                                                  1488
*         /***********************************************************/
*         /*                                                         */
*         /*  IF CLOSE FAILED, SET RETURN CODE TO 4,                 */
*         /*  OTHERWISE SET RETURN CODE TO 0.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1489
*         IF TESTRC ^= 0                                           1489
*           THEN                                                   1489
         LH    @07,TESTRC(,REG6)                                   1489
         LTR   @07,@07                                             1489
         BZ    @RF01489                                            1489
*             RSSUBRC = RCUERR1;                                   1490
         MVC   RSSUBRC(4,REG6),@CF00038                            1490
*           ELSE                                                   1491
*             RSSUBRC = 0;                                         1491
*                                                                  1491
         B     @RC01489                                            1491
@RF01489 SLR   @07,@07                                             1491
         ST    @07,RSSUBRC(,REG6)                                  1491
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETE.  RETURN                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1492
*         IF GDTDBG = NULLPTR                                      1492
*           THEN;                                                  1492
@RC01489 L     @07,GDTDBG(,REG5)                                   1492
         LTR   @07,@07                                             1492
         BZ    @RT01492                                            1492
*           ELSE                                                   1494
*             CALL IDCDB010 (GDTTBL,'RSD2');                       1494
*                                                                  1494
         ST    REG5,@AL00001                                       1494
         LA    @07,@CC03874                                        1494
         ST    @07,@AL00001+4                                      1494
         MVI   @AL00001+4,X'80'                                    1494
         L     @15,GDTDBG(,REG5)                                   1494
         LA    @01,@AL00001                                        1494
         BALR  @14,@15                                             1494
*         /*RESTORE CALLER'S REGISTERS AND RETURN*/                1495
*         DO;                                                      1495
@RT01492 DS    0H                                                  1496
*           GENERATE;                                              1496
         L     @13,4(,@13)  RESTORE CALLER'S REG SAVE
         L     @14,12(,@13)  RESTORE RETURN ADDRESS
         LM    @00,@12,20(@13)  RESTORE REGS
         MVI   12(@13),255  MARK END OF SAVE LIST
*           RETURN CODE(RSSUBRC); /*RETURN*/                       1497
         L     @15,RSSUBRC(,REG6)                                  1497
@EL00018 DS    0H                                                  1497
@EF00018 DS    0H                                                  1497
@ER00018 BR    @14                                                 1497
*         END;                                                     1498
*                                                                  1498
*  CALL EXIT;  /*TERMINATE*/                                       1499
*  END DSCLOSE; /*END OF PROCEDURE*/                               1500
@PB00018 DS    0H                                                  1501
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - WFDEF                                           */
*/*                                                                  */
*/* FUNCTION - DEFINE THE RELATIVE RECORD DATA SET TO BE USED        */
*/*            AS THE WORKFILE                                       */
*/*                                                                  */
*/* INPUT -    RSWFPRIM MUST CONTAIN THE PRIMARY ALLOCATION (RECORDS)*/
*/*            RSWFSCND MUST CONTAIN THE SECONDARY ALLOC    (RECORDS)*/
*/*                                                                  */
*/* OUTPUT -   RSWFDSN WILL CONTAIN THE WORKFILE DSNAME              */
*/*            RSWFDS WILL CONTAIN THE ADDRESS OF THE WORKFILE DSNAME*/
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1501
         DS    0F
NAME0102 DC    CL8'WFDEF'
*WFDEF: PROCEDURE                                                  1502
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1502
*                                                                  1502
         B     @PB00019                                            1502
WFDEF    DS    0H                                                  1503
*      GENERATE REFS(RS06RG08, REG6);                              1503
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY WFDEF  ENTRY POINT
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0102  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  DEFINE WORKAREAS                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1504
*         DCL 1 DEFAREAS BDY(HWORD) BASED(RSWFDFAR),               1504
*                                       /*DEFINE WORKAREAS           */
*               2 DEFRWA,               /*AREA FOR RECOVERY VOLSER   */
*                 3 DEFRTLN  FIXED(15), /*LENGTH OF AREA             */
*                 3 DEFRRLN  FIXED(15), /*RETURN LENGTH              */
*                 3 DEFRSER  CHAR(6),   /*RECOVERY VOLSER            */
*               2 DEFVLT,               /*AREA FOR VOLSER LIST       */
*                 3 DEFVLN   FIXED(15), /*LENGTH OF VOLSER LIST      */
*                 3 DEFVLENT (5) CHAR(8),                          1504
*                                       /*VOLSER ENTRY               */
*                   4 DEFVLCDE CHAR(2), /*ALLOCATION STATUS          */
*                   4 DEFVLSER CHAR(6), /*VOLSER                     */
*               2 DEFSTY,               /*SECURITY FPL DATA AREA     */
*                 3 DEFSPSWD (4) CHAR(8),                          1504
*                                       /*PASSWORDS                  */
*                 3 DEFPRMT  CHAR(8),   /*PROMPTING CODE             */
*                 3 DEFATMP  CHAR(2),   /*NUMBER OF ATTEMPTS         */
*                 3 DEFUSVR  CHAR(8),   /*VERIFICATION NAME          */
*                 3 DEFUSAC  CHAR(2),   /*VERIFICATION NAME LENGTH   */
*               2 DEFAMDSB CHAR(LENGTH(IDAAMDSB)),                 1504
*                                       /*AMDSB FPL DATA AREA        */
*               2 DEFSPACE CHAR(7) BDY(BYTE),                      1504
*                                       /*SPACE FPL DATA AREA        */
*                 3 DEFSPRME PTR(24) BDY(BYTE),                    1504
*                                       /*PRIMARY ALLOCATION         */
*                 3 DEFSPSDY PTR(24) BDY(BYTE),                    1504
*                                       /*SECONDARY ALLOCATION       */
*                 3 DEFSPTYP CHAR(1),   /*ALLOCATION TYPE            */
*                   4 *        BIT(1),  /*NOT USED                   */
*                   4 DEFSPRCD BIT(1),  /*RECORD ALLOCATION          */
*                   4 *        BIT(6),  /*NOT USED                   */
*               2 DEFCR,                /*CREATION DATA FPL DATA AREA*/
*                 3 DEFCRTM  CHAR(8),   /*TIME RETURNED FROM UTIME   */
*                 3 DEFCRDT  CHAR(8),   /*DATE RETURNED FROM UTIME   */
*                   4 *        CHAR(1), /*NOT USED                   */
*                   4 DEFCRYR  FIXED(8) BDY(BYTE),                 1504
*                                       /*YEAR                       */
*                   4 DEFCRDAY FIXED(15) BDY(BYTE),                1504
*                                       /*DAY                        */
*                   4 *        CHAR(4), /*NOT USED                   */
*               2 DEFEXPIR CHAR(3),     /*EXPIRATION DATE FPL DATA   */
*               2 DEFDSATT BIT(16),     /*ATTRIBUTES FPL DATA AREA   */
*                 3 DEFDSPD  BIT(1),    /*SPEED OPTION               */
*                 3 *        BIT(9),    /*NOT USED                   */
*                 3 DEFDSHR  BIT(1),    /*SHARE OPTION               */
*                 3 *        BIT(5);    /*NOT USED                   */
*                                                                  1504
*         RFY CTGFV BASED(CTGFVPTR);                               1505
*         RFY IDAAMDSB BASED(RSWFAMDP);                            1506
*                                                                  1506
*         OLDERID2 = NEWERID2;                                     1507
         L     @07,GDTTR2(,REG5)                                   1507
         MVC   @TS00001(95),NEWERID2(@07)                          1507
         MVC   OLDERID2(95,@07),@TS00001                           1507
*         NEWID2 = 'RSWF';                                         1508
*                                                                  1508
         MVC   NEWID2(4,@07),@CC03918                              1508
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN WORKFILE DSNAME AND VOLUME LIST VIA UIOINFO     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1509
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP UIOINFO DSNAME AND VOLUME LIST OPTIONS        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1509
*         IOINFOPT = ''B;                                          1509
         LA    @07,700                                             1509
         ALR   @07,REG6                                            1509
         MVI   IOINFOPT(@07),X'00'                                 1509
*         IOINFVOL = ON;                                           1510
*         IOINFDSN = ON;                                           1511
         OI    IOINFVOL(@07),B'01100000'                           1511
*         RSUIRPT = 0;                                             1512
*                                                                  1512
         SLR   @04,@04                                             1512
         ST    @04,RSUIRPT(,REG6)                                  1512
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE UIOINFO                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1513
*         CALL IDCIOSI0 (GDTTBL,IOINFOPT,RSUIRPT,RSWFDDNM,POOL3);  1513
*                                                                  1513
         ST    REG5,@AL00001                                       1513
         ST    @07,@AL00001+4                                      1513
         LA    @07,RSUIRPT(,REG6)                                  1513
         ST    @07,@AL00001+8                                      1513
         LA    @07,RSWFDDNM(,REG6)                                 1513
         ST    @07,@AL00001+12                                     1513
         LA    @07,@CC00899                                        1513
         ST    @07,@AL00001+16                                     1513
         MVI   @AL00001+16,X'80'                                   1513
         L     @15,GDTIFO(,REG5)                                   1513
         LA    @01,@AL00001                                        1513
         BALR  @14,@15                                             1513
*         RESPECIFY RTNREG RSTD;                                   1514
*         TESTRC = RTNREG;                                         1515
         STH   RTNREG,TESTRC(,REG6)                                1515
*         RESPECIFY RTNREG UNRSTD;                                 1516
*                                                                  1516
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UIOINFO FAILED, CALL CKERR TO TERMINATE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1517
*         IF TESTRC ^= 0                                           1517
*           THEN                                                   1517
         LH    @07,TESTRC(,REG6)                                   1517
         LTR   @07,@07                                             1517
         BZ    @RF01517                                            1517
*             IF TESTRC = RCUERR1                                  1518
*               THEN                                               1518
*                                                                  1518
*                                                                  1518
         C     @07,@CF00038                                        1518
         BNE   @RF01518                                            1518
*                 DO;                                              1519
*                 /*CALL CKERR*/                                   1520
*                   RSCKERR = RSCKERR && RSCKERR;                  1520
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1520
*                   RSCKERN = RSE014;                              1521
         MVC   RSCKERN(2,REG6),@CH00631                            1521
*                   RSCKTERM = 'TERM';                             1522
*                                                                  1522
         MVC   RSCKTERM(4,REG6),@CC03827                           1522
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR      */
*                 CALL CKERR;                                      1523
         L     @15,@CV03452                                        1523
         BALR  @14,@15                                             1523
*                 END;                                             1524
*                                                                  1524
*               ELSE                                               1525
*                                                                  1525
*                                                                  1525
*                 DO;                                              1525
         B     @RC01518                                            1525
@RF01518 DS    0H                                                  1526
*                 /*CALL CKERR*/                                   1526
*                   RSCKERR = RSCKERR && RSCKERR;                  1526
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1526
*                   RSCKERN = RSE099;                              1527
         MVC   RSCKERN(2,REG6),@CH01078                            1527
*                   RSCKTERM = 'TERM';                             1528
*                                                                  1528
         MVC   RSCKTERM(4,REG6),@CC03827                           1528
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR      */
*                 CALL CKERR;                                      1529
         L     @15,@CV03452                                        1529
         BALR  @14,@15                                             1529
*                 END;                                             1530
*                                                                  1530
*         /***********************************************************/
*         /*                                                         */
*         /*    EXTRACT DSNAME AND VOLSER LIST FROM UIOINFO RETURN   */
*         /*    AREA AND SAVE IN MAIN WORKAREA.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1531
*         RSUIRPT = RSUIRPT + UIOHDR;                              1531
*                                                                  1531
@RC01518 DS    0H                                                  1531
@RF01517 LA    @07,4                                               1531
         AL    @07,RSUIRPT(,REG6)                                  1531
         ST    @07,RSUIRPT(,REG6)                                  1531
*WFDFLP1: DO RSIDX3 = 1 TO 2;                                      1532
*                                                                  1532
WFDFLP1  LA    @07,1                                               1532
         STH   @07,RSIDX3(,REG6)                                   1532
@DL01532 DS    0H                                                  1533
*         /***********************************************************/
*         /*                                                         */
*         /*    DSNAME RETURN AREA                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1533
*           IF UIODID = UIODSNID                                   1533
*             THEN                                                 1533
         L     @07,RSUIRPT(,REG6)                                  1533
         CLC   UIODID(2,@07),@CH00212                              1533
         BNE   @RF01533                                            1533
*               DO;                                                1534
*                 RSWFDSN = UIODNM;                                1535
         MVC   RSWFDSN(44,REG6),UIODNM(@07)                        1535
*                 RSWFDS = ADDR(RSWFDSN);                          1536
         LA    @07,RSWFDSN(,REG6)                                  1536
         ST    @07,RSWFDS(,REG6)                                   1536
*               END;                                               1537
*                                                                  1537
*         /***********************************************************/
*         /*                                                         */
*         /*    VOLUME LIST RETURN AREA                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1538
*             ELSE                                                 1538
*               DO;                                                1538
         B     @RC01533                                            1538
@RF01533 DS    0H                                                  1539
*                 RSDFVLCT = UIOVLN/LENGTH(RSDFVLSR);              1539
         L     @07,RSUIRPT(,REG6)                                  1539
         LH    @04,UIOVLN(,@07)                                    1539
         LR    @00,@04                                             1539
         SRDA  @00,32                                              1539
         D     @00,@CF00152                                        1539
         STC   @01,RSDFVLCT(,REG6)                                 1539
*                 RSDFVLSR(1,1:UIOVLN) = UIOVLS(1:UIOVLN);         1540
         BCTR  @04,0                                               1540
         EX    @04,@SM03997                                        1540
*               END;                                               1541
*                                                                  1541
*           RSUIRPT = RSUIRPT + UIODLN + UIOHDR;                   1542
*                                                                  1542
@RC01533 L     @07,RSUIRPT(,REG6)                                  1542
         LH    @04,UIODLN(,@07)                                    1542
         ALR   @04,@07                                             1542
         AL    @04,@CF00038                                        1542
         ST    @04,RSUIRPT(,REG6)                                  1542
*         END WFDFLP1;                                             1543
*                                                                  1543
         LA    @07,1                                               1543
         AH    @07,RSIDX3(,REG6)                                   1543
         STH   @07,RSIDX3(,REG6)                                   1543
         C     @07,@CF00149                                        1543
         BNH   @DL01532                                            1543
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE STORAGE OBTAINED BY UIOINFO                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1544
*         CALL IDCSAFP0 (GDTTBL,POOL3);                            1544
*                                                                  1544
         ST    REG5,@AL00001                                       1544
         LA    @07,@CC00899                                        1544
         ST    @07,@AL00001+4                                      1544
         MVI   @AL00001+4,X'80'                                    1544
         L     @15,GDTFPL(,REG5)                                   1544
         LA    @01,@AL00001                                        1544
         BALR  @14,@15                                             1544
*         /***********************************************************/
*         /*                                                         */
*         /*  DEFINE THE WORKFILE VIA UCATLG.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1545
*                                                                  1545
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE LOCATE CPL POINTER                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1545
*         RSWFSVCP = CTGPLPTR;                                     1545
*                                                                  1545
         L     @07,CTGPLPTR(,REG6)                                 1545
         ST    @07,RSWFSVCP(,REG6)                                 1545
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN STORAGE FOR CPL,FVTS,FPLS AND                 */
*         /*    DEFINE WORKAREAS VIA UGPOOL                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1546
*         RSUGLEN = LENGTH(CTGPL) + DIM(RSWFFVTP) * LENGTH(CTGFV) +
*                DIM(RSWFFPLP) * (LENGTH(CTGFL) + LENGTH(CTGFLDAT)) +
*                LENGTH(DEFAREAS);                                 1546
*                                                                  1546
         MVC   RSUGLEN(4,REG6),@CF03946                            1546
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,CTGPLPTR,POOL3,SETZERO);   1547
*                                                                  1547
         ST    REG5,@AL00001                                       1547
         LA    @07,RSUGLEN(,REG6)                                  1547
         ST    @07,@AL00001+4                                      1547
         LA    @07,CTGPLPTR(,REG6)                                 1547
         ST    @07,@AL00001+8                                      1547
         LA    @07,@CC00899                                        1547
         ST    @07,@AL00001+12                                     1547
         LA    @07,SETZERO                                         1547
         ST    @07,@AL00001+16                                     1547
         MVI   @AL00001+16,X'80'                                   1547
         L     @15,GDTGPL(,REG5)                                   1547
         LA    @01,@AL00001                                        1547
         BALR  @14,@15                                             1547
*         RESPECIFY RTNREG RSTD;                                   1548
*         TESTRC = RTNREG;                                         1549
         STH   RTNREG,TESTRC(,REG6)                                1549
*         RESPECIFY RTNREG UNRSTD;                                 1550
*                                                                  1550
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1551
*         IF TESTRC ^= 0                                           1551
*           THEN                                                   1551
*                                                                  1551
*                                                                  1551
         LH    @07,TESTRC(,REG6)                                   1551
         LTR   @07,@07                                             1551
         BZ    @RF01551                                            1551
*             DO;                                                  1552
*             /*CALL CKERR*/                                       1553
*               RSCKERR = RSCKERR && RSCKERR;                      1553
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1553
*               RSCKERN = RSE099;                                  1554
         MVC   RSCKERN(2,REG6),@CH01078                            1554
*               RSCKTERM = 'TERM';                                 1555
*                                                                  1555
         MVC   RSCKTERM(4,REG6),@CC03827                           1555
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1556
         L     @15,@CV03452                                        1556
         BALR  @14,@15                                             1556
*             END;                                                 1557
*                                                                  1557
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP FVT POINTERS                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1558
*         RSWFFVTP (1) = CTGPLPTR + LENGTH (CTGPL);                1558
@RF01551 LA    @07,28                                              1558
         AL    @07,CTGPLPTR(,REG6)                                 1558
         ST    @07,RSWFFVTP(,REG6)                                 1558
*         RSWFFVTP (2) = RSWFFVTP (1) + LENGTH(CTGFV);             1559
*                                                                  1559
         LA    @04,92                                              1559
         ALR   @07,@04                                             1559
         ST    @07,RSWFFVTP+4(,REG6)                               1559
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP FPL POINTERS                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1560
*         RSWFFPLP (1) = RSWFFVTP (2) + LENGTH(CTGFV);             1560
*                                                                  1560
         ALR   @07,@04                                             1560
         ST    @07,RSWFFPLP(,REG6)                                 1560
*WFDFLP2: DO RSIDX3 = 2 TO DIM(RSWFFPLP);                          1561
*                                                                  1561
WFDFLP2  LA    @07,2                                               1561
         STH   @07,RSIDX3(,REG6)                                   1561
@DL01561 DS    0H                                                  1562
*           RSWFFPLP(RSIDX3) = RSWFFPLP(RSIDX3 - 1) + LENGTH(CTGFL) +
*                              LENGTH(CTGFLDAT);                   1562
*                                                                  1562
         LH    @07,RSIDX3(,REG6)                                   1562
         SLA   @07,2                                               1562
         LA    @04,24                                              1562
         AL    @04,RSWFFPLP-8(@07,REG6)                            1562
         ST    @04,RSWFFPLP-4(@07,REG6)                            1562
*         END WFDFLP2;                                             1563
*                                                                  1563
         LA    @07,1                                               1563
         AH    @07,RSIDX3(,REG6)                                   1563
         STH   @07,RSIDX3(,REG6)                                   1563
         C     @07,@CF00482                                        1563
         BNH   @DL01561                                            1563
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP DEFINE WORKAREAS POINTER                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1564
*         RSWFDFAR = RSWFFPLP(DIM(RSWFFPLP)) + LENGTH(CTGFL) +     1564
*                    LENGTH(CTGFLDAT);                             1564
*                                                                  1564
         LA    @07,24                                              1564
         AL    @07,RSWFFPLP+24(,REG6)                              1564
         ST    @07,RSWFDFAR(,REG6)                                 1564
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE STATIC PORTIONS OF THE CPL                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1565
*         CTGNAME = ON;                                            1565
*         CTGCNAME = ON;                                           1566
         L     @04,CTGPLPTR(,REG6)                                 1566
         OI    CTGNAME(@04),B'00000110'                            1566
*         CTGFUNC = CTGCMS;                                        1567
         NI    CTGFUNC(@04),B'10011111'                            1567
         OI    CTGFUNC(@04),B'10000000'                            1567
*         CTGAM0 = ON;                                             1568
         OI    CTGAM0(@04),B'00000001'                             1568
*         CTGOPTNS = CTGDEFIN;                                     1569
         NI    CTGOPTNS(@04),B'00001111'                           1569
         OI    CTGOPTNS(@04),B'00001000'                           1569
*         CTGWKA = ADDR(UCATWA);                                   1570
         L     @01,RSIOTBL(,REG6)                                  1570
         LA    @15,UCATWA(,@01)                                    1570
         ST    @15,CTGWKA(,@04)                                    1570
*         CTGFVT = RSWFFVTP (1);                                   1571
*                                                                  1571
         L     @15,RSWFFVTP(,REG6)                                 1571
         ST    @15,CTGFVT(,@04)                                    1571
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE WORKCAT INFORMATION IN CPL                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1572
*         CTGCAT = RSWCDS;                                         1572
         L     @14,RSWCDS(,REG6)                                   1572
         ST    @14,CTGCAT(,@04)                                    1572
*         CTGPSWD = RSWCPAS;                                       1573
*                                                                  1573
         L     @14,RSWCPAS(,REG6)                                  1573
         ST    @14,CTGPSWD(,@04)                                   1573
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE STATIC PORTIONS OF CLUSTER FVT            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1574
*         CTGFVPTR = CTGFVT;                                       1574
         ST    @15,CTGFVPTR(,REG6)                                 1574
*         CTGFVTYP = CLID;                                         1575
         MVI   CTGFVTYP(@15),C'C'                                  1575
*         CTGFVDCH = RSWFFVTP (2);                                 1576
         L     @04,RSWFFVTP+4(,REG6)                               1576
         ST    @04,CTGFVDCH(,@15)                                  1576
*         CTGFVCRE = RSWFFPLP (1);                                 1577
         L     @14,RSWFFPLP(,REG6)                                 1577
         ST    @14,CTGFVCRE(,@15)                                  1577
*         CTGFVEXP = RSWFFPLP (2);                                 1578
         L     @14,RSWFFPLP+4(,REG6)                               1578
         ST    @14,CTGFVEXP(,@15)                                  1578
*         CTGFVWKA = ADDR(DEFRWA);                                 1579
*                                                                  1579
*                                                                  1579
         ST    @07,CTGFVWKA(,@15)                                  1579
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE WORKFILE DSNAME POINTER IN CLUSTER FVT         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1580
*         CTGFVENT = RSWFDS;                                       1580
*                                                                  1580
*                                                                  1580
         L     @07,RSWFDS(,REG6)                                   1580
         ST    @07,CTGFVENT(,@15)                                  1580
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKFILE PASSWORD WAS SPECIFIED, PLACE ADDRESS    */
*         /*    OF SECURITY FPL IN CLUSTER FVT AND DATA FVT          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1581
*         IF RSWFPAS ^= 0                                          1581
*           THEN                                                   1581
         L     @07,RSWFPAS(,REG6)                                  1581
         LTR   @07,@07                                             1581
         BZ    @RF01581                                            1581
*             DO;                                                  1582
*               CTGFVSTY = RSWFFPLP (3);                           1583
         L     @07,RSWFFPLP+8(,REG6)                               1583
         ST    @07,CTGFVSTY(,@15)                                  1583
*               CTGFVPTR = CTGFVDCH;                               1584
         ST    @04,CTGFVPTR(,REG6)                                 1584
*               CTGFVSTY = RSWFFPLP (3);                           1585
         ST    @07,CTGFVSTY(,@04)                                  1585
*             END;                                                 1586
*           ELSE                                                   1587
*             CTGFVPTR = CTGFVDCH;                                 1587
*                                                                  1587
         B     @RC01581                                            1587
@RF01581 L     @07,CTGFVPTR(,REG6)                                 1587
         L     @07,CTGFVDCH(,@07)                                  1587
         ST    @07,CTGFVPTR(,REG6)                                 1587
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE STATIC PORTIONS OF DATA FVT               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1588
*         CTGFVTYP = DATAID;                                       1588
@RC01581 L     @07,CTGFVPTR(,REG6)                                 1588
         MVI   CTGFVTYP(@07),C'D'                                  1588
*         CTGFVCRE = RSWFFPLP (1);                                 1589
         L     @04,RSWFFPLP(,REG6)                                 1589
         ST    @04,CTGFVCRE(,@07)                                  1589
*         CTGFVAMD = RSWFFPLP (4);                                 1590
         L     @04,RSWFFPLP+12(,REG6)                              1590
         ST    @04,CTGFVAMD(,@07)                                  1590
*         CTGFVATR = RSWFFPLP (5);                                 1591
         L     @04,RSWFFPLP+16(,REG6)                              1591
         ST    @04,CTGFVATR(,@07)                                  1591
*         CTGFVLRS = RSWFFPLP (6);                                 1592
         L     @04,RSWFFPLP+20(,REG6)                              1592
         ST    @04,CTGFVLRS(,@07)                                  1592
*         CTGFVSPC = RSWFFPLP (7);                                 1593
         L     @04,RSWFFPLP+24(,REG6)                              1593
         ST    @04,CTGFVSPC(,@07)                                  1593
*         CTGFVVLT = ADDR(DEFVLT);                                 1594
*                                                                  1594
         L     @04,RSWFDFAR(,REG6)                                 1594
         LA    @15,DEFVLT(,@04)                                    1594
         ST    @15,CTGFVVLT(,@07)                                  1594
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE WORKFILE DDNAME POINTER IN DATA FVT            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1595
*         CTGFVIND = RSWFDD;                                       1595
*                                                                  1595
         L     @15,RSWFDD(,REG6)                                   1595
         ST    @15,CTGFVIND(,@07)                                  1595
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP DATA FVT VOLUME SERIAL LIST                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1596
*         DEFVLN = RSDFVLCT * LENGTH(DEFVLENT);                    1596
*                                                                  1596
         SLR   @07,@07                                             1596
         IC    @07,RSDFVLCT(,REG6)                                 1596
         SLA   @07,3                                               1596
         STH   @07,DEFVLN(,@04)                                    1596
*WFDFLP3: DO RSIDX3 = 1 TO RSDFVLCT;                               1597
*                                                                  1597
WFDFLP3  LA    @07,1                                               1597
         B     @DE01597                                            1597
@DL01597 DS    0H                                                  1598
*           DEFVLCDE(RSIDX3) = ''B;                                1598
         LH    @07,RSIDX3(,REG6)                                   1598
         LR    @04,@07                                             1598
         SLA   @04,3                                               1598
         L     @15,RSWFDFAR(,REG6)                                 1598
         ST    @04,@TF00001                                        1598
         ALR   @04,@15                                             1598
         XC    DEFVLCDE-8(2,@04),DEFVLCDE-8(@04)                   1598
*           DEFVLSER(RSIDX3) = RSDFVLSR(RSIDX3);                   1599
*                                                                  1599
         AL    @15,@TF00001                                        1599
         MH    @07,@CH00152                                        1599
         ALR   @07,REG6                                            1599
         MVC   DEFVLSER-8(6,@15),RSDFVLSR-6(@07)                   1599
*         END WFDFLP3;                                             1600
*                                                                  1600
         LA    @07,1                                               1600
         AH    @07,RSIDX3(,REG6)                                   1600
@DE01597 STH   @07,RSIDX3(,REG6)                                   1600
         SLR   @04,@04                                             1600
         IC    @04,RSDFVLCT(,REG6)                                 1600
         CR    @07,@04                                             1600
         BNH   @DL01597                                            1600
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE COMMON STATIC PORTIONS OF FPLS            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1601
*WFDFLP4: DO RSIDX3 = 1 TO DIM(RSWFFPLP);                          1601
*                                                                  1601
WFDFLP4  LA    @07,1                                               1601
         STH   @07,RSIDX3(,REG6)                                   1601
@DL01601 DS    0H                                                  1602
*           CTGFLPTR = RSWFFPLP(RSIDX3);                           1602
         LH    @07,RSIDX3(,REG6)                                   1602
         LR    @04,@07                                             1602
         SLA   @04,2                                               1602
         L     @04,RSWFFPLP-4(@04,REG6)                            1602
         ST    @04,CTGFLPTR(,REG6)                                 1602
*           CTGFLDNO = 1;                                          1603
         MVI   CTGFLDNO(@04),X'01'                                 1603
*           CTGFLDNM = ADDR(DEFNMTAB(RSIDX3));                     1604
*                                                                  1604
         SLA   @07,3                                               1604
         LA    @07,DEFNMTAB-8(@07)                                 1604
         ST    @07,CTGFLDNM(,@04)                                  1604
*         END WFDFLP4;                                             1605
*                                                                  1605
         LA    @07,1                                               1605
         AH    @07,RSIDX3(,REG6)                                   1605
         STH   @07,RSIDX3(,REG6)                                   1605
         C     @07,@CF00482                                        1605
         BNH   @DL01601                                            1605
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP CREATION DATE FPL FOR CLUSTER AND             */
*         /*    DATA FVTS                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1606
*         CTGFVPTR = CTGFVT;                                       1606
         L     @07,CTGPLPTR(,REG6)                                 1606
         L     @07,CTGFVT(,@07)                                    1606
         ST    @07,CTGFVPTR(,REG6)                                 1606
*         CTGFLPTR = CTGFVCRE;                                     1607
         L     @07,CTGFVCRE(,@07)                                  1607
         ST    @07,CTGFLPTR(,REG6)                                 1607
*         CTGFLNG(1) = LENGTH(DEFCRYR) + LENGTH(DEFCRDAY);         1608
         MVC   CTGFLNG(4,@07),@CF00158                             1608
*         CTGFLPT(1) = ADDR(DEFCRYR);                              1609
*                                                                  1609
         L     @04,RSWFDFAR(,REG6)                                 1609
         LA    @15,DEFCRYR(,@04)                                   1609
         ST    @15,CTGFLPT(,@07)                                   1609
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN CURRENT DATE VIA UTIME                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1610
*         CALL IDCSATI0 (GDTTBL,DEFCRTM,DEFCRDT);                  1610
*                                                                  1610
         ST    REG5,@AL00001                                       1610
         LA    @07,DEFCRTM(,@04)                                   1610
         ST    @07,@AL00001+4                                      1610
         LA    @07,DEFCRDT(,@04)                                   1610
         ST    @07,@AL00001+8                                      1610
         MVI   @AL00001+8,X'80'                                    1610
         L     @15,GDTTIM(,REG5)                                   1610
         LA    @01,@AL00001                                        1610
         BALR  @14,@15                                             1610
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP EXPIRATION DATE FPL FOR CLUSTER FVT           */
*         /*    USING MAXIMUM EXPIRATION DATE. DATA SET MUST BE      */
*         /*    DELETED WITH PURGE.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1611
*         CTGFLPTR = CTGFVEXP;                                     1611
         L     @07,CTGFVPTR(,REG6)                                 1611
         L     @04,CTGFVEXP(,@07)                                  1611
         ST    @04,CTGFLPTR(,REG6)                                 1611
*         CTGFLNG(1) = LENGTH(DEFEXPIR);                           1612
         MVC   CTGFLNG(4,@04),@CF00158                             1612
*         CTGFLPT(1) = ADDR(DEFEXPIR);                             1613
*                                                                  1613
         L     @15,RSWFDFAR(,REG6)                                 1613
         LA    @14,DEFEXPIR(,@15)                                  1613
         ST    @14,CTGFLPT(,@04)                                   1613
*         DEFEXPIR = MAXEXPDT;                                     1614
*                                                                  1614
         MVC   DEFEXPIR(3,@15),MAXEXPDT                            1614
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP SECURITY FPL FOR CLUSTER FVT                  */
*         /*    AND DATA FVT                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1615
*         IF CTGFVSTY ^= 0                                         1615
*           THEN                                                   1615
         L     @07,CTGFVSTY(,@07)                                  1615
         LTR   @07,@07                                             1615
         BZ    @RF01615                                            1615
*             DO;                                                  1616
*               CTGFLPTR = CTGFVSTY;                               1617
         ST    @07,CTGFLPTR(,REG6)                                 1617
*               CTGFLNG(1) = LENGTH(DEFSTY);                       1618
         MVC   CTGFLNG(4,@07),@CF00989                             1618
*               CTGFLPT(1) = ADDR(DEFSTY);                         1619
*                                                                  1619
         LA    @04,DEFSTY(,@15)                                    1619
         ST    @04,CTGFLPT(,@07)                                   1619
*         /***********************************************************/
*         /*                                                         */
*         /*    USE WORKFILE PASSWORD FOR ALL FOUR PASSWORDS         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1620
*WFDFLP5:       DO RSIDX3 = 1 TO DIM(DEFSPSWD);                    1620
*                                                                  1620
WFDFLP5  LA    @07,1                                               1620
         STH   @07,RSIDX3(,REG6)                                   1620
@DL01620 DS    0H                                                  1621
*                 DEFSPSWD(RSIDX3) = RSWFPS;                       1621
*                                                                  1621
         LH    @07,RSIDX3(,REG6)                                   1621
         SLA   @07,3                                               1621
         L     @04,RSWFDFAR(,REG6)                                 1621
         ALR   @04,@07                                             1621
         MVC   DEFSPSWD-8(8,@04),RSWFPS(REG6)                      1621
*               END WFDFLP5;                                       1622
*                                                                  1622
         LA    @07,1                                               1622
         AH    @07,RSIDX3(,REG6)                                   1622
         STH   @07,RSIDX3(,REG6)                                   1622
         C     @07,@CF00038                                        1622
         BNH   @DL01620                                            1622
*         /***********************************************************/
*         /*                                                         */
*         /*    DO NOT SUPPLY PROMPTING NAME OR VERIFICATION NAME    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1623
*               DEFPRMT = DUMMYNM;                                 1623
         L     @07,RSWFDFAR(,REG6)                                 1623
         MVC   DEFPRMT(8,@07),DUMMYNM                              1623
*               DEFATMP = ''B;                                     1624
         XC    DEFATMP(2,@07),DEFATMP(@07)                         1624
*               DEFUSVR = DUMMYNM;                                 1625
         MVC   DEFUSVR(8,@07),DUMMYNM                              1625
*               DEFUSAC = ''B;                                     1626
*                                                                  1626
         XC    DEFUSAC(2,@07),DEFUSAC(@07)                         1626
*             END;                                                 1627
*                                                                  1627
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP AMDSB FPL FOR DATA FVT                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1628
*         CTGFVPTR = CTGFVDCH;                                     1628
@RF01615 L     @07,CTGFVPTR(,REG6)                                 1628
         L     @07,CTGFVDCH(,@07)                                  1628
         ST    @07,CTGFVPTR(,REG6)                                 1628
*         CTGFLPTR = CTGFVAMD;                                     1629
         L     @04,CTGFVAMD(,@07)                                  1629
         ST    @04,CTGFLPTR(,REG6)                                 1629
*         CTGFLNG(1) = LENGTH(IDAAMDSB);                           1630
         LA    @15,96                                              1630
         ST    @15,CTGFLNG(,@04)                                   1630
*         CTGFLPT(1) = ADDR(DEFAMDSB);                             1631
*                                                                  1631
         L     @14,RSWFDFAR(,REG6)                                 1631
         LA    @03,DEFAMDSB(,@14)                                  1631
         ST    @03,CTGFLPT(,@04)                                   1631
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CONTROL INTERVAL SIZE, RECORD SIZE AND           */
*         /*    RRDS OPTION                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1632
*         RSWFAMDP = ADDR(DEFAMDSB);                               1632
         ST    @03,RSWFAMDP(,REG6)                                 1632
*         AMDLEN = LENGTH(IDAAMDSB);                               1633
         STH   @15,AMDLEN(,@03)                                    1633
*         AMDCINV = CILEN;                                         1634
         MVC   AMDCINV(4,@03),@CF00740                             1634
*         AMDLRECL = CELEN;                                        1635
         LA    @04,505                                             1635
         ST    @04,AMDLRECL(,@03)                                  1635
*         AMDRRDS = ON;                                            1636
*                                                                  1636
         OI    AMDRRDS(@03),B'00000010'                            1636
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP DATA SET ATTRIBUTES FPL FOR DATA FVT          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1637
*         CTGFLPTR = CTGFVATR;                                     1637
         L     @15,CTGFVATR(,@07)                                  1637
         ST    @15,CTGFLPTR(,REG6)                                 1637
*         CTGFLNG(1) = LENGTH(DEFDSATT);                           1638
         MVC   CTGFLNG(4,@15),@CF00471                             1638
*         CTGFLPT(1) = ADDR(DEFDSATT);                             1639
*                                                                  1639
         LA    @03,DEFDSATT(,@14)                                  1639
         ST    @03,CTGFLPT(,@15)                                   1639
*         /***********************************************************/
*         /*                                                         */
*         /*    SET SPEED AND DEFAULT SHARE OPTIONS                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1640
*         DEFDSPD = ON;                                            1640
         OI    DEFDSPD(@14),B'10000000'                            1640
*         DEFDSHR = ON;                                            1641
*                                                                  1641
         OI    DEFDSHR(@14),B'00100000'                            1641
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP RECORD SIZE FPL FOR DATA FVT                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1642
*         CTGFLPTR = CTGFVLRS;                                     1642
         L     @15,CTGFVLRS(,@07)                                  1642
         ST    @15,CTGFLPTR(,REG6)                                 1642
*         RSWFLR = CELEN;                                          1643
         ST    @04,RSWFLR(,REG6)                                   1643
*         CTGFLNG(1) = LENGTH(RSWFLR);                             1644
         MVC   CTGFLNG(4,@15),@CF00038                             1644
*         CTGFLPT(1) = ADDR(RSWFLR);                               1645
*                                                                  1645
         LA    @04,RSWFLR(,REG6)                                   1645
         ST    @04,CTGFLPT(,@15)                                   1645
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP SPACE FPL FOR DATA FVT.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1646
*         CTGFLPTR = CTGFVSPC;                                     1646
         L     @07,CTGFVSPC(,@07)                                  1646
         ST    @07,CTGFLPTR(,REG6)                                 1646
*         CTGFLNG(1) = LENGTH(DEFSPACE);                           1647
         MVC   CTGFLNG(4,@07),@CF00482                             1647
*         CTGFLPT(1) = ADDR(DEFSPACE);                             1648
*                                                                  1648
         LA    @04,DEFSPACE(,@14)                                  1648
         ST    @04,CTGFLPT(,@07)                                   1648
*         /***********************************************************/
*         /*                                                         */
*         /*    SET PRIMARY AND SECONDARY ALLOCATION. SET RECORD     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1649
*         DEFSPRME = RSWFPRIM;                                     1649
         MVC   DEFSPRME(3,@14),RSWFPRIM+1(REG6)                    1649
*         DEFSPSDY = RSWFSCND;                                     1650
         MVC   DEFSPSDY(3,@14),RSWFSCND+1(REG6)                    1650
*         DEFSPRCD = ON;                                           1651
*                                                                  1651
         OI    DEFSPRCD(@14),B'01000000'                           1651
*         /***********************************************************/
*         /*                                                         */
*         /*    SET LENGTH OF WORKAREAS                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1652
*         UCATWTLN = LENGTH(UCATWA);                               1652
         L     @07,RSIOTBL(,REG6)                                  1652
         MVC   UCATWTLN(2,@07),@CH03740                            1652
*         DEFRTLN = LENGTH(DEFRWA);                                1653
*                                                                  1653
         MVC   DEFRTLN(2,@14),@CH00034                             1653
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE UCATLG TO DEFINE THE WORKFILE                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1654
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1654
*                                                                  1654
         ST    REG5,@AL00001                                       1654
         LA    @07,CTGPLPTR(,REG6)                                 1654
         ST    @07,@AL00001+4                                      1654
         L     @15,GDTCAT(,REG5)                                   1654
         LA    @01,@AL00001                                        1654
         BALR  @14,@15                                             1654
*         RESPECIFY RTNREG RSTD;                                   1655
*         TESTRC = RTNREG;                                         1656
         STH   RTNREG,TESTRC(,REG6)                                1656
*         RESPECIFY RTNREG UNRSTD;                                 1657
*                                                                  1657
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UCATLG FAILED, CALL CKERR TO TERMINATE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1658
*         IF TESTRC ^= 0                                           1658
*           THEN                                                   1658
         LH    @07,TESTRC(,REG6)                                   1658
         LTR   @07,@07                                             1658
         BZ    @RF01658                                            1658
*             DO;                                                  1659
*               RSCATRC = TESTRC;                                  1660
*                                                                  1660
*                                                                  1660
         STH   @07,RSCATRC(,REG6)                                  1660
*               DO;                                                1661
*               /*CALL CKERR*/                                     1662
*                 RSCKERR = RSCKERR && RSCKERR;                    1662
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1662
*                 RSCKERN = RSE035;                                1663
         MVC   RSCKERN(2,REG6),@CH00848                            1663
*                 RSCKTERM = 'RETU';                               1664
*                                                                  1664
         MVC   RSCKTERM(4,REG6),@CC03514                           1664
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1665
         L     @15,@CV03452                                        1665
         BALR  @14,@15                                             1665
*               END;                                               1666
*                                                                  1666
*                                                                  1666
*               DO;                                                1667
*               /*CALL CKERR*/                                     1668
*                 RSCKERR = RSCKERR && RSCKERR;                    1668
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1668
*                 RSCKERN = RSE012;                                1669
         MVC   RSCKERN(2,REG6),@CH00032                            1669
*                 RSCKTERM = 'TERM';                               1670
*                                                                  1670
         MVC   RSCKTERM(4,REG6),@CC03827                           1670
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1671
         L     @15,@CV03452                                        1671
         BALR  @14,@15                                             1671
*               END;                                               1672
*                                                                  1672
*             END;                                                 1673
*                                                                  1673
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE DEFINED. SET AUDIT FLAG.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1674
*         RSWFDEF = ON;                                            1674
*                                                                  1674
@RF01658 OI    RSWFDEF(REG6),B'10000000'                           1674
*         IF GDTDBG = NULLPTR                                      1675
*           THEN;                                                  1675
         L     @07,GDTDBG(,REG5)                                   1675
         LTR   @07,@07                                             1675
         BZ    @RT01675                                            1675
*           ELSE                                                   1677
*             CALL IDCDB010 (GDTTBL,'RSW2');                       1677
*                                                                  1677
         ST    REG5,@AL00001                                       1677
         LA    @07,@CC03929                                        1677
         ST    @07,@AL00001+4                                      1677
         MVI   @AL00001+4,X'80'                                    1677
         L     @15,GDTDBG(,REG5)                                   1677
         LA    @01,@AL00001                                        1677
         BALR  @14,@15                                             1677
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE UCATLG WORKAREA STORAGE                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1678
*         CALL IDCSAFP0 (GDTTBL,POOL3);                            1678
*                                                                  1678
@RT01675 ST    REG5,@AL00001                                       1678
         LA    @07,@CC00899                                        1678
         ST    @07,@AL00001+4                                      1678
         MVI   @AL00001+4,X'80'                                    1678
         L     @15,GDTFPL(,REG5)                                   1678
         LA    @01,@AL00001                                        1678
         BALR  @14,@15                                             1678
*         /***********************************************************/
*         /*                                                         */
*         /*  RESTORE CPL POINTER                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1679
*         CTGPLPTR = RSWFSVCP;                                     1679
*                                                                  1679
         L     @07,RSWFSVCP(,REG6)                                 1679
         ST    @07,CTGPLPTR(,REG6)                                 1679
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1680
*  CALL EXIT;  /*TERMINATE*/                                       1680
         BAL   @14,EXIT                                            1680
*  END WFDEF; /*END OF PROCEDURE*/                                 1681
@EL00019 DS    0H                                                  1681
@EF00019 DS    0H                                                  1681
@ER00019 BR    @14                                                 1681
@PB00019 DS    0H                                                  1682
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - WFDEL                                           */
*/*                                                                  */
*/* FUNCTION - DELETE THE RELATIVE RECORD DATA SET USED              */
*/*            AS THE WORKFILE                                       */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1682
         DS    0F
NAME0114 DC    CL8'WFDEL'
*WFDEL: PROCEDURE                                                  1683
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1683
*                                                                  1683
         B     @PB00020                                            1683
WFDEL    DS    0H                                                  1684
*      GENERATE REFS(RS06RG08, REG6);                              1684
*                                                                  1684
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY WFDEL  ENTRY POINT
         LM    @08,@12,RS06RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0114  PROCNAME TO REGSAVE
*         OLDERID2 = NEWERID2;                                     1685
         L     @07,GDTTR2(,REG5)                                   1685
         MVC   @TS00001(95),NEWERID2(@07)                          1685
         MVC   OLDERID2(95,@07),@TS00001                           1685
*         NEWID2 = 'RSWD';                                         1686
*                                                                  1686
         MVC   NEWID2(4,@07),@CC03934                              1686
*         /***********************************************************/
*         /*                                                         */
*         /*  RESET WORKFILE DEFINED AUDIT FLAG                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1687
*         RSWFDEF = OFF;                                           1687
*                                                                  1687
         NI    RSWFDEF(REG6),B'01111111'                           1687
*         /***********************************************************/
*         /*                                                         */
*         /*  DELETE WORKFILE VIA UCATLG.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1688
*                                                                  1688
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE STATIC PORTIONS OF THE CPL                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1688
*         CTGPL = ''B;                                             1688
         L     @07,CTGPLPTR(,REG6)                                 1688
         XC    CTGPL(28,@07),CTGPL(@07)                            1688
*         CTGNAME = ON;                                            1689
*         CTGCNAME = ON;                                           1690
         OI    CTGNAME(@07),B'00000110'                            1690
*         CTGAM0 = ON;                                             1691
         OI    CTGAM0(@07),B'00000001'                             1691
*         CTGFUNC = CTGCMS;                                        1692
         NI    CTGFUNC(@07),B'10011111'                            1692
         OI    CTGFUNC(@07),B'10000000'                            1692
*         CTGOPTNS = CTGDELET;                                     1693
         NI    CTGOPTNS(@07),B'00011111'                           1693
         OI    CTGOPTNS(@07),B'00011000'                           1693
*         CTGTYPE = CLID;                                          1694
         MVI   CTGTYPE(@07),C'C'                                   1694
*         CTGPURG = ON;                                            1695
         OI    CTGPURG(@07),B'00100000'                            1695
*         CTGWKA = ADDR(UCATWA);                                   1696
         L     @04,RSIOTBL(,REG6)                                  1696
         LA    @15,UCATWA(,@04)                                    1696
         ST    @15,CTGWKA(,@07)                                    1696
*         UCATWTLN = LENGTH(UCATWA);                               1697
*                                                                  1697
         MVC   UCATWTLN(2,@04),@CH03740                            1697
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE WORKCAT NAME POINTER IN CPL                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1698
*         CTGCAT = RSWCDS;                                         1698
*                                                                  1698
         L     @04,RSWCDS(,REG6)                                   1698
         ST    @04,CTGCAT(,@07)                                    1698
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKFILE PASSWORD WAS SPECIFIED, PLACE POINTER TO */
*         /*    IT IN CPL, OTHERWISE PLACE WORKCAT PASSWORD POINTER  */
*         /*    IN CPL                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1699
*         IF RSWFPAS ^= 0                                          1699
*           THEN                                                   1699
         L     @04,RSWFPAS(,REG6)                                  1699
         LTR   @04,@04                                             1699
         BZ    @RF01699                                            1699
*             CTGPSWD = RSWFPAS;                                   1700
         ST    @04,CTGPSWD(,@07)                                   1700
*           ELSE                                                   1701
*             CTGPSWD = RSWCPAS;                                   1701
*                                                                  1701
         B     @RC01699                                            1701
@RF01699 L     @07,CTGPLPTR(,REG6)                                 1701
         L     @04,RSWCPAS(,REG6)                                  1701
         ST    @04,CTGPSWD(,@07)                                   1701
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE WORKFILE DDNAME AND DSNAME POINTERS IN CPL     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1702
*         CTGDDNM = RSWFDD;                                        1702
@RC01699 L     @07,CTGPLPTR(,REG6)                                 1702
         L     @04,RSWFDD(,REG6)                                   1702
         ST    @04,CTGDDNM(,@07)                                   1702
*         CTGENT = RSWFDS;                                         1703
*                                                                  1703
         L     @04,RSWFDS(,REG6)                                   1703
         ST    @04,CTGENT(,@07)                                    1703
*         /***********************************************************/
*         /*                                                         */
*         /*  ISSUE UCATLG TO DELETE WORKFILE                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1704
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1704
*                                                                  1704
         ST    REG5,@AL00001                                       1704
         LA    @07,CTGPLPTR(,REG6)                                 1704
         ST    @07,@AL00001+4                                      1704
         L     @15,GDTCAT(,REG5)                                   1704
         LA    @01,@AL00001                                        1704
         BALR  @14,@15                                             1704
*         RESPECIFY RTNREG RSTD;                                   1705
*         TESTRC = RTNREG;                                         1706
         STH   RTNREG,TESTRC(,REG6)                                1706
*         RESPECIFY RTNREG UNRSTD;                                 1707
*                                                                  1707
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UCATLG FAILED, CALL CKERR TO PRINT TERMINATE      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1708
*         IF TESTRC ^= 0                                           1708
*           THEN                                                   1708
         LH    @07,TESTRC(,REG6)                                   1708
         LTR   @07,@07                                             1708
         BZ    @RF01708                                            1708
*             DO;                                                  1709
*               RSCATRC = TESTRC;                                  1710
*                                                                  1710
*                                                                  1710
         STH   @07,RSCATRC(,REG6)                                  1710
*               DO;                                                1711
*               /*CALL CKERR*/                                     1712
*                 RSCKERR = RSCKERR && RSCKERR;                    1712
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1712
*                 RSCKERN = RSE035;                                1713
         MVC   RSCKERN(2,REG6),@CH00848                            1713
*                 RSCKTERM = 'RETU';                               1714
*                                                                  1714
         MVC   RSCKTERM(4,REG6),@CC03514                           1714
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1715
         L     @15,@CV03452                                        1715
         BALR  @14,@15                                             1715
*               END;                                               1716
*                                                                  1716
*                                                                  1716
*               DO;                                                1717
*               /*CALL CKERR*/                                     1718
*                 RSCKERR = RSCKERR && RSCKERR;                    1718
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1718
*                 RSCKERN = RSE077;                                1719
         MVC   RSCKERN(2,REG6),@CH01037                            1719
*                 RSCKTERM = 'TERM';                               1720
*                                                                  1720
         MVC   RSCKTERM(4,REG6),@CC03827                           1720
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1721
         L     @15,@CV03452                                        1721
         BALR  @14,@15                                             1721
*               END;                                               1722
*                                                                  1722
*             END;                                                 1723
*                                                                  1723
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1724
*         IF GDTDBG = NULLPTR                                      1724
*           THEN;                                                  1724
@RF01708 L     @07,GDTDBG(,REG5)                                   1724
         LTR   @07,@07                                             1724
         BZ    @RT01724                                            1724
*           ELSE                                                   1726
*             CALL IDCDB010 (GDTTBL,'RSW3');                       1726
*                                                                  1726
         ST    REG5,@AL00001                                       1726
         LA    @07,@CC03935                                        1726
         ST    @07,@AL00001+4                                      1726
         MVI   @AL00001+4,X'80'                                    1726
         L     @15,GDTDBG(,REG5)                                   1726
         LA    @01,@AL00001                                        1726
         BALR  @14,@15                                             1726
*         RFY CTGFV BASED(CTGFVT);                                 1727
*                                                                  1727
@RT01724 DS    0H                                                  1728
*  CALL EXIT;  /*TERMINATE*/                                       1728
         BAL   @14,EXIT                                            1728
*  END WFDEL; /*END OF PROCEDURE*/                                 1729
*                                                                  1729
@EL00020 DS    0H                                                  1729
@EF00020 DS    0H                                                  1729
@ER00020 BR    @14                                                 1729
@PB00020 DS    0H                                                  1730
*      GENERATE;                                                   1730
         DS    0F
         DC    CL8'EXIT'
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       1731
*                                                                  1731
         B     @PB00021                                            1731
EXIT     DS    0H                                                  1732
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     1732
         L     @13,4(,@13)
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             1733
         LM    @14,@12,12(@13)
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        1734
         MVI   12(@13),255
*        GEN(BR    14);  /*RETURN*/                                1735
         BR    14
*END EXIT;  /*END OF PROC EXIT*/                                   1736
*                                                                  1736
@EL00021 DS    0H                                                  1736
@EF00021 DS    0H                                                  1736
@ER00021 BR    @14                                                 1736
*END IDCRS06   /*END OF MODULE*/                                   1737
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        *
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (AMCBS   )                                        *
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        *
*/*%INCLUDE SYSLIB  (IFGACB  )                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        *
*/*%INCLUDE SYSLIB  (IDARMRCD)                                        *
*;                                                                 1737
@EL00001 DS    0H                                                  1737
@EF00001 DS    0H                                                  1737
@ER00001 LM    @14,@12,12(@13)                                     1737
         BR    @14                                                 1737
@DATA    DS    0H
@CH00212 DC    H'1'
@CH00034 DC    H'10'
@CH00033 DC    H'11'
@CH00032 DC    H'12'
@CH00631 DC    H'14'
@CH00848 DC    H'35'
@CH00595 DC    H'44'
@CH01037 DC    H'77'
@CH01045 DC    H'81'
@CH01047 DC    H'82'
@CH01049 DC    H'83'
@CH01053 DC    H'85'
@CH01055 DC    H'86'
@CH01078 DC    H'99'
@CH00143 DC    H'100'
@CH03740 DC    H'104'
@SM03971 MVC   ALLVLSR(0,@07),CRAMVLSR(@14)
@SM03984 MVC   RECIORCD(0,@07),RECRCD(@01)
@SM03986 MVC   RECIORCD+256(0,@04),RECRCD+256(@15)
@SM03988 MVC   RECRCD(0,@07),RECIORCD(@04)
@SM03990 MVC   RECRCD+256(0,@07),RECIORCD+256(@15)
@SM03997 MVC   RSDFVLSR(0,REG6),UIOVLS(@07)
@DATD    DSECT
         DS    0F
@PC00003 DS    1F
@PC00005 DS    3F
@PC00007 DS    6F
@PC00014 DS    1F
@PC00018 DS    1F
@AL00001 DS    5A
@TF00001 DS    F
IDCRS06  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00149 DC    F'2'
@CF00158 DC    F'3'
@CF00038 DC    F'4'
@CF00152 DC    F'6'
@CH00152 EQU   @CF00152+2
@CF00482 DC    F'7'
@CF00175 DC    F'8'
@CH00175 EQU   @CF00175+2
@CF00471 DC    F'16'
@CF00747 DC    F'47'
@CF00989 DC    F'52'
@CF01845 DC    F'127'
@CF03810 DC    F'257'
@CF00738 DC    F'505'
@CF00740 DC    F'512'
@CF03946 DC    F'608'
@CF03995 DC    F'-8'
@CF03996 DC    F'-4'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL95
         DS    CL1
FDTTBL   DS    CL8
         ORG   FDTTBL
FDTVERB  DS    CL8
FDTPTR   DS    0A
         ORG   FDTTBL+8
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRS06  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV03452 DC    V(CKERR)
@CV03453 DC    V(ADDTN)
@CV03451 DC    V(ADDUPCR)
@CV03430 DC    V(ASSOC)
@CV03463 DC    V(CATEOV)
@CV03428 DC    V(CATINIT)
@CV03433 DC    V(CATRCDSU)
@CV03435 DC    V(CHKDSDIR)
@CV03462 DC    V(CNVTCCHH)
@CV03458 DC    V(CRAEOV)
@CV03455 DC    V(CRAUPCHN)
@CV03443 DC    V(DELGO)
@CV03454 DC    V(DELTN)
@CV03457 DC    V(ENSURECI)
@CV03444 DC    V(FIND)
@CV03460 DC    V(FRCRCCR)
@CV03456 DC    V(GENNAME)
@CV03438 DC    V(GETFIT)
@CV03439 DC    V(GETNEXTE)
@CV03440 DC    V(GETTAB)
@CV03445 DC    V(GETVIA)
@CV03450 DC    V(IDCRS5BR)
@CV03449 DC    V(IDCRS5BV)
@CV03446 DC    V(IDCRS5EN)
@CV03448 DC    V(IDCRS5SR)
@CV03447 DC    V(IDCRS5SV)
@CV03464 DC    V(IDCRS7SP)
@CV03432 DC    V(LOCDIT)
@CV03434 DC    V(MARKUNUS)
@CV03442 DC    V(MODGO)
@CV03431 DC    V(PROCTYPE)
@CV03437 DC    V(PROCVOL)
@CV03459 DC    V(RENAMEF)
@CV03465 DC    V(RENAMEP)
@CV03461 DC    V(UPDCCR)
@CV03441 DC    V(VERB)
@CV03436 DC    V(VOLCHK)
@CV03429 DC    V(WRAPUP)
         DS    0D
MAXCINO  DC    XL4'3FFFFF'
@CC00774 DC    C'SYSALLDA'
@CC00899 DC    C'RS03'
@CC03488 DC    C'RSCD'
@CC03490 DC    C'RSC6'
@CC03513 DC    C'RSCM'
@CC03514 DC    C'RETU'
@CC03515 DC    C'RSC5'
@CC03538 DC    C'DSDO'
@CC03545 DC    C'RSD1'
@CC03782 DC    C'RSRC'
@CC03795 DC    C'RSR2'
@CC03827 DC    C'TERM'
@CC03873 DC    C'RSDC'
@CC03874 DC    C'RSD2'
@CC03918 DC    C'RSWF'
@CC03929 DC    C'RSW2'
@CC03934 DC    C'RSWD'
@CC03935 DC    C'RSW3'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
TNTYPES  DC    CL11'CDIAXBVUMGR'
MAXEXPDT DC    X'99999F'
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'
RDFCIDF  DC    X'0001F901F90000'
PACKF    DC    X'0F'
DSCB1ID  DC    X'F1'
VOLUNUSE DC    X'0000'
NULLDIG  DC    X'00'
BADVOLSW DC    X'00'
FMT3NULL DC    X'0000000000'
DS4DSNM  DS    CL44
         ORG   DS4DSNM
@NM00040 DC    44X'04'
         ORG   DS4DSNM+44
MODID    DC    CL4'RS06'
         DS    CL1
PATCH    DS    CL1024
         ORG   PATCH
@NM00216 DC    CL12'PATCHAREA 1K'
@NM00217 DC    CL256'0'
         DC    CL256' '
         DC    CL256' '
         DC    CL244' '
         ORG   PATCH+1024
TRTBLE   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
DEFNMTAB DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'PASSWALL'
         DC    CL8'AMDSBCAT'
         DC    CL8'DSATTR'
         DC    CL8'LRECL'
         DC    CL8'SPACPARM'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG1     EQU   @01
REG5     EQU   @05
REG6     EQU   @06
REG8     EQU   @08
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG0     EQU   @00
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG7     EQU   @07
REG9     EQU   @09
CVTPTR   EQU   16
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTIOH   EQU   GDTTBL+36
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSACA0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPO0 EQU   0
IDCIOGT0 EQU   0
IDCIOPT0 EQU   0
IDCIOVY0 EQU   0
IDCIOSI0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMACUP EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMAC2  EQU   IOCSTR+19
IOCMACSK EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCCHP   EQU   IOCSTR+20
IOCCHPSQ EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPNU EQU   IOCCHP
IOCMSG   EQU   IOCSTR+21
IOCCHPKE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCKYA   EQU   IOCMEM
IOCNWM   EQU   IOCSTR+48
IOCPTL   EQU   IOCNWM
IOCREL   EQU   IOCSTR+60
IOCEXT   EQU   IOCSTR+64
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTOT EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPRA EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNDSOAM EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
OPNSTRNO EQU   OPNAGL+43
IOINFOPT EQU   0
IOINFVOL EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CATNM    EQU   0
CATNMFLG EQU   CATNM+10
CATDN    EQU   0
MRPW     EQU   0
WCAT     EQU   0
WCATFLG  EQU   WCAT+10
CRADN    EQU   0
CRAVL    EQU   0
CRADV    EQU   0
WFILE    EQU   0
IODATA   EQU   0
IODSID   EQU   IODATA+16
IOCSEX   EQU   0
IOCRPL   EQU   IOCSEX+4
IOCLRP   EQU   IOCSEX+10
IOCWKA   EQU   IOCSEX+12
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCFLG   EQU   IOCSEX+32
IOCDEV   EQU   IOCSEX+33
IOCINF   EQU   IOCSEX+34
IOCMOD   EQU   IOCSEX+35
IOCDLM   EQU   IOCSEX+36
IOCDDN   EQU   IOCDLM
IOCRCV   EQU   IOCSEX+44
CATIEXT  EQU   0
VOLSERTB EQU   0
VOLSRFLG EQU   VOLSERTB+8
RESVOL   EQU   0
RESVLFLG EQU   RESVOL+8
RESVLSER EQU   RESVOL+14
RSF1RNTB EQU   0
RSWORK   EQU   0
RSALLAGP EQU   RSWORK+4
RSCABHP1 EQU   RSWORK+12
RSCABLP1 EQU   RSWORK+16
RSCAIOCS EQU   RSWORK+40
RSCPE1   EQU   RSWORK+68
RSCPE2   EQU   RSWORK+72
RSCPE5   EQU   RSWORK+84
RSCPE6   EQU   RSWORK+88
RSCPE7   EQU   RSWORK+92
RSCRIOCS EQU   RSWORK+100
RSGCITS  EQU   RSWORK+108
RSGCITC  EQU   RSGCITS+8
@NM00045 EQU   RSGCITS+20
RSGDITS  EQU   RSWORK+136
RSGDITC  EQU   RSGDITS+8
@NM00048 EQU   RSGDITS+20
RSPSTACK EQU   RSWORK+164
RSPTWKC  EQU   RSPSTACK+8
RSTAB    EQU   RSWORK+192
RSTANCHR EQU   RSTAB
@NM00053 EQU   RSTAB+8
@NM00055 EQU   RSTAB+12
RSXXREGS EQU   RSWORK+212
RS01REGS EQU   RSXXREGS
RS02REGS EQU   RSXXREGS+20
RS03REGS EQU   RSXXREGS+40
RS04REGS EQU   RSXXREGS+60
RS05REGS EQU   RSXXREGS+80
RS06REGS EQU   RSXXREGS+100
RS06RG08 EQU   RS06REGS
RS06RG09 EQU   RS06REGS+4
RS07REGS EQU   RSXXREGS+120
RSCRBP1  EQU   RSWORK+372
RSIOTBL  EQU   RSWORK+412
RSRABWA  EQU   RSWORK+416
RSWFPRIM EQU   RSWORK+420
RSWFSCND EQU   RSWORK+424
RSGRABCU EQU   RSWORK+428
RSRMBP   EQU   RSWORK+432
RSWFBP1  EQU   RSWORK+436
RSWFBP2  EQU   RSWORK+440
RSWFNEXT EQU   RSWORK+444
RSENTPT  EQU   RSWORK+484
RSXCIEND EQU   RSWORK+496
RSWCDS   EQU   RSWORK+512
RSWCPAS  EQU   RSWORK+516
RSWFDD   EQU   RSWORK+520
RSWFPAS  EQU   RSWORK+524
RSWFDS   EQU   RSWORK+528
RSVTBENT EQU   RSWORK+532
RSWFIOCS EQU   RSWORK+540
CAXWAPTR EQU   RSWORK+568
CBSPTR   EQU   RSWORK+572
CTGPLPTR EQU   RSWORK+576
CTGFLPTR EQU   RSWORK+580
CTGFVPTR EQU   RSWORK+584
RSCIXLTA EQU   RSWORK+600
RSUIRPT  EQU   RSWORK+612
RSUGLEN  EQU   RSWORK+616
RSSUBRC  EQU   RSWORK+624
RSF1RNCU EQU   RSWORK+656
RSORVLLS EQU   RSWORK+668
RSIDX3   EQU   RSWORK+692
RSUIOPT  EQU   RSWORK+700
RSWFDDNM EQU   RSWORK+822
RSWFDSN  EQU   RSWORK+830
RSDFVLCT EQU   RSWORK+874
RSDFVLSR EQU   RSWORK+875
RSWFPS   EQU   RSWORK+957
RSNEWCAT EQU   RSWORK+965
RSFLAGSN EQU   RSWORK+979
RSFLAGN1 EQU   RSFLAGSN
RSWFDEF  EQU   RSFLAGN1
RSWFOPN  EQU   RSFLAGN1
RSCROPN  EQU   RSFLAGN1
RSCAOPN  EQU   RSFLAGN1
RSIGNR   EQU   RSFLAGN1
RSFLAGN2 EQU   RSFLAGSN+1
RSALLC   EQU   RSFLAGN2
RSFLAGSI EQU   RSWORK+981
RSFLAGI1 EQU   RSFLAGSI
RSFLAGI2 EQU   RSFLAGSI+1
RSOPDYN  EQU   RSFLAGI2+1
RSRECREQ EQU   RSWORK+984
RSRTYPE  EQU   RSRECREQ
RSRGET   EQU   RSRTYPE
RSRADD   EQU   RSRTYPE
RSRUPDT  EQU   RSRTYPE
RSRPOS   EQU   RSRTYPE
RSRDEL   EQU   RSRTYPE
RSRINIT  EQU   RSRTYPE
RSRTERM  EQU   RSRTYPE
RSRFREE  EQU   RSRTYPE
RSROPT   EQU   RSRECREQ+1
RSRDS    EQU   RSROPT
RSRWF    EQU   RSRDS
RSRCAT   EQU   RSRDS
RSRCRA   EQU   RSRDS
RSRBY    EQU   RSROPT
RSRKEY   EQU   RSRBY
RSRFOR   EQU   RSROPT
RSRUPD   EQU   RSRFOR
RSRUSE   EQU   RSROPT
RSRDIR   EQU   RSRUSE
RSREND   EQU   RSROPT
RSRCHK   EQU   RSROPT
RSASSOC  EQU   RSWORK+988
RSASSTBL EQU   RSASSOC
RSASSFLG EQU   RSASSOC+16
RSASSFL1 EQU   RSASSFLG
RSGDG    EQU   RSASSOC+20
RSGDGTB  EQU   RSGDG
RSPROCVL EQU   RSWORK+1064
RSMAPS   EQU   RSPROCVL
RSSBMAP  EQU   RSMAPS+8
RSPCBMAP EQU   RSMAPS+12
RSMAPAD  EQU   RSPROCVL+20
RSPVSNT  EQU   RSPROCVL+48
RSPVTTNN EQU   RSPROCVL+68
@NM00062 EQU   RSPROCVL+84
RSPVSETB EQU   @NM00062
RSPVFLG1 EQU   @NM00062+1
RSPVFLG2 EQU   @NM00062+2
RSEOVWA  EQU   RSWORK+1152
@NM00065 EQU   RSEOVWA+8
@NM00067 EQU   RSEOVWA+12
RSEOVFLG EQU   @NM00067+1
RSGETVIA EQU   RSWORK+1168
RSVIACRA EQU   RSGETVIA
@NM00072 EQU   RSGETVIA+12
RSVIAFLG EQU   @NM00072
@NM00074 EQU   RSGETVIA+16
RSREASW  EQU   RSWORK+1188
RSCKERR  EQU   RSWORK+1192
RSCKERN  EQU   RSCKERR
RSCKTERM EQU   RSCKERR+4
RSCKMVAR EQU   RSCKERR+8
RSCKERRW EQU   RSWORK+1240
RSLASTCC EQU   RSCKERRW
RSCKTIME EQU   RSCKERRW+8
RSCATRC  EQU   RSCKERRW+42
RSCKFLAG EQU   RSCKERRW+50
RSCIWA   EQU   RSWORK+1292
RSCIEXPT EQU   RSCIWA
RSINWA   EQU   RSWORK+1340
RSINDVL  EQU   RSINWA+24
RSINATR1 EQU   RSINWA+53
RSINFLGS EQU   RSINWA+54
RSRNWA   EQU   RSWORK+1488
RSRNPLST EQU   RSRNWA
RSRNFLGS EQU   RSRNWA+46
RSRNVL   EQU   RSRNWA+99
RSRNUL   EQU   RSRNWA+106
RSRWORK  EQU   RSWORK+1604
RSRGRBPT EQU   RSRWORK
RSRRC    EQU   RSRWORK+4
RSRSVARG EQU   RSRWORK+16
RSRRPL   EQU   RSRWORK+20
RSRXLFND EQU   RSRWORK+28
RSRCRARN EQU   RSRWORK+32
RSRCATRN EQU   RSRWORK+34
RSRWFRN  EQU   RSRWORK+36
RSRRCPY  EQU   RSRWORK+38
RSRRLN   EQU   RSRWORK+40
RSMSGRC  EQU   RSRWORK+42
RSMSGCI  EQU   RSRWORK+45
RSRSVFLG EQU   RSRWORK+48
RSRLU    EQU   RSRWORK+58
RSRLG    EQU   RSRWORK+59
RSRI     EQU   RSRWORK+60
RSRU     EQU   RSRWORK+61
RSRIXNO  EQU   RSRWORK+62
RSRX     EQU   RSRWORK+63
RSRFLGS  EQU   RSRWORK+64
RSROKSW  EQU   RSRFLGS
RSRXTRY  EQU   RSRFLGS
RSRXSW   EQU   RSRFLGS
RSRSKPSW EQU   RSRFLGS
RSWFWA   EQU   RSWORK+1672
RSWFSVCP EQU   RSWFWA
RSWFFVTP EQU   RSWFWA+4
RSWFFPLP EQU   RSWFWA+12
RSWFDFAR EQU   RSWFWA+40
RSWFLR   EQU   RSWFWA+44
RSWFAMDP EQU   RSWFWA+48
RSADWA   EQU   RSWORK+1724
RSADVL   EQU   RSADWA+32
RSADUL   EQU   RSADWA+39
RSCRWA   EQU   RSWORK+1772
RSGENWRK EQU   RSWORK+1780
RSGENDTE EQU   RSGENWRK+12
RSVOLWA  EQU   RSWORK+1796
RSVF1TS  EQU   RSVOLWA+52
RSVF1EXT EQU   RSVOLWA+75
RSVFLAGS EQU   RSVOLWA+140
RSDF00W  EQU   RSWORK+1940
LISTSCAN EQU   RSDF00W+4
IOCSPTR  EQU   RSDF00W+8
OPNPTR   EQU   RSDF00W+12
DDSTRU   EQU   RSDF00W+16
FSADDR   EQU   RSDF00W+20
ERCNVADR EQU   RSDF00W+24
DMPINDEX EQU   RSDF00W+28
TESTRC   EQU   RSDF00W+34
RSCNVTCC EQU   RSWORK+1980
RSCCHHP  EQU   RSCNVTCC+4
RSTTNN   EQU   RSCNVTCC+8
RSCNVTCF EQU   RSCNVTCC+12
RSCNVTF1 EQU   RSCNVTCF
RSWFNDWA EQU   RSWORK+1996
RSWASNVT EQU   RSWFNDWA+4
RSWSNFLG EQU   RSWFNDWA+8
RSGENMWA EQU   RSWORK+2052
RSGENAM  EQU   RSGENMWA+9
RSGDATE  EQU   RSGENAM+21
RSGTIME  EQU   RSGENAM+26
RSCDSDWA EQU   RSWORK+2108
RSCDSDIN EQU   RSCDSDWA
RSCDSDW  EQU   RSCDSDWA+16
RSMARKUN EQU   RSWORK+2144
RSCSWA   EQU   RSWORK+2152
GRAB     EQU   0
GRABFLGS EQU   GRAB
GRABAFLS EQU   GRABFLGS+1
GRABAFL1 EQU   GRABAFLS
GRABSFXT EQU   GRABAFL1
GRABSNRA EQU   GRABAFL1
GRABSEFN EQU   GRABAFL1
GRABSIOI EQU   GRABAFL1
GRABSIOF EQU   GRABAFL1
GRABSIOT EQU   GRABAFL1
GRABSNRN EQU   GRABAFL1
GRABSDUP EQU   GRABAFL1
GRABAFL2 EQU   GRABAFLS+1
GRABSNRF EQU   GRABAFL2
GRABSN   EQU   GRAB+3
GRABCURR EQU   GRAB+12
GRABRABS EQU   GRAB+16
RSRAB    EQU   0
RABFLGS  EQU   RSRAB
RABFLG1  EQU   RABFLGS
RABINUSE EQU   RABFLG1
RABUPD   EQU   RABFLG1
RABADD   EQU   RABFLG1
RABRRN   EQU   RABFLG1
RABIOIGN EQU   RABFLG1
RABNRF   EQU   RABFLG1
RABDUP   EQU   RABFLG1
RABRCDA  EQU   RSRAB+4
RABBUF   EQU   RSRAB+8
RABPROC  EQU   RSRAB+520
RMB      EQU   0
RMBCTL   EQU   RMB
RMBRPL   EQU   RMBCTL
RMBARG   EQU   RMBCTL+4
RMBFLAGS EQU   RMBCTL+8
RMBSEQ   EQU   RMBFLAGS
RMBDIR   EQU   RMBFLAGS
RMBUPD   EQU   RMBFLAGS
RMBKEY   EQU   RMBFLAGS
RMBKEQ   EQU   RMBFLAGS
RMBGETU  EQU   RMBFLAGS
RMBKEYA  EQU   RMB+12
RSXCIXLT EQU   0
RSXCIENT EQU   RSXCIXLT+8
RSXCIBEG EQU   RSXCIENT
RSXCILN  EQU   RSXCIENT+4
RSXCIFLG EQU   RSXCIENT+8
RSXCIFL1 EQU   RSXCIFLG
RSXCIREL EQU   RSXCIENT+12
UIODSN   EQU   0
UIODID   EQU   UIODSN
UIODLN   EQU   UIODSN+2
UIODNM   EQU   UIODSN+4
UIOVOL   EQU   0
UIOVLN   EQU   UIOVOL+2
UIOVLS   EQU   UIOVOL+4
RECIOWA  EQU   0
GRABSWF  EQU   RECIOWA
GRABSCA  EQU   RECIOWA+40
GRABSCR  EQU   RECIOWA+80
WFDRMB   EQU   RECIOWA+120
WFSRMB   EQU   RECIOWA+156
CRARMB   EQU   RECIOWA+168
CATLRMB  EQU   RECIOWA+180
CATHRMB  EQU   RECIOWA+192
RSOPNAGL EQU   RECIOWA+248
RSALLAGL EQU   RECIOWA+632
ALLUL    EQU   RECIOWA+784
ALLULC   EQU   ALLUL
ALLULLN  EQU   ALLUL+2
ALLULNM  EQU   ALLUL+4
ALLVL    EQU   RECIOWA+796
ALLVLC   EQU   ALLVL
ALLVLLN  EQU   ALLVL+2
ALLVLSR  EQU   ALLVL+4
RSCAMINN EQU   RECIOWA+816
UCATWA   EQU   RECIOWA+874
UCATWTLN EQU   UCATWA
RECPTRCD EQU   RECIOWA+978
RSCNCCHH EQU   0
TASSENT  EQU   0
TASSFL1  EQU   TASSENT+1
TASSO    EQU   0
TABANCHR EQU   0
TABC     EQU   TABANCHR+8
@NM00102 EQU   TABANCHR+20
TABHEAD  EQU   0
THEAD    EQU   TABHEAD
PTWORK   EQU   0
PTYPEDTA EQU   PTWORK+12
PTGCIT   EQU   PTYPEDTA
@NM00104 EQU   PTGCIT
@NM00106 EQU   PTGCIT+4
@NM00108 EQU   PTGCIT+8
PTCITCUR EQU   PTGCIT+12
PTGDIT   EQU   PTYPEDTA+24
@NM00110 EQU   PTGDIT
@NM00112 EQU   PTGDIT+4
@NM00114 EQU   PTGDIT+8
PTDITCUR EQU   PTGDIT+12
PTASSO   EQU   PTYPEDTA+48
PTASSCUR EQU   PTASSO+4
PTASSOEA EQU   PTASSO+8
PTASSOE1 EQU   PTASSO+12
PTASSOE  EQU   PTASSOE1
PTASSEXP EQU   PTASSO+52
PTINDX   EQU   PTYPEDTA+104
PTVERDI  EQU   PTYPEDTA+120
PTVALL   EQU   PTVERDI
PTVDI    EQU   PTVALL
PTXALIAS EQU   PTYPEDTA+152
PTXFLAGS EQU   PTXALIAS+30
PTXFLAG1 EQU   PTXFLAGS
PTFLAGS  EQU   PTYPEDTA+190
PTF1     EQU   PTFLAGS
PTF2     EQU   PTFLAGS+1
PTLOC    EQU   PTWORK+204
@NM00120 EQU   PTLOC
@NM00122 EQU   PTLOC+12
PTLDITFB EQU   PTLOC+18
PTASOE   EQU   0
GCITS    EQU   0
CITABE   EQU   0
CITFLA   EQU   CITABE
@NM00127 EQU   CITABE+4
@NM00128 EQU   CITABE+8
@NM00129 EQU   CITABE+12
@NM00131 EQU   CITABE+16
GDITS    EQU   0
DITABE   EQU   0
DITFA    EQU   DITABE
DITFLB   EQU   DITABE+1
@NM00140 EQU   DITABE+4
DITSN    EQU   @NM00140
DITVSN   EQU   DITSN
@NM00143 EQU   DITABE+8
GDGLDS   EQU   0
GDGLHEAD EQU   GDGLDS
GDGFLG   EQU   GDGLHEAD+30
GDGLENTS EQU   GDGLDS+32
GDGENT   EQU   GDGLENTS
RSFSNVT  EQU   0
RSFLAGS  EQU   RSFSNVT+1
RSFAENT  EQU   RSFSNVT+8
RSFATTNN EQU   RSFSNVT+16
SNTAB    EQU   0
SNFIXED  EQU   SNTAB
SNFLAG   EQU   SNFIXED
SNENTRY  EQU   SNTAB+24
SNVDATA  EQU   SNENTRY
SSPHDFLG EQU   SNVDATA+8
SSPEXTNT EQU   SNVDATA+10
SNASSOC  EQU   0
SNGLEV   EQU   SNASSOC+28
SNVGO    EQU   0
SITYPEXT EQU   SNVGO+34
SNEXTENT EQU   SNVGO+43
SNVSBM   EQU   0
SNDSDIR  EQU   0
SDSIDFLG EQU   SNDSDIR+24
SNTTNN   EQU   0
CATGOPT  EQU   0
CATGOCI  EQU   CATGOPT
CATGOFLG EQU   CATGOCI
CATGOGC1 EQU   CATGOPT+3
CATGOSEQ EQU   CATGOPT+4
CATRCD   EQU   0
RCDCINO  EQU   CATRCD+1
REPCNTRL EQU   0
EXTRCDPT EQU   REPCNTRL
VARFIELD EQU   0
VARLEN   EQU   VARFIELD
CNTRLINF EQU   0
CTGRBASE EQU   0
CATTR    EQU   CTGRBASE+107
CATTR1   EQU   CATTR
CATTR2   EQU   CATTR+1
COPEN    EQU   CTGRBASE+109
CSPACPRM EQU   CTGRBASE+114
CCR      EQU   0
ASGO     EQU   0
ASG1     EQU   ASGO+2
ASG2     EQU   ASGO+6
ASGOGDG  EQU   0
DSDIR    EQU   0
SPACEPRM EQU   0
SPCOPTNS EQU   SPACEPRM+6
RGATTRFL EQU   0
RGATTR1  EQU   RGATTRFL
RGATTSG1 EQU   RGATTRFL+1
VOLGO    EQU   0
GDGRCD   EQU   0
GENLVLS  EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGGTNXT EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGTYPE  EQU   CTGPL+18
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVDCH EQU   CTGFV+4
CTGFVIND EQU   CTGFV+16
CTGFVENT EQU   CTGFV+20
CTGFVSTY EQU   CTGFV+24
CTGFVEXP EQU   CTGFV+32
CTGFVCRE EQU   CTGFV+36
CTGFVVLT EQU   CTGFV+40
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVATR EQU   CTGFV+60
CTGFVLRS EQU   CTGFV+68
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CTGFVWKA EQU   CTGFV+88
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
AMCBS    EQU   0
CBSCMP   EQU   AMCBS+16
CBSVSRT  EQU   AMCBS+32
IGGCAXWA EQU   0
CAXFLGS  EQU   IGGCAXWA+8
CAXFLG2  EQU   IGGCAXWA+9
CAXFLG3  EQU   IGGCAXWA+10
CAXCCR   EQU   IGGCAXWA+32
CAXCNAM  EQU   IGGCAXWA+52
CAXOPLST EQU   IGGCAXWA+96
COPTS    EQU   CAXOPLST
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBDVIND EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDRRDS  EQU   AMDATTR
AMDLEN   EQU   IDAAMDSB+2
AMDNEST  EQU   IDAAMDSB+4
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
CRADUDN  EQU   0
CRAMUDN  EQU   0
CRAMVL   EQU   0
CRAMVLLN EQU   CRAMVL
CRAMVLSR EQU   CRAMVL+1
CRAMUL   EQU   0
CRAMULLN EQU   CRAMUL
CRAMULNM EQU   CRAMUL+1
DSOUDDN  EQU   0
DSORDDN  EQU   0
RECIORCD EQU   0
RECIODSN EQU   0
RECISTRT EQU   0
RECICNT  EQU   0
RECIXLTE EQU   0
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLERREG EQU   RPLRTNCD
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
DEFAREAS EQU   0
DEFRWA   EQU   DEFAREAS
DEFRTLN  EQU   DEFRWA
DEFVLT   EQU   DEFAREAS+10
DEFVLN   EQU   DEFVLT
DEFVLENT EQU   DEFVLT+2
DEFVLCDE EQU   DEFVLENT
DEFVLSER EQU   DEFVLENT+2
DEFSTY   EQU   DEFAREAS+52
DEFSPSWD EQU   DEFSTY
DEFPRMT  EQU   DEFSTY+32
DEFATMP  EQU   DEFSTY+40
DEFUSVR  EQU   DEFSTY+42
DEFUSAC  EQU   DEFSTY+50
DEFAMDSB EQU   DEFAREAS+104
DEFSPACE EQU   DEFAREAS+200
DEFSPRME EQU   DEFSPACE
DEFSPSDY EQU   DEFSPACE+3
DEFSPTYP EQU   DEFSPACE+6
DEFSPRCD EQU   DEFSPTYP
DEFCR    EQU   DEFAREAS+207
DEFCRTM  EQU   DEFCR
DEFCRDT  EQU   DEFCR+8
DEFCRYR  EQU   DEFCRDT+1
DEFCRDAY EQU   DEFCRDT+2
DEFEXPIR EQU   DEFAREAS+223
DEFDSATT EQU   DEFAREAS+226
DEFDSPD  EQU   DEFDSATT
DEFDSHR  EQU   DEFDSATT+1
ALLP     EQU   0
ALLPPTR  EQU   0
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
BMAP     EQU   0
CABUFH1  EQU   0
CABUFL1  EQU   0
CAT      EQU   0
CATSN    EQU   0
CFILE    EQU   0
CFILECNT EQU   0
CIN      EQU   0
CRADNPTR EQU   0
CRADVPTR EQU   0
CRAVLPTR EQU   0
CRBUF1   EQU   0
CVOL     EQU   0
CVOLCNT  EQU   0
DMPTRM   EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIO050 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IGN      EQU   0
LASTCC   EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NIGN     EQU   0
NONE     EQU   0
NONEPTR  EQU   0
PTASSEX  EQU   0
RABS     EQU   0
RECIOKEY EQU   0
WFBUF1   EQU   0
WFBUF2   EQU   0
WFDN     EQU   0
CRADDDP  EQU   0
CRAMVLP  EQU   0
CRAMULP  EQU   0
CRAMDDP  EQU   0
DSOTYP   EQU   0
DSODS    EQU   0
DSOOP    EQU   0
DSODDNP  EQU   0
DSODSNP  EQU   0
DSOPSWP  EQU   0
RECXLCI  EQU   0
DSCDS    EQU   0
RSWFLD   EQU   RABPROC
RSWFKG1  EQU   RSWFLD+8
RSWFLG2  EQU   RSWFLD+9
RABARRAY EQU   GRABRABS
@NM00165 EQU   CATTR1
CCATTR   EQU   @NM00165
@NM00166 EQU   CCATTR
@NM00168 EQU   CATTR1
CRGATTR  EQU   @NM00168
CUPG     EQU   CRGATTR
DEVCHARS EQU   RABBUF+101
@NM00177 EQU   DEVCHARS
RTDEVUCB EQU   @NM00177
RTBOKAB  EQU   @NM00177+14
RTDVFLGS EQU   @NM00177+17
@NM00191 EQU   CTGDDNM
CTGPROB  EQU   @NM00191
CTGREASN EQU   CTGPROB+2
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
RECRCD   EQU   RABBUF
RECFFLG  EQU   RABPROC
RECKEYA  EQU   RABRCDA
RECHL    EQU   RABBUF
BMAPARRY EQU   RSMAPS
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
RTTOLFCT EQU   @NM00177+18
RTTOLFLG EQU   RTDVFLGS
@NM00180 EQU   RTDVFLGS
RTKABFLG EQU   RTDVFLGS
@NM00179 EQU   RTDVFLGS
RTBONK   EQU   @NM00177+16
RTBOKLB  EQU   RTBOKAB+1
RTBOKNLB EQU   RTBOKAB
RTTRKSIZ EQU   @NM00177+12
RTNOTRKS EQU   @NM00177+10
RTNOCYLS EQU   @NM00177+8
RTMXDBLK EQU   @NM00177+4
RTCLSTYP EQU   RTDEVUCB+2
@NM00178 EQU   RTDEVUCB
@NM00169 EQU   CRGATTR
CUPD     EQU   CUPG
CPGSP    EQU   @NM00166
@NM00167 EQU   @NM00166
@NM00094 EQU   RSWFLG2
RSWCHRA  EQU   RSWFLG2
RSWCHNRR EQU   RSWFLG2
RSWDSDIR EQU   RSWFLG2
RSWUPCCH EQU   RSWFLG2
RSWDICHK EQU   RSWFLG2
RSWDUPRR EQU   RSWFLG2
RSWINVCI EQU   RSWFLG2
RSWDUPCI EQU   RSWFKG1
RSWASSCK EQU   RSWFKG1
RSWRASCI EQU   RSWFKG1
@NM00093 EQU   RSWFKG1
RSWUPCRA EQU   RSWFKG1
RSWUPCAT EQU   RSWFKG1
RSWDLCAT EQU   RSWFKG1
RSWFCRA  EQU   RSWFKG1
RSWDUPTR EQU   RSWFLD+4
RSWCHPTR EQU   RSWFLD
@NM00226 EQU   DEFDSATT+1
@NM00225 EQU   DEFDSATT
@NM00224 EQU   DEFCRDT+4
@NM00223 EQU   DEFCRDT
@NM00222 EQU   DEFSPTYP
@NM00221 EQU   DEFSPTYP
DEFRSER  EQU   DEFRWA+4
DEFRRLN  EQU   DEFRWA+2
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00220 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00219 EQU   RPLRBAR+3
@NM00218 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLWAITX EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLAREA  EQU   RPLCOMN+32
RPLTCBPT EQU   RPLCOMN+28
RPLDACB  EQU   RPLCOMN+24
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00215 EQU   IDAAMDSB+41
@NM00214 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDKEYLN EQU   IDAAMDSB+8
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDSPAN  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00213 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
@NM00212 EQU   ACBINFLG+1
ACBBYPSS EQU   ACBINFLG
ACBSDS   EQU   ACBVVIC
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00211 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00210 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00209 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00208 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00207 EQU   ACBDSORG
ACBOPTJ  EQU   ACBDVIND
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00206 EQU   ACBCCTYP
ACBTRCID EQU   ACBCCTYP
@NM00205 EQU   ACBRECFM
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00204 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00203 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00202 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
CAXCRACB EQU   IGGCAXWA+112
CAXJDE   EQU   IGGCAXWA+108
CAXCCA   EQU   IGGCAXWA+104
CAXOPEWA EQU   IGGCAXWA+100
COPACB   EQU   CAXOPLST+1
@NM00201 EQU   COPTS
CENLST   EQU   COPTS
@NM00200 EQU   CAXCNAM+22
CAXRADDN EQU   CAXCNAM+14
CAXRATEP EQU   CAXCNAM+10
CAXRACTS EQU   CAXCNAM+6
CAXVOLID EQU   CAXCNAM
CAXRPL   EQU   IGGCAXWA+48
CAXRPLCT EQU   IGGCAXWA+46
CAXASID  EQU   IGGCAXWA+44
CAXFDCI  EQU   CAXCCR+9
CAXCDCI  EQU   CAXCCR+6
CAXNFCI  EQU   CAXCCR+3
CAXHACI  EQU   CAXCCR
CAXUCB   EQU   IGGCAXWA+28
CAXACB   EQU   IGGCAXWA+24
CAXDRWP  EQU   IGGCAXWA+20
CAXSCHWA EQU   IGGCAXWA+16
CAXATIOT EQU   IGGCAXWA+12
CAXACT   EQU   IGGCAXWA+11
@NM00199 EQU   CAXFLG3
CAXF3B6  EQU   CAXFLG3
CAXF3B5  EQU   CAXFLG3
@NM00198 EQU   CAXFLG3
CAXF3ANE EQU   CAXFLG3
CAXF3AT  EQU   CAXFLG3
CAXF2VTU EQU   CAXFLG2
CAXF2REC EQU   CAXFLG2
CAXF2CA  EQU   CAXFLG2
CAXF2CLR EQU   CAXFLG2
CAXF2IOE EQU   CAXFLG2
CAXF2NCR EQU   CAXFLG2
CAXF2NDD EQU   CAXFLG2
CAXF2DT  EQU   CAXFLG2
CAXSCR   EQU   CAXFLGS
CAXCMR   EQU   CAXFLGS
CAXMCT   EQU   CAXFLGS
CAXCMP   EQU   CAXFLGS
CAXEOV   EQU   CAXFLGS
CAXCLS   EQU   CAXFLGS
CAXOPN   EQU   CAXFLGS
CAXBLD   EQU   CAXFLGS
CAXCHN   EQU   IGGCAXWA+4
@NM00197 EQU   IGGCAXWA+1
CAXID    EQU   IGGCAXWA
CBSVPTR  EQU   CBSVSRT+4
CBSVUSE  EQU   CBSVSRT
CBSCRTCB EQU   AMCBS+28
CBSCRACA EQU   AMCBS+24
CBSCAXCN EQU   AMCBS+20
CBSMCUCB EQU   CBSCMP
CBSCBP   EQU   AMCBS+12
CBSACB   EQU   AMCBS+8
CBSMCSTA EQU   AMCBS+4
CBSSIZ   EQU   AMCBS+2
CBSID    EQU   AMCBS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00196 EQU   CVTFIX+248
@NM00195 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
CTGFVPWD EQU   CTGFV+84
CTGFVNAM EQU   CTGFV+80
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVBUF EQU   CTGFV+64
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
CTGFVDVT EQU   CTGFV+48
CTGFVRNG EQU   CTGFV+44
CTGFVOWN EQU   CTGFV+28
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
@NM00194 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00193 EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00192 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFIELD EQU   CTGPL+28
@NM00190 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGNOFLD EQU   CTGPL+19
@NM00189 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00188 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00187 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00186 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGUCRAX EQU   CTGGTNXT
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
GDGLVL   EQU   GENLVLS+2
@NM00185 EQU   GENLVLS
@NM00184 EQU   GDGRCD+108
GDGLIMIT EQU   GDGRCD+107
@NM00183 EQU   GDGRCD
@NM00182 EQU   VOLGO+34
NOBLKTRK EQU   VOLGO+32
@NM00181 EQU   VOLGO
@NM00176 EQU   RGATTSG1
RGATSUP1 EQU   RGATTSG1
@NM00175 EQU   RGATTR1
RGATTUPG EQU   RGATTR1
SPCROUND EQU   SPCOPTNS
SPCALXRQ EQU   SPCOPTNS
SPCMXIGR EQU   SPCOPTNS
SPCCNTIG EQU   SPCOPTNS
@NM00174 EQU   SPCOPTNS
SPCRQTYP EQU   SPCOPTNS
SPCSECDQ EQU   SPACEPRM+3
SPCPRIMQ EQU   SPACEPRM
DSSUMTT  EQU   DSDIR+9
DSCRETS  EQU   DSDIR+5
DSIDNO   EQU   DSDIR+2
@NM00173 EQU   DSDIR
ASGDGLVL EQU   ASGOGDG+6
@NM00172 EQU   ASGOGDG+2
@NM00171 EQU   ASGOGDG
ASCI2    EQU   ASG2+1
ASTYPE2  EQU   ASG2
ASCI     EQU   ASG1+1
ASTYPE   EQU   ASG1
@NM00170 EQU   ASGO
CCRRBAS  EQU   CCR+57
CCRFDCI  EQU   CCR+54
CCRCDCI  EQU   CCR+51
CCRNFCI  EQU   CCR+48
CCRHACI  EQU   CCR+45
CCRID    EQU   CCR+44
CCRKEY   EQU   CCR
CEXT     EQU   CTGRBASE+135
CDOSUINF EQU   CTGRBASE+133
CLRECL   EQU   CTGRBASE+129
CHIA     EQU   CTGRBASE+125
CHIU     EQU   CTGRBASE+121
CSORT    EQU   CSPACPRM+6
CSEC     EQU   CSPACPRM+3
CPRIM    EQU   CSPACPRM
CBUF     EQU   CTGRBASE+110
@NM00164 EQU   COPEN
COPENDS  EQU   COPEN
CNUS     EQU   CATTR2
@NM00163 EQU   CATTR2
CATTRSSH EQU   CATTR2
CATTRISH EQU   CATTR2
CTRKOV   EQU   CATTR1
CTEMP    EQU   CATTR1
CINHIB   EQU   CATTR1
CRECOV   EQU   CATTR1
CERASE   EQU   CATTR1
CREUSE   EQU   CATTR1
CUNIQ    EQU   CATTR1
CSP      EQU   CATTR1
CEXP     EQU   CTGRBASE+104
CCRE     EQU   CTGRBASE+101
COWNID   EQU   CTGRBASE+93
CNAME    EQU   CTGRBASE+49
@NM00162 EQU   CTGRBASE
LENFIX   EQU   CNTRLINF+1
CNTVAR   EQU   CNTRLINF
VARINFO  EQU   VARFIELD+2
REPGOPT  EQU   REPCNTRL+6
REPCNT   EQU   REPCNTRL+5
@NM00161 EQU   EXTRCDPT+3
EXTGOCI  EQU   EXTRCDPT
NREPLF   EQU   CATRCD+48
NREPCV   EQU   CATRCD+47
RCDSIZ   EQU   CATRCD+45
RCDID    EQU   CATRCD+44
@NM00160 EQU   CATRCD+26
RCDDICTS EQU   CATRCD+22
RCDRACTS EQU   CATRCD+18
RCDCRADT EQU   CATRCD+14
RCDCRACI EQU   CATRCD+11
RCDCRAVL EQU   CATRCD+5
RCDRELID EQU   CATRCD+4
RCDKEYTY EQU   CATRCD
CATGOGC  EQU   CATGOGC1
CATGODEL EQU   CATGOGC1
CATGOEXT EQU   CATGOGC1
CATGODSP EQU   CATGOCI+1
@NM00159 EQU   CATGOFLG
SNNN     EQU   SNTTNN+2
SNTT     EQU   SNTTNN
SDSSUMTT EQU   SNDSDIR+32
SDSCRETS EQU   SNDSDIR+28
SDSIDNO  EQU   SNDSDIR+25
@NM00158 EQU   SDSIDFLG
SDSEXT   EQU   SDSIDFLG
@NM00157 EQU   SNDSDIR
SNLBM    EQU   SNVSBM+28
SNABM    EQU   SNVSBM+24
@NM00156 EQU   SNVSBM
@NM00155 EQU   SNEXTENT+16
@NM00154 EQU   SNEXTENT+12
NTR      EQU   SNEXTENT+10
@NM00153 EQU   SNEXTENT+8
@NM00152 EQU   SNEXTENT+6
SHH      EQU   SNEXTENT+4
SCC      EQU   SNEXTENT+2
SS       EQU   SNEXTENT
SNEXTI   EQU   SNVGO+42
SNTTNNMC EQU   SNVGO+41
SNTTNNC  EQU   SNVGO+40
SNTTNNX  EQU   SNVGO+39
SNVGOSS  EQU   SNVGO+37
SDSDIRSN EQU   SNVGO+35
SNSSWD   EQU   SITYPEXT
SNVOLSER EQU   SNVGO+28
SNDEVTYP EQU   SNVGO+24
@NM00151 EQU   SNVGO
SNNAME2  EQU   SNGLEV+1
SNTYPE2  EQU   SNGLEV
SNNAME   EQU   SNASSOC+25
SNTYPE   EQU   SNASSOC+24
@NM00150 EQU   SNASSOC
SSPEXTNN EQU   SSPEXTNT
SNODSPXT EQU   SNVDATA+9
SNVSPCAT EQU   SSPHDFLG
@NM00149 EQU   SSPHDFLG
SNVSPUNQ EQU   SSPHDFLG
SDSCBTS  EQU   SNVDATA
SNVGOEL  EQU   SNFIXED+20
SNEGOP   EQU   SNFIXED+16
SNECI    EQU   SNFIXED+13
SNAGOP   EQU   SNFIXED+11
SNACI    EQU   SNFIXED+8
SNGOP    EQU   SNFIXED+6
SNCI     EQU   SNFIXED+3
SNSN     EQU   SNFIXED+1
@NM00148 EQU   SNFLAG
SNFINC   EQU   SNFLAG
SNFMOD   EQU   SNFLAG
SNFPROC  EQU   SNFLAG
SNFALT   EQU   SNFLAG
SNFDEL   EQU   SNFLAG
SNFUSE   EQU   SNFLAG
RSFCILST EQU   RSFSNVT+28
RSFCADR  EQU   RSFSNVT+24
RSFABMAP EQU   RSFSNVT+20
RSFLENBM EQU   RSFSNVT+14
RSFCNTTN EQU   RSFSNVT+12
RSFCNDX  EQU   RSFSNVT+6
RSFHNDX  EQU   RSFSNVT+4
RSFENTLN EQU   RSFSNVT+3
RSFGCODE EQU   RSFSNVT+2
@NM00147 EQU   RSFLAGS
RSFINVTY EQU   RSFLAGS
RSFNRF   EQU   RSFLAGS
@NM00146 EQU   RSFSNVT
GDGLVLT  EQU   GDGENT
@NM00145 EQU   GDGFLG
GDGWRAP  EQU   GDGFLG
GDGPAK   EQU   GDGLHEAD+22
GDGMVL   EQU   GDGLHEAD+20
GDGFRE   EQU   GDGLHEAD+18
GDGFRS   EQU   GDGLHEAD+16
GDGTOE   EQU   GDGLHEAD+14
GDGTOS   EQU   GDGLHEAD+12
GDGPLEV  EQU   GDGLHEAD+10
GDGVALB  EQU   GDGLHEAD+8
GDGCNT   EQU   GDGLHEAD+6
GDGLMT   EQU   GDGLHEAD+4
GDGVAL   EQU   GDGLHEAD
DITDGML  EQU   DITABE+12
DITCITAB EQU   @NM00143+1
@NM00144 EQU   @NM00143
@NM00142 EQU   @NM00140+2
DITOSN   EQU   DITVSN+1
@NM00141 EQU   DITVSN
DITOFS   EQU   DITABE+2
DITFB256 EQU   DITFLB
@NM00139 EQU   DITFLB
DITFBDGO EQU   DITFLB
@NM00138 EQU   DITFLB
DITFBAS2 EQU   DITFLB
DITFBAS1 EQU   DITFLB
DITFBGOE EQU   DITFLB
DITFBHEP EQU   DITFLB
@NM00137 EQU   DITFA
@NM00136 EQU   DITFA
@NM00135 EQU   DITFA
@NM00134 EQU   DITFA
DITFADEL EQU   DITFA
DITFARAS EQU   DITFA
DITFAVER EQU   DITFA
@NM00133 EQU   DITFA
GDIENTRY EQU   GDITS+12
GDITHEAD EQU   GDITS
CITEXTBA EQU   @NM00131+1
@NM00132 EQU   @NM00131
CITEXTCH EQU   @NM00129+1
@NM00130 EQU   @NM00129
CITDITAB EQU   @NM00128+1
CITDICNT EQU   @NM00128
CITRCIN  EQU   @NM00127+1
CITTYPE  EQU   @NM00127
CITCIN   EQU   CITABE+1
CITFADGO EQU   CITFLA
CITFAINV EQU   CITFLA
CITFASCA EQU   CITFLA
CITFAGOE EQU   CITFLA
CITFAHEP EQU   CITFLA
CITFARAS EQU   CITFLA
CITFAVER EQU   CITFLA
@NM00126 EQU   CITFLA
CITABENT EQU   GCITS+12
GCITHEAD EQU   GCITS
PTASCIT1 EQU   PTASOE+4
PTASDIT1 EQU   PTASOE
PTLDITID EQU   PTLOC+19
@NM00125 EQU   PTLDITFB
PTLFBDGO EQU   PTLDITFB
@NM00124 EQU   PTLDITFB
PTLFBAS2 EQU   PTLDITFB
PTLFBAS1 EQU   PTLDITFB
PTLFBGOE EQU   PTLDITFB
PTLFBHEP EQU   PTLDITFB
PTLSN    EQU   PTLOC+16
PTLNDIT  EQU   @NM00122+1
@NM00123 EQU   @NM00122
PTLCDIT  EQU   PTLOC+8
PTLCCIT  EQU   PTLOC+4
PTLBCITX EQU   @NM00120+1
@NM00121 EQU   @NM00120
@NM00119 EQU   PTF2
PTF2KSDS EQU   PTF2
PTF1ENDA EQU   PTF1
PTF1ENDG EQU   PTF1
PTF1END  EQU   PTF1
PTF1CKVL EQU   PTF1
PTF1DELT EQU   PTF1
PTF1OK   EQU   PTF1
PTF1HIT2 EQU   PTF1
PTF1HIT  EQU   PTF1
PTCRAVL  EQU   PTYPEDTA+184
@NM00118 EQU   PTXFLAGS+1
@NM00117 EQU   PTXFLAG1
PTXEXIST EQU   PTXFLAG1
PTXEND   EQU   PTXFLAG1
PTXX2C   EQU   PTXALIAS+28
PTXX1C   EQU   PTXALIAS+26
PTXX0C   EQU   PTXALIAS+24
PTXCITX1 EQU   PTXALIAS+20
PTXX1X0D EQU   PTXALIAS+16
PTXX1X2D EQU   PTXALIAS+12
PTXX1AUD EQU   PTXALIAS+8
PTXX0X1D EQU   PTXALIAS+4
PTXUX1D  EQU   PTXALIAS
PTVDSSNT EQU   PTVERDI+28
@NM00116 EQU   PTVERDI+26
PTVCNT   EQU   PTVERDI+24
PTVDIASS EQU   PTVDI+8
PTVDISNT EQU   PTVDI+4
PTVDICIT EQU   PTVDI
PTBASE   EQU   PTYPEDTA+116
PTINDX5  EQU   PTINDX+10
PTINDX4  EQU   PTINDX+8
PTINDXV  EQU   PTINDX+6
PTINDX3  EQU   PTINDX+4
PTINDX2  EQU   PTINDX+2
PTINDX1  EQU   PTINDX
PTASSCIT EQU   PTASSOE+4
PTASSDIT EQU   PTASSOE
PTASSOC  EQU   PTASSO
PTDITWK  EQU   PTGDIT+20
PTDITF   EQU   PTGDIT+16
PTDITNC  EQU   @NM00114+1
@NM00115 EQU   @NM00114
PTDITL   EQU   @NM00112+1
@NM00113 EQU   @NM00112
PTDITI   EQU   @NM00110+1
@NM00111 EQU   @NM00110
PTCITWK  EQU   PTGCIT+20
PTCITF   EQU   PTGCIT+16
PTCITNC  EQU   @NM00108+1
@NM00109 EQU   @NM00108
PTCITL   EQU   @NM00106+1
@NM00107 EQU   @NM00106
PTCITI   EQU   @NM00104+1
@NM00105 EQU   @NM00104
PTHEAD   EQU   PTWORK
TENTRY   EQU   TABHEAD+12
TABCURR  EQU   THEAD+10
TABMAXT  EQU   THEAD+8
TABFORW  EQU   THEAD+4
TABBACKW EQU   THEAD
TABUG    EQU   TABANCHR+24
TABNU    EQU   @NM00102+1
@NM00103 EQU   @NM00102
TABEN    EQU   TABANCHR+18
@NM00101 EQU   TABANCHR+16
TABSIZ   EQU   TABANCHR+12
TABL     EQU   TABANCHR+4
TABF     EQU   TABANCHR
TASSEN   EQU   TASSO+4
TASSNENT EQU   TASSO+2
@NM00100 EQU   TASSO+1
TASSID   EQU   TASSO
TASSRAB  EQU   TASSENT+2
@NM00099 EQU   TASSFL1
TASSSET  EQU   TASSFL1
TASSIS   EQU   TASSFL1
TASSVER  EQU   TASSFL1
TASSSCAN EQU   TASSFL1
TASSREAD EQU   TASSFL1
TASSTYPE EQU   TASSENT
RSCNHH2  EQU   RSCNCCHH+6
RSCNCC2  EQU   RSCNCCHH+4
RSCNHH1  EQU   RSCNCCHH+2
RSCNCC1  EQU   RSCNCCHH
UCATWRET EQU   UCATWA+4
UCATWRLN EQU   UCATWA+2
RSSCRLST EQU   RECIOWA+872
UCBAREA  EQU   RECIOWA+861
RSCAMIND EQU   RSCAMINN+1
RSCAMINL EQU   RSCAMINN
RSCAMAJN EQU   RECIOWA+808
RSVOLENT EQU   RECIOWA+692
RSVUENT  EQU   RECIOWA+664
UIOVID   EQU   UIOVOL
@NM00098 EQU   RSXCIFL1
RSXCIRNG EQU   RSXCIFL1
@NM00097 EQU   RSXCIXLT+4
RSXCIID  EQU   RSXCIXLT
@NM00096 EQU   RMBFLAGS
@NM00095 EQU   RSRAB+530
RABFLG4  EQU   RABFLGS+3
RABFLG3  EQU   RABFLGS+2
RABFLG2  EQU   RABFLGS+1
RABKEY   EQU   RABFLG1
GRABRAB6 EQU   GRABRABS+20
GRABRAB5 EQU   GRABRABS+16
GRABRAB4 EQU   GRABRABS+12
GRABRAB3 EQU   GRABRABS+8
GRABRAB2 EQU   GRABRABS+4
GRABRAB1 EQU   GRABRABS
GRABRABE EQU   GRAB+8
GRABBB   EQU   GRAB+4
GRABFLG1 EQU   GRABFLGS
@NM00092 EQU   RSCSWA+6
RSCSFCN  EQU   RSCSWA+4
RSCSFAE  EQU   RSCSWA
@NM00091 EQU   RSMARKUN+6
RSMA3FCN EQU   RSMARKUN+4
RSMA3FAE EQU   RSMARKUN
@NM00090 EQU   RSCDSDW+18
RSCDINDX EQU   RSCDSDW+16
RSCDSUMT EQU   RSCDSDW+12
RSCD8FCN EQU   RSCDSDW+10
RSCD3FCN EQU   RSCDSDW+8
RSCD8FAE EQU   RSCDSDW+4
RSCD3FAE EQU   RSCDSDW
RSCDDIR  EQU   RSCDSDIN+12
RSCDVOLR EQU   RSCDSDIN+8
RSCDSNT3 EQU   RSCDSDIN+4
RSCDSNT8 EQU   RSCDSDIN
RSGTMEB  EQU   RSGTIME+11
RSGDELM2 EQU   RSGTIME+9
@NM00089 EQU   RSGTIME+2
RSGDELM1 EQU   RSGTIME
RSGDAY   EQU   RSGDATE+2
RSGYEAR  EQU   RSGDATE
RSGFIXID EQU   RSGENAM+8
RSGTMEA  EQU   RSGENAM+1
RSGDELM  EQU   RSGENAM
RSGUNPK  EQU   RSGENMWA
RSFCPE7  EQU   RSWFNDWA+52
RSFCPE6  EQU   RSWFNDWA+48
RSFCPE5  EQU   RSWFNDWA+44
RSFCPE4  EQU   RSWFNDWA+40
RSFCPE3  EQU   RSWFNDWA+36
RSFCPE2  EQU   RSWFNDWA+32
RSFCPE1  EQU   RSWFNDWA+28
@NM00088 EQU   RSWFNDWA+26
RSWFBMLN EQU   RSWFNDWA+24
RSWFBMAP EQU   RSWFNDWA+20
RSWFBUF  EQU   RSWFNDWA+16
RSWFCIN  EQU   RSWFNDWA+13
RSWFRCSN EQU   RSWFNDWA+12
RSWSEQNR EQU   RSWFNDWA+10
RSWGCODE EQU   RSWFNDWA+9
@NM00087 EQU   RSWSNFLG
RSWFIRST EQU   RSWSNFLG
RSWFONE  EQU   RSWSNFLG
RSWAFINF EQU   RSWFNDWA
@NM00086 EQU   RSCNVTCF+1
@NM00085 EQU   RSCNVTF1
RSCFINN  EQU   RSCNVTF1
RSNN     EQU   RSTTNN+2
RSTT     EQU   RSTTNN
RSCIOCS  EQU   RSCNVTCC
LISTLN   EQU   RSDF00W+36
SETRC    EQU   RSDF00W+32
LISTPTR  EQU   RSDF00W
RSVF4TT  EQU   RSVOLWA+142
@NM00084 EQU   RSVOLWA+141
@NM00083 EQU   RSVFLAGS
RSVWFUPD EQU   RSVFLAGS
RSVREPOS EQU   RSVFLAGS
RSVGTEOF EQU   RSVFLAGS
RSVEXTS  EQU   RSVOLWA+139
RSVF1TTN EQU   RSVF1EXT
RSVF1CTS EQU   RSVOLWA+67
RSVF1PAD EQU   RSVF1TS+14
RSVF1TS2 EQU   RSVF1TS+7
RSVF1TS1 EQU   RSVF1TS
RSVSVTTR EQU   RSVOLWA+48
RSVSCRNM EQU   RSVOLWA+4
RSVSCRPT EQU   RSVOLWA
RSGENDT  EQU   RSGENDTE+1
@NM00082 EQU   RSGENDTE
RSGENTME EQU   RSGENWRK+4
RSGENTPT EQU   RSGENWRK
RSCRGRBP EQU   RSCRWA+4
RSCRENTP EQU   RSCRWA
@NM00081 EQU   RSADUL+10
RSADSTP  EQU   RSADUL+10
RSADFLGS EQU   RSADUL+9
RSADULNM EQU   RSADUL+1
RSADULC  EQU   RSADUL
RSADVLSR EQU   RSADVL+1
RSADVLC  EQU   RSADVL
RSADDDNP EQU   RSADWA+28
RSADULP  EQU   RSADWA+24
RSADVLP  EQU   RSADWA+20
RSADENP  EQU   RSADWA+16
RSADVSRP EQU   RSADWA+12
RSADGRBP EQU   RSADWA+8
RSADDDN  EQU   RSADWA
@NM00080 EQU   RSRWORK+65
RSRXLSV  EQU   RSRWORK+24
RSRFAD   EQU   RSRWORK+12
RSRDAD   EQU   RSRWORK+8
RSRNULNM EQU   RSRNUL+1
RSRNULC  EQU   RSRNUL
RSRNVLSR EQU   RSRNVL+1
RSRNVLC  EQU   RSRNVL
RSRNDDNM EQU   RSRNWA+91
RSRNOLDN EQU   RSRNWA+47
RSRNNOF1 EQU   RSRNFLGS
RSRNVDUP EQU   RSRNFLGS
RSRNSTP  EQU   RSRNFLGS
RSRNFAIL EQU   RSRNFLGS
RSRNRCRS EQU   RSRNFLGS
RSRNEVC  EQU   RSRNWA+44
RSRNEVP  EQU   RSRNWA+40
RSRNULP  EQU   RSRNWA+36
RSRNVLP  EQU   RSRNWA+32
RSRNVSPT EQU   RSRNWA+28
RSRNDDPT EQU   RSRNWA+24
RSRNVLPT EQU   RSRNWA+20
RSRNGRBP EQU   RSRNWA+16
RSRNPVLS EQU   RSRNPLST+12
RSRNPNDS EQU   RSRNPLST+8
RSRNPODS EQU   RSRNPLST+4
RSRNPFLG EQU   RSRNPLST
RSSVENT  EQU   RSINWA+55
RSINALL  EQU   RSINFLGS
@NM00079 EQU   RSINATR1
RSINRCV  EQU   RSINATR1
@NM00078 EQU   RSINATR1
RSINTS   EQU   RSINWA+45
RSINVLSR EQU   RSINWA+39
RSINSVVL EQU   RSINWA+33
RSINDVLV EQU   RSINDVL+1
RSINDVLL EQU   RSINDVL
RSINDDPT EQU   RSINWA+20
RSINDNPT EQU   RSINWA+16
RSINDVPT EQU   RSINWA+12
RSINCVPT EQU   RSINWA+8
RSINWACB EQU   RSINWA+4
RSINUAP  EQU   RSINWA
RSCISVLK EQU   RSCIWA+44
RSCIEXT  EQU   RSCIWA+24
RSCIDFCI EQU   RSCIWA+20
RSCIRMEN EQU   RSCIWA+16
RSCILCI  EQU   RSCIWA+12
RSCINXCI EQU   RSCIWA+8
RSCIEXCU EQU   RSCIWA+4
@NM00077 EQU   RSCKFLAG
RSCKTSW  EQU   RSCKFLAG
RSCKIDX3 EQU   RSCKERRW+48
RSCKIDX2 EQU   RSCKERRW+46
RSCKIDX1 EQU   RSCKERRW+44
RSOURCC  EQU   RSCKERRW+40
RSCKMDTB EQU   RSCKTIME+20
RSCKMDY  EQU   RSCKTIME+14
RSCKHMS  EQU   RSCKTIME+8
RSCKPDAY EQU   RSCKTIME+4
RSCKDAYS EQU   RSCKTIME
RSCKTPTR EQU   RSCKERRW+4
RSCKERNO EQU   RSCKERR+2
@NM00076 EQU   RSREASW
REASSW2  EQU   RSREASW
REASSW1  EQU   RSREASW
@NM00075 EQU   @NM00074+3
RSVIAGRB EQU   @NM00074
RSVIACIN EQU   @NM00072+1
@NM00073 EQU   RSVIAFLG
RSVIARRN EQU   RSVIAFLG
RSVIAUPD EQU   RSVIAFLG
RSVIAIS  EQU   RSVIAFLG
RSVIAFND EQU   RSVIAFLG
RSVIADUP EQU   RSVIAFLG
RSVIAFCR EQU   RSVIAFLG
@NM00071 EQU   RSGETVIA+8
RSVIAIDX EQU   RSGETVIA+6
@NM00070 EQU   RSVIACRA+4
RSVIADSC EQU   RSVIACRA
@NM00069 EQU   @NM00067+3
RSEOVERR EQU   @NM00067+2
@NM00068 EQU   RSEOVFLG
RSEOVPHY EQU   RSEOVFLG
RSEOVLOG EQU   RSEOVFLG
RSEOVEND EQU   RSEOVFLG
RSEOVFND EQU   RSEOVFLG
RSEOVXIO EQU   @NM00067
RSCATARG EQU   @NM00065+1
@NM00066 EQU   @NM00065
RSCATRPL EQU   RSEOVWA+4
RSEOVRAB EQU   RSEOVWA
RSPVFLG3 EQU   @NM00062+3
@NM00064 EQU   RSPVFLG2
RSBDVOLS EQU   RSPVFLG2
RSRETSPC EQU   RSPVFLG2
RSSETERR EQU   RSPVFLG2
RSSERROR EQU   RSPVFLG2
RSPERROR EQU   RSPVFLG2
RSVLCATE EQU   RSPVFLG2
RSMUNUS  EQU   RSPVFLG2
RSCK1TO1 EQU   RSPVFLG1
RSCKBERR EQU   RSPVFLG1
RSPVRSC  EQU   RSPVFLG1
RSPVRPC  EQU   RSPVFLG1
RSPVNRP  EQU   RSPVFLG1
RSPVDELT EQU   RSPVFLG1
RSPVRVOL EQU   RSPVFLG1
RSCHKCON EQU   RSPVFLG1
@NM00063 EQU   RSPVSETB
RSST1TO1 EQU   RSPVSETB
RSPVCLBM EQU   RSPVSETB
RSSETMAP EQU   RSPVSETB
RSSETCRA EQU   RSPVSETB
@NM00061 EQU   RSPVTTNN+15
RSMASK   EQU   RSPVTTNN+14
RSPVKNEX EQU   RSPVTTNN+12
RSPVNN   EQU   RSPVTTNN+10
RSBITPOS EQU   RSPVTTNN+8
RSPVTNEX EQU   RSPVTTNN+6
RSPVNEXT EQU   RSPVTTNN+4
RSSETTT  EQU   RSPVTTNN
RSPVSNT8 EQU   RSPVSNT+16
RSPVSNT6 EQU   RSPVSNT+12
RSPVSNT5 EQU   RSPVSNT+8
RSPVSNT3 EQU   RSPVSNT+4
RSPVSNTC EQU   RSPVSNT
TMPSZ    EQU   RSPROCVL+44
RSMAPSIZ EQU   RSPROCVL+40
RSFROMAP EQU   RSMAPAD+16
RSTOMAP  EQU   RSMAPAD+12
RSSTBMAP EQU   RSMAPAD+8
RSCKBMAP EQU   RSMAPAD+4
RSTGBMAP EQU   RSMAPAD
RSSCBMAP EQU   RSMAPS+16
RSCRBMAP EQU   RSPCBMAP
RSCABMAP EQU   RSSBMAP
RSPBMAP  EQU   RSMAPS+4
RSWKBMAP EQU   RSMAPS
RSGDGNM  EQU   RSGDG+10
RSGDGLN  EQU   RSGDG+8
RSGDGLL  EQU   RSGDG+4
@NM00060 EQU   RSASSFLG+1
@NM00059 EQU   RSASSFL1
RSASDSDI EQU   RSASSFL1
RSASSEPA EQU   RSASSFL1
RSASSPAS EQU   RSASSOC+14
RSASSEXT EQU   RSASSOC+12
RSASSEND EQU   RSASSOC+8
RSASSCIN EQU   RSASSOC+4
@NM00058 EQU   RSFLAGI2+1
RSBADVOL EQU   RSFLAGI2+1
RSUCDTN  EQU   RSFLAGI2+1
RSUCATN  EQU   RSFLAGI2+1
RSHAVECR EQU   RSFLAGI2+1
RSFDELET EQU   RSFLAGI2+1
RSSRNSCN EQU   RSFLAGI2+1
RSUCCCR  EQU   RSFLAGI2
RSUCTWWF EQU   RSFLAGI2
RSUCWFTN EQU   RSFLAGI2
RSUCCATN EQU   RSFLAGI2
RSMEBYV  EQU   RSFLAGI2
RSMEOP   EQU   RSFLAGI2
RSMETRM  EQU   RSFLAGI2
RSCCVFND EQU   RSFLAGI2
@NM00057 EQU   RSFLAGI1
RSDUPNRR EQU   RSFLAGI1
RSRENRR  EQU   RSFLAGI1
RSREARR  EQU   RSFLAGI1
RSCREXC  EQU   RSFLAGN2
RSCREOV  EQU   RSFLAGN2
RSTERM   EQU   RSFLAGN2
RSCRAUA  EQU   RSFLAGN2
RSWFCREA EQU   RSFLAGN2
RSCAEOV  EQU   RSFLAGN2
RSENUFCI EQU   RSFLAGN2
RSCARES  EQU   RSFLAGN1
RSREASND EQU   RSFLAGN1
RSVTOPN  EQU   RSFLAGN1
RSNCTS   EQU   RSNEWCAT+10
RSNCDEVT EQU   RSNEWCAT+6
RSNCVLSR EQU   RSNEWCAT
RSWCATPS EQU   RSWORK+949
RSWCATNM EQU   RSWORK+905
RSMRPS   EQU   RSWORK+814
RSCATVLS EQU   RSWORK+808
RSCATNCI EQU   RSWORK+805
RSCATTN  EQU   RSWORK+761
RSCATPS  EQU   RSWORK+753
RSCATDSN EQU   RSWORK+709
RSCATDDN EQU   RSWORK+701
RSUCCINO EQU   RSWORK+697
RSNOBLKT EQU   RSWORK+694
RSIDX2   EQU   RSWORK+690
RSIDX1   EQU   RSWORK+688
RSIDX    EQU   RSWORK+686
RSCAFUCN EQU   RSWORK+684
RSGOPLEN EQU   RSWORK+682
RSORSTAT EQU   RSORVLLS+12
RSORNVOL EQU   RSORVLLS+6
RSORNDEV EQU   RSORVLLS+2
RSORVLCT EQU   RSORVLLS
RSCRAVLN EQU   RSWORK+664
RSCHCRAN EQU   RSWORK+660
RSF1RNAM EQU   RSWORK+652
RSCIREMC EQU   RSWORK+648
RSCATSCN EQU   RSWORK+644
RSSUBSSZ EQU   RSWORK+640
RSSUBSTP EQU   RSWORK+636
RSSUBENP EQU   RSWORK+632
RSSUBGRP EQU   RSWORK+628
RSPROCRC EQU   RSWORK+620
RSCRADD  EQU   RSWORK+608
RSCIXLTB EQU   RSWORK+604
RSCATUCB EQU   RSWORK+596
RSCATACB EQU   RSWORK+592
RSCAPAS  EQU   RSWORK+588
RSUCNXT  EQU   RSWORK+564
RSTNNXT  EQU   RSWORK+560
RSDUPNXT EQU   RSWORK+556
RSRENEXT EQU   RSWORK+552
RSECPA   EQU   RSWORK+548
RSECBF1  EQU   RSWORK+544
RSVTIOCS EQU   RSWORK+536
RSMRPAS  EQU   RSWORK+508
RSGDT    EQU   RSWORK+504
RSXRREND EQU   RSWORK+500
RSENTNXT EQU   RSWORK+492
RSENTFBK EQU   RSWORK+488
RSENTST  EQU   RSWORK+480
RSTNCHN  EQU   RSWORK+476
RSREASS  EQU   RSWORK+472
RSREASSN EQU   RSWORK+468
RSVOLLUS EQU   RSWORK+464
RSVOLLST EQU   RSWORK+460
RSRESLUS EQU   RSWORK+456
RSVOLALL EQU   RSWORK+452
RSWFHURR EQU   RSWORK+448
RSFPL    EQU   RSWORK+392
RSFDT    EQU   RSWORK+388
RSCURRN  EQU   RSWORK+384
RSCURCI  EQU   RSWORK+380
RSCREND  EQU   RSWORK+376
RSCANFCN EQU   RSWORK+368
RSCMRR   EQU   RSWORK+364
RSCACDE  EQU   RSWORK+360
RSAVNEXT EQU   RSWORK+356
RSAVAILN EQU   RSWORK+352
RS07RG12 EQU   RS07REGS+16
RS07RG11 EQU   RS07REGS+12
RS07RG10 EQU   RS07REGS+8
RS07RG09 EQU   RS07REGS+4
RS07RG08 EQU   RS07REGS
RS06RG12 EQU   RS06REGS+16
RS06RG11 EQU   RS06REGS+12
RS06RG10 EQU   RS06REGS+8
RS05RG12 EQU   RS05REGS+16
RS05RG11 EQU   RS05REGS+12
RS05RG10 EQU   RS05REGS+8
RS05RG09 EQU   RS05REGS+4
RS05RG08 EQU   RS05REGS
RS04RG12 EQU   RS04REGS+16
RS04RG11 EQU   RS04REGS+12
RS04RG10 EQU   RS04REGS+8
RS04RG09 EQU   RS04REGS+4
RS04RG08 EQU   RS04REGS
RS03RG12 EQU   RS03REGS+16
RS03RG11 EQU   RS03REGS+12
RS03RG10 EQU   RS03REGS+8
RS03RG09 EQU   RS03REGS+4
RS03RG08 EQU   RS03REGS
RS02RG12 EQU   RS02REGS+16
RS02RG11 EQU   RS02REGS+12
RS02RG10 EQU   RS02REGS+8
RS02RG09 EQU   RS02REGS+4
RS02RG08 EQU   RS02REGS
RS01RG12 EQU   RS01REGS+16
RS01RG11 EQU   RS01REGS+12
RS01RG10 EQU   RS01REGS+8
RS01RG09 EQU   RS01REGS+4
RS01RG08 EQU   RS01REGS
RSTABAD  EQU   RSTAB+16
RSTWKIX  EQU   @NM00055+1
@NM00056 EQU   @NM00055
RSTENTIX EQU   @NM00053+1
@NM00054 EQU   @NM00053
RSTENTAD EQU   RSTAB+4
RSPTWKUG EQU   RSPSTACK+24
@NM00052 EQU   RSPSTACK+20
@NM00051 EQU   RSPSTACK+18
@NM00050 EQU   RSPSTACK+16
RSPTWKLN EQU   RSPSTACK+12
RSPTWKL  EQU   RSPSTACK+4
RSPTWKF  EQU   RSPSTACK
RSGDITUG EQU   RSGDITS+24
RSGDITNU EQU   @NM00048+1
@NM00049 EQU   @NM00048
RSGDITEN EQU   RSGDITS+18
@NM00047 EQU   RSGDITS+16
RSGDITLN EQU   RSGDITS+12
RSGDITL  EQU   RSGDITS+4
RSGDITF  EQU   RSGDITS
RSGCITUG EQU   RSGCITS+24
RSGCITNU EQU   @NM00045+1
@NM00046 EQU   @NM00045
RSGCITEN EQU   RSGCITS+18
@NM00044 EQU   RSGCITS+16
RSGCITLN EQU   RSGCITS+12
RSGCITL  EQU   RSGCITS+4
RSGCITF  EQU   RSGCITS
RSCRVL   EQU   RSWORK+104
RSCPE8   EQU   RSWORK+96
RSCPE4   EQU   RSWORK+80
RSCPE3   EQU   RSWORK+76
RSCITDUM EQU   RSWORK+48
RSCANFCI EQU   RSWORK+44
RSCAHALC EQU   RSWORK+36
RSCAHACI EQU   RSWORK+32
RSCAFUCI EQU   RSWORK+28
RSCADS   EQU   RSWORK+24
RSCADD   EQU   RSWORK+20
RSAVAIL  EQU   RSWORK+8
RSA      EQU   RSWORK
RSF1RNNM EQU   RSF1RNTB+14
RSF1RNDV EQU   RSF1RNTB+10
RSF1RNVL EQU   RSF1RNTB+4
RSF1RNNX EQU   RSF1RNTB
RESVLEXT EQU   RESVOL+28
RESVLDDN EQU   RESVOL+20
@NM00043 EQU   RESVOL+12
RESVLNEX EQU   RESVOL+10
@NM00042 EQU   RESVLFLG
RESVLBAD EQU   RESVLFLG
RESVLLAS EQU   RESVLFLG
RESVLALE EQU   RESVLFLG
RESVLMNT EQU   RESVLFLG
RESVLUPD EQU   RESVOL+4
RESVLNXT EQU   RESVOL
VOLSRTS  EQU   VOLSERTB+20
VOLSRSER EQU   VOLSERTB+14
VOLSRNTK EQU   VOLSERTB+12
VOLSRLAS EQU   VOLSRFLG
VOLSRCI  EQU   VOLSERTB+4
VOLSRNXT EQU   VOLSERTB
CATIHRBA EQU   CATIEXT+16
CATILRBA EQU   CATIEXT+12
@NM00041 EQU   CATIEXT
@NM00039 EQU   IOCRCV
IOCRCVRA EQU   IOCRCV
IOCRCVXM EQU   IOCRCV
IOCVLN   EQU   IOCSEX+42
IOCDNM   EQU   IOCSEX+40
IOCMODEX EQU   IOCMOD
IOCMODRP EQU   IOCMOD
IOCMODXM EQU   IOCMOD
IOCMODUB EQU   IOCMOD
IOCMODRG EQU   IOCMOD
IOCMODDY EQU   IOCMOD
IOCMODRR EQU   IOCMOD
IOCMODPD EQU   IOCMOD
IOCINFR1 EQU   IOCINF
IOCINFCT EQU   IOCINF
IOCINFDO EQU   IOCINF
IOCINFAC EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAE EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00038 EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
IOCDEVDA EQU   IOCDEV
@NM00037 EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGEF EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
IOCFLGEX EQU   IOCFLG
IOCSID   EQU   IOCSEX+28
IOCNIO   EQU   IOCSEX+24
@NM00036 EQU   IOCXPM+2
IOCEXL   EQU   IOCXPM
IOCEXA   EQU   IOCXAD
IOCCBL   EQU   IOCSEX+8
IOCDEC   EQU   IOCRPL
IOCCBA   EQU   IOCSEX
@NM00035 EQU   IODATA+64
IODAEI   EQU   IODATA+60
@NM00034 EQU   IODATA+56
IODIOX   EQU   IODATA+52
IODOCS   EQU   IODATA+48
IODICS   EQU   IODATA+44
IODOSO   EQU   IODATA+40
IODOSS   EQU   IODATA+36
IODEOD   EQU   IODATA+32
@NM00033 EQU   IODATA+30
@NM00032 EQU   IODATA+28
IODOEV   EQU   IODATA+24
IODIEV   EQU   IODATA+20
IODINC   EQU   IODSID+2
IODMID   EQU   IODSID
IODXTN   EQU   IODATA+12
IODADD   EQU   IODATA+8
IODMSG   EQU   IODATA+4
IODIOC   EQU   IODATA
WFILEVAL EQU   WFILE+10
WFILELEN EQU   WFILE+9
WFILEPAS EQU   WFILE+1
WFILEPLN EQU   WFILE
CRADVVAL EQU   CRADV+1
CRADVLEN EQU   CRADV
CRAVLVAL EQU   CRAVL+1
CRAVLLEN EQU   CRAVL
CRADNVAL EQU   CRADN+1
CRADNLEN EQU   CRADN
WCATVAL  EQU   WCAT+21
WCATLEN  EQU   WCAT+20
WCATMEM  EQU   WCAT+12
WCATMLN  EQU   WCAT+11
WCATFUQ  EQU   WCATFLG
WCATPOS  EQU   WCAT+9
WCATPAS  EQU   WCAT+1
WCATPLN  EQU   WCAT
MRPWVAL  EQU   MRPW+1
MRPWLEN  EQU   MRPW
CATDNVAL EQU   CATDN+1
CATDNLEN EQU   CATDN
CATNMVAL EQU   CATNM+21
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
CATNMPAS EQU   CATNM+1
CATNMPLN EQU   CATNM
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00698 EQU   @RC00695
@RC00807 EQU   @RC00805
@RF00821 EQU   @RC00805
@RC00815 EQU   @RC00805
@RF00828 EQU   @RC00825
@RF00888 EQU   @RC00884
@RF00930 EQU   @RC00927
@RF00967 EQU   @RC00963
@RC00978 EQU   @RC00977
@RF01144 EQU   @RC01139
@RC01142 EQU   @RC01139
@RF01224 EQU   @RC01221
@PB00021 EQU   @EL00001
@RF00810 EQU   @RC00807
@ENDDATA EQU   *
         END   IDCRS06,(C'PLS0030',0701,77116)

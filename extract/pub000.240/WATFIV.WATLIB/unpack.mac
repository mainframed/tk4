      SUBROUTINE     U N P A C K   (JNUNIT,JOUT)
COPYRIGHT 1970   UNIVERSITY OF WATERLOO
      IMPLICIT INTEGER (A-Z);   CHARACTER IN72*7
     *2,OUT72*72,IN(72),OUT(72),IN15*5,OUT15*5,IN6,OUT6,SEMI/Z5E/,COLON/
     *Z7A/,BLANK/Z40/;EQUIVALENCE(IN72,IN,IN15),(IN(6),IN6),(OUT72,OUT,O
     *UT15),(OUT(6),OUT6);COMMON/UNPKRD/INUNIT,I,IN;COMMON/UNPKPN/NOUT,S
     *EQNCE,O,OUT72;O=7;OUT72=BLANK;INUNIT=JNUNIT;NOUT=JOUT;SEQNCE=0;
 1    CALLREAD(&2);2:OUT15=IN15;O=7;10:IF(IN(I).EQ.SEMI)GOTO40;IF(IN(I).
     *EQ.BLANK.AND.O.EQ.7)GOTO11;20:OUT(O)=IN(I);I=I+1;IF(I.LT.73)GOTO25
12    CALLREAD(&2);IF(IN6.NE.BLANK)GOTO25;CALLPUNCH;GOTO2;11:I=I+1;IF(I.
     *LT.73)GOTO10;GOTO12;25:O=O+1;IF(O.NE.73)GOTO10;CALLPUNCH;IF(IN(I).
     *EQ.SEMI)GOTO50;OUT6='*';30:O=7;GOTO20;40:CALLPUNCH;50:I=I+1;IF(I.E
     *Q.73)GOTO1;IF(IN(I).EQ.BLANK)GOTO50;IF(IN(I).LT.'0')GOTO30;O=1;
60    OUT(O)=IN(I);O=O+1;I=I+1;IF(I.EQ.73)CALLREAD(&2);IF(IN(I).NE.COLON
     *)GOTO60;O=7;61:I=I+1;IF(I.EQ.73)CALLREAD(&2);IF(IN(I).EQ.BLANK)GOT
     *O61;GOTO20;END;SUBROUTINEREAD(*);CHARACTERIN72*72,IN(72),IN1,OUT72
     **72,BLANK/Z40/;COMMON/UNPKRD/INUNIT,I,IN;COMMON/UNPKPN/NOUT,JSEQ,I
     *O,OUT72;EQUIVALENCE(IN72,IN,IN1);IND=0;1:READ(INUNIT,10,END=9)IN72
      IF(IN1.NE.'C')GOTO5;IND=1;IF(IO.NE.7)CALLPUNCH;OUT72=IN72;CALLPUNC
     *H;GOTO1;5:I=7;IF(IND.EQ.1)RETURN1;RETURN;9:IF(IO.NE.7)CALLPUNCH;ST
     *OP;10:FORMAT(A72)
      END;SUBROUTINEPUNCH;CHARACTEROUT72*72,OUT(72),BLANK/Z40/;EQUIVALEN
     *CE(OUT72,OUT);COMMON/UNPKPN/NOUT,JSEQ,IO,OUT72
C
      PRINT10,OUT72,JSEQ;WRITE(NOUT,11)OUT72,JSEQ
C
      JSEQ=JSEQ+1;IO=7;OUT72=BLANK;RETURN;10:FORMAT(' ',A72,'00000000',T
     *74,I4)
11    FORMAT(A72,'00000000',T73,I4)
      END
$ENTRY

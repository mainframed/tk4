          SUBROUTINE  F I V P A K     (JNUNIT,JUTUNT)
COPYRIGHT 1970     UNIVERSITY OF WATERLOO
      IMPLICIT  INTEGER   (A-Y);  CHARACTER CARD
     *(72),X,QUOTE/''''/,OUT(1326),IN15*5,OUT15*5,BUFF*72;CHARACTERCHAR1
     *,DUM(4),CARDX*72;EQUIVALENCE(CARD,CARDX,IN15),(OUT,OUT15),(DUM,KK)
     *,(DUM(4),CHAR1);COMMONCARD/IO/INUNIT,OUTUNT/BUF/OUTPTR,OUT/TOTALS/
     *ITOTAL,JTOTAL;COMMON/ST/IX,IY,BUFF;KK=0;INUNIT=JNUNIT;OUTUNT=JUTUN
     *T;ITOTAL=JTOTAL=0;CALLRESET;CALLFLUSH;1:CALLREAD(&999,&200,&300,&4
     *00)
CONTROL IS PASSED TO THE FOLLOWING LOCATIONS B/C
C        999    EOF
C        200    COMMENT
C        300    NEW CARD
C        400    SEPARATOR
      INPTR=7;2:CONTINUE;10:X=CARD(INPTR);IF(X.NE.' ')GOTO12;11:INPTR=IN
     *PTR+1;IF(INPTR.EQ.73)GOTO1;GOTO10;12:IF(X.EQ.QUOTE)GOTO20;IF(X.EQ.
     *'H')GOTO30;13:OUT(OUTPTR)=X;OUTPTR=OUTPTR+1;GOTO11;20:OUT(OUTPTR)=
     *X;OUTPTR=OUTPTR+1;INPTR=INPTR+1;IF(INPTR.NE.73)GOTO22;CALLREAD(&99
     *9,&200,&300,&400);INPTR=7;22:X=CARD(INPTR);IF(X.NE.QUOTE)GOTO20;GO
     *TO13
C    HOLLERITH CONSTANT, CHECK FOR INTEGER BEFORE "H"
30    OUT(OUTPTR)=X;N1=0;IF(OUTPTR.EQ.7)GOTO35;N123=OUTPTR;31:N123=N123-
     *1;CHAR1=OUT(N123);N12=KK-240;IF(N12.LT.0)GOTO34;IF(N12.GT.9)GOTO34
      GOTO31;34:N123=N123+1;IF(N123.EQ.OUTPTR)GOTO35;CHAR1=OUT(N123);N1=
     *N1*10+KK-240;GOTO34;35:OUTPTR=OUTPTR+1;36:IF(N1.EQ.0)GOTO11;INPTR=
     *INPTR+1;IF(INPTR.NE.73)GOTO37;CALLREAD(&999,&200,&300,&400);INPTR=
     *7;37:X=CARD(INPTR);N1=N1-1;OUT(OUTPTR)=X;OUTPTR=OUTPTR+1;GOTO36;
200   IF(OUTPTR.EQ.7)GOTO205;CALLOUTPUT;CALLFLUSH;205:CALLREPRO;GOTO1;
300   IF(OUTPTR.NE.7)CALLOUTPUT;OUT15=IN15;OUTPTR=INPTR=7;GOTO2;400:IF(O
     *UTPTR.EQ.7)GOTO401;CALLOUTPUT;401:CALLFLUSH;CALLRESET;GOTO1;
999   ZPER=JTOTAL*100./ITOTAL;PRINT1000,ITOTAL,JTOTAL,ZPER;RETURN
1000  FORMAT('- CARDS INPUT =',I13/'0CARDS OUTPUT =',I12/'-OUTPUT IS',F7
     *.2,'% OF INPUT'//)
      END;SUBROUTINEREAD(*,*,*,*);CHARACTERC*72,C72(72),C1,C6;COMMONC/IO
     */NIN,NOUT/TOTALS/ITOTAL,JTOTAL;EQUIVALENCE(C,C72,C1),(C72(6),C6);R
     *EAD(NIN,1,END=999)C;IF(C1.EQ.'*')RETURN4;ITOTAL=ITOTAL+1;IF(C1.EQ.
     *'C')RETURN2;IF(C6.EQ.' ')RETURN3;IF(C6.EQ.'0')RETURN3;RETURN;
999   CALLOUTPUT;CALLFLUSH;RETURN1
1     FORMAT(A72)
      END;SUBROUTINEOUTPUT;CHARACTERFMT*7,OUT(1326),OUT15*5,OUT6,BUF16*6
     *,COLON/Z7A/;EQUIVALENCE(FMT,OUT(7)),(OUT,OUT15),(OUT(6),OUT6);COMM
     *ON/BUF/IOUT,OUT/ST/IB,JSEQ,BUF16;DATALEGAL/67/;IF(FMT.EQ.'FORMAT('
     *)CALLFLUSH;IF(IB.NE.7)CALLSEMI;IF(OUT15.EQ.'     ')GOTO20
CHECK TO SEE IF THE STNO IN COLS 1-5 WILL FIT ENTIRELY ON THIS
CARD.  IF NOT, START A NEW CARD TO ELIMINATE STNO CROSS-OVERS B/C
COMPILER WILL NOT ALLOW THEM.
      IF(IB.LT.LEGAL)GOTO15;CALLFLUSH;BUF16=OUT15;GOTO20
CARD-TO-CARD STNO CROSS-OVERS HAVE BEEN ELIMINATED
15    OUT6=COLON;CALLSTNO;20:CALLPACK;IF(FMT.EQ.'FORMAT(')CALLFLUSH;RETU
     *RN;END;SUBROUTINEPACK;CHARACTEROUT(1326),BUFFER(72),BUFF*72,BUF6,C
     *ARD*72,BUF15*5;CHARACTEROUT15*5,OUT6,SEMICO/Z5E/;COMMON/BUF/IOUT,O
     *UT/ST/IB,JSEQ,BUFF/IO/NIN,NOUT;COMMON/TOTALS/IT,JTOTAL//CARD;EQUIV
     *ALENCE(BUFFER,BUFF,BUF15),(BUFFER(6),BUF6),(OUT,OUT15);EQUIVALENCE
     *(OUT(6),OUT6);JOUT=IOUT-1;DO10I=7,JOUT;IF(IB.NE.73)GOTO5;CALLPUNCH
      BUF6='*';5:BUFFER(IB)=OUT(I);10:IB=IB+1;RETURN;ENTRYFLUSH;IF(IB.EQ
     *.7)GOTO12;CALLPUNCH;BUF6=' ';IB=7;12:RETURN;ENTRYSTNO;IF(IB.EQ.7)G
     *OTO20;DO15K=1,6;IF(OUT(K).EQ.' ')GOTO15;BUFFER(IB)=OUT(K);IB=IB+1
      IF(IB.NE.73)GOTO15;CALLPUNCH;BUF6='*';15:CONTINUE;RETURN;20:BUF15=
     *OUT15;OUT6=' ';IB=7;RETURN;ENTRYSEMI;IF(IB.LT.72)GOTO25;CALLPUNCH
      RETURN;25:BUFFER(IB)=SEMICO;IB=IB+1;RETURN;ENTRYRESET;BUFF=' ';IOU
     *T=7;JSEQ=1;BUF6=' ';IB=7;PRINT50;RETURN
50    FORMAT('1* * * * *   F I V P A K   * * * * *'/'+',12X,'F I V P A K
     *'/)
      END;SUBROUTINEPUNCH;CHARACTERB*72,CARD*72;COMMONCARD/ST/I,JSEQ,B/I
     *O/N,M/TOTALS/ITOTAL,JTOTAL/BUF/J;PRINT500,B,JSEQ;WRITE(M,501)B,JSE
     *Q;B=' ';1:JSEQ=JSEQ+1;JTOTAL=JTOTAL+1;I=7;RETURN;ENTRYREPRO;PRINT5
     *00,CARD,JSEQ;WRITE(M,501)CARD,JSEQ;J=7;GOTO1
500   FORMAT(' ',A72,'00000000',T74,I4)
501   FORMAT(A72,'00000000',T73,I4)
      END

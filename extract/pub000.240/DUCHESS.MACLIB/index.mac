         MACRO
&LABEL   INDEX &STR,&REG
.*
.*  SINGLE CHARACTER INDEX FUNCTION
.*  &REG CONTAINS CHARACTER TO BE SEARCHED FOR
.*  &STR IS A LITERAL, OR IS A STRING ADDRESSABLE BY ADCON
.*
         LCLC  &A
&A       SETC  '*+3'
         AIF   ('&STR'(1,1) EQ '''').LIT
&A       SETC  '&STR'
.LIT     ANOP
&LABEL   STC   &REG,INC&SYSNDX
         LA    R14,INR&SYSNDX
         L     R15,=V(INDEX)
         CNOP  2,4
         BALR  R1,R15
         DC    A(*+12),AL1(X'80'),AL3(&A),H'1'
INC&SYSNDX DS    CL2
         AIF   ('&STR'(1,1) NE '''').NOLIT
         DC    AL2(L'INS&SYSNDX)
INS&SYSNDX DC    C&STR
.NOLIT   ANOP
INR&SYSNDX DS    0H
         MEND
